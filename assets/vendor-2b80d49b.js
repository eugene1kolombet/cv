var Fi=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(Fi||{}),Fh=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.WEBGL=1]="WEBGL",s[s.CANVAS=2]="CANVAS",s))(Fh||{}),Yo=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(Yo||{}),Z=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(Z||{}),rs=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(rs||{}),z=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(z||{}),Qi=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))(Qi||{}),et=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(et||{}),$o=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))($o||{}),Oe=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(Oe||{}),Ws=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(Ws||{}),cs=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(cs||{}),Je=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(Je||{}),Ss=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(Ss||{}),xa=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(xa||{}),ze=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(ze||{}),te=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(te||{}),Vf=(s=>(s[s.RED=1]="RED",s[s.GREEN=2]="GREEN",s[s.BLUE=4]="BLUE",s[s.ALPHA=8]="ALPHA",s))(Vf||{}),jt=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(jt||{}),As=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(As||{});const Uf={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},q={ADAPTER:Uf,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var ja=/iPhone/i,od=/iPod/i,ad=/iPad/i,ld=/\biOS-universal(?:.+)Mac\b/i,qa=/\bAndroid(?:.+)Mobile\b/i,hd=/Android/i,fn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,lo=/Silk/i,Qs=/Windows Phone/i,cd=/\bWindows(?:.+)ARM\b/i,ud=/BlackBerry/i,dd=/BB10/i,fd=/Opera Mini/i,md=/\b(CriOS|Chrome)(?:.+)Mobile/i,pd=/Mobile(?:.+)Firefox\b/i,gd=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function f0(s){return function(t){return t.test(s)}}function xd(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var n=f0(e),r={apple:{phone:n(ja)&&!n(Qs),ipod:n(od),tablet:!n(ja)&&(n(ad)||gd(t))&&!n(Qs),universal:n(ld),device:(n(ja)||n(od)||n(ad)||n(ld)||gd(t))&&!n(Qs)},amazon:{phone:n(fn),tablet:!n(fn)&&n(lo),device:n(fn)||n(lo)},android:{phone:!n(Qs)&&n(fn)||!n(Qs)&&n(qa),tablet:!n(Qs)&&!n(fn)&&!n(qa)&&(n(lo)||n(hd)),device:!n(Qs)&&(n(fn)||n(lo)||n(qa)||n(hd))||n(/\bokhttp\b/i)},windows:{phone:n(Qs),tablet:n(cd),device:n(Qs)||n(cd)},other:{blackberry:n(ud),blackberry10:n(dd),opera:n(fd),firefox:n(pd),chrome:n(md),device:n(ud)||n(dd)||n(fd)||n(pd)||n(md)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}const m0=xd.default??xd,Ts=m0(globalThis.navigator);q.RETINA_PREFIX=/@([0-9\.]+)x/;q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xf(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function p0(s){if(s.__esModule)return s;var t=s.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(s).forEach(function(i){var n=Object.getOwnPropertyDescriptor(s,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return s[i]}})}),e}var Yf={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function n(o,h,c){this.fn=o,this.context=h,this.once=c||!1}function r(o,h,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new n(c,u||o,d),m=e?e+h:h;return o._events[m]?o._events[m].fn?o._events[m]=[o._events[m],f]:o._events[m].push(f):(o._events[m]=f,o._eventsCount++),o}function a(o,h){--o._eventsCount===0?o._events=new i:delete o._events[h]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},l.prototype.listeners=function(h){var c=e?e+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,m=new Array(f);d<f;d++)m[d]=u[d].fn;return m},l.prototype.listenerCount=function(h){var c=e?e+h:h,u=this._events[c];return u?u.fn?1:u.length:0},l.prototype.emit=function(h,c,u,d,f,m){var p=e?e+h:h;if(!this._events[p])return!1;var g=this._events[p],v=arguments.length,_,x;if(g.fn){switch(g.once&&this.removeListener(h,g.fn,void 0,!0),v){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,u),!0;case 4:return g.fn.call(g.context,c,u,d),!0;case 5:return g.fn.call(g.context,c,u,d,f),!0;case 6:return g.fn.call(g.context,c,u,d,f,m),!0}for(x=1,_=new Array(v-1);x<v;x++)_[x-1]=arguments[x];g.fn.apply(g.context,_)}else{var y=g.length,b;for(x=0;x<y;x++)switch(g[x].once&&this.removeListener(h,g[x].fn,void 0,!0),v){case 1:g[x].fn.call(g[x].context);break;case 2:g[x].fn.call(g[x].context,c);break;case 3:g[x].fn.call(g[x].context,c,u);break;case 4:g[x].fn.call(g[x].context,c,u,d);break;default:if(!_)for(b=1,_=new Array(v-1);b<v;b++)_[b-1]=arguments[b];g[x].fn.apply(g[x].context,_)}}return!0},l.prototype.on=function(h,c,u){return r(this,h,c,u,!1)},l.prototype.once=function(h,c,u){return r(this,h,c,u,!0)},l.prototype.removeListener=function(h,c,u,d){var f=e?e+h:h;if(!this._events[f])return this;if(!c)return a(this,f),this;var m=this._events[f];if(m.fn)m.fn===c&&(!d||m.once)&&(!u||m.context===u)&&a(this,f);else{for(var p=0,g=[],v=m.length;p<v;p++)(m[p].fn!==c||d&&!m[p].once||u&&m[p].context!==u)&&g.push(m[p]);g.length?this._events[f]=g.length===1?g[0]:g:a(this,f)}return this},l.prototype.removeAllListeners=function(h){var c;return h?(c=e?e+h:h,this._events[c]&&a(this,c)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,s.exports=l})(Yf);var g0=Yf.exports;const Fs=Xf(g0);var Bh={exports:{}};Bh.exports=ya;Bh.exports.default=ya;function ya(s,t,e){e=e||2;var i=t&&t.length,n=i?t[0]*e:s.length,r=$f(s,0,n,e,!0),a=[];if(!r||r.next===r.prev)return a;var l,o,h,c,u,d,f;if(i&&(r=b0(s,t,r,e)),s.length>80*e){l=h=s[0],o=c=s[1];for(var m=e;m<n;m+=e)u=s[m],d=s[m+1],u<l&&(l=u),d<o&&(o=d),u>h&&(h=u),d>c&&(c=d);f=Math.max(h-l,c-o),f=f!==0?32767/f:0}return Cr(r,a,e,l,o,f,0),a}function $f(s,t,e,i,n){var r,a;if(n===Ul(s,t,e,i)>0)for(r=t;r<e;r+=i)a=yd(r,s[r],s[r+1],a);else for(r=e-i;r>=t;r-=i)a=yd(r,s[r],s[r+1],a);return a&&_a(a,a.next)&&(Ir(a),a=a.next),a}function rn(s,t){if(!s)return s;t||(t=s);var e=s,i;do if(i=!1,!e.steiner&&(_a(e,e.next)||Ut(e.prev,e,e.next)===0)){if(Ir(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function Cr(s,t,e,i,n,r,a){if(s){!a&&r&&A0(s,i,n,r);for(var l=s,o,h;s.prev!==s.next;){if(o=s.prev,h=s.next,r?y0(s,i,n,r):x0(s)){t.push(o.i/e|0),t.push(s.i/e|0),t.push(h.i/e|0),Ir(s),s=h.next,l=h.next;continue}if(s=h,s===l){a?a===1?(s=_0(rn(s),t,e),Cr(s,t,e,i,n,r,2)):a===2&&v0(s,t,e,i,n,r):Cr(rn(s),t,e,i,n,r,1);break}}}}function x0(s){var t=s.prev,e=s,i=s.next;if(Ut(t,e,i)>=0)return!1;for(var n=t.x,r=e.x,a=i.x,l=t.y,o=e.y,h=i.y,c=n<r?n<a?n:a:r<a?r:a,u=l<o?l<h?l:h:o<h?o:h,d=n>r?n>a?n:a:r>a?r:a,f=l>o?l>h?l:h:o>h?o:h,m=i.next;m!==t;){if(m.x>=c&&m.x<=d&&m.y>=u&&m.y<=f&&In(n,l,r,o,a,h,m.x,m.y)&&Ut(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function y0(s,t,e,i){var n=s.prev,r=s,a=s.next;if(Ut(n,r,a)>=0)return!1;for(var l=n.x,o=r.x,h=a.x,c=n.y,u=r.y,d=a.y,f=l<o?l<h?l:h:o<h?o:h,m=c<u?c<d?c:d:u<d?u:d,p=l>o?l>h?l:h:o>h?o:h,g=c>u?c>d?c:d:u>d?u:d,v=Ol(f,m,t,e,i),_=Ol(p,g,t,e,i),x=s.prevZ,y=s.nextZ;x&&x.z>=v&&y&&y.z<=_;){if(x.x>=f&&x.x<=p&&x.y>=m&&x.y<=g&&x!==n&&x!==a&&In(l,c,o,u,h,d,x.x,x.y)&&Ut(x.prev,x,x.next)>=0||(x=x.prevZ,y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==n&&y!==a&&In(l,c,o,u,h,d,y.x,y.y)&&Ut(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;x&&x.z>=v;){if(x.x>=f&&x.x<=p&&x.y>=m&&x.y<=g&&x!==n&&x!==a&&In(l,c,o,u,h,d,x.x,x.y)&&Ut(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;y&&y.z<=_;){if(y.x>=f&&y.x<=p&&y.y>=m&&y.y<=g&&y!==n&&y!==a&&In(l,c,o,u,h,d,y.x,y.y)&&Ut(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function _0(s,t,e){var i=s;do{var n=i.prev,r=i.next.next;!_a(n,r)&&Gf(n,i,i.next,r)&&Mr(n,r)&&Mr(r,n)&&(t.push(n.i/e|0),t.push(i.i/e|0),t.push(r.i/e|0),Ir(i),Ir(i.next),i=s=r),i=i.next}while(i!==s);return rn(i)}function v0(s,t,e,i,n,r){var a=s;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&I0(a,l)){var o=Wf(a,l);a=rn(a,a.next),o=rn(o,o.next),Cr(a,t,e,i,n,r,0),Cr(o,t,e,i,n,r,0);return}l=l.next}a=a.next}while(a!==s)}function b0(s,t,e,i){var n=[],r,a,l,o,h;for(r=0,a=t.length;r<a;r++)l=t[r]*i,o=r<a-1?t[r+1]*i:s.length,h=$f(s,l,o,i,!1),h===h.next&&(h.steiner=!0),n.push(M0(h));for(n.sort(w0),r=0;r<n.length;r++)e=E0(n[r],e);return e}function w0(s,t){return s.x-t.x}function E0(s,t){var e=S0(s,t);if(!e)return t;var i=Wf(e,s);return rn(i,i.next),rn(e,e.next)}function S0(s,t){var e=t,i=s.x,n=s.y,r=-1/0,a;do{if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){var l=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=i&&l>r&&(r=l,a=e.x<e.next.x?e:e.next,l===i))return a}e=e.next}while(e!==t);if(!a)return null;var o=a,h=a.x,c=a.y,u=1/0,d;e=a;do i>=e.x&&e.x>=h&&i!==e.x&&In(n<c?i:r,n,h,c,n<c?r:i,n,e.x,e.y)&&(d=Math.abs(n-e.y)/(i-e.x),Mr(e,s)&&(d<u||d===u&&(e.x>a.x||e.x===a.x&&T0(a,e)))&&(a=e,u=d)),e=e.next;while(e!==o);return a}function T0(s,t){return Ut(s.prev,s,t.prev)<0&&Ut(t.next,s,s.next)<0}function A0(s,t,e,i){var n=s;do n.z===0&&(n.z=Ol(n.x,n.y,t,e,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==s);n.prevZ.nextZ=null,n.prevZ=null,C0(n)}function C0(s){var t,e,i,n,r,a,l,o,h=1;do{for(e=s,s=null,r=null,a=0;e;){for(a++,i=e,l=0,t=0;t<h&&(l++,i=i.nextZ,!!i);t++);for(o=h;l>0||o>0&&i;)l!==0&&(o===0||!i||e.z<=i.z)?(n=e,e=e.nextZ,l--):(n=i,i=i.nextZ,o--),r?r.nextZ=n:s=n,n.prevZ=r,r=n;e=i}r.nextZ=null,h*=2}while(a>1);return s}function Ol(s,t,e,i,n){return s=(s-e)*n|0,t=(t-i)*n|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function M0(s){var t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function In(s,t,e,i,n,r,a,l){return(n-a)*(t-l)>=(s-a)*(r-l)&&(s-a)*(i-l)>=(e-a)*(t-l)&&(e-a)*(r-l)>=(n-a)*(i-l)}function I0(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!R0(s,t)&&(Mr(s,t)&&Mr(t,s)&&P0(s,t)&&(Ut(s.prev,s,t.prev)||Ut(s,t.prev,t))||_a(s,t)&&Ut(s.prev,s,s.next)>0&&Ut(t.prev,t,t.next)>0)}function Ut(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function _a(s,t){return s.x===t.x&&s.y===t.y}function Gf(s,t,e,i){var n=co(Ut(s,t,e)),r=co(Ut(s,t,i)),a=co(Ut(e,i,s)),l=co(Ut(e,i,t));return!!(n!==r&&a!==l||n===0&&ho(s,e,t)||r===0&&ho(s,i,t)||a===0&&ho(e,s,i)||l===0&&ho(e,t,i))}function ho(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function co(s){return s>0?1:s<0?-1:0}function R0(s,t){var e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&Gf(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function Mr(s,t){return Ut(s.prev,s,s.next)<0?Ut(s,t,s.next)>=0&&Ut(s,s.prev,t)>=0:Ut(s,t,s.prev)<0||Ut(s,s.next,t)<0}function P0(s,t){var e=s,i=!1,n=(s.x+t.x)/2,r=(s.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&n<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function Wf(s,t){var e=new Vl(s.i,s.x,s.y),i=new Vl(t.i,t.x,t.y),n=s.next,r=t.prev;return s.next=t,t.prev=s,e.next=n,n.prev=e,i.next=e,e.prev=i,r.next=i,i.prev=r,i}function yd(s,t,e,i){var n=new Vl(s,t,e);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Ir(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Vl(s,t,e){this.i=s,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ya.deviation=function(s,t,e,i){var n=t&&t.length,r=n?t[0]*e:s.length,a=Math.abs(Ul(s,0,r,e));if(n)for(var l=0,o=t.length;l<o;l++){var h=t[l]*e,c=l<o-1?t[l+1]*e:s.length;a-=Math.abs(Ul(s,h,c,e))}var u=0;for(l=0;l<i.length;l+=3){var d=i[l]*e,f=i[l+1]*e,m=i[l+2]*e;u+=Math.abs((s[d]-s[m])*(s[f+1]-s[d+1])-(s[d]-s[f])*(s[m+1]-s[d+1]))}return a===0&&u===0?0:Math.abs((u-a)/a)};function Ul(s,t,e,i){for(var n=0,r=t,a=e-i;r<e;r+=i)n+=(s[a]-s[r])*(s[r+1]+s[a+1]),a=r;return n}ya.flatten=function(s){for(var t=s[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,n=0;n<s.length;n++){for(var r=0;r<s[n].length;r++)for(var a=0;a<t;a++)e.vertices.push(s[n][r][a]);n>0&&(i+=s[n-1].length,e.holes.push(i))}return e};var k0=Bh.exports;const Hf=Xf(k0);var Go={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Go.exports;(function(s,t){(function(e){var i=t&&!t.nodeType&&t,n=s&&!s.nodeType&&s,r=typeof Za=="object"&&Za;(r.global===r||r.window===r||r.self===r)&&(e=r);var a,l=2147483647,o=36,h=1,c=26,u=38,d=700,f=72,m=128,p="-",g=/^xn--/,v=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=o-h,b=Math.floor,w=String.fromCharCode,E;function S(F){throw new RangeError(x[F])}function A(F,V){for(var X=F.length,Y=[];X--;)Y[X]=V(F[X]);return Y}function M(F,V){var X=F.split("@"),Y="";X.length>1&&(Y=X[0]+"@",F=X[1]),F=F.replace(_,".");var $=F.split("."),W=A($,V).join(".");return Y+W}function I(F){for(var V=[],X=0,Y=F.length,$,W;X<Y;)$=F.charCodeAt(X++),$>=55296&&$<=56319&&X<Y?(W=F.charCodeAt(X++),(W&64512)==56320?V.push((($&1023)<<10)+(W&1023)+65536):(V.push($),X--)):V.push($);return V}function k(F){return A(F,function(V){var X="";return V>65535&&(V-=65536,X+=w(V>>>10&1023|55296),V=56320|V&1023),X+=w(V),X}).join("")}function R(F){return F-48<10?F-22:F-65<26?F-65:F-97<26?F-97:o}function P(F,V){return F+22+75*(F<26)-((V!=0)<<5)}function B(F,V,X){var Y=0;for(F=X?b(F/d):F>>1,F+=b(F/V);F>y*c>>1;Y+=o)F=b(F/y);return b(Y+(y+1)*F/(F+u))}function L(F){var V=[],X=F.length,Y,$=0,W=m,Q=f,st,mt,ot,xt,ut,St,At,Jt,Wt;for(st=F.lastIndexOf(p),st<0&&(st=0),mt=0;mt<st;++mt)F.charCodeAt(mt)>=128&&S("not-basic"),V.push(F.charCodeAt(mt));for(ot=st>0?st+1:0;ot<X;){for(xt=$,ut=1,St=o;ot>=X&&S("invalid-input"),At=R(F.charCodeAt(ot++)),(At>=o||At>b((l-$)/ut))&&S("overflow"),$+=At*ut,Jt=St<=Q?h:St>=Q+c?c:St-Q,!(At<Jt);St+=o)Wt=o-Jt,ut>b(l/Wt)&&S("overflow"),ut*=Wt;Y=V.length+1,Q=B($-xt,Y,xt==0),b($/Y)>l-W&&S("overflow"),W+=b($/Y),$%=Y,V.splice($++,0,W)}return k(V)}function O(F){var V,X,Y,$,W,Q,st,mt,ot,xt,ut,St=[],At,Jt,Wt,me;for(F=I(F),At=F.length,V=m,X=0,W=f,Q=0;Q<At;++Q)ut=F[Q],ut<128&&St.push(w(ut));for(Y=$=St.length,$&&St.push(p);Y<At;){for(st=l,Q=0;Q<At;++Q)ut=F[Q],ut>=V&&ut<st&&(st=ut);for(Jt=Y+1,st-V>b((l-X)/Jt)&&S("overflow"),X+=(st-V)*Jt,V=st,Q=0;Q<At;++Q)if(ut=F[Q],ut<V&&++X>l&&S("overflow"),ut==V){for(mt=X,ot=o;xt=ot<=W?h:ot>=W+c?c:ot-W,!(mt<xt);ot+=o)me=mt-xt,Wt=o-xt,St.push(w(P(xt+me%Wt,0))),mt=b(me/Wt);St.push(w(P(mt,0))),W=B(X,Jt,Y==$),X=0,++Y}++X,++V}return St.join("")}function G(F){return M(F,function(V){return g.test(V)?L(V.slice(4).toLowerCase()):V})}function U(F){return M(F,function(V){return v.test(V)?"xn--"+O(V):V})}if(a={version:"1.4.1",ucs2:{decode:I,encode:k},decode:L,encode:O,toASCII:U,toUnicode:G},i&&n)if(s.exports==i)n.exports=a;else for(E in a)a.hasOwnProperty(E)&&(i[E]=a[E]);else e.punycode=a})(Za)})(Go,Go.exports);var F0=Go.exports,B0=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;t[e]=n;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var r=Object.getOwnPropertySymbols(t);if(r.length!==1||r[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,e);if(a.value!==n||a.enumerable!==!0)return!1}return!0},_d=typeof Symbol<"u"&&Symbol,D0=B0,N0=function(){return typeof _d!="function"||typeof Symbol!="function"||typeof _d("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:D0()},vd={foo:{}},L0=Object,O0=function(){return{__proto__:vd}.foo===vd.foo&&!({__proto__:null}instanceof L0)},V0="Function.prototype.bind called on incompatible ",Ka=Array.prototype.slice,U0=Object.prototype.toString,X0="[object Function]",Y0=function(t){var e=this;if(typeof e!="function"||U0.call(e)!==X0)throw new TypeError(V0+e);for(var i=Ka.call(arguments,1),n,r=function(){if(this instanceof n){var c=e.apply(this,i.concat(Ka.call(arguments)));return Object(c)===c?c:this}else return e.apply(t,i.concat(Ka.call(arguments)))},a=Math.max(0,e.length-i.length),l=[],o=0;o<a;o++)l.push("$"+o);if(n=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(r),e.prototype){var h=function(){};h.prototype=e.prototype,n.prototype=new h,h.prototype=null}return n},$0=Y0,Dh=Function.prototype.bind||$0,G0=Dh,W0=G0.call(Function.call,Object.prototype.hasOwnProperty),pt,On=SyntaxError,zf=Function,kn=TypeError,Qa=function(s){try{return zf('"use strict"; return ('+s+").constructor;")()}catch{}},Ji=Object.getOwnPropertyDescriptor;if(Ji)try{Ji({},"")}catch{Ji=null}var Ja=function(){throw new kn},H0=Ji?function(){try{return arguments.callee,Ja}catch{try{return Ji(arguments,"callee").get}catch{return Ja}}}():Ja,mn=N0(),z0=O0(),le=Object.getPrototypeOf||(z0?function(s){return s.__proto__}:null),yn={},j0=typeof Uint8Array>"u"||!le?pt:le(Uint8Array),tn={"%AggregateError%":typeof AggregateError>"u"?pt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?pt:ArrayBuffer,"%ArrayIteratorPrototype%":mn&&le?le([][Symbol.iterator]()):pt,"%AsyncFromSyncIteratorPrototype%":pt,"%AsyncFunction%":yn,"%AsyncGenerator%":yn,"%AsyncGeneratorFunction%":yn,"%AsyncIteratorPrototype%":yn,"%Atomics%":typeof Atomics>"u"?pt:Atomics,"%BigInt%":typeof BigInt>"u"?pt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?pt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?pt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?pt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?pt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?pt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?pt:FinalizationRegistry,"%Function%":zf,"%GeneratorFunction%":yn,"%Int8Array%":typeof Int8Array>"u"?pt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?pt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?pt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":mn&&le?le(le([][Symbol.iterator]())):pt,"%JSON%":typeof JSON=="object"?JSON:pt,"%Map%":typeof Map>"u"?pt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!mn||!le?pt:le(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?pt:Promise,"%Proxy%":typeof Proxy>"u"?pt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?pt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?pt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!mn||!le?pt:le(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?pt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":mn&&le?le(""[Symbol.iterator]()):pt,"%Symbol%":mn?Symbol:pt,"%SyntaxError%":On,"%ThrowTypeError%":H0,"%TypedArray%":j0,"%TypeError%":kn,"%Uint8Array%":typeof Uint8Array>"u"?pt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?pt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?pt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?pt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?pt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?pt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?pt:WeakSet};if(le)try{null.error}catch(s){var q0=le(le(s));tn["%Error.prototype%"]=q0}var Z0=function s(t){var e;if(t==="%AsyncFunction%")e=Qa("async function () {}");else if(t==="%GeneratorFunction%")e=Qa("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Qa("async function* () {}");else if(t==="%AsyncGenerator%"){var i=s("%AsyncGeneratorFunction%");i&&(e=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var n=s("%AsyncGenerator%");n&&le&&(e=le(n.prototype))}return tn[t]=e,e},bd={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},jr=Dh,Wo=W0,K0=jr.call(Function.call,Array.prototype.concat),Q0=jr.call(Function.apply,Array.prototype.splice),wd=jr.call(Function.call,String.prototype.replace),Ho=jr.call(Function.call,String.prototype.slice),J0=jr.call(Function.call,RegExp.prototype.exec),tx=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ex=/\\(\\)?/g,sx=function(t){var e=Ho(t,0,1),i=Ho(t,-1);if(e==="%"&&i!=="%")throw new On("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&e!=="%")throw new On("invalid intrinsic syntax, expected opening `%`");var n=[];return wd(t,tx,function(r,a,l,o){n[n.length]=l?wd(o,ex,"$1"):a||r}),n},ix=function(t,e){var i=t,n;if(Wo(bd,i)&&(n=bd[i],i="%"+n[0]+"%"),Wo(tn,i)){var r=tn[i];if(r===yn&&(r=Z0(i)),typeof r>"u"&&!e)throw new kn("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:r}}throw new On("intrinsic "+t+" does not exist!")},Nh=function(t,e){if(typeof t!="string"||t.length===0)throw new kn("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new kn('"allowMissing" argument must be a boolean');if(J0(/^%?[^%]*%?$/,t)===null)throw new On("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=sx(t),n=i.length>0?i[0]:"",r=ix("%"+n+"%",e),a=r.name,l=r.value,o=!1,h=r.alias;h&&(n=h[0],Q0(i,K0([0,1],h)));for(var c=1,u=!0;c<i.length;c+=1){var d=i[c],f=Ho(d,0,1),m=Ho(d,-1);if((f==='"'||f==="'"||f==="`"||m==='"'||m==="'"||m==="`")&&f!==m)throw new On("property names with quotes must have matching quotes");if((d==="constructor"||!u)&&(o=!0),n+="."+d,a="%"+n+"%",Wo(tn,a))l=tn[a];else if(l!=null){if(!(d in l)){if(!e)throw new kn("base intrinsic for "+t+" exists, but the property is not available.");return}if(Ji&&c+1>=i.length){var p=Ji(l,d);u=!!p,u&&"get"in p&&!("originalValue"in p.get)?l=p.get:l=l[d]}else u=Wo(l,d),l=l[d];u&&!o&&(tn[a]=l)}}return l},jf={exports:{}};(function(s){var t=Dh,e=Nh,i=e("%Function.prototype.apply%"),n=e("%Function.prototype.call%"),r=e("%Reflect.apply%",!0)||t.call(n,i),a=e("%Object.getOwnPropertyDescriptor%",!0),l=e("%Object.defineProperty%",!0),o=e("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}s.exports=function(u){var d=r(t,n,arguments);if(a&&l){var f=a(d,"length");f.configurable&&l(d,"length",{value:1+o(0,u.length-(arguments.length-1))})}return d};var h=function(){return r(t,i,arguments)};l?l(s.exports,"apply",{value:h}):s.exports.apply=h})(jf);var nx=jf.exports,qf=Nh,Zf=nx,rx=Zf(qf("String.prototype.indexOf")),ox=function(t,e){var i=qf(t,!!e);return typeof i=="function"&&rx(t,".prototype.")>-1?Zf(i):i};const ax={},lx=Object.freeze(Object.defineProperty({__proto__:null,default:ax},Symbol.toStringTag,{value:"Module"})),hx=p0(lx);var Lh=typeof Map=="function"&&Map.prototype,tl=Object.getOwnPropertyDescriptor&&Lh?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,zo=Lh&&tl&&typeof tl.get=="function"?tl.get:null,Ed=Lh&&Map.prototype.forEach,Oh=typeof Set=="function"&&Set.prototype,el=Object.getOwnPropertyDescriptor&&Oh?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,jo=Oh&&el&&typeof el.get=="function"?el.get:null,Sd=Oh&&Set.prototype.forEach,cx=typeof WeakMap=="function"&&WeakMap.prototype,br=cx?WeakMap.prototype.has:null,ux=typeof WeakSet=="function"&&WeakSet.prototype,wr=ux?WeakSet.prototype.has:null,dx=typeof WeakRef=="function"&&WeakRef.prototype,Td=dx?WeakRef.prototype.deref:null,fx=Boolean.prototype.valueOf,mx=Object.prototype.toString,px=Function.prototype.toString,gx=String.prototype.match,Vh=String.prototype.slice,Ti=String.prototype.replace,xx=String.prototype.toUpperCase,Ad=String.prototype.toLowerCase,Kf=RegExp.prototype.test,Cd=Array.prototype.concat,Ys=Array.prototype.join,yx=Array.prototype.slice,Md=Math.floor,Xl=typeof BigInt=="function"?BigInt.prototype.valueOf:null,sl=Object.getOwnPropertySymbols,Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ve=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Vn||"symbol")?Symbol.toStringTag:null,Qf=Object.prototype.propertyIsEnumerable,Id=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(s){return s.__proto__}:null);function Rd(s,t){if(s===1/0||s===-1/0||s!==s||s&&s>-1e3&&s<1e3||Kf.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof s=="number"){var i=s<0?-Md(-s):Md(s);if(i!==s){var n=String(i),r=Vh.call(t,n.length+1);return Ti.call(n,e,"$&_")+"."+Ti.call(Ti.call(r,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ti.call(t,e,"$&_")}var $l=hx,Pd=$l.custom,kd=tm(Pd)?Pd:null,_x=function s(t,e,i,n){var r=e||{};if(Ei(r,"quoteStyle")&&r.quoteStyle!=="single"&&r.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ei(r,"maxStringLength")&&(typeof r.maxStringLength=="number"?r.maxStringLength<0&&r.maxStringLength!==1/0:r.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Ei(r,"customInspect")?r.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ei(r,"indent")&&r.indent!==null&&r.indent!=="	"&&!(parseInt(r.indent,10)===r.indent&&r.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ei(r,"numericSeparator")&&typeof r.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var l=r.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return sm(t,r);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var o=String(t);return l?Rd(t,o):o}if(typeof t=="bigint"){var h=String(t)+"n";return l?Rd(t,h):h}var c=typeof r.depth>"u"?5:r.depth;if(typeof i>"u"&&(i=0),i>=c&&c>0&&typeof t=="object")return Gl(t)?"[Array]":"[Object]";var u=Lx(r,i);if(typeof n>"u")n=[];else if(em(n,t)>=0)return"[Circular]";function d(R,P,B){if(P&&(n=yx.call(n),n.push(P)),B){var L={depth:r.depth};return Ei(r,"quoteStyle")&&(L.quoteStyle=r.quoteStyle),s(R,L,i+1,n)}return s(R,r,i+1,n)}if(typeof t=="function"&&!Fd(t)){var f=Mx(t),m=uo(t,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(m.length>0?" { "+Ys.call(m,", ")+" }":"")}if(tm(t)){var p=Vn?Ti.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Yl.call(t);return typeof t=="object"&&!Vn?ir(p):p}if(Bx(t)){for(var g="<"+Ad.call(String(t.nodeName)),v=t.attributes||[],_=0;_<v.length;_++)g+=" "+v[_].name+"="+Jf(vx(v[_].value),"double",r);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+Ad.call(String(t.nodeName))+">",g}if(Gl(t)){if(t.length===0)return"[]";var x=uo(t,d);return u&&!Nx(x)?"["+Wl(x,u)+"]":"[ "+Ys.call(x,", ")+" ]"}if(wx(t)){var y=uo(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!Qf.call(t,"cause")?"{ ["+String(t)+"] "+Ys.call(Cd.call("[cause]: "+d(t.cause),y),", ")+" }":y.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Ys.call(y,", ")+" }"}if(typeof t=="object"&&a){if(kd&&typeof t[kd]=="function"&&$l)return $l(t,{depth:c-i});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(Ix(t)){var b=[];return Ed&&Ed.call(t,function(R,P){b.push(d(P,t,!0)+" => "+d(R,t))}),Bd("Map",zo.call(t),b,u)}if(kx(t)){var w=[];return Sd&&Sd.call(t,function(R){w.push(d(R,t))}),Bd("Set",jo.call(t),w,u)}if(Rx(t))return il("WeakMap");if(Fx(t))return il("WeakSet");if(Px(t))return il("WeakRef");if(Sx(t))return ir(d(Number(t)));if(Ax(t))return ir(d(Xl.call(t)));if(Tx(t))return ir(fx.call(t));if(Ex(t))return ir(d(String(t)));if(!bx(t)&&!Fd(t)){var E=uo(t,d),S=Id?Id(t)===Object.prototype:t instanceof Object||t.constructor===Object,A=t instanceof Object?"":"null prototype",M=!S&&ve&&Object(t)===t&&ve in t?Vh.call(Bi(t),8,-1):A?"Object":"",I=S||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",k=I+(M||A?"["+Ys.call(Cd.call([],M||[],A||[]),": ")+"] ":"");return E.length===0?k+"{}":u?k+"{"+Wl(E,u)+"}":k+"{ "+Ys.call(E,", ")+" }"}return String(t)};function Jf(s,t,e){var i=(e.quoteStyle||t)==="double"?'"':"'";return i+s+i}function vx(s){return Ti.call(String(s),/"/g,"&quot;")}function Gl(s){return Bi(s)==="[object Array]"&&(!ve||!(typeof s=="object"&&ve in s))}function bx(s){return Bi(s)==="[object Date]"&&(!ve||!(typeof s=="object"&&ve in s))}function Fd(s){return Bi(s)==="[object RegExp]"&&(!ve||!(typeof s=="object"&&ve in s))}function wx(s){return Bi(s)==="[object Error]"&&(!ve||!(typeof s=="object"&&ve in s))}function Ex(s){return Bi(s)==="[object String]"&&(!ve||!(typeof s=="object"&&ve in s))}function Sx(s){return Bi(s)==="[object Number]"&&(!ve||!(typeof s=="object"&&ve in s))}function Tx(s){return Bi(s)==="[object Boolean]"&&(!ve||!(typeof s=="object"&&ve in s))}function tm(s){if(Vn)return s&&typeof s=="object"&&s instanceof Symbol;if(typeof s=="symbol")return!0;if(!s||typeof s!="object"||!Yl)return!1;try{return Yl.call(s),!0}catch{}return!1}function Ax(s){if(!s||typeof s!="object"||!Xl)return!1;try{return Xl.call(s),!0}catch{}return!1}var Cx=Object.prototype.hasOwnProperty||function(s){return s in this};function Ei(s,t){return Cx.call(s,t)}function Bi(s){return mx.call(s)}function Mx(s){if(s.name)return s.name;var t=gx.call(px.call(s),/^function\s*([\w$]+)/);return t?t[1]:null}function em(s,t){if(s.indexOf)return s.indexOf(t);for(var e=0,i=s.length;e<i;e++)if(s[e]===t)return e;return-1}function Ix(s){if(!zo||!s||typeof s!="object")return!1;try{zo.call(s);try{jo.call(s)}catch{return!0}return s instanceof Map}catch{}return!1}function Rx(s){if(!br||!s||typeof s!="object")return!1;try{br.call(s,br);try{wr.call(s,wr)}catch{return!0}return s instanceof WeakMap}catch{}return!1}function Px(s){if(!Td||!s||typeof s!="object")return!1;try{return Td.call(s),!0}catch{}return!1}function kx(s){if(!jo||!s||typeof s!="object")return!1;try{jo.call(s);try{zo.call(s)}catch{return!0}return s instanceof Set}catch{}return!1}function Fx(s){if(!wr||!s||typeof s!="object")return!1;try{wr.call(s,wr);try{br.call(s,br)}catch{return!0}return s instanceof WeakSet}catch{}return!1}function Bx(s){return!s||typeof s!="object"?!1:typeof HTMLElement<"u"&&s instanceof HTMLElement?!0:typeof s.nodeName=="string"&&typeof s.getAttribute=="function"}function sm(s,t){if(s.length>t.maxStringLength){var e=s.length-t.maxStringLength,i="... "+e+" more character"+(e>1?"s":"");return sm(Vh.call(s,0,t.maxStringLength),t)+i}var n=Ti.call(Ti.call(s,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Dx);return Jf(n,"single",t)}function Dx(s){var t=s.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+xx.call(t.toString(16))}function ir(s){return"Object("+s+")"}function il(s){return s+" { ? }"}function Bd(s,t,e,i){var n=i?Wl(e,i):Ys.call(e,", ");return s+" ("+t+") {"+n+"}"}function Nx(s){for(var t=0;t<s.length;t++)if(em(s[t],`
`)>=0)return!1;return!0}function Lx(s,t){var e;if(s.indent==="	")e="	";else if(typeof s.indent=="number"&&s.indent>0)e=Ys.call(Array(s.indent+1)," ");else return null;return{base:e,prev:Ys.call(Array(t+1),e)}}function Wl(s,t){if(s.length===0)return"";var e=`
`+t.prev+t.base;return e+Ys.call(s,","+e)+`
`+t.prev}function uo(s,t){var e=Gl(s),i=[];if(e){i.length=s.length;for(var n=0;n<s.length;n++)i[n]=Ei(s,n)?t(s[n],s):""}var r=typeof sl=="function"?sl(s):[],a;if(Vn){a={};for(var l=0;l<r.length;l++)a["$"+r[l]]=r[l]}for(var o in s)Ei(s,o)&&(e&&String(Number(o))===o&&o<s.length||Vn&&a["$"+o]instanceof Symbol||(Kf.call(/[^\w$]/,o)?i.push(t(o,s)+": "+t(s[o],s)):i.push(o+": "+t(s[o],s))));if(typeof sl=="function")for(var h=0;h<r.length;h++)Qf.call(s,r[h])&&i.push("["+t(r[h])+"]: "+t(s[r[h]],s));return i}var Uh=Nh,Wn=ox,Ox=_x,Vx=Uh("%TypeError%"),fo=Uh("%WeakMap%",!0),mo=Uh("%Map%",!0),Ux=Wn("WeakMap.prototype.get",!0),Xx=Wn("WeakMap.prototype.set",!0),Yx=Wn("WeakMap.prototype.has",!0),$x=Wn("Map.prototype.get",!0),Gx=Wn("Map.prototype.set",!0),Wx=Wn("Map.prototype.has",!0),Xh=function(s,t){for(var e=s,i;(i=e.next)!==null;e=i)if(i.key===t)return e.next=i.next,i.next=s.next,s.next=i,i},Hx=function(s,t){var e=Xh(s,t);return e&&e.value},zx=function(s,t,e){var i=Xh(s,t);i?i.value=e:s.next={key:t,next:s.next,value:e}},jx=function(s,t){return!!Xh(s,t)},qx=function(){var t,e,i,n={assert:function(r){if(!n.has(r))throw new Vx("Side channel does not contain "+Ox(r))},get:function(r){if(fo&&r&&(typeof r=="object"||typeof r=="function")){if(t)return Ux(t,r)}else if(mo){if(e)return $x(e,r)}else if(i)return Hx(i,r)},has:function(r){if(fo&&r&&(typeof r=="object"||typeof r=="function")){if(t)return Yx(t,r)}else if(mo){if(e)return Wx(e,r)}else if(i)return jx(i,r);return!1},set:function(r,a){fo&&r&&(typeof r=="object"||typeof r=="function")?(t||(t=new fo),Xx(t,r,a)):mo?(e||(e=new mo),Gx(e,r,a)):(i||(i={key:{},next:null}),zx(i,r,a))}};return n},Zx=String.prototype.replace,Kx=/%20/g,nl={RFC1738:"RFC1738",RFC3986:"RFC3986"},Yh={default:nl.RFC3986,formatters:{RFC1738:function(s){return Zx.call(s,Kx,"+")},RFC3986:function(s){return String(s)}},RFC1738:nl.RFC1738,RFC3986:nl.RFC3986},Qx=Yh,rl=Object.prototype.hasOwnProperty,zi=Array.isArray,Ls=function(){for(var s=[],t=0;t<256;++t)s.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return s}(),Jx=function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(zi(i)){for(var n=[],r=0;r<i.length;++r)typeof i[r]<"u"&&n.push(i[r]);e.obj[e.prop]=n}}},im=function(t,e){for(var i=e&&e.plainObjects?Object.create(null):{},n=0;n<t.length;++n)typeof t[n]<"u"&&(i[n]=t[n]);return i},ty=function s(t,e,i){if(!e)return t;if(typeof e!="object"){if(zi(t))t.push(e);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!rl.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var n=t;return zi(t)&&!zi(e)&&(n=im(t,i)),zi(t)&&zi(e)?(e.forEach(function(r,a){if(rl.call(t,a)){var l=t[a];l&&typeof l=="object"&&r&&typeof r=="object"?t[a]=s(l,r,i):t.push(r)}else t[a]=r}),t):Object.keys(e).reduce(function(r,a){var l=e[a];return rl.call(r,a)?r[a]=s(r[a],l,i):r[a]=l,r},n)},ey=function(t,e){return Object.keys(e).reduce(function(i,n){return i[n]=e[n],i},t)},sy=function(s,t,e){var i=s.replace(/\+/g," ");if(e==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},iy=function(t,e,i,n,r){if(t.length===0)return t;var a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),i==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var l="",o=0;o<a.length;++o){var h=a.charCodeAt(o);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||r===Qx.RFC1738&&(h===40||h===41)){l+=a.charAt(o);continue}if(h<128){l=l+Ls[h];continue}if(h<2048){l=l+(Ls[192|h>>6]+Ls[128|h&63]);continue}if(h<55296||h>=57344){l=l+(Ls[224|h>>12]+Ls[128|h>>6&63]+Ls[128|h&63]);continue}o+=1,h=65536+((h&1023)<<10|a.charCodeAt(o)&1023),l+=Ls[240|h>>18]+Ls[128|h>>12&63]+Ls[128|h>>6&63]+Ls[128|h&63]}return l},ny=function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],n=0;n<e.length;++n)for(var r=e[n],a=r.obj[r.prop],l=Object.keys(a),o=0;o<l.length;++o){var h=l[o],c=a[h];typeof c=="object"&&c!==null&&i.indexOf(c)===-1&&(e.push({obj:a,prop:h}),i.push(c))}return Jx(e),t},ry=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},oy=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},ay=function(t,e){return[].concat(t,e)},ly=function(t,e){if(zi(t)){for(var i=[],n=0;n<t.length;n+=1)i.push(e(t[n]));return i}return e(t)},nm={arrayToObject:im,assign:ey,combine:ay,compact:ny,decode:sy,encode:iy,isBuffer:oy,isRegExp:ry,maybeMap:ly,merge:ty},rm=qx,Fo=nm,Er=Yh,hy=Object.prototype.hasOwnProperty,Dd={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},oi=Array.isArray,cy=Array.prototype.push,om=function(s,t){cy.apply(s,oi(t)?t:[t])},uy=Date.prototype.toISOString,Nd=Er.default,_e={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Fo.encode,encodeValuesOnly:!1,format:Nd,formatter:Er.formatters[Nd],indices:!1,serializeDate:function(t){return uy.call(t)},skipNulls:!1,strictNullHandling:!1},dy=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},ol={},fy=function s(t,e,i,n,r,a,l,o,h,c,u,d,f,m,p,g){for(var v=t,_=g,x=0,y=!1;(_=_.get(ol))!==void 0&&!y;){var b=_.get(t);if(x+=1,typeof b<"u"){if(b===x)throw new RangeError("Cyclic object value");y=!0}typeof _.get(ol)>"u"&&(x=0)}if(typeof o=="function"?v=o(e,v):v instanceof Date?v=u(v):i==="comma"&&oi(v)&&(v=Fo.maybeMap(v,function(L){return L instanceof Date?u(L):L})),v===null){if(r)return l&&!m?l(e,_e.encoder,p,"key",d):e;v=""}if(dy(v)||Fo.isBuffer(v)){if(l){var w=m?e:l(e,_e.encoder,p,"key",d);return[f(w)+"="+f(l(v,_e.encoder,p,"value",d))]}return[f(e)+"="+f(String(v))]}var E=[];if(typeof v>"u")return E;var S;if(i==="comma"&&oi(v))m&&l&&(v=Fo.maybeMap(v,l)),S=[{value:v.length>0?v.join(",")||null:void 0}];else if(oi(o))S=o;else{var A=Object.keys(v);S=h?A.sort(h):A}for(var M=n&&oi(v)&&v.length===1?e+"[]":e,I=0;I<S.length;++I){var k=S[I],R=typeof k=="object"&&typeof k.value<"u"?k.value:v[k];if(!(a&&R===null)){var P=oi(v)?typeof i=="function"?i(M,k):M:M+(c?"."+k:"["+k+"]");g.set(t,x);var B=rm();B.set(ol,g),om(E,s(R,P,i,n,r,a,i==="comma"&&m&&oi(v)?null:l,o,h,c,u,d,f,m,p,B))}}return E},my=function(t){if(!t)return _e;if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||_e.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Er.default;if(typeof t.format<"u"){if(!hy.call(Er.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var n=Er.formatters[i],r=_e.filter;return(typeof t.filter=="function"||oi(t.filter))&&(r=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:_e.addQueryPrefix,allowDots:typeof t.allowDots>"u"?_e.allowDots:!!t.allowDots,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:_e.charsetSentinel,delimiter:typeof t.delimiter>"u"?_e.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:_e.encode,encoder:typeof t.encoder=="function"?t.encoder:_e.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:_e.encodeValuesOnly,filter:r,format:i,formatter:n,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:_e.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:_e.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:_e.strictNullHandling}},py=function(s,t){var e=s,i=my(t),n,r;typeof i.filter=="function"?(r=i.filter,e=r("",e)):oi(i.filter)&&(r=i.filter,n=r);var a=[];if(typeof e!="object"||e===null)return"";var l;t&&t.arrayFormat in Dd?l=t.arrayFormat:t&&"indices"in t?l=t.indices?"indices":"repeat":l="indices";var o=Dd[l];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=o==="comma"&&t&&t.commaRoundTrip;n||(n=Object.keys(e)),i.sort&&n.sort(i.sort);for(var c=rm(),u=0;u<n.length;++u){var d=n[u];i.skipNulls&&e[d]===null||om(a,fy(e[d],d,o,h,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}var f=a.join(i.delimiter),m=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),f.length>0?m+f:""},Un=nm,Hl=Object.prototype.hasOwnProperty,gy=Array.isArray,ae={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Un.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},xy=function(s){return s.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},am=function(s,t){return s&&typeof s=="string"&&t.comma&&s.indexOf(",")>-1?s.split(","):s},yy="utf8=%26%2310003%3B",_y="utf8=%E2%9C%93",vy=function(t,e){var i={__proto__:null},n=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,r=e.parameterLimit===1/0?void 0:e.parameterLimit,a=n.split(e.delimiter,r),l=-1,o,h=e.charset;if(e.charsetSentinel)for(o=0;o<a.length;++o)a[o].indexOf("utf8=")===0&&(a[o]===_y?h="utf-8":a[o]===yy&&(h="iso-8859-1"),l=o,o=a.length);for(o=0;o<a.length;++o)if(o!==l){var c=a[o],u=c.indexOf("]="),d=u===-1?c.indexOf("="):u+1,f,m;d===-1?(f=e.decoder(c,ae.decoder,h,"key"),m=e.strictNullHandling?null:""):(f=e.decoder(c.slice(0,d),ae.decoder,h,"key"),m=Un.maybeMap(am(c.slice(d+1),e),function(p){return e.decoder(p,ae.decoder,h,"value")})),m&&e.interpretNumericEntities&&h==="iso-8859-1"&&(m=xy(m)),c.indexOf("[]=")>-1&&(m=gy(m)?[m]:m),Hl.call(i,f)?i[f]=Un.combine(i[f],m):i[f]=m}return i},by=function(s,t,e,i){for(var n=i?t:am(t,e),r=s.length-1;r>=0;--r){var a,l=s[r];if(l==="[]"&&e.parseArrays)a=[].concat(n);else{a=e.plainObjects?Object.create(null):{};var o=l.charAt(0)==="["&&l.charAt(l.length-1)==="]"?l.slice(1,-1):l,h=parseInt(o,10);!e.parseArrays&&o===""?a={0:n}:!isNaN(h)&&l!==o&&String(h)===o&&h>=0&&e.parseArrays&&h<=e.arrayLimit?(a=[],a[h]=n):o!=="__proto__"&&(a[o]=n)}n=a}return n},wy=function(t,e,i,n){if(t){var r=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,o=i.depth>0&&a.exec(r),h=o?r.slice(0,o.index):r,c=[];if(h){if(!i.plainObjects&&Hl.call(Object.prototype,h)&&!i.allowPrototypes)return;c.push(h)}for(var u=0;i.depth>0&&(o=l.exec(r))!==null&&u<i.depth;){if(u+=1,!i.plainObjects&&Hl.call(Object.prototype,o[1].slice(1,-1))&&!i.allowPrototypes)return;c.push(o[1])}return o&&c.push("["+r.slice(o.index)+"]"),by(c,e,i,n)}},Ey=function(t){if(!t)return ae;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?ae.charset:t.charset;return{allowDots:typeof t.allowDots>"u"?ae.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:ae.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:ae.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:ae.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ae.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:ae.comma,decoder:typeof t.decoder=="function"?t.decoder:ae.decoder,delimiter:typeof t.delimiter=="string"||Un.isRegExp(t.delimiter)?t.delimiter:ae.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:ae.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:ae.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:ae.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:ae.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ae.strictNullHandling}},Sy=function(s,t){var e=Ey(t);if(s===""||s===null||typeof s>"u")return e.plainObjects?Object.create(null):{};for(var i=typeof s=="string"?vy(s,e):s,n=e.plainObjects?Object.create(null):{},r=Object.keys(i),a=0;a<r.length;++a){var l=r[a],o=wy(l,i[l],e,typeof s=="string");n=Un.merge(n,o,e)}return e.allowSparse===!0?n:Un.compact(n)},Ty=py,Ay=Sy,Cy=Yh,My={formats:Cy,parse:Ay,stringify:Ty},Iy=F0;function Cs(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Ry=/^([a-z0-9.+-]+:)/i,Py=/:[0-9]*$/,ky=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Fy=["<",">",'"',"`"," ","\r",`
`,"	"],By=["{","}","|","\\","^","`"].concat(Fy),zl=["'"].concat(By),Ld=["%","/","?",";","#"].concat(zl),Od=["/","?","#"],Dy=255,Vd=/^[+a-z0-9A-Z_-]{0,63}$/,Ny=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ly={javascript:!0,"javascript:":!0},jl={javascript:!0,"javascript:":!0},Fn={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},ql=My;function va(s,t,e){if(s&&typeof s=="object"&&s instanceof Cs)return s;var i=new Cs;return i.parse(s,t,e),i}Cs.prototype.parse=function(s,t,e){if(typeof s!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var i=s.indexOf("?"),n=i!==-1&&i<s.indexOf("#")?"?":"#",r=s.split(n),a=/\\/g;r[0]=r[0].replace(a,"/"),s=r.join(n);var l=s;if(l=l.trim(),!e&&s.split("#").length===1){var o=ky.exec(l);if(o)return this.path=l,this.href=l,this.pathname=o[1],o[2]?(this.search=o[2],t?this.query=ql.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=Ry.exec(l);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,l=l.substr(h.length)}if(e||h||l.match(/^\/\/[^@/]+@[^@/]+/)){var u=l.substr(0,2)==="//";u&&!(h&&jl[h])&&(l=l.substr(2),this.slashes=!0)}if(!jl[h]&&(u||h&&!Fn[h])){for(var d=-1,f=0;f<Od.length;f++){var m=l.indexOf(Od[f]);m!==-1&&(d===-1||m<d)&&(d=m)}var p,g;d===-1?g=l.lastIndexOf("@"):g=l.lastIndexOf("@",d),g!==-1&&(p=l.slice(0,g),l=l.slice(g+1),this.auth=decodeURIComponent(p)),d=-1;for(var f=0;f<Ld.length;f++){var m=l.indexOf(Ld[f]);m!==-1&&(d===-1||m<d)&&(d=m)}d===-1&&(d=l.length),this.host=l.slice(0,d),l=l.slice(d),this.parseHost(),this.hostname=this.hostname||"";var v=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!v)for(var _=this.hostname.split(/\./),f=0,x=_.length;f<x;f++){var y=_[f];if(y&&!y.match(Vd)){for(var b="",w=0,E=y.length;w<E;w++)y.charCodeAt(w)>127?b+="x":b+=y[w];if(!b.match(Vd)){var S=_.slice(0,f),A=_.slice(f+1),M=y.match(Ny);M&&(S.push(M[1]),A.unshift(M[2])),A.length&&(l="/"+A.join(".")+l),this.hostname=S.join(".");break}}}this.hostname.length>Dy?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=Iy.toASCII(this.hostname));var I=this.port?":"+this.port:"",k=this.hostname||"";this.host=k+I,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!Ly[c])for(var f=0,x=zl.length;f<x;f++){var R=zl[f];if(l.indexOf(R)!==-1){var P=encodeURIComponent(R);P===R&&(P=escape(R)),l=l.split(R).join(P)}}var B=l.indexOf("#");B!==-1&&(this.hash=l.substr(B),l=l.slice(0,B));var L=l.indexOf("?");if(L!==-1?(this.search=l.substr(L),this.query=l.substr(L+1),t&&(this.query=ql.parse(this.query)),l=l.slice(0,L)):t&&(this.search="",this.query={}),l&&(this.pathname=l),Fn[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var I=this.pathname||"",O=this.search||"";this.path=I+O}return this.href=this.format(),this};function Oy(s){return typeof s=="string"&&(s=va(s)),s instanceof Cs?s.format():Cs.prototype.format.call(s)}Cs.prototype.format=function(){var s=this.auth||"";s&&(s=encodeURIComponent(s),s=s.replace(/%3A/i,":"),s+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",n=!1,r="";this.host?n=s+this.host:this.hostname&&(n=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(r=ql.stringify(this.query));var a=this.search||r&&"?"+r||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Fn[t])&&n!==!1?(n="//"+(n||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),a&&a.charAt(0)!=="?"&&(a="?"+a),e=e.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),a=a.replace("#","%23"),t+n+e+a+i};function Vy(s,t){return va(s,!1,!0).resolve(t)}Cs.prototype.resolve=function(s){return this.resolveObject(va(s,!1,!0)).format()};Cs.prototype.resolveObject=function(s){if(typeof s=="string"){var t=new Cs;t.parse(s,!1,!0),s=t}for(var e=new Cs,i=Object.keys(this),n=0;n<i.length;n++){var r=i[n];e[r]=this[r]}if(e.hash=s.hash,s.href==="")return e.href=e.format(),e;if(s.slashes&&!s.protocol){for(var a=Object.keys(s),l=0;l<a.length;l++){var o=a[l];o!=="protocol"&&(e[o]=s[o])}return Fn[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(s.protocol&&s.protocol!==e.protocol){if(!Fn[s.protocol]){for(var h=Object.keys(s),c=0;c<h.length;c++){var u=h[c];e[u]=s[u]}return e.href=e.format(),e}if(e.protocol=s.protocol,!s.host&&!jl[s.protocol]){for(var x=(s.pathname||"").split("/");x.length&&!(s.host=x.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),x[0]!==""&&x.unshift(""),x.length<2&&x.unshift(""),e.pathname=x.join("/")}else e.pathname=s.pathname;if(e.search=s.search,e.query=s.query,e.host=s.host||"",e.auth=s.auth,e.hostname=s.hostname||s.host,e.port=s.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||s.slashes,e.href=e.format(),e}var m=e.pathname&&e.pathname.charAt(0)==="/",p=s.host||s.pathname&&s.pathname.charAt(0)==="/",g=p||m||e.host&&s.pathname,v=g,_=e.pathname&&e.pathname.split("/")||[],x=s.pathname&&s.pathname.split("/")||[],y=e.protocol&&!Fn[e.protocol];if(y&&(e.hostname="",e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(x[0]===""?x[0]=s.host:x.unshift(s.host)),s.host=null),g=g&&(x[0]===""||_[0]==="")),p)e.host=s.host||s.host===""?s.host:e.host,e.hostname=s.hostname||s.hostname===""?s.hostname:e.hostname,e.search=s.search,e.query=s.query,_=x;else if(x.length)_||(_=[]),_.pop(),_=_.concat(x),e.search=s.search,e.query=s.query;else if(s.search!=null){if(y){e.host=_.shift(),e.hostname=e.host;var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.hostname=b.shift(),e.host=e.hostname)}return e.search=s.search,e.query=s.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!_.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var w=_.slice(-1)[0],E=(e.host||s.host||_.length>1)&&(w==="."||w==="..")||w==="",S=0,A=_.length;A>=0;A--)w=_[A],w==="."?_.splice(A,1):w===".."?(_.splice(A,1),S++):S&&(_.splice(A,1),S--);if(!g&&!v)for(;S--;S)_.unshift("..");g&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),E&&_.join("/").substr(-1)!=="/"&&_.push("");var M=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(y){e.hostname=M?"":_.length?_.shift():"",e.host=e.hostname;var b=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;b&&(e.auth=b.shift(),e.hostname=b.shift(),e.host=e.hostname)}return g=g||e.host&&_.length,g&&!M&&_.unshift(""),_.length>0?e.pathname=_.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=s.auth||e.auth,e.slashes=e.slashes||s.slashes,e.href=e.format(),e};Cs.prototype.parseHost=function(){var s=this.host,t=Py.exec(s);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),s=s.substr(0,s.length-t.length)),s&&(this.hostname=s)};var Uy=va,Xy=Vy,Yy=Oy;const lm={parse:Uy,format:Yy,resolve:Xy};function us(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function nr(s){return s.split("?")[0].split("#")[0]}function $y(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Gy(s,t,e){return s.replace(new RegExp($y(t),"g"),e)}function Wy(s,t){let e="",i=0,n=-1,r=0,a=-1;for(let l=0;l<=s.length;++l){if(l<s.length)a=s.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(n===l-1||r===1))if(n!==l-1&&r===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const o=e.lastIndexOf("/");if(o!==e.length-1){o===-1?(e="",i=0):(e=e.slice(0,o),i=e.length-1-e.lastIndexOf("/")),n=l,r=0;continue}}else if(e.length===2||e.length===1){e="",i=0,n=l,r=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${s.slice(n+1,l)}`:e=s.slice(n+1,l),i=l-n-1;n=l,r=0}else a===46&&r!==-1?++r:r=-1}return e}const It={toPosix(s){return Gy(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},hasProtocol(s){return/^[^/:]+:\//.test(this.toPosix(s))},getProtocol(s){us(s),s=this.toPosix(s);let t="";const e=/^file:\/\/\//.exec(s),i=/^[^/:]+:\/\//.exec(s),n=/^[^/:]+:\//.exec(s);if(e||i||n){const r=(e==null?void 0:e[0])||(i==null?void 0:i[0])||(n==null?void 0:n[0]);t=r,s=s.slice(r.length)}return t},toAbsolute(s,t,e){if(this.isDataUrl(s))return s;const i=nr(this.toPosix(t??q.ADAPTER.getBaseUrl())),n=nr(this.toPosix(e??this.rootname(i)));return us(s),s=this.toPosix(s),s.startsWith("/")?It.join(n,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(s=this.toPosix(s),us(s),s.length===0)return".";let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=Wy(s,!1),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return us(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(us(i),i.length>0)if(t===void 0)t=i;else{const n=s[e-1]??"";this.extname(n)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(us(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,n=!0;const r=this.getProtocol(s),a=s;s=s.slice(r.length);for(let l=s.length-1;l>=1;--l)if(t=s.charCodeAt(l),t===47){if(!n){i=l;break}}else n=!1;return i===-1?e?"/":this.isUrl(a)?r+s:r:e&&i===1?"//":r+s.slice(0,i)},rootname(s){us(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){us(s),t&&us(t),s=nr(this.toPosix(s));let e=0,i=-1,n=!0,r;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let a=t.length-1,l=-1;for(r=s.length-1;r>=0;--r){const o=s.charCodeAt(r);if(o===47){if(!n){e=r+1;break}}else l===-1&&(n=!1,l=r+1),a>=0&&(o===t.charCodeAt(a)?--a===-1&&(i=r):(a=-1,i=l))}return e===i?i=l:i===-1&&(i=s.length),s.slice(e,i)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===47){if(!n){e=r+1;break}}else i===-1&&(n=!1,i=r+1);return i===-1?"":s.slice(e,i)},extname(s){us(s),s=nr(this.toPosix(s));let t=-1,e=0,i=-1,n=!0,r=0;for(let a=s.length-1;a>=0;--a){const l=s.charCodeAt(a);if(l===47){if(!n){e=a+1;break}continue}i===-1&&(n=!1,i=a+1),l===46?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||i===-1||r===0||r===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){us(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=nr(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let n;t.root=this.rootname(s),i||this.hasProtocol(s)?n=1:n=0;let r=-1,a=0,l=-1,o=!0,h=s.length-1,c=0;for(;h>=n;--h){if(e=s.charCodeAt(h),e===47){if(!o){a=h+1;break}continue}l===-1&&(o=!1,l=h+1),e===46?r===-1?r=h:c!==1&&(c=1):r!==-1&&(c=-1)}return r===-1||l===-1||c===0||c===1&&r===l-1&&r===a+1?l!==-1&&(a===0&&i?t.base=t.name=s.slice(1,l):t.base=t.name=s.slice(a,l)):(a===0&&i?(t.name=s.slice(1,r),t.base=s.slice(1,l)):(t.name=s.slice(a,r),t.base=s.slice(a,l)),t.ext=s.slice(r,l)),t.dir=this.dirname(s),t},sep:"/",delimiter:":"},Ud={};function rt(s,t,e=3){if(Ud[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),Ud[t]=!0}function Hy(){rt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function zy(){rt("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}let al;function hm(){return typeof al>"u"&&(al=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!q.ADAPTER.getWebGLRenderingContext())return!1;const i=q.ADAPTER.createCanvas();let n=i.getContext("webgl",t)||i.getContext("experimental-webgl",t);const r=!!((e=n==null?void 0:n.getContextAttributes())!=null&&e.stencil);if(n){const a=n.getExtension("WEBGL_lose_context");a&&a.loseContext()}return n=null,r}catch{return!1}}()),al}var jy={grad:.9,turn:360,rad:360/(2*Math.PI)},Js=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},he=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},os=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},cm=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Xd=function(s){return{r:os(s.r,0,255),g:os(s.g,0,255),b:os(s.b,0,255),a:os(s.a)}},ll=function(s){return{r:he(s.r),g:he(s.g),b:he(s.b),a:he(s.a,3)}},qy=/^#([0-9a-f]{3,8})$/i,po=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},um=function(s){var t=s.r,e=s.g,i=s.b,n=s.a,r=Math.max(t,e,i),a=r-Math.min(t,e,i),l=a?r===t?(e-i)/a:r===e?2+(i-t)/a:4+(t-e)/a:0;return{h:60*(l<0?l+6:l),s:r?a/r*100:0,v:r/255*100,a:n}},dm=function(s){var t=s.h,e=s.s,i=s.v,n=s.a;t=t/360*6,e/=100,i/=100;var r=Math.floor(t),a=i*(1-e),l=i*(1-(t-r)*e),o=i*(1-(1-t+r)*e),h=r%6;return{r:255*[i,l,a,a,o,i][h],g:255*[o,i,i,l,a,a][h],b:255*[a,a,o,i,i,l][h],a:n}},Yd=function(s){return{h:cm(s.h),s:os(s.s,0,100),l:os(s.l,0,100),a:os(s.a)}},$d=function(s){return{h:he(s.h),s:he(s.s),l:he(s.l),a:he(s.a,3)}},Gd=function(s){return dm((e=(t=s).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},Sr=function(s){return{h:(t=um(s)).h,s:(n=(200-(e=t.s))*(i=t.v)/100)>0&&n<200?e*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,e,i,n},Zy=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ky=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Qy=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Jy=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Zl={string:[[function(s){var t=qy.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?he(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?he(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=Qy.exec(s)||Jy.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:Xd({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=Zy.exec(s)||Ky.exec(s);if(!t)return null;var e,i,n=Yd({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(jy[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Gd(n)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,i=s.b,n=s.a,r=n===void 0?1:n;return Js(t)&&Js(e)&&Js(i)?Xd({r:Number(t),g:Number(e),b:Number(i),a:Number(r)}):null},"rgb"],[function(s){var t=s.h,e=s.s,i=s.l,n=s.a,r=n===void 0?1:n;if(!Js(t)||!Js(e)||!Js(i))return null;var a=Yd({h:Number(t),s:Number(e),l:Number(i),a:Number(r)});return Gd(a)},"hsl"],[function(s){var t=s.h,e=s.s,i=s.v,n=s.a,r=n===void 0?1:n;if(!Js(t)||!Js(e)||!Js(i))return null;var a=function(l){return{h:cm(l.h),s:os(l.s,0,100),v:os(l.v,0,100),a:os(l.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(r)});return dm(a)},"hsv"]]},Wd=function(s,t){for(var e=0;e<t.length;e++){var i=t[e][0](s);if(i)return[i,t[e][1]]}return[null,void 0]},t_=function(s){return typeof s=="string"?Wd(s.trim(),Zl.string):typeof s=="object"&&s!==null?Wd(s,Zl.object):[null,void 0]},hl=function(s,t){var e=Sr(s);return{h:e.h,s:os(e.s+100*t,0,100),l:e.l,a:e.a}},cl=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Hd=function(s,t){var e=Sr(s);return{h:e.h,s:e.s,l:os(e.l+100*t,0,100),a:e.a}},Kl=function(){function s(t){this.parsed=t_(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return he(cl(this.rgba),2)},s.prototype.isDark=function(){return cl(this.rgba)<.5},s.prototype.isLight=function(){return cl(this.rgba)>=.5},s.prototype.toHex=function(){return t=ll(this.rgba),e=t.r,i=t.g,n=t.b,a=(r=t.a)<1?po(he(255*r)):"","#"+po(e)+po(i)+po(n)+a;var t,e,i,n,r,a},s.prototype.toRgb=function(){return ll(this.rgba)},s.prototype.toRgbString=function(){return t=ll(this.rgba),e=t.r,i=t.g,n=t.b,(r=t.a)<1?"rgba("+e+", "+i+", "+n+", "+r+")":"rgb("+e+", "+i+", "+n+")";var t,e,i,n,r},s.prototype.toHsl=function(){return $d(Sr(this.rgba))},s.prototype.toHslString=function(){return t=$d(Sr(this.rgba)),e=t.h,i=t.s,n=t.l,(r=t.a)<1?"hsla("+e+", "+i+"%, "+n+"%, "+r+")":"hsl("+e+", "+i+"%, "+n+"%)";var t,e,i,n,r},s.prototype.toHsv=function(){return t=um(this.rgba),{h:he(t.h),s:he(t.s),v:he(t.v),a:he(t.a,3)};var t},s.prototype.invert=function(){return Vs({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Vs(hl(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Vs(hl(this.rgba,-t))},s.prototype.grayscale=function(){return Vs(hl(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Vs(Hd(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Vs(Hd(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Vs({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):he(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=Sr(this.rgba);return typeof t=="number"?Vs({h:t,s:e.s,l:e.l,a:e.a}):he(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Vs(t).toHex()},s}(),Vs=function(s){return s instanceof Kl?s:new Kl(s)},zd=[],e_=function(s){s.forEach(function(t){zd.indexOf(t)<0&&(t(Kl,Zl),zd.push(t))})};function s_(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in e)i[e[n]]=n;var r={};s.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,o,h=i[this.toHex()];if(h)return h;if(a!=null&&a.closest){var c=this.toRgb(),u=1/0,d="black";if(!r.length)for(var f in e)r[f]=new s(e[f]).toRgb();for(var m in e){var p=(l=c,o=r[m],Math.pow(l.r-o.r,2)+Math.pow(l.g-o.g,2)+Math.pow(l.b-o.b,2));p<u&&(u=p,d=m)}return d}},t.string.push([function(a){var l=a.toLowerCase(),o=l==="transparent"?"#0000":e[l];return o?new s(o).toRgb():null},"name"])}e_([s_]);const Bn=class{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Bn)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,a)=>r===e[a]);if(t!==null&&e!==null){const r=Object.keys(t),a=Object.keys(e);return r.length!==a.length?!1:r.every(l=>t[l]===e[l])}return t===e}toRgba(){const[t,e,i,n]=this._components;return{r:t,g:e,b:i,a:n}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,n]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(n*255),t}toRgbArray(t){t=t??[];const[e,i,n]=this._components;return t[0]=e,t[1]=i,t[2]=n,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,n,r]=Bn.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=n,this._components[3]*=r,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,r=this._int&255;return e&&(i=i*t+.5|0,n=n*t+.5|0,r=r*t+.5|0),(t*255<<24)+(i<<16)+(n<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,n]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(n*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,n,r]=this._components;return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}normalize(t){let e,i,n,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,i=(a>>8&255)/255,n=(a&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,n,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,n,r=255]=t,e/=255,i/=255,n/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const l=Bn.HEX_PATTERN.exec(t);l&&(t=`#${l[2]}`)}const a=Vs(t);a.isValid()&&({r:e,g:i,b:n,a:r}=a.rgba,e/=255,i/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=n,this._components[3]=r,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((n,r)=>{t[r]=Math.min(Math.max(n,e),i)}),t)}};let bt=Bn;bt.shared=new Bn;bt.temp=new Bn;bt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;function $h(s,t=[]){return rt("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),bt.shared.setValue(s).toRgbArray(t)}function fm(s){return rt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),bt.shared.setValue(s).toHex()}function i_(s){return rt("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),bt.shared.setValue(s).toNumber()}function Dn(s){return rt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),bt.shared.setValue(s).toNumber()}function n_(){const s=[],t=[];for(let i=0;i<32;i++)s[i]=i,t[i]=i;s[Z.NORMAL_NPM]=Z.NORMAL,s[Z.ADD_NPM]=Z.ADD,s[Z.SCREEN_NPM]=Z.SCREEN,t[Z.NORMAL]=Z.NORMAL_NPM,t[Z.ADD]=Z.ADD_NPM,t[Z.SCREEN]=Z.SCREEN_NPM;const e=[];return e.push(t),e.push(s),e}const Gh=n_();function Wh(s,t){return Gh[t?1:0][s]}function r_(s,t,e,i=!0){return rt("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),bt.shared.setValue(s).premultiply(t,i).toArray(e??new Float32Array(4))}function o_(s,t){return rt("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),bt.shared.setValue(s).toPremultiplied(t)}function a_(s,t,e,i=!0){return rt("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),bt.shared.setValue(s).premultiply(t,i).toArray(e??new Float32Array(4))}const mm=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function pm(s,t=null){const e=s*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,n=0;i<e;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function ba(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}const l_={Float32Array,Uint32Array,Int32Array,Uint8Array};function h_(s,t){let e=0,i=0;const n={};for(let o=0;o<s.length;o++)i+=t[o],e+=s[o].length;const r=new ArrayBuffer(e*4);let a=null,l=0;for(let o=0;o<s.length;o++){const h=t[o],c=s[o],u=ba(c);n[u]||(n[u]=new l_[u](r)),a=n[u];for(let d=0;d<c.length;d++){const f=(d/h|0)*i+l,m=d%h;a[f+m]=c[d]}l+=h}return new Float32Array(r)}function Rr(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Ql(s){return!(s&s-1)&&!!s}function Jl(s){let t=(s>65535?1:0)<<4;s>>>=t;let e=(s>255?1:0)<<3;return s>>>=e,t|=e,e=(s>15?1:0)<<2,s>>>=e,t|=e,e=(s>3?1:0)<<1,s>>>=e,t|=e,t|s>>1}function en(s,t,e){const i=s.length;let n;if(t>=i||e===0)return;e=t+e>i?i-t:e;const r=i-e;for(n=t;n<r;++n)s[n]=s[n+e];s.length=r}function ai(s){return s===0?0:s<0?-1:1}let c_=0;function Ii(){return++c_}const gm=class{constructor(s,t,e,i){this.left=s,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let qo=gm;qo.EMPTY=new gm(0,0,0,0);const th={},Ae=Object.create(null),He=Object.create(null);function u_(){let s;for(s in Ae)Ae[s].destroy();for(s in He)He[s].destroy()}function d_(){let s;for(s in Ae)delete Ae[s];for(s in He)delete He[s]}class xm{constructor(t,e,i){this._canvas=q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||q.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function jd(s,t,e){for(let i=0,n=4*e*t;i<t;++i,n+=4)if(s[n+3]!==0)return!1;return!0}function qd(s,t,e,i,n){const r=4*t;for(let a=i,l=i*r+4*e;a<=n;++a,l+=r)if(s[l+3]!==0)return!1;return!0}function ym(s){const{width:t,height:e}=s,i=s.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const r=i.getImageData(0,0,t,e).data;let a=0,l=0,o=t-1,h=e-1;for(;l<e&&jd(r,t,l);)++l;if(l===e)return qo.EMPTY;for(;jd(r,t,h);)--h;for(;qd(r,t,a,l,h);)++a;for(;qd(r,t,o,l,h);)--o;return++o,++h,new qo(a,l,o,h)}function _m(s){const t=ym(s),{width:e,height:i}=t;let n=null;if(!t.isEmpty()){const r=s.getContext("2d");if(r===null)throw new TypeError("Failed to get canvas 2D context");n=r.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:n}}function f_(s){const t=mm.exec(s);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}let go;function vm(s,t=globalThis.location){if(s.startsWith("data:"))return"";t=t||globalThis.location,go||(go=document.createElement("a")),go.href=s;const e=lm.parse(go.href),i=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!i||e.protocol!==t.protocol?"anonymous":""}function ui(s,t=1){var i;const e=(i=q.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}const m_=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:He,BoundingBox:qo,CanvasRenderTarget:xm,DATA_URI:mm,EventEmitter:Fs,ProgramCache:th,TextureCache:Ae,clearTextureCache:d_,correctBlendMode:Wh,createIndicesForQuads:pm,decomposeDataUri:f_,deprecation:rt,destroyTextureCache:u_,determineCrossOrigin:vm,earcut:Hf,getBufferType:ba,getCanvasBoundingBox:ym,getResolutionOfUrl:ui,hex2rgb:$h,hex2string:fm,interleaveTypedArrays:h_,isMobile:Ts,isPow2:Ql,isWebGLSupported:hm,log2:Jl,nextPow2:Rr,path:It,premultiplyBlendMode:Gh,premultiplyRgba:r_,premultiplyTint:o_,premultiplyTintToRgba:a_,removeItems:en,rgb2hex:Dn,sayHello:zy,sign:ai,skipHello:Hy,string2hex:i_,trimCanvas:_m,uid:Ii,url:lm},Symbol.toStringTag,{value:"Module"}));var j=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(j||{});const eh=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Zd=(s,t)=>eh(s).priority??t,J={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(eh).forEach(t=>{t.type.forEach(e=>{var i,n;return(n=(i=this._removeHandlers)[e])==null?void 0:n.call(i,t)})}),this},add(...s){return s.map(eh).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,n=this._queue;i[e]?i[e](t):(n[e]=n[e]||[],n[e].push(t))})}),this},handle(s,t,e){const i=this._addHandlers,n=this._removeHandlers;if(i[s]||n[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,n[s]=e;const r=this._queue;return r[s]&&(r[s].forEach(a=>t(a)),delete r[s]),this},handleByMap(s,t){return this.handle(s,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,r)=>Zd(r,e)-Zd(n,e)))},i=>{const n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})}};class Zo{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const p_=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function g_(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function bm(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=p_.replace(/%forloop%/gi,g_(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}return s}const ul=0,dl=1,fl=2,ml=3,pl=4,gl=5;class qs{constructor(){this.data=0,this.blendMode=Z.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ul)}set blend(t){!!(this.data&1<<ul)!==t&&(this.data^=1<<ul)}get offsets(){return!!(this.data&1<<dl)}set offsets(t){!!(this.data&1<<dl)!==t&&(this.data^=1<<dl)}get culling(){return!!(this.data&1<<fl)}set culling(t){!!(this.data&1<<fl)!==t&&(this.data^=1<<fl)}get depthTest(){return!!(this.data&1<<ml)}set depthTest(t){!!(this.data&1<<ml)!==t&&(this.data^=1<<ml)}get depthMask(){return!!(this.data&1<<gl)}set depthMask(t){!!(this.data&1<<gl)!==t&&(this.data^=1<<gl)}get clockwiseFrontFace(){return!!(this.data&1<<pl)}set clockwiseFrontFace(t){!!(this.data&1<<pl)!==t&&(this.data^=1<<pl)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==Z.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new qs;return t.depthTest=!1,t.blend=!0,t}}const Ko=[];function Hh(s,t){if(!s)return null;let e="";if(typeof s=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);i&&(e=i[1].toLowerCase())}for(let i=Ko.length-1;i>=0;--i){const n=Ko[i];if(n.test&&n.test(s,e))return new n(s,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class je{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,n,r,a,l,o){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][h](t,e,i,n,r,a,l,o);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(je.prototype,{dispatch:{value:je.prototype.emit},run:{value:je.prototype.emit}});class Xn{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new je("setRealSize"),this.onUpdate=new je("update"),this.onError=new je("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Hn extends Xn{constructor(t,e){const{width:i,height:n}=e||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=t}upload(t,e,i){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Je.UNPACK);const r=e.realWidth,a=e.realHeight;return i.width===r&&i.height===a?n.texSubImage2D(e.target,0,0,0,r,a,e.format,i.type,this.data):(i.width=r,i.height=a,n.texImage2D(e.target,0,i.internalFormat,r,a,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const x_={scaleMode:Oe.NEAREST,format:z.RGBA,alphaMode:Je.NPM},_n=class extends Fs{constructor(s=null,t=null){super(),t=Object.assign({},_n.defaultOptions,t);const{alphaMode:e,mipmap:i,anisotropicLevel:n,scaleMode:r,width:a,height:l,wrapMode:o,format:h,type:c,target:u,resolution:d,resourceOptions:f}=t;s&&!(s instanceof Xn)&&(s=Hh(s,f),s.internal=!0),this.resolution=d||q.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=n,this._wrapMode=o,this._scaleMode=r,this.format=h,this.type=c,this.target=u,this.alphaMode=e,this.uid=Ii(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(s)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(s){this._mipmap!==s&&(this._mipmap=s,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(s){this._scaleMode!==s&&(this._scaleMode=s,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(s){this._wrapMode!==s&&(this._wrapMode=s,this.dirtyStyleId++)}setStyle(s,t){let e;return s!==void 0&&s!==this.scaleMode&&(this.scaleMode=s,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(s,t,e){return e=e||this.resolution,this.setRealSize(s*e,t*e,e)}setRealSize(s,t,e){return this.resolution=e||this.resolution,this.width=Math.round(s)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ql(this.realWidth)&&Ql(this.realHeight)}setResolution(s){const t=this.resolution;return t===s?this:(this.resolution=s,this.valid&&(this.width=Math.round(this.width*t)/s,this.height=Math.round(this.height*t)/s,this.emit("update",this)),this._refreshPOT(),this)}setResource(s){if(this.resource===s)return this;if(this.resource)throw new Error("Resource can be set only once");return s.bind(this),this.resource=s,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(s){this.emit("error",this,s)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete He[this.cacheId],delete Ae[this.cacheId],this.cacheId=null),this.dispose(),_n.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(s,t,e=q.STRICT_TEXTURE_CACHE){const i=typeof s=="string";let n=null;if(i)n=s;else{if(!s._pixiId){const a=(t==null?void 0:t.pixiIdPrefix)||"pixiid";s._pixiId=`${a}_${Ii()}`}n=s._pixiId}let r=He[n];if(i&&e&&!r)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return r||(r=new _n(s,t),r.cacheId=n,_n.addToCache(r,n)),r}static fromBuffer(s,t,e,i){s=s||new Float32Array(t*e*4);const n=new Hn(s,{width:t,height:e}),r=s instanceof Float32Array?et.FLOAT:et.UNSIGNED_BYTE;return new _n(n,Object.assign({},x_,{type:r},i))}static addToCache(s,t){t&&(s.textureCacheIds.includes(t)||s.textureCacheIds.push(t),He[t]&&He[t]!==s&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),He[t]=s)}static removeFromCache(s){if(typeof s=="string"){const t=He[s];if(t){const e=t.textureCacheIds.indexOf(s);return e>-1&&t.textureCacheIds.splice(e,1),delete He[s],t}}else if(s!=null&&s.textureCacheIds){for(let t=0;t<s.textureCacheIds.length;++t)delete He[s.textureCacheIds[t]];return s.textureCacheIds.length=0,s}return null}};let nt=_n;nt.defaultOptions={mipmap:cs.POW2,anisotropicLevel:0,scaleMode:Oe.LINEAR,wrapMode:Ws.CLAMP,alphaMode:Je.UNPACK,target:Qi.TEXTURE_2D,format:z.RGBA,type:et.UNSIGNED_BYTE};nt._globalBatch=0;class Qo{constructor(){this.texArray=null,this.blend=0,this.type=rs.TRIANGLES,this.start=0,this.size=0,this.data=null}}let y_=0;class $t{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=y_++,this.disposeRunner=new je("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?As.ELEMENT_ARRAY_BUFFER:As.ARRAY_BUFFER}get index(){return this.type===As.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new $t(t)}}class Pr{constructor(t,e=0,i=!1,n=et.FLOAT,r,a,l,o=1){this.buffer=t,this.size=e,this.normalized=i,this.type=n,this.stride=r,this.start=a,this.instance=l,this.divisor=o}destroy(){this.buffer=null}static from(t,e,i,n,r){return new Pr(t,e,i,n,r)}}const __={Float32Array,Uint32Array,Int32Array,Uint8Array};function v_(s,t){let e=0,i=0;const n={};for(let o=0;o<s.length;o++)i+=t[o],e+=s[o].length;const r=new ArrayBuffer(e*4);let a=null,l=0;for(let o=0;o<s.length;o++){const h=t[o],c=s[o],u=ba(c);n[u]||(n[u]=new __[u](r)),a=n[u];for(let d=0;d<c.length;d++){const f=(d/h|0)*i+l,m=d%h;a[f+m]=c[d]}l+=h}return new Float32Array(r)}const Kd={5126:4,5123:2,5121:1};let b_=0;const w_={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class di{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=b_++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new je("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,n=!1,r,a,l,o=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof $t||(e instanceof Array&&(e=new Float32Array(e)),e=new $t(e));const h=t.split("|");if(h.length>1){for(let u=0;u<h.length;u++)this.addAttribute(h[u],e,i,n,r);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Pr(c,i,n,r,a,l,o),this.instanced=this.instanced||o,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof $t||(t instanceof Array&&(t=new Uint16Array(t)),t=new $t(t)),t.type=As.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new $t;let n;for(n in this.attributes){const r=this.attributes[n],a=this.buffers[r.buffer];t.push(a.data),e.push(r.size*Kd[r.type]/4),r.buffer=0}for(i.data=v_(t,e),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new di;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new $t(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new Pr(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=As.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new di,i=[],n=[],r=[];let a;for(let l=0;l<t.length;l++){a=t[l];for(let o=0;o<a.buffers.length;o++)n[o]=n[o]||0,n[o]+=a.buffers[o].data.length,r[o]=0}for(let l=0;l<a.buffers.length;l++)i[l]=new w_[ba(a.buffers[l].data)](n[l]),e.buffers[l]=new $t(i[l]);for(let l=0;l<t.length;l++){a=t[l];for(let o=0;o<a.buffers.length;o++)i[o].set(a.buffers[o].data,r[o]),r[o]+=a.buffers[o].data.length}if(e.attributes=a.attributes,a.indexBuffer){e.indexBuffer=e.buffers[a.buffers.indexOf(a.indexBuffer)],e.indexBuffer.type=As.ELEMENT_ARRAY_BUFFER;let l=0,o=0,h=0,c=0;for(let u=0;u<a.buffers.length;u++)if(a.buffers[u]!==a.indexBuffer){c=u;break}for(const u in a.attributes){const d=a.attributes[u];(d.buffer|0)===c&&(o+=d.size*Kd[d.type]/4)}for(let u=0;u<t.length;u++){const d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+h]+=l;l+=t[u].buffers[c].data.length/o,h+=d.length}}return e}}class zh extends di{constructor(t=!1){super(),this._buffer=new $t(null,t,!1),this._indexBuffer=new $t(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,et.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,et.FLOAT).addAttribute("aColor",this._buffer,4,!0,et.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,et.FLOAT).addIndex(this._indexBuffer)}}const kr=Math.PI*2,wm=180/Math.PI,Em=Math.PI/180;var de=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(de||{});class at{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new at(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const xo=[new at,new at,new at,new at];let ft=class sh{constructor(t=0,e=0,i=0,n=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n),this.type=de.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new sh(0,0,0,0)}clone(){return new sh(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const S=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=S)return!1;const M=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>M}const i=this.left,n=this.right,r=this.top,a=this.bottom;if(n<=i||a<=r)return!1;const l=xo[0].set(t.left,t.top),o=xo[1].set(t.left,t.bottom),h=xo[2].set(t.right,t.top),c=xo[3].set(t.right,t.bottom);if(h.x<=l.x||o.y<=l.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(l,l),e.apply(o,o),e.apply(h,h),e.apply(c,c),Math.max(l.x,o.x,h.x,c.x)<=i||Math.min(l.x,o.x,h.x,c.x)>=n||Math.max(l.y,o.y,h.y,c.y)<=r||Math.min(l.y,o.y,h.y,c.y)>=a))return!1;const d=u*(o.y-l.y),f=u*(l.x-o.x),m=d*i+f*r,p=d*n+f*r,g=d*i+f*a,v=d*n+f*a;if(Math.max(m,p,g,v)<=d*l.x+f*l.y||Math.min(m,p,g,v)>=d*c.x+f*c.y)return!1;const _=u*(l.y-h.y),x=u*(h.x-l.x),y=_*i+x*r,b=_*n+x*r,w=_*i+x*a,E=_*n+x*a;return!(Math.max(y,b,w,E)<=_*l.x+x*l.y||Math.min(y,b,w,E)>=_*c.x+x*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=n,this.height=Math.max(r-n,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=n,this.height=r-n,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};class wa{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=de.CIRC}clone(){return new wa(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-t,r=this.y-e;return n*=n,r*=r,n+r<=i}getBounds(){return new ft(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ea{constructor(t=0,e=0,i=0,n=0){this.x=t,this.y=e,this.width=i,this.height=n,this.type=de.ELIP}clone(){return new Ea(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new ft(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Ci{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let n=0,r=e.length;n<r;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=de.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Ci(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1;const n=this.points.length/2;for(let r=0,a=n-1;r<n;a=r++){const l=this.points[r*2],o=this.points[r*2+1],h=this.points[a*2],c=this.points[a*2+1];o>e!=c>e&&t<(h-l)*((e-o)/(c-o))+l&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class Sa{constructor(t=0,e=0,i=0,n=0,r=20){this.x=t,this.y=e,this.width=i,this.height=n,this.radius=r,this.type=de.RREC}clone(){return new Sa(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),r=e-(this.y+i);const a=i*i;if(n*n+r*r<=a||(n=t-(this.x+this.width-i),n*n+r*r<=a)||(r=e-(this.y+this.height-i),n*n+r*r<=a)||(n=t-(this.x+i),n*n+r*r<=a))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Rt{constructor(t=1,e=0,i=0,n=1,r=0,a=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,n,r,a){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new at;const i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e}applyInverse(t,e){e=e||new at;const i=1/(this.a*this.d+this.c*-this.b),n=t.x,r=t.y;return e.x=this.d*i*n+-this.c*i*r+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*r+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,a=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this}append(t){const e=this.a,i=this.b,n=this.c,r=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*r,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*r,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*r+this.ty,this}setTransform(t,e,i,n,r,a,l,o,h){return this.a=Math.cos(l+h)*r,this.b=Math.sin(l+h)*r,this.c=-Math.sin(l-o)*a,this.d=Math.cos(l-o)*a,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,n=this.c,r=this.d,a=t.pivot,l=-Math.atan2(-n,r),o=Math.atan2(i,e),h=Math.abs(l+o);return h<1e-5||Math.abs(kr-h)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+r*r),t.position.x=this.tx+(a.x*e+a.y*n),t.position.y=this.ty+(a.x*i+a.y*r),t}invert(){const t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,a=t*n-e*i;return this.a=n/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(t*this.ty-e*r)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Rt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Rt}static get TEMP_MATRIX(){return new Rt}}const Xi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Yi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],$i=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Gi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ih=[],Sm=[],yo=Math.sign;function E_(){for(let s=0;s<16;s++){const t=[];ih.push(t);for(let e=0;e<16;e++){const i=yo(Xi[s]*Xi[e]+$i[s]*Yi[e]),n=yo(Yi[s]*Xi[e]+Gi[s]*Yi[e]),r=yo(Xi[s]*$i[e]+$i[s]*Gi[e]),a=yo(Yi[s]*$i[e]+Gi[s]*Gi[e]);for(let l=0;l<16;l++)if(Xi[l]===i&&Yi[l]===n&&$i[l]===r&&Gi[l]===a){t.push(l);break}}}for(let s=0;s<16;s++){const t=new Rt;t.set(Xi[s],Yi[s],$i[s],Gi[s],0,0),Sm.push(t)}}E_();const Ft={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Xi[s],uY:s=>Yi[s],vX:s=>$i[s],vY:s=>Gi[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>ih[s][t],sub:(s,t)=>ih[s][Ft.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?Ft.S:Ft.N:Math.abs(t)*2<=Math.abs(s)?s>0?Ft.E:Ft.W:t>0?s>0?Ft.SE:Ft.SW:s>0?Ft.NE:Ft.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const n=Sm[Ft.inv(t)];n.tx=e,n.ty=i,s.append(n)}};class li{constructor(t,e,i=0,n=0){this._x=i,this._y=n,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new li(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=0 y=0 scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const Tm=class{constructor(){this.worldTransform=new Rt,this.localTransform=new Rt,this.position=new li(this.onChange,this,0,0),this.scale=new li(this.onChange,this,1,1),this.pivot=new li(this.onChange,this,0,0),this.skew=new li(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){const e=s.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}};let zn=Tm;zn.IDENTITY=new Tm;var S_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,T_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Qd(s,t,e){const i=s.createShader(t);return s.shaderSource(i,e),s.compileShader(i),i}function xl(s){const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Am(s,t){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return xl(2*t);case"bvec3":return xl(3*t);case"bvec4":return xl(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const sn=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,t)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(t==null||t.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,t)=>s.type==="mat3"&&s.size===1&&!s.isArray&&t.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,t)=>s.type==="vec2"&&s.size===1&&!s.isArray&&t.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${s}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(s,t)=>s.type==="vec3"&&s.size===1&&!s.isArray&&t.red!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${s}"].location, v.red, v.green, v.blue)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}],A_={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},C_={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function M_(s,t){var i;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const n in s.uniforms){const r=t[n];if(!r){(i=s.uniforms[n])!=null&&i.group&&(s.uniforms[n].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${n}, '${n}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${n}, syncData);
                    `));continue}const a=s.uniforms[n];let l=!1;for(let o=0;o<sn.length;o++)if(sn[o].test(r,a)){e.push(sn[o].code(n,a)),l=!0;break}if(!l){const h=(r.size===1&&!r.isArray?A_:C_)[r.type].replace("location",`ud["${n}"].location`);e.push(`
            cu = ud["${n}"];
            cv = cu.value;
            v = uv["${n}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Cm={};let pn=Cm;function Mm(){if(pn===Cm||pn!=null&&pn.isContextLost()){const s=q.ADAPTER.createCanvas();let t;q.PREFER_ENV>=Fi.WEBGL2&&(t=s.getContext("webgl2",{})),t||(t=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),pn=t}return pn}let _o;function I_(){if(!_o){_o=ze.MEDIUM;const s=Mm();s&&s.getShaderPrecisionFormat&&(_o=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?ze.HIGH:ze.MEDIUM)}return _o}function Jd(s,t){const e=s.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),i=s.getShaderInfoLog(t),n=i.split(`
`),r={},a=n.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!r[h]?(r[h]=!0,!0):!1),l=[""];a.forEach(h=>{e[h-1]=`%c${e[h-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const o=e.join(`
`);l[0]=o,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function R_(s,t,e,i){s.getProgramParameter(t,s.LINK_STATUS)||(s.getShaderParameter(e,s.COMPILE_STATUS)||Jd(s,e),s.getShaderParameter(i,s.COMPILE_STATUS)||Jd(s,i),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(t)))}const P_={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Im(s){return P_[s]}let vo=null;const tf={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Rm(s,t){if(!vo){const e=Object.keys(tf);vo={};for(let i=0;i<e.length;++i){const n=e[i];vo[s[n]]=tf[n]}}return vo[t]}function ef(s,t,e){if(s.substring(0,9)!=="precision"){let i=t;return t===ze.HIGH&&e!==ze.HIGH&&(i=ze.MEDIUM),`precision ${i} float;
${s}`}else if(e!==ze.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}let rr;function Pm(){if(typeof rr=="boolean")return rr;try{rr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{rr=!1}return rr}let k_=0;const bo={},vn=class{constructor(s,t,e="pixi-shader",i={}){this.extra={},this.id=k_++,this.vertexSrc=s||vn.defaultVertexSrc,this.fragmentSrc=t||vn.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),bo[e]?(bo[e]++,e+=`-${bo[e]}`):bo[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=ef(this.vertexSrc,vn.defaultVertexPrecision,ze.HIGH),this.fragmentSrc=ef(this.fragmentSrc,vn.defaultFragmentPrecision,I_())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return T_}static get defaultFragmentSrc(){return S_}static from(s,t,e){const i=s+t;let n=th[i];return n||(th[i]=n=new vn(s,t,e)),n}};let as=vn;as.defaultVertexPrecision=ze.HIGH;as.defaultFragmentPrecision=Ts.apple.device?ze.HIGH:ze.MEDIUM;let F_=0;class hs{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=F_++,this.static=!!e,this.ubo=!!i,t instanceof $t?(this.buffer=t,this.buffer.type=As.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new $t(new Float32Array(1)),this.buffer.type=As.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new hs(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new hs(t,e,i)}static uboFrom(t,e){return new hs(t,e??!0,!0)}}class Ms{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof hs?this.uniformGroup=e:this.uniformGroup=new hs(e):this.uniformGroup=new hs({}),this.disposeRunner=new je("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const n=e.uniforms[i];if(n.group&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const n=as.from(t,e);return new Ms(n,i)}}class km{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let r=0;r<t;r++)i[r]=r;this.defaultGroupCache[t]=hs.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new as(this.vertexSrc,n)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Rt,default:this.defaultGroupCache[t]};return new Ms(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Jo{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function B_(){return!Ts.apple.device}function D_(s){let t=!0;const e=q.ADAPTER.getNavigator();if(Ts.tablet||Ts.phone){if(Ts.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Ts.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?s:4}class qr{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var N_=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,L_=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const fs=class extends qr{constructor(s){super(s),this.setShaderGenerator(),this.geometryClass=zh,this.vertexSize=6,this.state=qs.for2d(),this.size=fs.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),s.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??D_(32),this._defaultMaxTextures}static set defaultMaxTextures(s){this._defaultMaxTextures=s}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??B_(),this._canUploadSameBuffer}static set canUploadSameBuffer(s){this._canUploadSameBuffer=s}get MAX_TEXTURES(){return rt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return L_}static get defaultFragmentTemplate(){return N_}setShaderGenerator({vertex:s=fs.defaultVertexSrc,fragment:t=fs.defaultFragmentTemplate}={}){this.shaderGenerator=new km(s,t)}contextChange(){const s=this.renderer.gl;q.PREFER_ENV===Fi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),fs.defaultMaxTextures),this.maxTextures=bm(this.maxTextures,s)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:s,_textureArrayPool:t}=fs,e=this.size/4,i=Math.floor(e/this.maxTextures)+1;for(;s.length<e;)s.push(new Qo);for(;t.length<i;)t.push(new Jo);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(s){s._texture.valid&&(this._vertexCount+s.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=s.vertexData.length/2,this._indexCount+=s.indices.length,this._bufferedTextures[this._bufferSize]=s._texture.baseTexture,this._bufferedElements[this._bufferSize++]=s)}buildTexturesAndDrawCalls(){const{_bufferedTextures:s,maxTextures:t}=this,e=fs._textureArrayPool,i=this.renderer.batch,n=this._tempBoundTextures,r=this.renderer.textureGC.count;let a=++nt._globalBatch,l=0,o=e[0],h=0;i.copyBoundTextures(n,t);for(let c=0;c<this._bufferSize;++c){const u=s[c];s[c]=null,u._batchEnabled!==a&&(o.count>=t&&(i.boundArray(o,n,a,t),this.buildDrawCalls(o,h,c),h=c,o=e[++l],++a),u._batchEnabled=a,u.touched=r,o.elements[o.count++]=u)}o.count>0&&(i.boundArray(o,n,a,t),this.buildDrawCalls(o,h,this._bufferSize),++l,++a);for(let c=0;c<n.length;c++)n[c]=null;nt._globalBatch=a}buildDrawCalls(s,t,e){const{_bufferedElements:i,_attributeBuffer:n,_indexBuffer:r,vertexSize:a}=this,l=fs._drawCallPool;let o=this._dcIndex,h=this._aIndex,c=this._iIndex,u=l[o];u.start=this._iIndex,u.texArray=s;for(let d=t;d<e;++d){const f=i[d],m=f._texture.baseTexture,p=Gh[m.alphaMode?1:0][f.blendMode];i[d]=null,t<d&&u.blend!==p&&(u.size=c-u.start,t=d,u=l[++o],u.texArray=s,u.start=c),this.packInterleavedGeometry(f,n,r,h,c),h+=f.vertexData.length/2*a,c+=f.indices.length,u.blend=p}t<e&&(u.size=c-u.start,++o),this._dcIndex=o,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(s){const t=this.renderer.texture;for(let e=0;e<s.count;e++)t.bind(s.elements[e],s.ids[e]),s.elements[e]=null;s.count=0}updateGeometry(){const{_packedGeometries:s,_attributeBuffer:t,_indexBuffer:e}=this;fs.canUploadSameBuffer?(s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,s[this._flushId]=new this.geometryClass),s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(s[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const s=this._dcIndex,{gl:t,state:e}=this.renderer,i=fs._drawCallPool;let n=null;for(let r=0;r<s;r++){const{texArray:a,type:l,size:o,start:h,blend:c}=i[r];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,e.set(this.state),t.drawElements(l,o,t.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),fs.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]&&this._packedGeometries[s].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(s){const t=Rr(Math.ceil(s/8)),e=Jl(t),i=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Zo(i*this.vertexSize*4)),n}getIndexBuffer(s){const t=Rr(Math.ceil(s/12)),e=Jl(t),i=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let n=this._iBuffers[e];return n||(this._iBuffers[e]=n=new Uint16Array(i)),n}packInterleavedGeometry(s,t,e,i,n){const{uint32View:r,float32View:a}=t,l=i/this.vertexSize,o=s.uvs,h=s.indices,c=s.vertexData,u=s._texture.baseTexture._batchLocation,d=Math.min(s.worldAlpha,1),f=bt.shared.setValue(s._tintRGB).toPremultiplied(d,s._texture.baseTexture.alphaMode>0);for(let m=0;m<c.length;m+=2)a[i++]=c[m],a[i++]=c[m+1],a[i++]=o[m],a[i++]=o[m+1],r[i++]=f,a[i++]=u;for(let m=0;m<h.length;m++)e[n++]=l+h[m]}};let is=fs;is.defaultBatchSize=4096;is.extension={name:"batch",type:j.RendererPlugin};is._drawCallPool=[];is._textureArrayPool=[];J.add(is);var O_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,V_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const hr=class extends Ms{constructor(s,t,e){const i=as.from(s||hr.defaultVertexSrc,t||hr.defaultFragmentSrc);super(i,e),this.padding=0,this.resolution=hr.defaultResolution,this.multisample=hr.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new qs}apply(s,t,e,i,n){s.applyFilter(this,t,e,i)}get blendMode(){return this.state.blendMode}set blendMode(s){this.state.blendMode=s}get resolution(){return this._resolution}set resolution(s){this._resolution=s}static get defaultVertexSrc(){return V_}static get defaultFragmentSrc(){return O_}};let se=hr;se.defaultResolution=1;se.defaultMultisample=jt.NONE;class Zr{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new bt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:i,backgroundAlpha:n}=t,r=i??e;r!==void 0&&(this.color=r),this.alpha=n}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Zr.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};Zr.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"background"};J.add(Zr);class jh{constructor(t){this.renderer=t,this.emptyRenderer=new qr(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let n=e-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,e,i,n){const{elements:r,ids:a,count:l}=t;let o=0;for(let h=0;h<l;h++){const c=r[h],u=c._batchLocation;if(u>=0&&u<n&&e[u]===c){a[h]=u;continue}for(;o<n;){const d=e[o];if(d&&d._batchEnabled===i&&d._batchLocation===o){o++;continue}a[h]=o,c._batchLocation=o,e[o]=c;break}}}destroy(){this.renderer=null}}jh.extension={type:j.RendererSystem,name:"batch"};J.add(jh);let sf=0;class Kr{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=sf++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=sf++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(q.PREFER_ENV>=Fi.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Kr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"};Kr.extension={type:j.RendererSystem,name:"context"};J.add(Kr);class U_ extends Hn{upload(t,e,i){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Je.UNPACK);const r=e.realWidth,a=e.realHeight;return i.width===r&&i.height===a?n.texSubImage2D(e.target,0,0,0,r,a,e.format,i.type,this.data):(i.width=r,i.height=a,n.texImage2D(e.target,0,i.internalFormat,r,a,0,e.format,i.type,this.data)),!0}}class ta{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new je("disposeFramebuffer"),this.multisample=jt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new nt(null,{scaleMode:Oe.NEAREST,resolution:1,mipmap:cs.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new nt(new U_(null,{width:this.width,height:this.height}),{scaleMode:Oe.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:cs.OFF,format:z.DEPTH_COMPONENT,type:et.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const n=this.colorTextures[i],r=n.resolution;n.setSize(t/r,e/r)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class qh extends nt{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3];t={width:e,height:i,scaleMode:n,resolution:r}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=jt.NONE),super(null,t),this.mipmap=cs.OFF,this.valid=!0,this._clear=new bt([0,0,0,0]),this.framebuffer=new ta(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class fi extends Xn{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;super(i,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=vm(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,n){const r=t.gl,a=e.realWidth,l=e.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1&&n.buffered.length===0)return!1;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Je.UNPACK),!this.noSubImage&&e.target===r.TEXTURE_2D&&i.width===a&&i.height===l?r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,i.type,n):(i.width=a,i.height=l,r.texImage2D(e.target,0,i.internalFormat,e.format,i.type,n)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class Zh extends fi{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;fi.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const n=this.source;this.url=n.src;const r=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.resize(n.width,n.height),this._load=null,this.createBitmap?e(this.process()):e(this))};n.complete&&n.src?r():(n.onload=r,n.onerror=a=>{i(a),this.onError.emit(a)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>e(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Je.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let n=!0;const r=e._glTextures;for(const a in r){const l=r[a];if(l!==i&&l.dirtyId!==e.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Kh{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const n=e.width,r=e.height;if(i){const a=t.width/2/n,l=t.height/2/r,o=t.x/n+a,h=t.y/r+l;i=Ft.add(i,Ft.NW),this.x0=o+a*Ft.uX(i),this.y0=h+l*Ft.uY(i),i=Ft.add(i,2),this.x1=o+a*Ft.uX(i),this.y1=h+l*Ft.uY(i),i=Ft.add(i,2),this.x2=o+a*Ft.uX(i),this.y2=h+l*Ft.uY(i),i=Ft.add(i,2),this.x3=o+a*Ft.uX(i),this.y3=h+l*Ft.uY(i)}else this.x0=t.x/n,this.y0=t.y/r,this.x1=(t.x+t.width)/n,this.y1=t.y/r,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/r,this.x3=t.x/n,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const nf=new Kh;function wo(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}class K extends Fs{constructor(t,e,i,n,r,a,l){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new ft(0,0,1,1)),t instanceof K&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=n,this.valid=!1,this._uvs=nf,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(r||0),r===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new at(a.x,a.y):new at(0,0),this.defaultBorders=l,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Ae[e.url]&&K.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,K.removeFromCache(this),this.textureCacheIds=null}clone(){var n;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new K(this.baseTexture,!this.noFrame&&t,e,(n=this.trim)==null?void 0:n.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===nf&&(this._uvs=new Kh),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=q.STRICT_TEXTURE_CACHE){const n=typeof t=="string";let r=null;if(n)r=t;else if(t instanceof nt){if(!t.cacheId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${l}-${Ii()}`,nt.addToCache(t,t.cacheId)}r=t.cacheId}else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${Ii()}`}r=t._pixiId}let a=Ae[r];if(n&&i&&!a)throw new Error(`The cacheId "${r}" does not exist in TextureCache.`);return!a&&!(t instanceof nt)?(e.resolution||(e.resolution=ui(t)),a=new K(new nt(t,e)),a.baseTexture.cacheId=r,nt.addToCache(a.baseTexture,r),K.addToCache(a,r)):!a&&t instanceof nt&&(a=new K(t),K.addToCache(a,r)),a}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),n=K.from(t,Object.assign({resourceOptions:i},e),!1),r=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):r.load().then(()=>Promise.resolve(n))}static fromBuffer(t,e,i,n){return new K(nt.fromBuffer(t,e,i,n))}static fromLoader(t,e,i,n){const r=new nt(t,Object.assign({scaleMode:nt.defaultOptions.scaleMode,resolution:ui(e)},n)),{resource:a}=r;a instanceof Zh&&(a.url=e);const l=new K(r);return i||(i=e),nt.addToCache(l.baseTexture,i),K.addToCache(l,i),i!==e&&(nt.addToCache(l.baseTexture,e),K.addToCache(l,e)),l.baseTexture.valid?Promise.resolve(l):new Promise(o=>{l.baseTexture.once("loaded",()=>o(l))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ae[e]&&Ae[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Ae[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Ae[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Ae[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Ae[t.textureCacheIds[e]]===t&&delete Ae[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:n,height:r}=t,a=e+n>this.baseTexture.width,l=i+r>this.baseTexture.height;if(a||l){const o=a&&l?"and":"or",h=`X: ${e} + ${n} = ${e+n} > ${this.baseTexture.width}`,c=`Y: ${i} + ${r} = ${i+r} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${o} ${c}`)}this.valid=n&&r&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return K._EMPTY||(K._EMPTY=new K(new nt),wo(K._EMPTY),wo(K._EMPTY.baseTexture)),K._EMPTY}static get WHITE(){if(!K._WHITE){const t=q.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),K._WHITE=new K(nt.from(t)),wo(K._WHITE),wo(K._WHITE.baseTexture)}return K._WHITE}}class Di extends K{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const n=this.baseTexture.resolution,r=Math.round(t*n)/n,a=Math.round(e*n)/n;this.valid=r>0&&a>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=a,i&&this.baseTexture.resize(r,a),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Di(new qh(t))}}class Qh{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=jt.NONE){const n=new qh(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new Di(n)}getOptimalTexture(t,e,i=1,n=jt.NONE){let r;t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Rr(t),e=Rr(e),r=((t&65535)<<16|e&65535)>>>0,n>1&&(r+=n*4294967296)):r=n>1?-n:-1,this.texturePool[r]||(this.texturePool[r]=[]);let a=this.texturePool[r].pop();return a||(a=this.createTexture(t,e,n)),a.filterPoolKey=r,a.setResolution(i),a}getFilterTexture(t,e,i){const n=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||jt.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Qh.SCREEN_KEY=-1;class Fm extends di{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Jh extends di{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new $t(this.vertices),this.uvBuffer=new $t(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Bm{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=jt.NONE,this.sourceFrame=new ft,this.destinationFrame=new ft,this.bindingSourceFrame=new ft,this.bindingDestinationFrame=new ft,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Eo=[new at,new at,new at,new at],yl=new Rt;class tc{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Qh,this.statePool=[],this.quad=new Fm,this.quadUv=new Jh,this.tempRect=new ft,this.activeState={},this.globalUniforms=new hs({outputFrame:new ft,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,n=this.defaultFilterStack,r=this.statePool.pop()||new Bm,a=this.renderer.renderTexture;let l=e[0].resolution,o=e[0].multisample,h=e[0].padding,c=e[0].autoFit,u=e[0].legacy??!0;for(let m=1;m<e.length;m++){const p=e[m];l=Math.min(l,p.resolution),o=Math.min(o,p.multisample),h=this.useMaxPadding?Math.max(h,p.padding):h+p.padding,c=c&&p.autoFit,u=u||(p.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=a.current),n.push(r),r.resolution=l,r.multisample=o,r.legacy=u,r.target=t,r.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),r.sourceFrame.pad(h);const d=this.tempRect.copyFrom(a.sourceFrame);i.projection.transform&&this.transformAABB(yl.copyFrom(i.projection.transform).invert(),d),c?(r.sourceFrame.fit(d),(r.sourceFrame.width<=0||r.sourceFrame.height<=0)&&(r.sourceFrame.width=0,r.sourceFrame.height=0)):r.sourceFrame.intersects(d)||(r.sourceFrame.width=0,r.sourceFrame.height=0),this.roundFrame(r.sourceFrame,a.current?a.current.resolution:i.resolution,a.sourceFrame,a.destinationFrame,i.projection.transform),r.renderTexture=this.getOptimalFilterTexture(r.sourceFrame.width,r.sourceFrame.height,l,o),r.filters=e,r.destinationFrame.width=r.renderTexture.width,r.destinationFrame.height=r.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=r.sourceFrame.width,f.height=r.sourceFrame.height,r.renderTexture.filterFrame=r.sourceFrame,r.bindingSourceFrame.copyFrom(a.sourceFrame),r.bindingDestinationFrame.copyFrom(a.destinationFrame),r.transform=i.projection.transform,i.projection.transform=null,a.bind(r.renderTexture,r.sourceFrame,f),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const n=this.globalUniforms.uniforms;n.outputFrame=e.sourceFrame,n.resolution=e.resolution;const r=n.inputSize,a=n.inputPixel,l=n.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],a[0]=Math.round(r[0]*e.resolution),a[1]=Math.round(r[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],l[0]=.5*a[2],l[1]=.5*a[3],l[2]=e.sourceFrame.width*r[2]-.5*a[2],l[3]=e.sourceFrame.height*r[3]-.5*a[3],e.legacy){const h=n.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const o=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,o.renderTexture,Ss.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let h=e.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,e.resolution);c.filterFrame=h.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,e.resolution),c.filterFrame=h.filterFrame),i[u].apply(this,h,c,Ss.CLEAR,e);const d=h;h=c,c=d}i[u].apply(this,h,o.renderTexture,Ss.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Ss.CLEAR){const{renderTexture:i,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const r=n.stateId&1||this.forceClear;(e===Ss.CLEAR||e===Ss.BLIT&&r)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,n){const r=this.renderer;r.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(rs.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(rs.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:r}=e._texture,a=t.set(n.width,0,0,n.height,i.x,i.y),l=e.worldTransform.copyTo(Rt.TEMP_MATRIX);return l.invert(),a.prepend(l),a.scale(1/r.width,1/r.height),a.translate(e.anchor.x,e.anchor.y),a}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,n=jt.NONE){return this.texturePool.getOptimalTexture(t,e,i,n)}getFilterTexture(t,e,i){if(typeof t=="number"){const r=t;t=e,e=r}t=t||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||jt.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=Eo[0],n=Eo[1],r=Eo[2],a=Eo[3];i.set(e.left,e.top),n.set(e.left,e.bottom),r.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(i,i),t.apply(n,n),t.apply(r,r),t.apply(a,a);const l=Math.min(i.x,n.x,r.x,a.x),o=Math.min(i.y,n.y,r.y,a.y),h=Math.max(i.x,n.x,r.x,a.x),c=Math.max(i.y,n.y,r.y,a.y);e.x=l,e.y=o,e.width=h-l,e.height=c-o}roundFrame(t,e,i,n,r){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(r){const{a,b:l,c:o,d:h}=r;if((Math.abs(l)>1e-4||Math.abs(o)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(h)>1e-4))return}r=r?yl.copyFrom(r):yl.identity(),r.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(r,t),t.ceil(e),this.transformAABB(r.invert(),t)}}}tc.extension={type:j.RendererSystem,name:"filter"};J.add(tc);class Dm{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=jt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const X_=new ft;class ec{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new ta(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ft,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;q.PREFER_ENV===Fi.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=n=>e.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:n}=this;if(t){const r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=i),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let a=0;a<t.colorTextures.length;a++){const l=t.colorTextures[a];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const a=e.width>>i,l=e.height>>i,o=a/e.width;this.setViewport(e.x*o,e.y*o,a,l)}else{const a=t.width>>i,l=t.height>>i;this.setViewport(0,0,a,l)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,n){const r=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),n=Math.round(n),(r.width!==i||r.height!==n||r.x!==t||r.y!==e)&&(r.x=t,r.y=e,r.width=i,r.height=n,this.gl.viewport(t,e,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,n,r=Yo.COLOR|Yo.DEPTH){const{gl:a}=this;a.clearColor(t,e,i,n),a.clear(r)}initFramebuffer(t){const{gl:e}=this,i=new Dm(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const n=t.colorTextures;let r=n.length;e.drawBuffers||(r=Math.min(r,1));for(let a=0;a<r;a++){const l=n[a],o=l.parentTextureArray||l;this.renderer.texture.bind(o,0),a===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,n=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures;let a=r.length;i.drawBuffers||(a=Math.min(a,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const l=[];for(let o=0;o<a;o++){const h=r[o],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),o===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+o,h.target,c._glTextures[this.CONTEXT_UID].texture,e),l.push(i.COLOR_ATTACHMENT0+o))}if(l.length>1&&i.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=jt.NONE;if(t<=1||e===null)return i;for(let n=0;n<e.length;n++)if(e[n]<=t){i=e[n];break}return i===1&&(i=jt.NONE),i}blit(t,e,i){const{current:n,renderer:r,gl:a,CONTEXT_UID:l}=this;if(r.context.webGLVersion!==2||!n)return;const o=n.glFramebuffers[l];if(!o)return;if(!t){if(!o.msaaBuffer)return;const c=n.colorTextures[0];if(!c)return;o.blitFramebuffer||(o.blitFramebuffer=new ta(n.width,n.height),o.blitFramebuffer.addColorTexture(0,c)),t=o.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}e||(e=X_,e.width=n.width,e.height=n.height),i||(i=e);const h=e.width===i.width&&e.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,o.framebuffer),a.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,h?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const i=t.width,n=t.height,r=this.gl,a=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,a),e.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,e.multisample,r.DEPTH24_STENCIL8,i,n):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,i,n),e.stencil=a,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ft}destroy(){this.renderer=null}}ec.extension={type:j.RendererSystem,name:"framebuffer"};J.add(ec);const _l={5126:4,5123:2,5121:1};class sc{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;q.PREFER_ENV===Fi.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=n=>i.bindVertexArrayOES(n),t.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(n,r)=>i.vertexAttribDivisorANGLE(n,r),t.drawElementsInstanced=(n,r,a,l,o)=>i.drawElementsInstancedANGLE(n,r,a,l,o),t.drawArraysInstanced=(n,r,a,l)=>i.drawArraysInstancedANGLE(n,r,a,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let n=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},r=!0);const a=n[e.program.id]||this.initGeometryVao(t,e,r);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?i.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const n=t.buffers[i];e.update(n)}}checkCompatibility(t,e){const i=t.attributes,n=e.attributeData;for(const r in n)if(!i[r])throw new Error(`shader and geometry incompatible, geometry missing the "${r}" attribute`)}getSignature(t,e){const i=t.attributes,n=e.attributeData,r=["g",t.id];for(const a in i)n[a]&&r.push(a,n[a].location);return r.join("-")}initGeometryVao(t,e,i=!0){const n=this.gl,r=this.CONTEXT_UID,a=this.renderer.buffer,l=e.program;l.glPrograms[r]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const o=this.getSignature(t,l),h=t.glVertexArrayObjects[this.CONTEXT_UID];let c=h[o];if(c)return h[l.id]=c,c;const u=t.buffers,d=t.attributes,f={},m={};for(const p in u)f[p]=0,m[p]=0;for(const p in d)!d[p].size&&l.attributeData[p]?d[p].size=l.attributeData[p].size:d[p].size||console.warn(`PIXI Geometry attribute '${p}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[p].buffer]+=d[p].size*_l[d[p].type];for(const p in d){const g=d[p],v=g.size;g.stride===void 0&&(f[g.buffer]===v*_l[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=m[g.buffer],m[g.buffer]+=v*_l[g.type])}c=n.createVertexArray(),n.bindVertexArray(c);for(let p=0;p<u.length;p++){const g=u[p];a.bind(g),i&&g._glBuffers[r].refCount++}return this.activateVao(t,l),h[l.id]=c,h[o]=c,n.bindVertexArray(null),a.unbind(As.ARRAY_BUFFER),c}disposeGeometry(t,e){var l;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,r=t.buffers,a=(l=this.renderer)==null?void 0:l.buffer;if(t.disposeRunner.remove(this),!!i){if(a)for(let o=0;o<r.length;o++){const h=r[o]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&a.dispose(r[o],e))}if(!e){for(const o in i)if(o[0]==="g"){const h=i[o];this._activeVao===h&&this.unbind(),n.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,n=this.CONTEXT_UID,r=this.renderer.buffer,a=t.buffers,l=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);let o=null;for(const h in l){const c=l[h],u=a[c.buffer],d=u._glBuffers[n];if(e.attributeData[h]){o!==d&&(r.bind(u),o=d);const f=e.attributeData[h].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,n){const{gl:r}=this,a=this._activeGeometry;if(a.indexBuffer){const l=a.indexBuffer.data.BYTES_PER_ELEMENT,o=l===2?r.UNSIGNED_SHORT:r.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?a.instanced?r.drawElementsInstanced(t,e||a.indexBuffer.data.length,o,(i||0)*l,n||1):r.drawElements(t,e||a.indexBuffer.data.length,o,(i||0)*l):console.warn("unsupported index buffer type: uint32")}else a.instanced?r.drawArraysInstanced(t,i,e||a.getSize(),n||1):r.drawArrays(t,i,e||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}sc.extension={type:j.RendererSystem,name:"geometry"};J.add(sc);const rf=new Rt;class Ta{constructor(t,e){this._texture=t,this.mapCoord=new Rt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let n=0;n<t.length;n+=2){const r=t[n],a=t[n+1];e[n]=r*i.a+a*i.c+i.tx,e[n+1]=r*i.b+a*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const n=e.orig,r=e.trim;r&&(rf.set(n.width/r.width,0,0,n.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(rf));const a=e.baseTexture,l=this.uClampFrame,o=this.clampMargin/a.resolution,h=this.clampOffset;return l[0]=(e._frame.x+o+h)/a.width,l[1]=(e._frame.y+o+h)/a.height,l[2]=(e._frame.x+e._frame.width-o+h)/a.width,l[3]=(e._frame.y+e._frame.height-o+h)/a.height,this.uClampOffset[0]=h/a.realWidth,this.uClampOffset[1]=h/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&e.rotate===0,!0}}var Y_=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,$_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Nm extends se{constructor(t,e,i){let n=null;typeof t!="string"&&e===void 0&&i===void 0&&(n=t,t=void 0,e=void 0,i=void 0),super(t||$_,e||Y_,i),this.maskSprite=n,this.maskMatrix=new Rt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,n){const r=this._maskSprite,a=r._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Ta(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,i,n))}}class Lm{constructor(t=null){this.type=te.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=se.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=te.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class ic{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const r=this.maskDataPool.pop()||new Lm;r.pooled=!0,r.maskObject=e,i=r}const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==te.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case te.SCISSOR:this.renderer.scissor.push(i);break;case te.STENCIL:this.renderer.stencil.push(i);break;case te.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case te.COLOR:this.pushColorMask(i);break}i.type===te.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case te.SCISSOR:this.renderer.scissor.pop(e);break;case te.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case te.SPRITE:this.popSpriteMask(e);break;case te.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===te.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=te.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=te.SCISSOR:t.type=te.STENCIL:t.type=te.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Nm]));const r=this.renderer,a=r.renderTexture;let l,o;if(a.current){const c=a.current;l=t.resolution||c.resolution,o=t.multisample??c.multisample}else l=t.resolution||r.resolution,o=t.multisample??r.multisample;n[0].resolution=l,n[0].multisample=o,n[0].maskSprite=e;const h=i.filterArea;i.filterArea=e.getBounds(!0),r.filter.push(i,n),i.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}ic.extension={type:j.RendererSystem,name:"mask"};J.add(ic);class Om{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const n=this.getStackLength();n!==i&&(n===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const of=new Rt,af=[],Bo=class extends Om{constructor(s){super(s),this.glConst=q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const s=this.maskStack[this.maskStack.length-1];return s?s._scissorCounter:0}calcScissorRect(s){if(s._scissorRectLocal)return;const t=s._scissorRect,{maskObject:e}=s,{renderer:i}=this,n=i.renderTexture,r=e.getBounds(!0,af.pop()??new ft);this.roundFrameToPixels(r,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),t&&r.fit(t),s._scissorRectLocal=r}static isMatrixRotated(s){if(!s)return!1;const{a:t,b:e,c:i,d:n}=s;return(Math.abs(e)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(s){const{maskObject:t}=s;if(!t.isFastRect||!t.isFastRect()||Bo.isMatrixRotated(t.worldTransform)||Bo.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(s);const e=s._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(s,t,e,i,n){Bo.isMatrixRotated(n)||(n=n?of.copyFrom(n):of.identity(),n.translate(-e.x,-e.y).scale(i.width/e.width,i.height/e.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,s),s.fit(i),s.x=Math.round(s.x*t),s.y=Math.round(s.y*t),s.width=Math.round(s.width*t),s.height=Math.round(s.height*t))}push(s){s._scissorRectLocal||this.calcScissorRect(s);const{gl:t}=this.renderer;s._scissorRect||t.enable(t.SCISSOR_TEST),s._scissorCounter++,s._scissorRect=s._scissorRectLocal,this._useCurrent()}pop(s){const{gl:t}=this.renderer;s&&af.push(s._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const s=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=s.y:t=this.renderer.height-s.height-s.y,this.renderer.gl.scissor(s.x,t,s.width,s.height)}};let nc=Bo;nc.extension={type:j.RendererSystem,name:"scissor"};J.add(nc);class rc extends Om{constructor(t){super(t),this.glConst=q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const r=t._colorMask;r!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,r!==0&&(t._colorMask=r,i.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,e.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}rc.extension={type:j.RendererSystem,name:"stencil"};J.add(rc);class oc{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return rt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return rt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return rt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}oc.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_plugin"};J.add(oc);class ac{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Rt,this.transform=null}update(t,e,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);const r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)}calculateProjection(t,e,i,n){const r=this.projectionMatrix,a=n?-1:1;r.identity(),r.a=1/e.width*2,r.d=a*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-a-e.y*r.d}setTransform(t){}destroy(){this.renderer=null}}ac.extension={type:j.RendererSystem,name:"projection"};J.add(ac);const G_=new zn;class lc{constructor(t){this.renderer=t,this._tempMatrix=new Rt}generateTexture(t,e){const{region:i,...n}=e||{},r=i||t.getLocalBounds(null,!0);r.width===0&&(r.width=1),r.height===0&&(r.height=1);const a=Di.create({width:r.width,height:r.height,...n});this._tempMatrix.tx=-r.x,this._tempMatrix.ty=-r.y;const l=t.transform;return t.transform=G_,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,a}destroy(){}}lc.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"textureGenerator"};J.add(lc);const Oi=new ft,or=new ft;class hc{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ft,this.destinationFrame=new ft,this.viewportFrame=new ft}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){const n=this.renderer;this.current=t;let r,a,l;t?(r=t.baseTexture,l=r.resolution,e||(Oi.width=t.frame.width,Oi.height=t.frame.height,e=Oi),i||(or.x=t.frame.x,or.y=t.frame.y,or.width=e.width,or.height=e.height,i=or),a=r.framebuffer):(l=n.resolution,e||(Oi.width=n._view.screen.width,Oi.height=n._view.screen.height,e=Oi),i||(i=Oi,i.width=e.width,i.height=e.height));const o=this.viewportFrame;o.x=i.x*l,o.y=i.y*l,o.width=i.width*l,o.height=i.height*l,t||(o.y=n.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(a,o),this.renderer.projection.update(i,e,l,!a),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=bt.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const r=this.destinationFrame,a=this.current?this.current.baseTexture:this.renderer._view.screen,l=r.width!==a.width||r.height!==a.height;if(l){let{x:o,y:h,width:c,height:u}=this.viewportFrame;o=Math.round(o),h=Math.round(h),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,h,c,u)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,e),l&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}hc.extension={type:j.RendererSystem,name:"renderTexture"};J.add(hc);class W_{}class Vm{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function H_(s,t){const e={},i=t.getProgramParameter(s,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const r=t.getActiveAttrib(s,n);if(r.name.startsWith("gl_"))continue;const a=Rm(t,r.type),l={type:a,name:r.name,size:Im(a),location:t.getAttribLocation(s,r.name)};e[r.name]=l}return e}function z_(s,t){const e={},i=t.getProgramParameter(s,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){const r=t.getActiveUniform(s,n),a=r.name.replace(/\[.*?\]$/,""),l=!!r.name.match(/\[.*?\]$/),o=Rm(t,r.type);e[a]={name:a,index:n,type:o,size:r.size,isArray:l,value:Am(o,r.size)}}return e}function Um(s,t){var o;const e=Qd(s,s.VERTEX_SHADER,t.vertexSrc),i=Qd(s,s.FRAGMENT_SHADER,t.fragmentSrc),n=s.createProgram();s.attachShader(n,e),s.attachShader(n,i);const r=(o=t.extra)==null?void 0:o.transformFeedbackVaryings;if(r&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(n,r.names,r.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(n),s.getProgramParameter(n,s.LINK_STATUS)||R_(s,n,e,i),t.attributeData=H_(n,s),t.uniformData=z_(n,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const h=Object.keys(t.attributeData);h.sort((c,u)=>c>u?1:-1);for(let c=0;c<h.length;c++)t.attributeData[h[c]].location=c,s.bindAttribLocation(n,c,h[c]);s.linkProgram(n)}s.deleteShader(e),s.deleteShader(i);const a={};for(const h in t.uniformData){const c=t.uniformData[h];a[h]={location:s.getUniformLocation(n,h),value:Am(c.type,c.size)}}return new Vm(n,a)}function j_(s,t,e,i,n){e.buffer.update(n)}const q_={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Xm={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Ym(s){const t=s.map(r=>({data:r,offset:0,dataLen:0,dirty:0}));let e=0,i=0,n=0;for(let r=0;r<t.length;r++){const a=t[r];if(e=Xm[a.data.type],a.data.size>1&&(e=Math.max(e,16)*a.data.size),a.dataLen=e,i%e!==0&&i<16){const l=i%e%16;i+=l,n+=l}i+e>16?(n=Math.ceil(n/16)*16,a.offset=n,n+=e,i=e):(a.offset=n,i+=e,n+=e)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function $m(s,t){const e=[];for(const i in s)t[i]&&e.push(t[i]);return e.sort((i,n)=>i.index-n.index),e}function Gm(s,t){if(!s.autoManage)return{size:0,syncFunc:j_};const e=$m(s.uniforms,t),{uboElements:i,size:n}=Ym(e),r=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let a=0;a<i.length;a++){const l=i[a],o=s.uniforms[l.data.name],h=l.data.name;let c=!1;for(let u=0;u<sn.length;u++){const d=sn[u];if(d.codeUbo&&d.test(l.data,o)){r.push(`offset = ${l.offset/4};`,sn[u].codeUbo(l.data.name,o)),c=!0;break}}if(!c)if(l.data.size>1){const u=Im(l.data.type),d=Math.max(Xm[l.data.type]/16,1),f=u/d,m=(4-f%4)%4;r.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{const u=q_[l.data.type];r.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${l.offset/4};
                ${u};
                `)}}return r.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",r.join(`
`))}}let Z_=0;const So={textureCount:0,uboCount:0};class cc{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Z_++}systemCheck(){if(!Pm())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),e||(So.textureCount=0,So.uboCount=0,this.syncUniformGroup(t.uniformGroup,So)),n}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=M_(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,So,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);const r=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(e.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(t,this.shader.program.uniformData,"ubo");let l=this._uboCache[a];if(l||(l=this._uboCache[a]=Gm(t,this.shader.program.uniformData)),t.autoManage){const o=new Float32Array(l.size/4);t.buffer.update(o)}return e.uniformGroups[t.id]=l.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const n=t.uniforms,r=[`${i}-`];for(const a in n)r.push(a),e[a]&&r.push(e[a].type);return r.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,n=Um(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}cc.extension={type:j.RendererSystem,name:"shader"};J.add(cc);class Qr{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.2.4 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Qr.defaultOptions={hello:!1};Qr.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"startup"};J.add(Qr);function K_(s,t=[]){return t[Z.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.ADD]=[s.ONE,s.ONE],t[Z.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.NONE]=[0,0],t[Z.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],t[Z.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SRC_IN]=[s.DST_ALPHA,s.ZERO],t[Z.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],t[Z.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[Z.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],t[Z.DST_IN]=[s.ZERO,s.SRC_ALPHA],t[Z.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],t[Z.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],t[Z.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[Z.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],t}const Q_=0,J_=1,tv=2,ev=3,sv=4,iv=5,nh=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Z.NONE,this._blendEq=!1,this.map=[],this.map[Q_]=this.setBlend,this.map[J_]=this.setOffset,this.map[tv]=this.setCullFace,this.map[ev]=this.setDepthTest,this.map[sv]=this.setFrontFace,this.map[iv]=this.setDepthMask,this.checks=[],this.defaultState=new qs,this.defaultState.blend=!0}contextChange(s){this.gl=s,this.blendModes=K_(s),this.set(this.defaultState),this.reset()}set(s){if(s=s||this.defaultState,this.stateId!==s.data){let t=this.stateId^s.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(s.data&1<<e)),t=t>>1,e++;this.stateId=s.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,s)}forceState(s){s=s||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(s.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,s);this.stateId=s.data}setBlend(s){this.updateCheck(nh.checkBlendMode,s),this.gl[s?"enable":"disable"](this.gl.BLEND)}setOffset(s){this.updateCheck(nh.checkPolygonOffset,s),this.gl[s?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(s){this.gl[s?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(s){this.gl.depthMask(s)}setCullFace(s){this.gl[s?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(s){this.gl.frontFace(this.gl[s?"CW":"CCW"])}setBlendMode(s){if(s===this.blendMode)return;this.blendMode=s;const t=this.blendModes[s],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(s,t){this.gl.polygonOffset(s,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(s,t){const e=this.checks.indexOf(s);t&&e===-1?this.checks.push(s):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(s,t){s.setBlendMode(t.blendMode)}static checkPolygonOffset(s,t){s.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let uc=nh;uc.extension={type:j.RendererSystem,name:"state"};J.add(uc);class Wm extends Fs{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(n=>t.systems[n]),i=[...e,...Object.keys(t.systems).filter(n=>!e.includes(n))];for(const n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(e=>{this.runners[e]=new je(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(n=>{const r=i.find(a=>this._systemsHash[a]===n);n[t.name](e[r])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Do=class{constructor(s){this.renderer=s,this.count=0,this.checkCount=0,this.maxIdle=Do.defaultMaxIdle,this.checkCountMax=Do.defaultCheckCountMax,this.mode=Do.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==xa.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const s=this.renderer.texture,t=s.managedTextures;let e=!1;for(let i=0;i<t.length;i++){const n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(s.destroyTexture(n,!0),t[i]=null,e=!0)}if(e){let i=0;for(let n=0;n<t.length;n++)t[n]!==null&&(t[i++]=t[n]);t.length=i}}unload(s){const t=this.renderer.texture,e=s._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let i=s.children.length-1;i>=0;i--)this.unload(s.children[i])}destroy(){this.renderer=null}};let ns=Do;ns.defaultMode=xa.AUTO;ns.defaultMaxIdle=60*60;ns.defaultCheckCountMax=60*10;ns.extension={type:j.RendererSystem,name:"textureGC"};J.add(ns);class No{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=et.UNSIGNED_BYTE,this.internalFormat=z.RGBA,this.samplerType=0}}function nv(s){let t;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?t={[et.UNSIGNED_BYTE]:{[z.RGBA]:s.RGBA8,[z.RGB]:s.RGB8,[z.RG]:s.RG8,[z.RED]:s.R8,[z.RGBA_INTEGER]:s.RGBA8UI,[z.RGB_INTEGER]:s.RGB8UI,[z.RG_INTEGER]:s.RG8UI,[z.RED_INTEGER]:s.R8UI,[z.ALPHA]:s.ALPHA,[z.LUMINANCE]:s.LUMINANCE,[z.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[et.BYTE]:{[z.RGBA]:s.RGBA8_SNORM,[z.RGB]:s.RGB8_SNORM,[z.RG]:s.RG8_SNORM,[z.RED]:s.R8_SNORM,[z.RGBA_INTEGER]:s.RGBA8I,[z.RGB_INTEGER]:s.RGB8I,[z.RG_INTEGER]:s.RG8I,[z.RED_INTEGER]:s.R8I},[et.UNSIGNED_SHORT]:{[z.RGBA_INTEGER]:s.RGBA16UI,[z.RGB_INTEGER]:s.RGB16UI,[z.RG_INTEGER]:s.RG16UI,[z.RED_INTEGER]:s.R16UI,[z.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[et.SHORT]:{[z.RGBA_INTEGER]:s.RGBA16I,[z.RGB_INTEGER]:s.RGB16I,[z.RG_INTEGER]:s.RG16I,[z.RED_INTEGER]:s.R16I},[et.UNSIGNED_INT]:{[z.RGBA_INTEGER]:s.RGBA32UI,[z.RGB_INTEGER]:s.RGB32UI,[z.RG_INTEGER]:s.RG32UI,[z.RED_INTEGER]:s.R32UI,[z.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[et.INT]:{[z.RGBA_INTEGER]:s.RGBA32I,[z.RGB_INTEGER]:s.RGB32I,[z.RG_INTEGER]:s.RG32I,[z.RED_INTEGER]:s.R32I},[et.FLOAT]:{[z.RGBA]:s.RGBA32F,[z.RGB]:s.RGB32F,[z.RG]:s.RG32F,[z.RED]:s.R32F,[z.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[et.HALF_FLOAT]:{[z.RGBA]:s.RGBA16F,[z.RGB]:s.RGB16F,[z.RG]:s.RG16F,[z.RED]:s.R16F},[et.UNSIGNED_SHORT_5_6_5]:{[z.RGB]:s.RGB565},[et.UNSIGNED_SHORT_4_4_4_4]:{[z.RGBA]:s.RGBA4},[et.UNSIGNED_SHORT_5_5_5_1]:{[z.RGBA]:s.RGB5_A1},[et.UNSIGNED_INT_2_10_10_10_REV]:{[z.RGBA]:s.RGB10_A2,[z.RGBA_INTEGER]:s.RGB10_A2UI},[et.UNSIGNED_INT_10F_11F_11F_REV]:{[z.RGB]:s.R11F_G11F_B10F},[et.UNSIGNED_INT_5_9_9_9_REV]:{[z.RGB]:s.RGB9_E5},[et.UNSIGNED_INT_24_8]:{[z.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[et.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[z.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:t={[et.UNSIGNED_BYTE]:{[z.RGBA]:s.RGBA,[z.RGB]:s.RGB,[z.ALPHA]:s.ALPHA,[z.LUMINANCE]:s.LUMINANCE,[z.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[et.UNSIGNED_SHORT_5_6_5]:{[z.RGB]:s.RGB},[et.UNSIGNED_SHORT_4_4_4_4]:{[z.RGBA]:s.RGBA},[et.UNSIGNED_SHORT_5_5_5_1]:{[z.RGBA]:s.RGBA}},t}class dc{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new nt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=nv(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};const i=new No(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new No(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,e=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let r=t-1;r>=0;--r){const a=e[r];a&&a._glTextures[n].samplerType!==$o.FLOAT&&this.renderer.texture.unbind(a)}}initTexture(t){const e=new No(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i;e.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,this.webGLVersion===2&&t.type===et.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var n;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),(n=t.resource)!=null&&n.upload(i,t,e))e.samplerType!==$o.FLOAT&&(this.hasIntegerTextures=!0);else{const r=t.realWidth,a=t.realHeight,l=i.gl;(e.width!==r||e.height!==a||e.dirtyId<0)&&(e.width=r,e.height=a,l.texImage2D(t.target,0,e.internalFormat,r,a,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const n=this.managedTextures.indexOf(t);n!==-1&&en(this.managedTextures,n,1)}}updateTextureStyle(t){var i;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===cs.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Ws.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==cs.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Oe.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===Oe.LINEAR){const r=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Oe.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Oe.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}dc.extension={type:j.RendererSystem,name:"texture"};J.add(dc);class fc{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,n=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:n}=this;e&&n.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:n}=this,r=e.createTransformFeedback();t._glTransformFeedbacks[n]=r,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r);for(let a=0;a<t.buffers.length;a++){const l=t.buffers[a];l&&(i.buffer.update(l),l._glBuffers[n].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,a,l._glBuffers[n].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),r}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);const r=this.renderer.buffer;if(r)for(let a=0;a<t.buffers.length;a++){const l=t.buffers[a];if(!l)continue;const o=l._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,o.refCount===0&&!e&&r.dispose(l,e))}i&&(e||n.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}fc.extension={type:j.RendererSystem,name:"transformFeedback"};J.add(fc);class Jr{constructor(t){this.renderer=t}init(t){this.screen=new ft(0,0,t.width,t.height),this.element=t.view||q.ADAPTER.createCanvas(),this.resolution=t.resolution||q.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Jr.defaultOptions={width:800,height:600,resolution:q.RESOLUTION,autoDensity:!1};Jr.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_view"};J.add(Jr);q.PREFER_ENV=Fi.WEBGL2;q.STRICT_TEXTURE_CACHE=!1;q.RENDER_OPTIONS={...Kr.defaultOptions,...Zr.defaultOptions,...Jr.defaultOptions,...Qr.defaultOptions};Object.defineProperties(q,{WRAP_MODE:{get(){return nt.defaultOptions.wrapMode},set(s){rt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),nt.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return nt.defaultOptions.scaleMode},set(s){rt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),nt.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return nt.defaultOptions.mipmap},set(s){rt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),nt.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return nt.defaultOptions.anisotropicLevel},set(s){rt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),nt.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return rt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),se.defaultResolution},set(s){se.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return rt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),se.defaultMultisample},set(s){se.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return is.defaultMaxTextures},set(s){rt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),is.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return is.defaultBatchSize},set(s){rt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),is.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return is.canUploadSameBuffer},set(s){rt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),is.canUploadSameBuffer=s}},GC_MODE:{get(){return ns.defaultMode},set(s){rt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ns.defaultMode=s}},GC_MAX_IDLE:{get(){return ns.defaultMaxIdle},set(s){rt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ns.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return ns.defaultCheckCountMax},set(s){rt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ns.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return as.defaultVertexPrecision},set(s){rt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),as.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return as.defaultFragmentPrecision},set(s){rt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),as.defaultFragmentPrecision=s}}});var mi=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(mi||{});class vl{constructor(t,e=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=n}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const We=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new vl(null,null,1/0),this.deltaMS=1/We.targetFPMS,this.elapsedMS=1/We.targetFPMS,this._tick=s=>{this._requestId=null,this.started&&(this.update(s),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(s,t,e=mi.NORMAL){return this._addListener(new vl(s,t,e))}addOnce(s,t,e=mi.NORMAL){return this._addListener(new vl(s,t,e,!0))}_addListener(s){let t=this._head.next,e=this._head;if(!t)s.connect(e);else{for(;t;){if(s.priority>t.priority){s.connect(e);break}e=t,t=t.next}s.previous||s.connect(e)}return this._startIfPossible(),this}remove(s,t){let e=this._head.next;for(;e;)e.match(s,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let s=0,t=this._head;for(;t=t.next;)s++;return s}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let s=this._head.next;for(;s;)s=s.destroy(!0);this._head.destroy(),this._head=null}}update(s=performance.now()){let t;if(s>this.lastTime){if(t=this.elapsedMS=s-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const n=s-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=s-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*We.targetFPMS;const e=this._head;let i=e.next;for(;i;)i=i.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=s}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(s){const t=Math.min(this.maxFPS,s),e=Math.min(Math.max(0,t)/1e3,We.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(s){if(s===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,s);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!We._shared){const s=We._shared=new We;s.autoStart=!0,s._protected=!0}return We._shared}static get system(){if(!We._system){const s=We._system=new We;s.autoStart=!0,s._protected=!0}return We._system}};let Pt=We;Pt.targetFPMS=.06;Object.defineProperties(q,{TARGET_FPMS:{get(){return Pt.targetFPMS},set(s){rt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Pt.targetFPMS=s}}});class mc{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,mi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Pt.shared:new Pt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}mc.extension=j.Application;J.add(mc);const Hm=[];J.handleByList(j.Renderer,Hm);function zm(s){for(const t of Hm)if(t.test(s))return new t(s);throw new Error("Unable to auto-detect a suitable renderer.")}var rv=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ov=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const jm=rv,pc=ov;class gc{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=jt.HIGH?this.multisample=jt.HIGH:e>=jt.MEDIUM?this.multisample=jt.MEDIUM:e>=jt.LOW?this.multisample=jt.LOW:this.multisample=jt.NONE}destroy(){}}gc.extension={type:j.RendererSystem,name:"_multisample"};J.add(gc);class av{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class xc{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,n.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[e]!==t){const r=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,r.buffer)}}bindBufferRange(t,e,i){const{gl:n,CONTEXT_UID:r}=this;i=i||0;const a=t._glBuffers[r]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,e||0,a.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,e.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(e||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new av(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}xc.extension={type:j.RendererSystem,name:"buffer"};J.add(xc);class yc{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let n,r,a,l;if(e&&(n=e.renderTexture,r=e.clear,a=e.transform,l=e.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=a,!i.context.isLost){if(n||(this.lastObjectRendered=t),!l){const o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(r??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),n&&(e.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}yc.extension={type:j.RendererSystem,name:"objectRenderer"};J.add(yc);const rh=class extends Wm{constructor(s){super(),this.type=Fh.WEBGL,s=Object.assign({},q.RENDER_OPTIONS,s),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new hs({projectionMatrix:new Rt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:rh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in s&&(rt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),s.premultipliedAlpha=s.useContextAlpha&&s.useContextAlpha!=="notMultiplied",s.backgroundAlpha=s.useContextAlpha===!1?1:s.backgroundAlpha),this._plugin.rendererPlugins=rh.__plugins,this.options=s,this.startup.run(this.options)}static test(s){return s!=null&&s.forceCanvas?!1:hm()}render(s,t){this.objectRenderer.render(s,t)}resize(s,t){this._view.resizeView(s,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(s=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:s}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(s){this._view.resolution=s,this.runners.resolutionChange.emit(s)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return rt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return rt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return rt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return rt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(s){rt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=s}get backgroundAlpha(){return rt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(s){rt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=s}get powerPreference(){return rt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(s,t){return this.textureGenerator.generateTexture(s,t)}};let cn=rh;cn.extension={type:j.Renderer,priority:1};cn.__plugins={};cn.__systems={};J.handleByMap(j.RendererPlugin,cn.__plugins);J.handleByMap(j.RendererSystem,cn.__systems);J.add(cn);class _c extends Xn{constructor(t,e){const{width:i,height:n}=e||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let r=0;r<t;r++){const a=new nt;this.items.push(a),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Xn?this.addResourceAt(t[i],i):this.addResourceAt(Hh(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(e).then(()=>{const{realWidth:i,realHeight:n}=this.items[0];return this.resize(i,n),Promise.resolve(this)}),this._load}}class qm extends _c{constructor(t,e){const{width:i,height:n}=e||{};let r,a;Array.isArray(t)?(r=t,a=t.length):a=t,super(a,{width:i,height:n}),r&&this.initFromArray(r,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Qi.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:n,itemDirtyIds:r,items:a}=this,{gl:l}=t;i.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,e.format,i.type,null);for(let o=0;o<n;o++){const h=a[o];r[o]<h.dirtyId&&(r[o]=h.dirtyId,h.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,o,h.resource.width,h.resource.height,1,e.format,i.type,h.resource.source))}return!0}}class Zm extends fi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const cr=class extends _c{constructor(s,t){const{width:e,height:i,autoLoad:n,linkBaseTexture:r}=t||{};if(s&&s.length!==cr.SIDES)throw new Error(`Invalid length. Got ${s.length}, expected 6`);super(6,{width:e,height:i});for(let a=0;a<cr.SIDES;a++)this.items[a].target=Qi.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=r!==!1,s&&this.initFromArray(s,t),n!==!1&&this.load()}bind(s){super.bind(s),s.target=Qi.TEXTURE_CUBE_MAP}addBaseTextureAt(s,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||s.parentTextureArray||Object.keys(s._glTextures).length>0)if(s.resource)this.addResourceAt(s.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else s.target=Qi.TEXTURE_CUBE_MAP_POSITIVE_X+t,s.parentTextureArray=this.baseTexture,this.items[t]=s;return s.valid&&!this.valid&&this.resize(s.realWidth,s.realHeight),this.items[t]=s,this}upload(s,t,e){const i=this.itemDirtyIds;for(let n=0;n<cr.SIDES;n++){const r=this.items[n];(i[n]<r.dirtyId||e.dirtyId<t.dirtyId)&&(r.valid&&r.resource?(r.resource.upload(s,r,e),i[n]=r.dirtyId):i[n]<-1&&(s.gl.texImage2D(r.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),i[n]=-1))}return!0}static test(s){return Array.isArray(s)&&s.length===cr.SIDES}};let vc=cr;vc.SIDES=6;class ji extends fi{constructor(t,e){e=e||{};let i,n;typeof t=="string"?(i=ji.EMPTY,n=t):(i=t,n=null),super(i),this.url=n,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await q.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await i.blob();if(this.destroyed)return;const r=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Je.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=r,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return ji._EMPTY=ji._EMPTY??q.ADAPTER.createCanvas(0,0),ji._EMPTY}}const Lo=class extends fi{constructor(s,t){t=t||{},super(q.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=s,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(s=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),s(this)},Lo.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const s=new Image;fi.crossOrigin(s,this.svg,this._crossorigin),s.src=this.svg,s.onerror=t=>{this._resolve&&(s.onerror=null,this.onError.emit(t))},s.onload=()=>{if(!this._resolve)return;const t=s.width,e=s.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,n=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/e*t,n=this._overrideHeight||this._overrideWidth/t*e),i=Math.round(i),n=Math.round(n);const r=this.source;r.width=i,r.height=n,r._pixiId=`canvas_${Ii()}`,r.getContext("2d").drawImage(s,0,0,t,e,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(s){const t=Lo.SVG_SIZE.exec(s),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(s,t){return t==="svg"||typeof s=="string"&&s.startsWith("data:image/svg+xml")||typeof s=="string"&&Lo.SVG_XML.test(s)}};let Yn=Lo;Yn.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Yn.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const oh=class extends fi{constructor(s,t){if(t=t||{},!(s instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof s=="string"&&(s=[s]);const i=s[0].src||s[0];fi.crossOrigin(e,i,t.crossorigin);for(let n=0;n<s.length;++n){const r=document.createElement("source");let{src:a,mime:l}=s[n];a=a||s[n];const o=a.split("?").shift().toLowerCase(),h=o.slice(o.lastIndexOf(".")+1);l=l||oh.MIME_TYPES[h]||`video/${h}`,r.src=a,r.type=l,e.appendChild(r)}s=e}super(s),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(s=0){if(!this.destroyed){const t=Pt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const s=this.source;return(s.readyState===s.HAVE_ENOUGH_DATA||s.readyState===s.HAVE_FUTURE_DATA)&&s.width&&s.height&&(s.complete=!0),s.addEventListener("play",this._onPlayStart.bind(this)),s.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(s.addEventListener("canplay",this._onCanPlay),s.addEventListener("canplaythrough",this._onCanPlay),s.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,s.load())}),this._load}_onError(s){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(s)}_isSourcePlaying(){const s=this.source;return!s.paused&&!s.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Pt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Pt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const s=this.source;s.removeEventListener("canplay",this._onCanPlay),s.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(s.videoWidth,s.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&s.play()}dispose(){this._isConnectedToTicker&&(Pt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const s=this.source;s&&(s.removeEventListener("error",this._onError,!0),s.pause(),s.src="",s.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,!this._autoUpdate&&this._isConnectedToTicker?(Pt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Pt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(s){s!==this._updateFPS&&(this._updateFPS=s)}static test(s,t){return globalThis.HTMLVideoElement&&s instanceof HTMLVideoElement||oh.TYPES.includes(t)}};let Aa=oh;Aa.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Aa.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ko.push(ji,Zh,Zm,Aa,Yn,Hn,vc,qm);class lv{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new je("disposeTransformFeedback")}bindBuffer(t,e){this.buffers[t]=e}destroy(){this.disposeRunner.emit(this,!1)}}const hv="7.2.4";class Fr{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?ft.EMPTY:(t=t||new ft(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:n,c:r,d:a,tx:l,ty:o}=t,h=i*e.x+r*e.y+l,c=n*e.x+a*e.y+o;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,a=t[0],l=t[1];e=a<e?a:e,i=l<i?l:i,n=a>n?a:n,r=l>r?l:r,a=t[2],l=t[3],e=a<e?a:e,i=l<i?l:i,n=a>n?a:n,r=l>r?l:r,a=t[4],l=t[5],e=a<e?a:e,i=l<i?l:i,n=a>n?a:n,r=l>r?l:r,a=t[6],l=t[7],e=a<e?a:e,i=l<i?l:i,n=a>n?a:n,r=l>r?l:r,this.minX=e,this.minY=i,this.maxX=n,this.maxY=r}addFrame(t,e,i,n,r){this.addFrameMatrix(t.worldTransform,e,i,n,r)}addFrameMatrix(t,e,i,n,r){const a=t.a,l=t.b,o=t.c,h=t.d,c=t.tx,u=t.ty;let d=this.minX,f=this.minY,m=this.maxX,p=this.maxY,g=a*e+o*i+c,v=l*e+h*i+u;d=g<d?g:d,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,g=a*n+o*i+c,v=l*n+h*i+u,d=g<d?g:d,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,g=a*e+o*r+c,v=l*e+h*r+u,d=g<d?g:d,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,g=a*n+o*r+c,v=l*n+h*r+u,d=g<d?g:d,f=v<f?v:f,m=g>m?g:m,p=v>p?v:p,this.minX=d,this.minY=f,this.maxX=m,this.maxY=p}addVertexData(t,e,i){let n=this.minX,r=this.minY,a=this.maxX,l=this.maxY;for(let o=e;o<i;o+=2){const h=t[o],c=t[o+1];n=h<n?h:n,r=c<r?c:r,a=h>a?h:a,l=c>l?c:l}this.minX=n,this.minY=r,this.maxX=a,this.maxY=l}addVertices(t,e,i,n){this.addVerticesMatrix(t.worldTransform,e,i,n)}addVerticesMatrix(t,e,i,n,r=0,a=r){const l=t.a,o=t.b,h=t.c,c=t.d,u=t.tx,d=t.ty;let f=this.minX,m=this.minY,p=this.maxX,g=this.maxY;for(let v=i;v<n;v+=2){const _=e[v],x=e[v+1],y=l*_+h*x+u,b=c*x+o*_+d;f=Math.min(f,y-r),p=Math.max(p,y+r),m=Math.min(m,b-a),g=Math.max(g,b+a)}this.minX=f,this.minY=m,this.maxX=p,this.maxY=g}addBounds(t){const e=this.minX,i=this.minY,n=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>r?t.maxY:r}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=r&&n<=a){const l=this.minX,o=this.minY,h=this.maxX,c=this.maxY;this.minX=i<l?i:l,this.minY=n<o?n:o,this.maxX=r>h?r:h,this.maxY=a>c?a:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=r&&n<=a){const l=this.minX,o=this.minY,h=this.maxX,c=this.maxY;this.minX=i<l?i:l,this.minY=n<o?n:o,this.maxX=r>h?r:h,this.maxY=a>c?a:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,n,r,a){t-=r,e-=a,i+=r,n+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n}}class Bt extends Fs{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new zn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Fr,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const n=e[i];Object.defineProperty(Bt.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ft),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new ft),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Fr);const e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,r=this._boundsID;this._bounds=this._localBounds;const a=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=n,this._bounds.updateID+=this._boundsID-r,a}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,i=1,n=1,r=0,a=0,l=0,o=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=r,this.skew.x=a,this.skew.y=l,this.pivot.x=o,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Km),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*wm}set angle(t){this.transform.rotation=t*Em}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class Km extends Bt{constructor(){super(...arguments),this.sortDirty=null}}Bt.prototype.displayObjectUpdateTransform=Bt.prototype.updateTransform;const cv=new Rt;function uv(s,t){return s.zIndex===t.zIndex?s._lastSortedIndex-t._lastSortedIndex:s.zIndex-t.zIndex}const ah=class extends Bt{constructor(){super(),this.children=[],this.sortableChildren=ah.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(s){}addChild(...s){if(s.length>1)for(let t=0;t<s.length;t++)this.addChild(s[t]);else{const t=s[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return s[0]}addChildAt(s,t){if(t<0||t>this.children.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.splice(t,0,s),this._boundsID++,this.onChildrenChange(t),s.emit("added",this),this.emit("childAdded",s,this,t),s}swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s,this.onChildrenChange(e<i?e:i)}getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(s);en(this.children,e,1),this.children.splice(t,0,s),this.onChildrenChange(t)}getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]}removeChild(...s){if(s.length>1)for(let t=0;t<s.length;t++)this.removeChild(s[t]);else{const t=s[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,en(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return s[0]}removeChildAt(s){const t=this.getChildAt(s);return t.parent=null,t.transform._parentID=-1,en(this.children,s,1),this._boundsID++,this.onChildrenChange(s),t.emit("removed",this),this.emit("childRemoved",t,this,s),t}removeChildren(s=0,t=this.children.length){const e=s,i=t,n=i-e;let r;if(n>0&&n<=i){r=this.children.splice(e,n);for(let a=0;a<r.length;++a)r[a].parent=null,r[a].transform&&(r[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(s);for(let a=0;a<r.length;++a)r[a].emit("removed",this),this.emit("childRemoved",r[a],this,a);return r}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let s=!1;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i._lastSortedIndex=t,!s&&i.zIndex!==0&&(s=!0)}s&&this.children.length>1&&this.children.sort(uv),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let s=0,t=this.children.length;s<t;++s){const e=this.children[s];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let s=0;s<this.children.length;s++){const t=this.children[s];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(s,t=!1){const e=super.getLocalBounds(s);if(!t)for(let i=0,n=this.children.length;i<n;++i){const r=this.children[i];r.visible&&r.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(s){const t=s.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,i;this.cullArea?(e=this.cullArea,i=this.worldTransform):this._render!==ah.prototype._render&&(e=this.getBounds(!0));const n=s.projection.transform;if(n&&(i?(i=cv.copyFrom(i),i.prepend(n)):i=n),e&&t.intersects(e,i))this._render(s);else if(this.cullArea)return;for(let r=0,a=this.children.length;r<a;++r){const l=this.children[r],o=l.cullable;l.cullable=o||!this.cullArea,l.render(s),l.cullable=o}}render(s){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(s);else if(this.cullable)this._renderWithCulling(s);else{this._render(s);for(let e=0,i=this.children.length;e<i;++e)this.children[e].render(s)}}renderAdvanced(s){var n,r,a;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const i=t&&((n=this._enabledFilters)==null?void 0:n.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==te.NONE));if(i&&s.batch.flush(),t&&((r=this._enabledFilters)!=null&&r.length)&&s.filter.push(this,this._enabledFilters),e&&s.mask.push(this,this._mask),this.cullable)this._renderWithCulling(s);else{this._render(s);for(let l=0,o=this.children.length;l<o;++l)this.children[l].render(s)}i&&s.batch.flush(),e&&s.mask.pop(this),t&&((a=this._enabledFilters)!=null&&a.length)&&s.filter.pop()}_render(s){}destroy(s){super.destroy(),this.sortDirty=!1;const t=typeof s=="boolean"?s:s==null?void 0:s.children,e=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<e.length;++i)e[i].destroy(s)}get width(){return this.scale.x*this.getLocalBounds().width}set width(s){const t=this.getLocalBounds().width;t!==0?this.scale.x=s/t:this.scale.x=1,this._width=s}get height(){return this.scale.y*this.getLocalBounds().height}set height(s){const t=this.getLocalBounds().height;t!==0?this.scale.y=s/t:this.scale.y=1,this._height=s}};let fe=ah;fe.defaultSortableChildren=!1;fe.prototype.containerUpdateTransform=fe.prototype.updateTransform;Object.defineProperties(q,{SORTABLE_CHILDREN:{get(){return fe.defaultSortableChildren},set(s){rt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),fe.defaultSortableChildren=s}}});const ar=new at,dv=new Uint16Array([0,1,2,0,2,3]);class Bs extends fe{constructor(t){super(),this._anchor=new li(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new bt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=Z.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||K.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=dv,this.pluginName="batch",this.isSprite=!0,this._roundPixels=q.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ai(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ai(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,n=e.b,r=e.c,a=e.d,l=e.tx,o=e.ty,h=this.vertexData,c=t.trim,u=t.orig,d=this._anchor;let f=0,m=0,p=0,g=0;if(c?(m=c.x-d._x*u.width,f=m+c.width,g=c.y-d._y*u.height,p=g+c.height):(m=-d._x*u.width,f=m+u.width,g=-d._y*u.height,p=g+u.height),h[0]=i*m+r*g+l,h[1]=a*g+n*m+o,h[2]=i*f+r*g+l,h[3]=a*g+n*f+o,h[4]=i*f+r*p+l,h[5]=a*p+n*f+o,h[6]=i*m+r*p+l,h[7]=a*p+n*m+o,this._roundPixels){const v=q.RESOLUTION;for(let _=0;_<h.length;++_)h[_]=Math.round(h[_]*v)/v}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,n=this._anchor,r=this.transform.worldTransform,a=r.a,l=r.b,o=r.c,h=r.d,c=r.tx,u=r.ty,d=-n._x*i.width,f=d+i.width,m=-n._y*i.height,p=m+i.height;e[0]=a*d+o*m+c,e[1]=h*m+l*d+u,e[2]=a*f+o*m+c,e[3]=h*m+l*f+u,e[4]=a*f+o*p+c,e[5]=h*p+l*f+u,e[6]=a*d+o*p+c,e[7]=h*p+l*d+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Fr),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ft),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,ar);const e=this._texture.orig.width,i=this._texture.orig.height,n=-e*this.anchor.x;let r=0;return ar.x>=n&&ar.x<n+e&&(r=-i*this.anchor.y,ar.y>=r&&ar.y<r+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,e){const i=t instanceof K?t:K.from(t,e);return new Bs(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=ai(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=ai(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||K.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const Qm=new Rt;Bt.prototype._cacheAsBitmap=!1;Bt.prototype._cacheData=null;Bt.prototype._cacheAsBitmapResolution=null;Bt.prototype._cacheAsBitmapMultisample=null;class fv{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Bt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(s){s!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(s){s!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=s,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(s){if(this._cacheAsBitmap===s)return;this._cacheAsBitmap=s;let t;s?(this._cacheData||(this._cacheData=new fv),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Bt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Bt.prototype._initCachedDisplayObject=function(t){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const i=this.getLocalBounds(null,!0).clone();if((f=this.filters)!=null&&f.length){const m=this.filters[0].padding;i.pad(m)}i.ceil(q.RESOLUTION);const n=t.renderTexture.current,r=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,o=Di.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),h=`cacheAsBitmap_${Ii()}`;this._cacheData.textureCacheId=h,nt.addToCache(o.baseTexture,h),K.addToCache(o,h);const c=this.transform.localTransform.copyTo(Qm).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:o,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(n,r,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const u=new Bs(o);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(i.x/i.width),u.anchor.y=-(i.y/i.height),u.alpha=e,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};Bt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Bt.prototype._initCachedDisplayObjectCanvas=function(t){var c;if((c=this._cacheData)!=null&&c.sprite)return;const e=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;const n=t.canvasContext.activeContext,r=t._projTransform;e.ceil(q.RESOLUTION);const a=Di.create({width:e.width,height:e.height}),l=`cacheAsBitmap_${Ii()}`;this._cacheData.textureCacheId=l,nt.addToCache(a.baseTexture,l),K.addToCache(a,l);const o=Qm;this.transform.localTransform.copyTo(o),o.invert(),o.tx-=e.x,o.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:o,skipUpdateTransform:!1}),t.canvasContext.activeContext=n,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const h=new Bs(a);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(e.x/e.width),h.anchor.y=-(e.y/e.height),h.alpha=i,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};Bt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Bt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Bt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,nt.removeFromCache(this._cacheData.textureCacheId),K.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Bt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Bt.prototype.name=null;fe.prototype.getChildByName=function(t,e){for(let i=0,n=this.children.length;i<n;i++)if(this.children[i].name===t)return this.children[i];if(e)for(let i=0,n=this.children.length;i<n;i++){const r=this.children[i];if(!r.getChildByName)continue;const a=r.getChildByName(t,!0);if(a)return a}return null};Bt.prototype.getGlobalPosition=function(t=new at,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var mv=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class Jm extends se{constructor(t=1){super(jm,mv,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const pv={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},gv=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function xv(s){const t=pv[s],e=t.length;let i=gv,n="";const r="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let a;for(let l=0;l<s;l++){let o=r.replace("%index%",l.toString());a=l,l>=e&&(a=s-l-1),o=o.replace("%value%",t[a].toString()),n+=o,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",s.toString()),i}const yv=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function _v(s,t){const e=Math.ceil(s/2);let i=yv,n="",r;t?r="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":r="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let a=0;a<s;a++){let l=r.replace("%index%",a.toString());l=l.replace("%sampleIndex%",`${a-(e-1)}.0`),n+=l,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",s.toString()),i}class ea extends se{constructor(t,e=8,i=4,n=se.defaultResolution,r=5){const a=_v(r,t),l=xv(r);super(a,l),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=i,this.blur=e}apply(t,e,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,i,n);else{const r=t.getFilterTexture(),a=t.renderer;let l=e,o=r;this.state.blend=!1,t.applyFilter(this,l,o,Ss.CLEAR);for(let h=1;h<this.passes-1;h++){t.bindAndClear(l,Ss.BLIT),this.uniforms.uSampler=o;const c=o;o=l,l=c,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,o,i,n),t.returnFilterTexture(r)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class tp extends se{constructor(t=8,e=4,i=se.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new ea(!0,t,e,i,n),this.blurYFilter=new ea(!1,t,e,i,n),this.resolution=i,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,i,n){const r=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(r&&a){const l=t.getFilterTexture();this.blurXFilter.apply(t,e,l,Ss.CLEAR),this.blurYFilter.apply(t,l,i,n),t.returnFilterTexture(l)}else a?this.blurYFilter.apply(t,e,i,n):this.blurXFilter.apply(t,e,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var vv=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class sa extends se{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(pc,vv,t),this.alpha=1}_loadMatrix(t,e=!1){let i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}tint(t,e){const[i,n,r]=bt.shared.setValue(t).toArray(),a=[i,0,0,0,0,0,n,0,0,0,0,0,r,0,0,0,0,0,1,0];this._loadMatrix(a,e)}greyscale(t,e){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const i=Math.cos(t),n=Math.sin(t),r=Math.sqrt,a=1/3,l=r(a),o=i+(1-i)*a,h=a*(1-i)-l*n,c=a*(1-i)+l*n,u=a*(1-i)+l*n,d=i+a*(1-i),f=a*(1-i)-l*n,m=a*(1-i)-l*n,p=a*(1-i)+l*n,g=i+a*(1-i),v=[o,h,c,0,0,u,d,f,0,0,m,p,g,0,0,0,0,0,1,0];this._loadMatrix(v,e)}contrast(t,e){const i=(t||0)+1,n=-.5*(i-1),r=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(r,e)}saturate(t=0,e){const i=t*2/3+1,n=(i-1)*-.5,r=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(r,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,i,n,r){t=t||.2,e=e||.15,i=i||16770432,n=n||3375104;const a=bt.shared,[l,o,h]=a.setValue(i).toArray(),[c,u,d]=a.setValue(n).toArray(),f=[.3,.59,.11,0,0,l,o,h,t,0,c,u,d,e,0,l-c,o-u,h-d,0,0];this._loadMatrix(f,r)}night(t,e){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,e)}predator(t,e){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}sa.prototype.grayscale=sa.prototype.greyscale;var bv=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,wv=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class ep extends se{constructor(t,e){const i=new Rt;t.renderable=!1,super(wv,bv,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,e==null&&(e=20),this.scale=new at(e,e)}apply(t,e,i,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const r=this.maskSprite.worldTransform,a=Math.sqrt(r.a*r.a+r.b*r.b),l=Math.sqrt(r.c*r.c+r.d*r.d);a!==0&&l!==0&&(this.uniforms.rotation[0]=r.a/a,this.uniforms.rotation[1]=r.b/a,this.uniforms.rotation[2]=r.c/l,this.uniforms.rotation[3]=r.d/l),t.applyFilter(this,e,i,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var Ev=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,Sv=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class sp extends se{constructor(){super(Sv,Ev)}}var Tv=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class ip extends se{constructor(t=.5,e=Math.random()){super(pc,Tv,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const lh={AlphaFilter:Jm,BlurFilter:tp,BlurFilterPass:ea,ColorMatrixFilter:sa,DisplacementFilter:ep,FXAAFilter:sp,NoiseFilter:ip};Object.entries(lh).forEach(([s,t])=>{Object.defineProperty(lh,s,{get(){return rt("7.1.0",`filters.${s} has moved to ${s}`),t}})});class Av{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(Pt.system.add(this.tickerUpdate,this,mi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Pt.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Si=new Av;class jn{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=jn.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new at,this.page=new at,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,n,r){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Br extends jn{constructor(){super(...arguments),this.client=new at,this.movement=new at,this.offset=new at,this.global=new at,this.screen=new at}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,n,r,a,l,o,h,c,u,d,f,m,p){throw new Error("Method not implemented.")}}class es extends Br{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class on extends Br{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}on.DOM_DELTA_PIXEL=0;on.DOM_DELTA_LINE=1;on.DOM_DELTA_PAGE=2;const Cv=2048,Mv=new at,bl=new at;class np{constructor(t){this.dispatch=new Fs,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,n)=>i.priority-n.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let i=0,n=e.length;i<n;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Si.pauseUpdate=!0;const n=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",r=this[n](this.rootTarget,this.rootTarget.eventMode,Mv.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,r=i.length-1;n<r;n++)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const n=Array.isArray(e)?e:[e];for(let r=i.length-1;r>=0;r--)n.forEach(a=>{t.currentTarget=i[r],this.notifyTarget(t,a)})}propagationPath(t){const e=[t];for(let i=0;i<Cv&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,i,n,r,a=!1){let l=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Si.pauseUpdate=!1),t.interactiveChildren&&t.children){const c=t.children;for(let u=c.length-1;u>=0;u--){const d=c[u],f=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,i,n,r,a||r(t,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const m=t.isInteractive();(f.length>0||m)&&(m&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),l=!0}}}const o=this._isInteractive(e),h=t.isInteractive();return h&&h&&this._allInteractiveElements.push(t),a||this._hitElements.length>0?null:l?this._hitElements:o&&!r(t,i)&&n(t,i)?h?[t]:[]:null}hitTestRecursive(t,e,i,n,r){if(this._interactivePrune(t)||r(t,i))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Si.pauseUpdate=!1),t.interactiveChildren&&t.children){const o=t.children;for(let h=o.length-1;h>=0;h--){const c=o[h],u=this.hitTestRecursive(c,this._isInteractive(e)?e:c.eventMode,i,n,r);if(u){if(u.length>0&&!u[u.length-1].parent)continue;const d=t.isInteractive();return(u.length>0||d)&&u.push(t),u}}}const a=this._isInteractive(e),l=t.isInteractive();return a&&n(t,i)?l?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var i;if(t.hitArea&&(t.worldTransform.applyInverse(e,bl),!t.hitArea.contains(bl.x,bl.y)))return!0;if(t._mask){const n=t._mask.isMaskData?t._mask.maskObject:t._mask;if(n&&!((i=n.containsPoint)!=null&&i.call(n,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var r,a;e=e??t.type;const i=`on${e}`;(a=(r=t.currentTarget)[i])==null||a.call(r,t);const n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const n=e.button===2;this.dispatchEvent(e,n?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var o,h;if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const i=e.pointerType==="mouse"||e.pointerType==="pen",n=this.trackingData(t.pointerId),r=this.findMountedTarget(n.overTargets);if(((o=n.overTargets)==null?void 0:o.length)>0&&r!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(t,c,r);if(this.dispatchEvent(u,"pointerout"),i&&this.dispatchEvent(u,"mouseout"),!e.composedPath().includes(r)){const d=this.createPointerEvent(t,"pointerleave",r);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(u)}if(r!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(e,c);this.dispatchEvent(u,"pointerover"),i&&this.dispatchEvent(u,"mouseover");let d=r==null?void 0:r.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const m=this.clonePointerEvent(e,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==r&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),i&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(u)}const a=[],l=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(e,"pointermove"),l&&a.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),l&&a.push("globaltouchmove")),i&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),l&&a.push("globalmousemove"),this.cursor=(h=e.target)==null?void 0:h.cursor),a.length>0&&this.all(e,a),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var a;if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(a=i.target)==null?void 0:a.cursor);const r=this.clonePointerEvent(i,"pointerenter");for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),n&&this.notifyTarget(r,"mouseenter"),r.target=r.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(r)}mapPointerOut(t){if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(e.overTargets),r=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(r),i&&this.dispatchEvent(r,"mouseout");const a=this.createPointerEvent(t,"pointerleave",n);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),i&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;e.overTargets=null,this.freeEvent(r),this.freeEvent(a)}this.cursor=null}mapPointerUp(t){if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.dispatchEvent(i,l?"rightup":"mouseup")}const n=this.trackingData(t.pointerId),r=this.findMountedTarget(n.pressTargetsByButton[t.button]);let a=r;if(r&&!i.composedPath().includes(r)){let l=r;for(;l&&!i.composedPath().includes(l);){if(i.currentTarget=l,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const o=i.button===2;this.notifyTarget(i,o?"rightupoutside":"mouseupoutside")}l=l.parent}delete n.pressTargetsByButton[t.button],a=l}if(a){const l=this.clonePointerEvent(i,"click");l.target=a,l.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:e});const o=n.clicksByButton[t.button];if(o.target===l.target&&e-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=l.target,o.timeStamp=e,l.detail=o.clickCount,l.pointerType==="mouse"){const h=l.button===2;this.dispatchEvent(l,h?"rightclick":"click")}else l.pointerType==="touch"&&this.dispatchEvent(l,"tap");this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let r=i;for(;r;)n.currentTarget=r,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),r=r.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof on)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){const n=this.allocateEvent(es);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof e=="string"&&(n.type=e),n}createWheelEvent(t){const e=this.allocateEvent(on);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const i=this.allocateEvent(es);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof es&&e instanceof es&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Br&&e instanceof Br&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(e,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let n=0,r=i.length;n<r&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeListener(e,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,t)}}const Iv=1,Rv={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},hh=class{constructor(s){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=s,this.rootBoundary=new np(null),Si.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new es(null),this.rootWheelEvent=new on(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...hh.defaultEventFeatures},{set:(t,e,i)=>(e==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=i),t[e]=i,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(s){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e,hh._defaultEventMode=s.eventMode??"auto",Object.assign(this.features,s.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(s){this.resolution=s}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(s){s=s||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===s)return;this.currentCursor=s;const e=this.cursorStyles[s];if(e)switch(typeof e){case"string":t&&(this.domElement.style.cursor=e);break;case"function":e(s);break;case"object":t&&Object.assign(this.domElement.style,e);break}else t&&typeof s=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,s)&&(this.domElement.style.cursor=s)}get pointer(){return this.rootPointerEvent}onPointerDown(s){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;const t=this.normalizeToPointerData(s);this.autoPreventDefault&&t[0].isNormalized&&(s.cancelable||!("cancelable"in s))&&s.preventDefault();for(let e=0,i=t.length;e<i;e++){const n=t[e],r=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(s){if(!this.features.move||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;Si.pointerMoved();const t=this.normalizeToPointerData(s);for(let e=0,i=t.length;e<i;e++){const n=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(s){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;let t=s.target;s.composedPath&&s.composedPath().length>0&&(t=s.composedPath()[0]);const e=t!==this.domElement?"outside":"",i=this.normalizeToPointerData(s);for(let n=0,r=i.length;n<r;n++){const a=this.bootstrapEvent(this.rootPointerEvent,i[n]);a.type+=e,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(s){if(!this.features.click||(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&s.pointerType==="touch"))return;const t=this.normalizeToPointerData(s);for(let e=0,i=t.length;e<i;e++){const n=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(s){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(s);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(s){this.removeEvents(),this.domElement=s,Si.domElement=s,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Si.addTickerListener();const s=this.domElement.style;s&&(globalThis.navigator.msPointerEnabled?(s.msContentZooming="none",s.msTouchAction="none"):this.supportsPointerEvents&&(s.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Si.removeTickerListener();const s=this.domElement.style;globalThis.navigator.msPointerEnabled?(s.msContentZooming="",s.msTouchAction=""):this.supportsPointerEvents&&(s.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(s,t,e){let i;this.domElement.parentElement?i=this.domElement.getBoundingClientRect():i={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const n=1/this.resolution;s.x=(t-i.left)*(this.domElement.width/i.width)*n,s.y=(e-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(s){const t=[];if(this.supportsTouchEvents&&s instanceof TouchEvent)for(let e=0,i=s.changedTouches.length;e<i;e++){const n=s.changedTouches[e];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=s.touches.length===1&&s.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=s.type,t.push(n)}else if(!globalThis.MouseEvent||s instanceof MouseEvent&&(!this.supportsPointerEvents||!(s instanceof globalThis.PointerEvent))){const e=s;typeof e.isPrimary>"u"&&(e.isPrimary=!0),typeof e.width>"u"&&(e.width=1),typeof e.height>"u"&&(e.height=1),typeof e.tiltX>"u"&&(e.tiltX=0),typeof e.tiltY>"u"&&(e.tiltY=0),typeof e.pointerType>"u"&&(e.pointerType="mouse"),typeof e.pointerId>"u"&&(e.pointerId=Iv),typeof e.pressure>"u"&&(e.pressure=.5),typeof e.twist>"u"&&(e.twist=0),typeof e.tangentialPressure>"u"&&(e.tangentialPressure=0),e.isNormalized=!0,t.push(e)}else t.push(s);return t}normalizeWheelEvent(s){const t=this.rootWheelEvent;return this.transferMouseData(t,s),t.deltaX=s.deltaX,t.deltaY=s.deltaY,t.deltaZ=s.deltaZ,t.deltaMode=s.deltaMode,this.mapPositionToPoint(t.screen,s.clientX,s.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=s,t.type=s.type,t}bootstrapEvent(s,t){return s.originalEvent=null,s.nativeEvent=t,s.pointerId=t.pointerId,s.width=t.width,s.height=t.height,s.isPrimary=t.isPrimary,s.pointerType=t.pointerType,s.pressure=t.pressure,s.tangentialPressure=t.tangentialPressure,s.tiltX=t.tiltX,s.tiltY=t.tiltY,s.twist=t.twist,this.transferMouseData(s,t),this.mapPositionToPoint(s.screen,t.clientX,t.clientY),s.global.copyFrom(s.screen),s.offset.copyFrom(s.screen),s.isTrusted=t.isTrusted,s.type==="pointerleave"&&(s.type="pointerout"),s.type.startsWith("mouse")&&(s.type=s.type.replace("mouse","pointer")),s.type.startsWith("touch")&&(s.type=Rv[s.type]||s.type),s}transferMouseData(s,t){s.isTrusted=t.isTrusted,s.srcElement=t.srcElement,s.timeStamp=performance.now(),s.type=t.type,s.altKey=t.altKey,s.button=t.button,s.buttons=t.buttons,s.client.x=t.clientX,s.client.y=t.clientY,s.ctrlKey=t.ctrlKey,s.metaKey=t.metaKey,s.movement.x=t.movementX,s.movement.y=t.movementY,s.page.x=t.pageX,s.page.y=t.pageY,s.relatedTarget=null,s.shiftKey=t.shiftKey}};let $n=hh;$n.extension={name:"events",type:[j.RendererSystem,j.CanvasRendererSystem]};$n.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};J.add($n);function lf(s){return s==="dynamic"||s==="static"}const rp={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??lf($n.defaultEventMode)},set interactive(s){rt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=s,this.eventMode=s?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??$n.defaultEventMode},set eventMode(s){this._internalInteractive=lf(s),this._internalEventMode=s},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(s,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,n=typeof t=="function"?void 0:t;s=i?`${s}capture`:s,t=typeof t=="function"?t:t.handleEvent,this.on(s,t,n)},removeEventListener(s,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,n=typeof t=="function"?void 0:t;s=i?`${s}capture`:s,t=typeof t=="function"?t:t.handleEvent,this.off(s,t,n)},dispatchEvent(s){if(!(s instanceof jn))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return s.defaultPrevented=!1,s.path=null,s.target=this,s.manager.dispatchEvent(s),!s.defaultPrevented}};Bt.mixin(rp);const op={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Bt.mixin(op);const Pv=9,To=100,kv=0,Fv=0,hf=2,cf=1,Bv=-1e3,Dv=-1e3,Nv=2;class bc{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Ts.tablet||Ts.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${To}px`,e.style.height=`${To}px`,e.style.position="absolute",e.style.top=`${kv}px`,e.style.left=`${Fv}px`,e.style.zIndex=hf.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${cf}px`,t.style.height=`${cf}px`,t.style.position="absolute",t.style.top=`${Bv}px`,t.style.left=`${Dv}px`,t.style.zIndex=Nv.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}update(){const t=performance.now();if(Ts.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:i,width:n,height:r}=this.renderer.view.getBoundingClientRect(),{width:a,height:l,resolution:o}=this.renderer,h=n/a*o,c=r/l*o;let u=this.div;u.style.left=`${e}px`,u.style.top=`${i}px`,u.style.width=`${a}px`,u.style.height=`${l}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,en(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{u=f._accessibleDiv;let m=f.hitArea;const p=f.worldTransform;f.hitArea?(u.style.left=`${(p.tx+m.x*p.a)*h}px`,u.style.top=`${(p.ty+m.y*p.d)*c}px`,u.style.width=`${m.width*p.a*h}px`,u.style.height=`${m.height*p.d*c}px`):(m=f.getBounds(),this.capHitArea(m),u.style.left=`${m.x*h}px`,u.style.top=`${m.y*c}px`,u.style.width=`${m.width*h}px`,u.style.height=`${m.height*c}px`,u.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(u.title=f.accessibleTitle),u.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&u.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==u.title||f.tabIndex!==u.tabIndex)&&(u.title=f.accessibleTitle,u.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:i}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${To}px`,e.style.height=`${To}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=hf.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:i}=t.target,n=this.renderer.events.rootBoundary,r=Object.assign(new jn(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,e.forEach(a=>n.dispatchEvent(r,a))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===Pv&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}bc.extension={name:"accessibility",type:[j.RendererPlugin,j.CanvasRendererPlugin]};J.add(bc);const ch=class{constructor(s){this.stage=new fe,s=Object.assign({forceCanvas:!1},s),this.renderer=zm(s),ch._plugins.forEach(t=>{t.init.call(this,s)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(s,t){const e=ch._plugins.slice(0);e.reverse(),e.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(s),this.renderer=null}};let wc=ch;wc._plugins=[];J.handleByList(j.Application,wc._plugins);class Ec{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:r}=this._resizeTo;e=n,i=r}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Ec.extension=j.Application;J.add(Ec);const uf={loader:j.LoadParser,resolver:j.ResolveParser,cache:j.CacheParser,detection:j.DetectionParser};J.handle(j.Asset,s=>{const t=s.ref;Object.entries(uf).filter(([e])=>!!t[e]).forEach(([e,i])=>J.add(Object.assign(t[e],{extension:t[e].extension??i})))},s=>{const t=s.ref;Object.keys(uf).filter(e=>!!t[e]).forEach(e=>J.remove(t[e]))});class Lv{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function qn(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Ve(s,t){const e=s.split("?")[0],i=It.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const Hs=(s,t)=>(Array.isArray(s)||(s=[s]),t?s.map(e=>typeof e=="string"?t(e):e):s),ia=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s};function ap(s,t,e,i,n){const r=t[e];for(let a=0;a<r.length;a++){const l=r[a];e<t.length-1?ap(s.replace(i[e],l),t,e+1,i,n):n.push(s.replace(i[e],l))}}function lp(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const n=[];e.forEach(r=>{const a=r.substring(1,r.length-1).split(",");n.push(a)}),ap(s,n,0,e,i)}else i.push(s);return i}const Dr=s=>!Array.isArray(s);class Ov{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=Hs(t);let n;for(let l=0;l<this.parsers.length;l++){const o=this.parsers[l];if(o.test(e)){n=o.getCacheableAssets(i,e);break}}n||(n={},i.forEach(l=>{n[l]=e}));const r=Object.keys(n),a={cacheKeys:r,keys:i};if(i.forEach(l=>{this._cacheMap.set(l,a)}),r.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==e&&console.warn("[Cache] already has key:",l),this._cache.set(l,n[l])}),e instanceof K){const l=e;i.forEach(o=>{l.baseTexture!==K.EMPTY.baseTexture&&nt.addToCache(l.baseTexture,o),K.addToCache(l,o)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(n=>{this._cache.delete(n)}),e.keys.forEach(n=>{this._cacheMap.delete(n)})}get parsers(){return this._parsers}}const bn=new Ov;class Vv{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var a,l;let n=null,r=null;if(e.loadParser&&(r=this._parserHash[e.loadParser],r||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!r){for(let o=0;o<this.parsers.length;o++){const h=this.parsers[o];if(h.load&&((a=h.test)!=null&&a.call(h,t,e,this))){r=h;break}}if(!r)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await r.load(t,e,this),i.parser=r;for(let o=0;o<this.parsers.length;o++){const h=this.parsers[o];h.parse&&h.parse&&await((l=h.testParse)==null?void 0:l.call(h,n,e,this))&&(n=await h.parse(n,e,this)||n,i.parser=h)}return n})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const n={},r=Dr(t),a=Hs(t,h=>({src:h})),l=a.length,o=a.map(async h=>{const c=It.toAbsolute(h.src);if(!n[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),n[h.src]=await this.promiseCache[c].promise,e&&e(++i/l)}catch(u){throw delete this.promiseCache[c],delete n[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(o),r?n[a[0].src]:n}async unload(t){const i=Hs(t,n=>({src:n})).map(async n=>{var l,o;const r=It.toAbsolute(n.src),a=this.promiseCache[r];if(a){const h=await a.promise;(o=(l=a.parser)==null?void 0:l.unload)==null||o.call(l,h,n,this),delete this.promiseCache[r]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var Ue=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(Ue||{});const Uv=".json",Xv="application/json",hp={extension:{type:j.LoadParser,priority:Ue.Low},name:"loadJson",test(s){return qn(s,Xv)||Ve(s,Uv)},async load(s){return await(await q.ADAPTER.fetch(s)).json()}};J.add(hp);const Yv=".txt",$v="text/plain",cp={name:"loadTxt",extension:{type:j.LoadParser,priority:Ue.Low},test(s){return qn(s,$v)||Ve(s,Yv)},async load(s){return await(await q.ADAPTER.fetch(s)).text()}};J.add(cp);const Gv=["normal","bold","100","200","300","400","500","600","700","800","900"],Wv=[".ttf",".otf",".woff",".woff2"],Hv=["font/ttf","font/otf","font/woff","font/woff2"],zv=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function up(s){const t=It.extname(s),n=It.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1));let r=n.length>0;for(const l of n)if(!l.match(zv)){r=!1;break}let a=n.join(" ");return r||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const dp={extension:{type:j.LoadParser,priority:Ue.Low},name:"loadWebFont",test(s){return qn(s,Hv)||Ve(s,Wv)},async load(s,t){var i,n,r;const e=q.ADAPTER.getFontFaceSet();if(e){const a=[],l=((i=t.data)==null?void 0:i.family)??up(s),o=((r=(n=t.data)==null?void 0:n.weights)==null?void 0:r.filter(c=>Gv.includes(c)))??["normal"],h=t.data??{};for(let c=0;c<o.length;c++){const u=o[c],d=new FontFace(l,`url(${encodeURI(s)})`,{...h,weight:u});await d.load(),e.add(d),a.push(d)}return a.length===1?a[0]:a}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>q.ADAPTER.getFontFaceSet().delete(t))}};J.add(dp);let df=0,wl;const jv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",qv={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${jv}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Zv={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let El;class Kv{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([qv.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(e),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){wl===void 0&&(wl=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<wl&&(El||(El=URL.createObjectURL(new Blob([Zv.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(El),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((n,r)=>{this.queue.push({id:t,arguments:e,resolve:n,reject:r})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[df]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:df++,id:i})}}const ff=new Kv;function to(s,t,e){const i=new K(s);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),i}const Qv=[".jpeg",".jpg",".png",".webp",".avif"],Jv=["image/jpeg","image/png","image/webp","image/avif"];async function fp(s){const t=await q.ADAPTER.fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const eo={name:"loadTextures",extension:{type:j.LoadParser,priority:Ue.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return qn(s,Jv)||Ve(s,Qv)},async load(s,t,e){let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await ff.isImageBitmapSupported()?i=await ff.loadImageBitmap(s):i=await fp(s):i=await new Promise(r=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=s,i.complete?r(i):i.onload=()=>{r(i)}});const n=new nt(i,{resolution:ui(s),...t.data});return n.resource.src=s,to(n,e,s)},unload(s){s.destroy(!0)}};J.add(eo);const tb=".svg",eb="image/svg+xml",mp={extension:{type:j.LoadParser,priority:Ue.High},name:"loadSVG",test(s){return qn(s,eb)||Ve(s,tb)},async testParse(s){return Yn.test(s)},async parse(s,t,e){var a;const i=new Yn(s,(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions);await i.load();const n=new nt(i,{resolution:ui(s),...t==null?void 0:t.data});return n.resource.src=s,to(n,e,s)},async load(s,t){return(await q.ADAPTER.fetch(s)).text()},unload:eo.unload};J.add(mp);class sb{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(n=>{if(typeof n.name=="string"){const r=this._createBundleAssetId(t,n.name);i.push(r),this.add([n.name,r],n.srcs,n.data)}else{const r=n.name.map(a=>this._createBundleAssetId(t,a));r.forEach(a=>{i.push(a)}),this.add([...n.name,...r],n.srcs)}}):Object.keys(e).forEach(n=>{i.push(this._createBundleAssetId(t,n)),this.add([n,this._createBundleAssetId(t,n)],e[n])}),this._bundles[t]=i}add(t,e,i){const n=Hs(t);n.forEach(a=>{this.hasKey(a)&&console.warn(`[Resolver] already has key: ${a} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=lp(e):e=[e]);const r=e.map(a=>{let l=a;if(typeof a=="string"){let o=!1;for(let h=0;h<this._parsers.length;h++){const c=this._parsers[h];if(c.test(a)){l=c.parse(a),o=!0;break}}o||(l={src:a})}return l.format||(l.format=l.src.split(".").pop()),l.alias||(l.alias=n),(this._basePath||this._rootPath)&&(l.src=It.toAbsolute(l.src,this._basePath,this._rootPath)),l.src=this._appendDefaultSearchParams(l.src),l.data=l.data??i,l});n.forEach(a=>{this._assetMap[a]=r})}resolveBundle(t){const e=Dr(t);t=Hs(t);const i={};return t.forEach(n=>{const r=this._bundles[n];if(r){const a=this.resolve(r),l={};for(const o in a){const h=a[o];l[this._extractAssetIdFromBundle(n,o)]=h}i[n]=l}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const n in e)i[n]=e[n].src;return i}return e.src}resolve(t){const e=Dr(t);t=Hs(t);const i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let r=this._assetMap[n];const a=this._getPreferredOrder(r),l=r[0];a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const c=r.filter(u=>u[o]?u[o]===h:!1);c.length&&(r=c)})}),this._resolverHash[n]=r[0]??l}else{let r=n;(this._basePath||this._rootPath)&&(r=It.toAbsolute(r,this._basePath,this._rootPath)),r=this._appendDefaultSearchParams(r),this._resolverHash[n]={src:r}}i[n]=this._resolverHash[n]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],n=this._preferredOrder.find(r=>r.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class pp{constructor(){this._detections=[],this._initialized=!1,this.resolver=new sb,this.loader=new Vv,this.cache=bn,this._backgroundLoader=new Lv(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,a,l;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((r=t.texturePreference)==null?void 0:r.resolution)??1,i=typeof e=="number"?[e]:e;let n=[];if((a=t.texturePreference)!=null&&a.format){const o=(l=t.texturePreference)==null?void 0:l.format;n=typeof o=="string"?[o]:o;for(const h of this._detections)await h.test()||(n=await h.remove(n))}else for(const o of this._detections)await o.test()&&(n=await o.add(n));this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,i){this.resolver.add(t,e,i)}async load(t,e){this._initialized||await this.init();const i=Dr(t),n=Hs(t).map(l=>typeof l!="string"?(this.resolver.add(l.src,l),l.src):(this.resolver.hasKey(l)||this.resolver.add(l,l),l)),r=this.resolver.resolve(n),a=await this._mapLoadToResolve(r,e);return i?a[n[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const n=this.resolver.resolveBundle(t),r={},a=Object.keys(n);let l=0,o=0;const h=()=>{e==null||e(++l/o)},c=a.map(u=>{const d=n[u];return o+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(f=>{r[u]=f})});return await Promise.all(c),i?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return bn.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=bn.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;const r=await this.loader.load(i,e);this._backgroundLoader.active=!0;const a={};return i.forEach((l,o)=>{const h=r[l.src],c=[l.src];l.alias&&c.push(...l.alias),a[n[o]]=h,bn.set(c,h)}),a}async unload(t){this._initialized||await this.init();const e=Hs(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Hs(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(n=>this._unloadFromResolved(e[n]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{bn.remove(i.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return eo.config.preferWorkers}set preferWorkers(t){rt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const ur=new pp;J.handleByList(j.LoadParser,ur.loader.parsers).handleByList(j.ResolveParser,ur.resolver.parsers).handleByList(j.CacheParser,ur.cache.parsers).handleByList(j.DetectionParser,ur.detections);const gp={extension:j.CacheParser,test:s=>Array.isArray(s)&&s.every(t=>t instanceof K),getCacheableAssets:(s,t)=>{const e={};return s.forEach(i=>{t.forEach((n,r)=>{e[i+(r===0?"":r+1)]=n})}),e}};J.add(gp);const xp={extension:{type:j.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const s="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await q.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")};J.add(xp);const yp={extension:{type:j.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const s="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await q.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};J.add(yp);const mf=["png","jpg","jpeg"],_p={extension:{type:j.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...mf],remove:async s=>s.filter(t=>!mf.includes(t))};J.add(_p);const vp={extension:j.ResolveParser,test:eo.test,parse:s=>{var t;return{resolution:parseFloat(((t=q.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}};J.add(vp);var Ne=(s=>(s[s.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",s[s.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",s[s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",s[s.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",s[s.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",s[s.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",s[s.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",s[s.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",s[s.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",s[s.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",s[s.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",s[s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",s[s.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",s[s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",s[s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",s[s.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",s[s.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",s[s.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",s[s.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",s))(Ne||{});const Nr={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let ei,wn;function pf(){wn={s3tc:ei.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ei.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ei.getExtension("WEBGL_compressed_texture_etc"),etc1:ei.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ei.getExtension("WEBGL_compressed_texture_pvrtc")||ei.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ei.getExtension("WEBGL_compressed_texture_atc"),astc:ei.getExtension("WEBGL_compressed_texture_astc")}}const bp={extension:{type:j.DetectionParser,priority:2},test:async()=>{const t=q.ADAPTER.createCanvas().getContext("webgl");return t?(ei=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async s=>{wn||pf();const t=[];for(const e in wn)wn[e]&&t.push(e);return[...t,...s]},remove:async s=>(wn||pf(),s.filter(t=>!(t in wn)))};J.add(bp);class wp extends Hn{constructor(t,e={width:1,height:1,autoLoad:!0}){let i,n;typeof t=="string"?(i=t,n=new Uint8Array):(i=null,n=t),super(n,e),this.origin=i,this.buffer=n?new Zo(n):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new Zo(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Mi extends wp{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Mi._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Mi._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,i){const n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let a=0,l=this.levels;a<l;a++){const{levelID:o,levelWidth:h,levelHeight:c,levelBuffer:u}=this._levelBuffers[a];n.compressedTexImage2D(n.TEXTURE_2D,o,this.format,h,c,0,u)}return!0}onBlobLoaded(){this._levelBuffers=Mi._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,i,n,r,a,l){const o=new Array(i);let h=t.byteOffset,c=a,u=l,d=c+n-1&~(n-1),f=u+r-1&~(r-1),m=d*f*Nr[e];for(let p=0;p<i;p++)o[p]={levelID:p,levelWidth:i>1?c:d,levelHeight:i>1?u:f,levelBuffer:new Uint8Array(t.buffer,h,m)},h+=m,c=c>>1||1,u=u>>1||1,d=c+n-1&~(n-1),f=u+r-1&~(r-1),m=d*f*Nr[e];return o}}const Sl=4,Ao=124,ib=32,gf=20,nb=542327876,Co={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},rb={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Mo={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},ob=1,ab=2,lb=4,hb=64,cb=512,ub=131072,db=827611204,fb=861165636,mb=894720068,pb=808540228,gb=4,xb={[db]:Ne.COMPRESSED_RGBA_S3TC_DXT1_EXT,[fb]:Ne.COMPRESSED_RGBA_S3TC_DXT3_EXT,[mb]:Ne.COMPRESSED_RGBA_S3TC_DXT5_EXT},yb={70:Ne.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:Ne.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:Ne.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:Ne.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:Ne.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:Ne.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:Ne.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:Ne.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:Ne.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function Ep(s){const t=new Uint32Array(s);if(t[0]!==nb)throw new Error("Invalid DDS file magic word");const i=new Uint32Array(s,0,Ao/Uint32Array.BYTES_PER_ELEMENT),n=i[Co.HEIGHT],r=i[Co.WIDTH],a=i[Co.MIPMAP_COUNT],l=new Uint32Array(s,Co.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,ib/Uint32Array.BYTES_PER_ELEMENT),o=l[ob];if(o&lb){const h=l[rb.FOURCC];if(h!==pb){const x=xb[h],y=Sl+Ao,b=new Uint8Array(s,y);return[new Mi(b,{format:x,width:r,height:n,levels:a})]}const c=Sl+Ao,u=new Uint32Array(t.buffer,c,gf/Uint32Array.BYTES_PER_ELEMENT),d=u[Mo.DXGI_FORMAT],f=u[Mo.RESOURCE_DIMENSION],m=u[Mo.MISC_FLAG],p=u[Mo.ARRAY_SIZE],g=yb[d];if(g===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${d}`);if(m===gb)throw new Error("DDSParser does not support cubemap textures");if(f===6)throw new Error("DDSParser does not supported 3D texture data");const v=new Array,_=Sl+Ao+gf;if(p===1)v.push(new Uint8Array(s,_));else{const x=Nr[g];let y=0,b=r,w=n;for(let S=0;S<a;S++){const A=Math.max(1,b+3&-4),M=Math.max(1,w+3&-4),I=A*M*x;y+=I,b=b>>>1,w=w>>>1}let E=_;for(let S=0;S<p;S++)v.push(new Uint8Array(s,E,y)),E+=y}return v.map(x=>new Mi(x,{format:g,width:r,height:n,levels:a}))}throw o&hb?new Error("DDSParser does not support uncompressed texture data."):o&cb?new Error("DDSParser does not supported YUV uncompressed texture data."):o&ub?new Error("DDSParser does not support single-channel (lumninance) texture data!"):o&ab?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const xf=[171,75,84,88,32,49,49,187,13,10,26,10],_b=67305985,ds={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},uh=64,dh={[et.UNSIGNED_BYTE]:1,[et.UNSIGNED_SHORT]:2,[et.INT]:4,[et.UNSIGNED_INT]:4,[et.FLOAT]:4,[et.HALF_FLOAT]:8},Sp={[z.RGBA]:4,[z.RGB]:3,[z.RG]:2,[z.RED]:1,[z.LUMINANCE]:1,[z.LUMINANCE_ALPHA]:2,[z.ALPHA]:1},Tp={[et.UNSIGNED_SHORT_4_4_4_4]:2,[et.UNSIGNED_SHORT_5_5_5_1]:2,[et.UNSIGNED_SHORT_5_6_5]:2};function Ap(s,t,e=!1){const i=new DataView(t);if(!vb(s,i))return null;const n=i.getUint32(ds.ENDIANNESS,!0)===_b,r=i.getUint32(ds.GL_TYPE,n),a=i.getUint32(ds.GL_FORMAT,n),l=i.getUint32(ds.GL_INTERNAL_FORMAT,n),o=i.getUint32(ds.PIXEL_WIDTH,n),h=i.getUint32(ds.PIXEL_HEIGHT,n)||1,c=i.getUint32(ds.PIXEL_DEPTH,n)||1,u=i.getUint32(ds.NUMBER_OF_ARRAY_ELEMENTS,n)||1,d=i.getUint32(ds.NUMBER_OF_FACES,n),f=i.getUint32(ds.NUMBER_OF_MIPMAP_LEVELS,n),m=i.getUint32(ds.BYTES_OF_KEY_VALUE_DATA,n);if(h===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");const p=4,g=4,v=o+3&-4,_=h+3&-4,x=new Array(u);let y=o*h;r===0&&(y=v*_);let b;if(r!==0?dh[r]?b=dh[r]*Sp[a]:b=Tp[r]:b=Nr[l],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const w=e?wb(i,m,n):null;let S=y*b,A=o,M=h,I=v,k=_,R=uh+m;for(let P=0;P<f;P++){const B=i.getUint32(R,n);let L=R+4;for(let O=0;O<u;O++){let G=x[O];G||(G=x[O]=new Array(f)),G[P]={levelID:P,levelWidth:f>1||r!==0?A:I,levelHeight:f>1||r!==0?M:k,levelBuffer:new Uint8Array(t,L,S)},L+=S}R+=B+4,R=R%4!==0?R+4-R%4:R,A=A>>1||1,M=M>>1||1,I=A+p-1&~(p-1),k=M+g-1&~(g-1),S=I*k*b}return r!==0?{uncompressed:x.map(P=>{let B=P[0].levelBuffer,L=!1;return r===et.FLOAT?B=new Float32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4):r===et.UNSIGNED_INT?(L=!0,B=new Uint32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)):r===et.INT&&(L=!0,B=new Int32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)),{resource:new Hn(B,{width:P[0].levelWidth,height:P[0].levelHeight}),type:r,format:L?bb(a):a}}),kvData:w}:{compressed:x.map(P=>new Mi(null,{format:l,width:o,height:h,levels:f,levelBuffers:P})),kvData:w}}function vb(s,t){for(let e=0;e<xf.length;e++)if(t.getUint8(e)!==xf[e])return console.error(`${s} is not a valid *.ktx file!`),!1;return!0}function bb(s){switch(s){case z.RGBA:return z.RGBA_INTEGER;case z.RGB:return z.RGB_INTEGER;case z.RG:return z.RG_INTEGER;case z.RED:return z.RED_INTEGER;default:return s}}function wb(s,t,e){const i=new Map;let n=0;for(;n<t;){const r=s.getUint32(uh+n,e),a=uh+n+4,l=3-(r+3)%4;if(r===0||r>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let o=0;for(;o<r&&s.getUint8(a+o)!==0;o++);if(o===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(s.buffer,a,o)),c=new DataView(s.buffer,a+o+1,r-o-1);i.set(h,c),n+=4+r+l}return i}const Cp={extension:{type:j.LoadParser,priority:Ue.High},name:"loadDDS",test(s){return Ve(s,".dds")},async load(s,t,e){const n=await(await q.ADAPTER.fetch(s)).arrayBuffer(),a=Ep(n).map(l=>{const o=new nt(l,{mipmap:cs.OFF,alphaMode:Je.NO_PREMULTIPLIED_ALPHA,resolution:ui(s),...t.data});return to(o,e,s)});return a.length===1?a[0]:a},unload(s){Array.isArray(s)?s.forEach(t=>t.destroy(!0)):s.destroy(!0)}};J.add(Cp);const Mp={extension:{type:j.LoadParser,priority:Ue.High},name:"loadKTX",test(s){return Ve(s,".ktx")},async load(s,t,e){const n=await(await q.ADAPTER.fetch(s)).arrayBuffer(),{compressed:r,uncompressed:a,kvData:l}=Ap(s,n),o=r??a,h={mipmap:cs.OFF,alphaMode:Je.NO_PREMULTIPLIED_ALPHA,resolution:ui(s),...t.data},c=o.map(u=>{o===a&&Object.assign(h,{type:u.type,format:u.format});const d=new nt(u,h);return d.ktxKeyValueData=l,to(d,e,s)});return c.length===1?c[0]:c},unload(s){Array.isArray(s)?s.forEach(t=>t.destroy(!0)):s.destroy(!0)}};J.add(Mp);const Ip={extension:j.ResolveParser,test:s=>{const e=s.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:s=>{var i,n;if(s.split("?")[0].split(".").pop()==="ktx"){const r=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(r.some(a=>s.endsWith(a)))return{resolution:parseFloat(((i=q.RETINA_PREFIX.exec(s))==null?void 0:i[1])??"1"),format:r.find(a=>s.endsWith(a)),src:s}}return{resolution:parseFloat(((n=q.RETINA_PREFIX.exec(s))==null?void 0:n[1])??"1"),format:s.split(".").pop(),src:s}}};J.add(Ip);const Eb=new ft,Sb=4,dr=class{constructor(s){this.renderer=s}async image(s,t,e){const i=new Image;return i.src=await this.base64(s,t,e),i}async base64(s,t,e){const i=this.canvas(s);if(i.toBlob!==void 0)return new Promise((n,r)=>{i.toBlob(a=>{if(!a){r(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>n(l.result),l.onerror=r,l.readAsDataURL(a)},t,e)});if(i.toDataURL!==void 0)return i.toDataURL(t,e);if(i.convertToBlob!==void 0){const n=await i.convertToBlob({type:t,quality:e});return new Promise((r,a)=>{const l=new FileReader;l.onload=()=>r(l.result),l.onerror=a,l.readAsDataURL(n)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(s,t){const{pixels:e,width:i,height:n,flipY:r}=this._rawPixels(s,t);r&&dr._flipY(e,i,n),dr._unpremultiplyAlpha(e);const a=new xm(i,n,1),l=new ImageData(new Uint8ClampedArray(e.buffer),i,n);return a.context.putImageData(l,0,0),a.canvas}pixels(s,t){const{pixels:e,width:i,height:n,flipY:r}=this._rawPixels(s,t);return r&&dr._flipY(e,i,n),dr._unpremultiplyAlpha(e),e}_rawPixels(s,t){const e=this.renderer;if(!e)throw new Error("The Extract has already been destroyed");let i,n=!1,r,a=!1;if(s&&(s instanceof Di?r=s:(r=e.generateTexture(s,{resolution:e.resolution,multisample:e.multisample}),a=!0)),r){if(i=r.baseTexture.resolution,t=t??r.frame,n=!1,!a){e.renderTexture.bind(r);const u=r.framebuffer.glFramebuffers[e.CONTEXT_UID];u.blitFramebuffer&&e.framebuffer.bind(u.blitFramebuffer)}}else i=e.resolution,t||(t=Eb,t.width=e.width/i,t.height=e.height/i),n=!0,e.renderTexture.bind();const l=Math.round(t.width*i),o=Math.round(t.height*i),h=new Uint8Array(Sb*l*o),c=e.gl;return c.readPixels(Math.round(t.x*i),Math.round(t.y*i),l,o,c.RGBA,c.UNSIGNED_BYTE,h),a&&(r==null||r.destroy(!0)),{pixels:h,width:l,height:o,flipY:n}}destroy(){this.renderer=null}static _flipY(s,t,e){const i=t<<2,n=e>>1,r=new Uint8Array(i);for(let a=0;a<n;a++){const l=a*i,o=(e-a-1)*i;r.set(s.subarray(l,l+i)),s.copyWithin(l,o,o+i),s.set(r,o)}}static _unpremultiplyAlpha(s){s instanceof Uint8ClampedArray&&(s=new Uint8Array(s.buffer));const t=s.length;for(let e=0;e<t;e+=4){const i=s[e+3];if(i!==0){const n=255.001/i;s[e]=s[e]*n+.5,s[e+1]=s[e+1]*n+.5,s[e+2]=s[e+2]*n+.5}}}};let Sc=dr;Sc.extension={name:"extract",type:j.RendererSystem};J.add(Sc);const Lr={build(s){const t=s.points;let e,i,n,r,a,l;if(s.type===de.CIRC){const m=s.shape;e=m.x,i=m.y,a=l=m.radius,n=r=0}else if(s.type===de.ELIP){const m=s.shape;e=m.x,i=m.y,a=m.width,l=m.height,n=r=0}else{const m=s.shape,p=m.width/2,g=m.height/2;e=m.x+p,i=m.y+g,a=l=Math.max(0,Math.min(m.radius,Math.min(p,g))),n=p-a,r=g-l}if(!(a>=0&&l>=0&&n>=0&&r>=0)){t.length=0;return}const o=Math.ceil(2.3*Math.sqrt(a+l)),h=o*8+(n?4:0)+(r?4:0);if(t.length=h,h===0)return;if(o===0){t.length=8,t[0]=t[6]=e+n,t[1]=t[3]=i+r,t[2]=t[4]=e-n,t[5]=t[7]=i-r;return}let c=0,u=o*4+(n?2:0)+2,d=u,f=h;{const m=n+a,p=r,g=e+m,v=e-m,_=i+p;if(t[c++]=g,t[c++]=_,t[--u]=_,t[--u]=v,r){const x=i-p;t[d++]=v,t[d++]=x,t[--f]=x,t[--f]=g}}for(let m=1;m<o;m++){const p=Math.PI/2*(m/o),g=n+Math.cos(p)*a,v=r+Math.sin(p)*l,_=e+g,x=e-g,y=i+v,b=i-v;t[c++]=_,t[c++]=y,t[--u]=y,t[--u]=x,t[d++]=x,t[d++]=b,t[--f]=b,t[--f]=_}{const m=n,p=r+l,g=e+m,v=e-m,_=i+p,x=i-p;t[c++]=g,t[c++]=_,t[--f]=x,t[--f]=g,n&&(t[c++]=v,t[c++]=_,t[--f]=x,t[--f]=v)}},triangulate(s,t){const e=s.points,i=t.points,n=t.indices;if(e.length===0)return;let r=i.length/2;const a=r;let l,o;if(s.type!==de.RREC){const c=s.shape;l=c.x,o=c.y}else{const c=s.shape;l=c.x+c.width/2,o=c.y+c.height/2}const h=s.matrix;i.push(s.matrix?h.a*l+h.c*o+h.tx:l,s.matrix?h.b*l+h.d*o+h.ty:o),r++,i.push(e[0],e[1]);for(let c=2;c<e.length;c+=2)i.push(e[c],e[c+1]),n.push(r++,a,r);n.push(a+1,a,r)}};function yf(s,t=!1){const e=s.length;if(e<6)return;let i=0;for(let n=0,r=s[e-2],a=s[e-1];n<e;n+=2){const l=s[n],o=s[n+1];i+=(l-r)*(o+a),r=l,a=o}if(!t&&i>0||t&&i<=0){const n=e/2;for(let r=n+n%2;r<e;r+=2){const a=e-r-2,l=e-r-1,o=r,h=r+1;[s[a],s[o]]=[s[o],s[a]],[s[l],s[h]]=[s[h],s[l]]}}}const Tc={build(s){s.points=s.shape.points.slice()},triangulate(s,t){let e=s.points;const i=s.holes,n=t.points,r=t.indices;if(e.length>=6){yf(e,!1);const a=[];for(let h=0;h<i.length;h++){const c=i[h];yf(c.points,!0),a.push(e.length/2),e=e.concat(c.points)}const l=Hf(e,a,2);if(!l)return;const o=n.length/2;for(let h=0;h<l.length;h+=3)r.push(l[h]+o),r.push(l[h+1]+o),r.push(l[h+2]+o);for(let h=0;h<e.length;h++)n.push(e[h])}}},Rp={build(s){const t=s.shape,e=t.x,i=t.y,n=t.width,r=t.height,a=s.points;a.length=0,n>=0&&r>=0&&a.push(e,i,e+n,i,e+n,i+r,e,i+r)},triangulate(s,t){const e=s.points,i=t.points;if(e.length===0)return;const n=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},Pp={build(s){Lr.build(s)},triangulate(s,t){Lr.triangulate(s,t)}};var ss=(s=>(s.MITER="miter",s.BEVEL="bevel",s.ROUND="round",s))(ss||{}),Ai=(s=>(s.BUTT="butt",s.ROUND="round",s.SQUARE="square",s))(Ai||{});const Ri={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(s,t=20){if(!this.adaptive||!s||isNaN(s))return t;let e=Math.ceil(s/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},Tb=Ri;class fh{static curveTo(t,e,i,n,r,a){const l=a[a.length-2],h=a[a.length-1]-e,c=l-t,u=n-e,d=i-t,f=Math.abs(h*d-c*u);if(f<1e-8||r===0)return(a[a.length-2]!==t||a[a.length-1]!==e)&&a.push(t,e),null;const m=h*h+c*c,p=u*u+d*d,g=h*u+c*d,v=r*Math.sqrt(m)/f,_=r*Math.sqrt(p)/f,x=v*g/m,y=_*g/p,b=v*d+_*c,w=v*u+_*h,E=c*(_+x),S=h*(_+x),A=d*(v+y),M=u*(v+y),I=Math.atan2(S-w,E-b),k=Math.atan2(M-w,A-b);return{cx:b+t,cy:w+e,radius:r,startAngle:I,endAngle:k,anticlockwise:c*u>d*h}}static arc(t,e,i,n,r,a,l,o,h){const c=l-a,u=Ri._segmentsCount(Math.abs(c)*r,Math.ceil(Math.abs(c)/kr)*40),d=c/(u*2),f=d*2,m=Math.cos(d),p=Math.sin(d),g=u-1,v=g%1/g;for(let _=0;_<=g;++_){const x=_+v*_,y=d+a+f*x,b=Math.cos(y),w=-Math.sin(y);h.push((m*b+p*w)*r+i,(m*-w+p*b)*r+n)}}}class kp{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Ca{static curveLength(t,e,i,n,r,a,l,o){let c=0,u=0,d=0,f=0,m=0,p=0,g=0,v=0,_=0,x=0,y=0,b=t,w=e;for(let E=1;E<=10;++E)u=E/10,d=u*u,f=d*u,m=1-u,p=m*m,g=p*m,v=g*t+3*p*u*i+3*m*d*r+f*l,_=g*e+3*p*u*n+3*m*d*a+f*o,x=b-v,y=w-_,b=v,w=_,c+=Math.sqrt(x*x+y*y);return c}static curveTo(t,e,i,n,r,a,l){const o=l[l.length-2],h=l[l.length-1];l.length-=2;const c=Ri._segmentsCount(Ca.curveLength(o,h,t,e,i,n,r,a));let u=0,d=0,f=0,m=0,p=0;l.push(o,h);for(let g=1,v=0;g<=c;++g)v=g/c,u=1-v,d=u*u,f=d*u,m=v*v,p=m*v,l.push(f*o+3*d*v*t+3*u*m*i+p*r,f*h+3*d*v*e+3*u*m*n+p*a)}}function _f(s,t,e,i,n,r,a,l){const o=s-e*n,h=t-i*n,c=s+e*r,u=t+i*r;let d,f;a?(d=i,f=-e):(d=-i,f=e);const m=o+d,p=h+f,g=c+d,v=u+f;return l.push(m,p,g,v),2}function Vi(s,t,e,i,n,r,a,l){const o=e-s,h=i-t;let c=Math.atan2(o,h),u=Math.atan2(n-s,r-t);l&&c<u?c+=Math.PI*2:!l&&c>u&&(u+=Math.PI*2);let d=c;const f=u-c,m=Math.abs(f),p=Math.sqrt(o*o+h*h),g=(15*m*Math.sqrt(p)/Math.PI>>0)+1,v=f/g;if(d+=v,l){a.push(s,t,e,i);for(let _=1,x=d;_<g;_++,x+=v)a.push(s,t,s+Math.sin(x)*p,t+Math.cos(x)*p);a.push(s,t,n,r)}else{a.push(e,i,s,t);for(let _=1,x=d;_<g;_++,x+=v)a.push(s+Math.sin(x)*p,t+Math.cos(x)*p,s,t);a.push(n,r,s,t)}return g*2}function Ab(s,t){const e=s.shape;let i=s.points||e.points.slice();const n=t.closePointEps;if(i.length===0)return;const r=s.lineStyle,a=new at(i[0],i[1]),l=new at(i[i.length-2],i[i.length-1]),o=e.type!==de.POLY||e.closeStroke,h=Math.abs(a.x-l.x)<n&&Math.abs(a.y-l.y)<n;if(o){i=i.slice(),h&&(i.pop(),i.pop(),l.set(i[i.length-2],i[i.length-1]));const O=(a.x+l.x)*.5,G=(l.y+a.y)*.5;i.unshift(O,G),i.push(O,G)}const c=t.points,u=i.length/2;let d=i.length;const f=c.length/2,m=r.width/2,p=m*m,g=r.miterLimit*r.miterLimit;let v=i[0],_=i[1],x=i[2],y=i[3],b=0,w=0,E=-(_-y),S=v-x,A=0,M=0,I=Math.sqrt(E*E+S*S);E/=I,S/=I,E*=m,S*=m;const k=r.alignment,R=(1-k)*2,P=k*2;o||(r.cap===Ai.ROUND?d+=Vi(v-E*(R-P)*.5,_-S*(R-P)*.5,v-E*R,_-S*R,v+E*P,_+S*P,c,!0)+2:r.cap===Ai.SQUARE&&(d+=_f(v,_,E,S,R,P,!0,c))),c.push(v-E*R,_-S*R,v+E*P,_+S*P);for(let O=1;O<u-1;++O){v=i[(O-1)*2],_=i[(O-1)*2+1],x=i[O*2],y=i[O*2+1],b=i[(O+1)*2],w=i[(O+1)*2+1],E=-(_-y),S=v-x,I=Math.sqrt(E*E+S*S),E/=I,S/=I,E*=m,S*=m,A=-(y-w),M=x-b,I=Math.sqrt(A*A+M*M),A/=I,M/=I,A*=m,M*=m;const G=x-v,U=_-y,F=x-b,V=w-y,X=G*F+U*V,Y=U*F-V*G,$=Y<0;if(Math.abs(Y)<.001*Math.abs(X)){c.push(x-E*R,y-S*R,x+E*P,y+S*P),X>=0&&(r.join===ss.ROUND?d+=Vi(x,y,x-E*R,y-S*R,x-A*R,y-M*R,c,!1)+4:d+=2,c.push(x-A*P,y-M*P,x+A*R,y+M*R));continue}const W=(-E+v)*(-S+y)-(-E+x)*(-S+_),Q=(-A+b)*(-M+y)-(-A+x)*(-M+w),st=(G*Q-F*W)/Y,mt=(V*W-U*Q)/Y,ot=(st-x)*(st-x)+(mt-y)*(mt-y),xt=x+(st-x)*R,ut=y+(mt-y)*R,St=x-(st-x)*P,At=y-(mt-y)*P,Jt=Math.min(G*G+U*U,F*F+V*V),Wt=$?R:P,me=Jt+Wt*Wt*p,$e=ot<=me;let Pe=r.join;if(Pe===ss.MITER&&ot/p>g&&(Pe=ss.BEVEL),$e)switch(Pe){case ss.MITER:{c.push(xt,ut,St,At);break}case ss.BEVEL:{$?c.push(xt,ut,x+E*P,y+S*P,xt,ut,x+A*P,y+M*P):c.push(x-E*R,y-S*R,St,At,x-A*R,y-M*R,St,At),d+=2;break}case ss.ROUND:{$?(c.push(xt,ut,x+E*P,y+S*P),d+=Vi(x,y,x+E*P,y+S*P,x+A*P,y+M*P,c,!0)+4,c.push(xt,ut,x+A*P,y+M*P)):(c.push(x-E*R,y-S*R,St,At),d+=Vi(x,y,x-E*R,y-S*R,x-A*R,y-M*R,c,!1)+4,c.push(x-A*R,y-M*R,St,At));break}}else{switch(c.push(x-E*R,y-S*R,x+E*P,y+S*P),Pe){case ss.MITER:{$?c.push(St,At,St,At):c.push(xt,ut,xt,ut),d+=2;break}case ss.ROUND:{$?d+=Vi(x,y,x+E*P,y+S*P,x+A*P,y+M*P,c,!0)+2:d+=Vi(x,y,x-E*R,y-S*R,x-A*R,y-M*R,c,!1)+2;break}}c.push(x-A*R,y-M*R,x+A*P,y+M*P),d+=2}}v=i[(u-2)*2],_=i[(u-2)*2+1],x=i[(u-1)*2],y=i[(u-1)*2+1],E=-(_-y),S=v-x,I=Math.sqrt(E*E+S*S),E/=I,S/=I,E*=m,S*=m,c.push(x-E*R,y-S*R,x+E*P,y+S*P),o||(r.cap===Ai.ROUND?d+=Vi(x-E*(R-P)*.5,y-S*(R-P)*.5,x-E*R,y-S*R,x+E*P,y+S*P,c,!1)+2:r.cap===Ai.SQUARE&&(d+=_f(x,y,E,S,R,P,!1,c)));const B=t.indices,L=Ri.epsilon*Ri.epsilon;for(let O=f;O<d+f-2;++O)v=c[O*2],_=c[O*2+1],x=c[(O+1)*2],y=c[(O+1)*2+1],b=c[(O+2)*2],w=c[(O+2)*2+1],!(Math.abs(v*(y-w)+x*(w-_)+b*(_-y))<L)&&B.push(O,O+1,O+2)}function Cb(s,t){let e=0;const i=s.shape,n=s.points||i.points,r=i.type!==de.POLY||i.closeStroke;if(n.length===0)return;const a=t.points,l=t.indices,o=n.length/2,h=a.length/2;let c=h;for(a.push(n[0],n[1]),e=1;e<o;e++)a.push(n[e*2],n[e*2+1]),l.push(c,c+1),c++;r&&l.push(c,h)}function mh(s,t){s.lineStyle.native?Cb(s,t):Ab(s,t)}class Ma{static curveLength(t,e,i,n,r,a){const l=t-2*i+r,o=e-2*n+a,h=2*i-2*t,c=2*n-2*e,u=4*(l*l+o*o),d=4*(l*h+o*c),f=h*h+c*c,m=2*Math.sqrt(u+d+f),p=Math.sqrt(u),g=2*u*p,v=2*Math.sqrt(f),_=d/p;return(g*m+p*d*(m-v)+(4*f*u-d*d)*Math.log((2*p+_+m)/(_+v)))/(4*g)}static curveTo(t,e,i,n,r){const a=r[r.length-2],l=r[r.length-1],o=Ri._segmentsCount(Ma.curveLength(a,l,t,e,i,n));let h=0,c=0;for(let u=1;u<=o;++u){const d=u/o;h=a+(t-a)*d,c=l+(e-l)*d,r.push(h+(t+(i-t)*d-h)*d,c+(e+(n-e)*d-c)*d)}}}const Oo={[de.POLY]:Tc,[de.CIRC]:Lr,[de.ELIP]:Lr,[de.RECT]:Rp,[de.RREC]:Pp},ph=[],fr=[];class Or{constructor(t,e=null,i=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=n,this.type=t.type}clone(){return new Or(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const gn=new at,Fp=class extends zh{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Fr,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let s=0;s<this.drawCalls.length;s++)this.drawCalls[s].texArray.clear(),fr.push(this.drawCalls[s]);this.drawCalls.length=0;for(let s=0;s<this.batches.length;s++){const t=this.batches[s];t.reset(),ph.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(s,t=null,e=null,i=null){const n=new Or(s,t,e,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(s,t=null){if(!this.graphicsData.length)return null;const e=new Or(s,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=i.lineStyle,i.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let s=0;s<this.graphicsData.length;++s)this.graphicsData[s].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(s){const t=this.graphicsData;for(let e=0;e<t.length;++e){const i=t[e];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(s,gn):gn.copyFrom(s),i.shape.contains(gn.x,gn.y))){let n=!1;if(i.holes){for(let r=0;r<i.holes.length;r++)if(i.holes[r].shape.contains(gn.x,gn.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const s=this.uvs,t=this.graphicsData;let e=null,i=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],i=e.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const o=t[l],h=o.fillStyle,c=o.lineStyle;Oo[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(h.visible||c.visible)&&this.processHoles(o.holes);for(let d=0;d<2;d++){const f=d===0?h:c;if(!f.visible)continue;const m=f.texture.baseTexture,p=this.indices.length,g=this.points.length/2;m.wrapMode=Ws.REPEAT,d===0?this.processFill(o):this.processLine(o);const v=this.points.length/2-g;v!==0&&(e&&!this._compareStyles(i,f)&&(e.end(p,g),e=null),e||(e=ph.pop()||new kp,e.begin(f,p,g),this.batches.push(e),i=f),this.addUvs(this.points,s,f.texture,g,v,f.matrix))}}const n=this.indices.length,r=this.points.length/2;if(e&&e.end(n,r),this.batches.length===0){this.batchable=!0;return}const a=r>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(s,t){return!(!s||!t||s.texture.baseTexture!==t.texture.baseTexture||s.color+s.alpha!==t.color+t.alpha||!!s.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let s=0,t=this.graphicsData.length;s<t;s++){const e=this.graphicsData[s],i=e.fillStyle,n=e.lineStyle;if(i&&!i.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const s=this.batches;for(let t=0,e=s.length;t<e;t++){const i=s[t];for(let n=0;n<i.size;n++){const r=i.start+n;this.indicesUint16[r]=this.indicesUint16[r]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const s=this.batches;for(let t=0;t<s.length;t++)if(s[t].style.native)return!1;return this.points.length<Fp.BATCHABLE_SIZE*2}buildDrawCalls(){let s=++nt._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),fr.push(this.drawCalls[c]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let i=fr.pop();i||(i=new Qo,i.texArray=new Jo),i.texArray.count=0,i.start=0,i.size=0,i.type=rs.TRIANGLES;let n=0,r=null,a=0,l=!1,o=rs.TRIANGLES,h=0;this.drawCalls.push(i);for(let c=0;c<this.batches.length;c++){const u=this.batches[c],d=8,f=u.style,m=f.texture.baseTexture;l!==!!f.native&&(l=!!f.native,o=l?rs.LINES:rs.TRIANGLES,r=null,n=d,s++),r!==m&&(r=m,m._batchEnabled!==s&&(n===d&&(s++,n=0,i.size>0&&(i=fr.pop(),i||(i=new Qo,i.texArray=new Jo),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=o),m.touched=1,m._batchEnabled=s,m._batchLocation=n,m.wrapMode=Ws.REPEAT,i.texArray.elements[i.texArray.count++]=m,n++)),i.size+=u.size,h+=u.size,a=m._batchLocation,this.addColors(t,f.color,f.alpha,u.attribSize,u.attribStart),this.addTextureIds(e,a,u.attribSize,u.attribStart)}nt._globalBatch=s,this.packAttributes()}packAttributes(){const s=this.points,t=this.uvs,e=this.colors,i=this.textureIds,n=new ArrayBuffer(s.length*3*4),r=new Float32Array(n),a=new Uint32Array(n);let l=0;for(let o=0;o<s.length/2;o++)r[l++]=s[o*2],r[l++]=s[o*2+1],r[l++]=t[o*2],r[l++]=t[o*2+1],a[l++]=e[o],r[l++]=i[o];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(s){s.holes.length?Tc.triangulate(s,this):Oo[s.type].triangulate(s,this)}processLine(s){mh(s,this);for(let t=0;t<s.holes.length;t++)mh(s.holes[t],this)}processHoles(s){for(let t=0;t<s.length;t++){const e=s[t];Oo[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const s=this._bounds;s.clear(),s.addVertexData(this.points,0,this.points.length),s.pad(this.boundsPadding,this.boundsPadding)}transformPoints(s,t){for(let e=0;e<s.length/2;e++){const i=s[e*2],n=s[e*2+1];s[e*2]=t.a*i+t.c*n+t.tx,s[e*2+1]=t.b*i+t.d*n+t.ty}}addColors(s,t,e,i,n=0){const r=bt.shared.setValue(t).toLittleEndianNumber(),a=bt.shared.setValue(r).toPremultiplied(e);s.length=Math.max(s.length,n+i);for(let l=0;l<i;l++)s[n+l]=a}addTextureIds(s,t,e,i=0){s.length=Math.max(s.length,i+e);for(let n=0;n<e;n++)s[i+n]=t}addUvs(s,t,e,i,n,r=null){let a=0;const l=t.length,o=e.frame;for(;a<n;){let c=s[(i+a)*2],u=s[(i+a)*2+1];if(r){const d=r.a*c+r.c*u+r.tx;u=r.b*c+r.d*u+r.ty,c=d}a++,t.push(c/o.width,u/o.height)}const h=e.baseTexture;(o.width<h.width||o.height<h.height)&&this.adjustUvs(t,e,l,n)}adjustUvs(s,t,e,i){const n=t.baseTexture,r=1e-6,a=e+i*2,l=t.frame,o=l.width/n.width,h=l.height/n.height;let c=l.x/l.width,u=l.y/l.height,d=Math.floor(s[e]+r),f=Math.floor(s[e+1]+r);for(let m=e+2;m<a;m+=2)d=Math.min(d,Math.floor(s[m]+r)),f=Math.min(f,Math.floor(s[m+1]+r));c-=d,u-=f;for(let m=e;m<a;m+=2)s[m]=(s[m]+c)*o,s[m+1]=(s[m+1]+u)*h}};let Ac=Fp;Ac.BATCHABLE_SIZE=100;class so{constructor(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new so;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=K.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class Ia extends so{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ai.BUTT,this.join=ss.MITER,this.miterLimit=10}clone(){const t=new Ia;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const Tl={},Vo=class extends fe{constructor(s=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new so,this._lineStyle=new Ia,this._matrix=null,this._holeMode=!1,this.state=qs.for2d(),this._geometry=s||new Ac,this._geometry.refCount++,this._transformID=-1,this._tintColor=new bt(16777215),this.blendMode=Z.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Vo(this._geometry)}set blendMode(s){this.state.blendMode=s}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(s){this._tintColor.setValue(s)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(s=null,t=0,e,i=.5,n=!1){return typeof s=="number"&&(s={width:s,color:t,alpha:e,alignment:i,native:n}),this.lineTextureStyle(s)}lineTextureStyle(s){const t={width:0,texture:K.WHITE,color:s!=null&&s.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ai.BUTT,join:ss.MITER,miterLimit:10};s=Object.assign(t,s),this.normalizeColor(s),this.currentPath&&this.startPoly();const e=s.width>0&&s.alpha>0;return e?(s.matrix&&(s.matrix=s.matrix.clone(),s.matrix.invert()),Object.assign(this._lineStyle,{visible:e},s)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const s=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Ci,this.currentPath.closeStroke=!1,this.currentPath.points.push(s[t-2],s[t-1]))}else this.currentPath=new Ci,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(s,t){return this.startPoly(),this.currentPath.points[0]=s,this.currentPath.points[1]=t,this}lineTo(s,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,i=e[e.length-2],n=e[e.length-1];return(i!==s||n!==t)&&e.push(s,t),this}_initCurve(s=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[s,t]):this.moveTo(s,t)}quadraticCurveTo(s,t,e,i){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),Ma.curveTo(s,t,e,i,n),this}bezierCurveTo(s,t,e,i,n,r){return this._initCurve(),Ca.curveTo(s,t,e,i,n,r,this.currentPath.points),this}arcTo(s,t,e,i,n){this._initCurve(s,t);const r=this.currentPath.points,a=fh.curveTo(s,t,e,i,n,r);if(a){const{cx:l,cy:o,radius:h,startAngle:c,endAngle:u,anticlockwise:d}=a;this.arc(l,o,h,c,u,d)}return this}arc(s,t,e,i,n,r=!1){if(i===n)return this;if(!r&&n<=i?n+=kr:r&&i<=n&&(i+=kr),n-i===0)return this;const l=s+Math.cos(i)*e,o=t+Math.sin(i)*e,h=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const u=Math.abs(c[c.length-2]-l),d=Math.abs(c[c.length-1]-o);u<h&&d<h||c.push(l,o)}else this.moveTo(l,o),c=this.currentPath.points;return fh.arc(l,o,s,t,e,i,n,r,c),this}beginFill(s=0,t){return this.beginTextureFill({texture:K.WHITE,color:s,alpha:t})}normalizeColor(s){const t=bt.shared.setValue(s.color??0);s.color=t.toNumber(),s.alpha??(s.alpha=t.alpha)}beginTextureFill(s){const t={texture:K.WHITE,color:16777215,matrix:null};s=Object.assign(t,s),this.normalizeColor(s),this.currentPath&&this.startPoly();const e=s.alpha>0;return e?(s.matrix&&(s.matrix=s.matrix.clone(),s.matrix.invert()),Object.assign(this._fillStyle,{visible:e},s)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(s,t,e,i){return this.drawShape(new ft(s,t,e,i))}drawRoundedRect(s,t,e,i,n){return this.drawShape(new Sa(s,t,e,i,n))}drawCircle(s,t,e){return this.drawShape(new wa(s,t,e))}drawEllipse(s,t,e,i){return this.drawShape(new Ea(s,t,e,i))}drawPolygon(...s){let t,e=!0;const i=s[0];i.points?(e=i.closeStroke,t=i.points):Array.isArray(s[0])?t=s[0]:t=s;const n=new Ci(t);return n.closeStroke=e,this.drawShape(n),this}drawShape(s){return this._holeMode?this._geometry.drawHole(s,this._matrix):this._geometry.drawShape(s,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const s=this._geometry.graphicsData;return s.length===1&&s[0].shape.type===de.RECT&&!s[0].matrix&&!s[0].holes.length&&!(s[0].lineStyle.visible&&s[0].lineStyle.width)}_render(s){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(s)):(s.batch.flush(),this._renderDirect(s))}_populateBatches(){const s=this._geometry,t=this.blendMode,e=s.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=s.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(s.points);for(let i=0;i<e;i++){const n=s.batches[i],r=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),l=new Float32Array(s.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),o=new Uint16Array(s.indicesUint16.buffer,n.start*2,n.size),h={vertexData:a,blendMode:t,indices:o,uvs:l,_batchRGB:bt.shared.setValue(r).toRgbArray(),_tintRGB:r,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[i]=h}}_renderBatched(s){if(this.batches.length){s.batch.setObjectRenderer(s.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,s.plugins[this.pluginName].render(i)}}}_renderDirect(s){const t=this._resolveDirectShader(s),e=this._geometry,i=this.worldAlpha,n=t.uniforms,r=e.drawCalls;n.translationMatrix=this.transform.worldTransform,bt.shared.setValue(this._tintColor).premultiply(i).toArray(n.tint),s.shader.bind(t),s.geometry.bind(e,t),s.state.set(this.state);for(let a=0,l=r.length;a<l;a++)this._renderDrawCallDirect(s,e.drawCalls[a])}_renderDrawCallDirect(s,t){const{texArray:e,type:i,size:n,start:r}=t,a=e.count;for(let l=0;l<a;l++)s.texture.bind(e.elements[l],l);s.geometry.draw(i,n,r)}_resolveDirectShader(s){let t=this.shader;const e=this.pluginName;if(!t){if(!Tl[e]){const{maxTextures:i}=s.plugins[e],n=new Int32Array(i);for(let l=0;l<i;l++)n[l]=l;const r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Rt,default:hs.from({uSamplers:n},!0)},a=s.plugins[e]._shader.program;Tl[e]=new Ms(a,r)}t=Tl[e]}return t}_calculateBounds(){this.finishPoly();const s=this._geometry;if(!s.graphicsData.length)return;const{minX:t,minY:e,maxX:i,maxY:n}=s.bounds;this._bounds.addFrame(this.transform,t,e,i,n)}containsPoint(s){return this.worldTransform.applyInverse(s,Vo._TEMP_POINT),this._geometry.containsPoint(Vo._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let s=0;s<this.batches.length;s++){const t=this.batches[s];t._tintRGB=bt.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const s=this.transform._worldID;if(this._transformID===s)return;this._transformID=s;const t=this.transform.worldTransform,e=t.a,i=t.b,n=t.c,r=t.d,a=t.tx,l=t.ty,o=this._geometry.points,h=this.vertexData;let c=0;for(let u=0;u<o.length;u+=2){const d=o[u],f=o[u+1];h[c++]=e*d+n*f+a,h[c++]=r*f+i*d+l}}closePath(){const s=this.currentPath;return s&&(s.closeStroke=!0,this.finishPoly()),this}setMatrix(s){return this._matrix=s,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(s){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(s)}};let Zn=Vo;Zn.curves=Ri;Zn._TEMP_POINT=new at;const Mb={buildPoly:Tc,buildCircle:Lr,buildRectangle:Rp,buildRoundedRectangle:Pp,buildLine:mh,ArcUtils:fh,BezierUtils:Ca,QuadraticUtils:Ma,BatchPart:kp,FILL_COMMANDS:Oo,BATCH_POOL:ph,DRAW_CALL_POOL:fr};class Bp{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Al=new at,vf=new Ci,Dp=class extends fe{constructor(s,t,e,i=rs.TRIANGLES){super(),this.geometry=s,this.shader=t,this.state=e||qs.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=q.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(s){this._geometry!==s&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=s,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(s){this.shader=s}get material(){return this.shader}set blendMode(s){this.state.blendMode=s}get blendMode(){return this.state.blendMode}set roundPixels(s){this._roundPixels!==s&&(this._transformID=-1),this._roundPixels=s}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(s){this.shader.tint=s}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(s){this.shader.texture=s}_render(s){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===rs.TRIANGLES&&t.length<Dp.BATCHABLE_SIZE*2?this._renderToBatch(s):this._renderDefault(s)}_renderDefault(s){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),s.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),s.shader.bind(t),s.state.set(this.state),s.geometry.bind(this.geometry,t),s.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(s){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const i=this.material.pluginName;s.batch.setObjectRenderer(s.plugins[i]),s.plugins[i].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const n=this.transform.worldTransform,r=n.a,a=n.b,l=n.c,o=n.d,h=n.tx,c=n.ty,u=this.vertexData;for(let d=0;d<u.length/2;d++){const f=e[d*2],m=e[d*2+1];u[d*2]=r*f+l*m+h,u[d*2+1]=a*f+o*m+c}if(this._roundPixels){const d=q.RESOLUTION;for(let f=0;f<u.length;++f)u[f]=Math.round(u[f]*d)/d}this.vertexDirty=i}calculateUvs(){const s=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=s.data:(this.batchUvs||(this.batchUvs=new Bp(s,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(s){if(!this.getBounds().contains(s.x,s.y))return!1;this.worldTransform.applyInverse(s,Al);const t=this.geometry.getBuffer("aVertexPosition").data,e=vf.points,i=this.geometry.getIndex().data,n=i.length,r=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=r){const l=i[a]*2,o=i[a+1]*2,h=i[a+2]*2;if(e[0]=t[l],e[1]=t[l+1],e[2]=t[o],e[3]=t[o+1],e[4]=t[h],e[5]=t[h+1],vf.contains(Al.x,Al.y))return!0}return!1}destroy(s){super.destroy(s),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let an=Dp;an.BATCHABLE_SIZE=100;class io extends di{constructor(t,e,i){super();const n=new $t(t),r=new $t(e,!0),a=new $t(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,et.FLOAT).addAttribute("aTextureCoord",r,2,!1,et.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var Ib=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Rb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Gn extends Ms{constructor(t,e){const i={uSampler:t,alpha:1,uTextureMatrix:Rt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(i,e.uniforms),super(e.program||as.from(Rb,Ib),i),this._colorDirty=!1,this.uvMatrix=new Ta(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new bt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const e=this.texture.baseTexture.alphaMode;bt.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Np extends io{constructor(t=100,e=100,i=10,n=10){super(),this.segWidth=i,this.segHeight=n,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],i=[],n=[],r=this.segWidth-1,a=this.segHeight-1,l=this.width/r,o=this.height/a;for(let c=0;c<t;c++){const u=c%this.segWidth,d=c/this.segWidth|0;e.push(u*l,d*o),i.push(u/r,d/a)}const h=r*a;for(let c=0;c<h;c++){const u=c%r,d=c/r|0,f=d*this.segWidth+u,m=d*this.segWidth+u+1,p=(d+1)*this.segWidth+u,g=(d+1)*this.segWidth+u+1;n.push(f,m,p,m,g,p)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class Lp extends io{constructor(t=200,e,i=0){super(new Float32Array(e.length*4),new Float32Array(e.length*4),new Uint16Array((e.length-1)*6)),this.points=e,this._width=t,this.textureScale=i,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),n=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),i.data=new Float32Array(t.length*4),n.data=new Uint16Array((t.length-1)*6));const r=i.data,a=n.data;r[0]=0,r[1]=0,r[2]=0,r[3]=1;let l=0,o=t[0];const h=this._width*this.textureScale,c=t.length;for(let d=0;d<c;d++){const f=d*4;if(this.textureScale>0){const m=o.x-t[d].x,p=o.y-t[d].y,g=Math.sqrt(m*m+p*p);o=t[d],l+=g/h}else l=d/(c-1);r[f]=l,r[f+1]=0,r[f+2]=l,r[f+3]=1}let u=0;for(let d=0;d<c-1;d++){const f=d*2;a[u++]=f,a[u++]=f+1,a[u++]=f+2,a[u++]=f+2,a[u++]=f+1,a[u++]=f+3}i.update(),n.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],i,n=0,r=0;const a=this.buffers[0].data,l=t.length,o=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let h=0;h<l;h++){const c=t[h],u=h*4;h<t.length-1?i=t[h+1]:i=c,r=-(i.x-e.x),n=i.y-e.y;const d=Math.sqrt(n*n+r*r);d<1e-6?(n=0,r=0):(n/=d,r/=d,n*=o,r*=o),a[u]=c.x+n,a[u+1]=c.y+r,a[u+2]=c.x-n,a[u+3]=c.y-r,e=c}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class Op extends an{constructor(t,e,i){const n=new Np(t.width,t.height,e,i),r=new Gn(K.WHITE);super(n,r),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:i}=this.shader.texture;this.autoResize&&(t.width!==e||t.height!==i)&&(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}const Io=10;class Pb extends Op{constructor(t,e,i,n,r){var a,l,o,h;super(K.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e??((a=t.defaultBorders)==null?void 0:a.left)??Io,this._rightWidth=n??((l=t.defaultBorders)==null?void 0:l.right)??Io,this._topHeight=i??((o=t.defaultBorders)==null?void 0:o.top)??Io,this._bottomHeight=r??((h=t.defaultBorders)==null?void 0:h.bottom)??Io,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,n=this._height>i?1:this._height/i;return Math.min(e,n)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const i=1/this._origWidth,n=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=n*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class Vp extends an{constructor(t=K.EMPTY,e,i,n,r){const a=new io(e,i,n);a.getBuffer("aVertexPosition").static=!1;const l=new Gn(t);super(a,l,null,r),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}class kb extends an{constructor(t,e,i=0){const n=new Lp(t.height,e,i),r=new Gn(t);i>0&&(t.baseTexture.wrapMode=Ws.REPEAT),super(n,r),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}class Fb extends fe{constructor(t=1500,e,i=16384,n=!1){super();const r=16384;i>r&&(i=r),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=Z.NORMAL,this.autoResize=n,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tintColor=new bt(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintColor.toRgbArray(this.tintRgb)}render(t){!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",()=>this.onChildrenChange(0))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class bf{constructor(t,e,i){this.geometry=new di,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let r=t[n];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||et.FLOAT,offset:r.offset},e[n]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new $t(pm(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];l.offset=e,e+=l.size,this.dynamicStride+=l.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new $t(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];l.offset=n,n+=l.size,this.staticStride+=l.size}const r=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(r),this.staticDataUint32=new Uint32Array(r),this.staticBuffer=new $t(this.staticData,!0,!1);for(let a=0;a<this.dynamicProperties.length;++a){const l=this.dynamicProperties[a];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===et.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let a=0;a<this.staticProperties.length;++a){const l=this.staticProperties[a];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===et.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,e,i){for(let n=0;n<this.dynamicProperties.length;n++){const r=this.dynamicProperties[n];r.uploadFunction(t,e,i,r.type===et.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,i){for(let n=0;n<this.staticProperties.length;n++){const r=this.staticProperties[n];r.uploadFunction(t,e,i,r.type===et.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var Bb=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,Db=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Cc extends qr{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Rt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:et.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Ms.from(Db,Bb,{}),this.state=qs.for2d()}render(t){const e=t.children,i=t._maxSize,n=t._batchSize,r=this.renderer;let a=e.length;if(a===0)return;a>i&&!t.autoResize&&(a=i);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));const o=e[0]._texture.baseTexture,h=o.alphaMode>0;this.state.blendMode=Wh(t.blendMode,h),r.state.set(this.state);const c=r.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(r.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=bt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=o,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,m=0;f<a;f+=n,m+=1){let p=a-f;p>n&&(p=n),m>=l.length&&l.push(this._generateOneMoreBuffer(t));const g=l[m];g.uploadDynamic(e,f,p);const v=t._bufferUpdateIDs[m]||0;d=d||g._updateID<v,d&&(g._updateID=t._updateID,g.uploadStatic(e,f,p)),r.geometry.bind(g.geometry),c.drawElements(c.TRIANGLES,p*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],i=t._maxSize,n=t._batchSize,r=t._properties;for(let a=0;a<i;a+=n)e.push(new bf(this.properties,r,n));return e}_generateOneMoreBuffer(t){const e=t._batchSize,i=t._properties;return new bf(this.properties,i,e)}uploadVertices(t,e,i,n,r,a){let l=0,o=0,h=0,c=0;for(let u=0;u<i;++u){const d=t[e+u],f=d._texture,m=d.scale.x,p=d.scale.y,g=f.trim,v=f.orig;g?(o=g.x-d.anchor.x*v.width,l=o+g.width,c=g.y-d.anchor.y*v.height,h=c+g.height):(l=v.width*(1-d.anchor.x),o=v.width*-d.anchor.x,h=v.height*(1-d.anchor.y),c=v.height*-d.anchor.y),n[a]=o*m,n[a+1]=c*p,n[a+r]=l*m,n[a+r+1]=c*p,n[a+r*2]=l*m,n[a+r*2+1]=h*p,n[a+r*3]=o*m,n[a+r*3+1]=h*p,a+=r*4}}uploadPosition(t,e,i,n,r,a){for(let l=0;l<i;l++){const o=t[e+l].position;n[a]=o.x,n[a+1]=o.y,n[a+r]=o.x,n[a+r+1]=o.y,n[a+r*2]=o.x,n[a+r*2+1]=o.y,n[a+r*3]=o.x,n[a+r*3+1]=o.y,a+=r*4}}uploadRotation(t,e,i,n,r,a){for(let l=0;l<i;l++){const o=t[e+l].rotation;n[a]=o,n[a+r]=o,n[a+r*2]=o,n[a+r*3]=o,a+=r*4}}uploadUvs(t,e,i,n,r,a){for(let l=0;l<i;++l){const o=t[e+l]._texture._uvs;o?(n[a]=o.x0,n[a+1]=o.y0,n[a+r]=o.x1,n[a+r+1]=o.y1,n[a+r*2]=o.x2,n[a+r*2+1]=o.y2,n[a+r*3]=o.x3,n[a+r*3+1]=o.y3,a+=r*4):(n[a]=0,n[a+1]=0,n[a+r]=0,n[a+r+1]=0,n[a+r*2]=0,n[a+r*2+1]=0,n[a+r*3]=0,n[a+r*3+1]=0,a+=r*4)}}uploadTint(t,e,i,n,r,a){for(let l=0;l<i;++l){const o=t[e+l],h=bt.shared.setValue(o._tintRGB).toPremultiplied(o.alpha,o.texture.baseTexture.alphaMode>0);n[a]=h,n[a+r]=h,n[a+r*2]=h,n[a+r*3]=h,a+=r*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Cc.extension={name:"particle",type:j.RendererPlugin};J.add(Cc);var no=(s=>(s[s.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",s[s.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",s))(no||{});const Ro={willReadFrequently:!0},tt=class{static get experimentalLetterSpacingSupported(){let s=tt._experimentalLetterSpacingSupported;if(s!==void 0){const t=q.ADAPTER.getCanvasRenderingContext2D().prototype;s=tt._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return s}constructor(s,t,e,i,n,r,a,l,o){this.text=s,this.style=t,this.width=e,this.height=i,this.lines=n,this.lineWidths=r,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=o}static measureText(s,t,e,i=tt._canvas){e=e??t.wordWrap;const n=t.toFontString(),r=tt.measureFont(n);r.fontSize===0&&(r.fontSize=t.fontSize,r.ascent=t.fontSize);const a=i.getContext("2d",Ro);a.font=n;const o=(e?tt.wordWrap(s,t,i):s).split(/(?:\r\n|\r|\n)/),h=new Array(o.length);let c=0;for(let m=0;m<o.length;m++){const p=tt._measureText(o[m],t.letterSpacing,a);h[m]=p,c=Math.max(c,p)}let u=c+t.strokeThickness;t.dropShadow&&(u+=t.dropShadowDistance);const d=t.lineHeight||r.fontSize+t.strokeThickness;let f=Math.max(d,r.fontSize+t.strokeThickness*2)+(o.length-1)*(d+t.leading);return t.dropShadow&&(f+=t.dropShadowDistance),new tt(s,t,u,f,o,h,d+t.leading,c,r)}static _measureText(s,t,e){let i=!1;tt.experimentalLetterSpacingSupported&&(tt.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,i=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let n=e.measureText(s).width;return n>0&&(i?n-=t:n+=(tt.graphemeSegmenter(s).length-1)*t),n}static wordWrap(s,t,e=tt._canvas){const i=e.getContext("2d",Ro);let n=0,r="",a="";const l=Object.create(null),{letterSpacing:o,whiteSpace:h}=t,c=tt.collapseSpaces(h),u=tt.collapseNewlines(h);let d=!c;const f=t.wordWrapWidth+o,m=tt.tokenize(s);for(let p=0;p<m.length;p++){let g=m[p];if(tt.isNewline(g)){if(!u){a+=tt.addLine(r),d=!c,r="",n=0;continue}g=" "}if(c){const _=tt.isBreakingSpace(g),x=tt.isBreakingSpace(r[r.length-1]);if(_&&x)continue}const v=tt.getFromCache(g,o,l,i);if(v>f)if(r!==""&&(a+=tt.addLine(r),r="",n=0),tt.canBreakWords(g,t.breakWords)){const _=tt.wordWrapSplit(g);for(let x=0;x<_.length;x++){let y=_[x],b=y,w=1;for(;_[x+w];){const S=_[x+w];if(!tt.canBreakChars(b,S,g,x,t.breakWords))y+=S;else break;b=S,w++}x+=w-1;const E=tt.getFromCache(y,o,l,i);E+n>f&&(a+=tt.addLine(r),d=!1,r="",n=0),r+=y,n+=E}}else{r.length>0&&(a+=tt.addLine(r),r="",n=0);const _=p===m.length-1;a+=tt.addLine(g,!_),d=!1,r="",n=0}else v+n>f&&(d=!1,a+=tt.addLine(r),r="",n=0),(r.length>0||!tt.isBreakingSpace(g)||d)&&(r+=g,n+=v)}return a+=tt.addLine(r,!1),a}static addLine(s,t=!0){return s=tt.trimRight(s),s=t?`${s}
`:s,s}static getFromCache(s,t,e,i){let n=e[s];return typeof n!="number"&&(n=tt._measureText(s,t,i)+t,e[s]=n),n}static collapseSpaces(s){return s==="normal"||s==="pre-line"}static collapseNewlines(s){return s==="normal"}static trimRight(s){if(typeof s!="string")return"";for(let t=s.length-1;t>=0;t--){const e=s[t];if(!tt.isBreakingSpace(e))break;s=s.slice(0,-1)}return s}static isNewline(s){return typeof s!="string"?!1:tt._newlines.includes(s.charCodeAt(0))}static isBreakingSpace(s,t){return typeof s!="string"?!1:tt._breakingSpaces.includes(s.charCodeAt(0))}static tokenize(s){const t=[];let e="";if(typeof s!="string")return t;for(let i=0;i<s.length;i++){const n=s[i],r=s[i+1];if(tt.isBreakingSpace(n,r)||tt.isNewline(n)){e!==""&&(t.push(e),e=""),t.push(n);continue}e+=n}return e!==""&&t.push(e),t}static canBreakWords(s,t){return t}static canBreakChars(s,t,e,i,n){return!0}static wordWrapSplit(s){return tt.graphemeSegmenter(s)}static measureFont(s){if(tt._fonts[s])return tt._fonts[s];const t={ascent:0,descent:0,fontSize:0},e=tt._canvas,i=tt._context;i.font=s;const n=tt.METRICS_STRING+tt.BASELINE_SYMBOL,r=Math.ceil(i.measureText(n).width);let a=Math.ceil(i.measureText(tt.BASELINE_SYMBOL).width);const l=Math.ceil(tt.HEIGHT_MULTIPLIER*a);if(a=a*tt.BASELINE_MULTIPLIER|0,r===0||l===0)return tt._fonts[s]=t,t;e.width=r,e.height=l,i.fillStyle="#f00",i.fillRect(0,0,r,l),i.font=s,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,a);const o=i.getImageData(0,0,r,l).data,h=o.length,c=r*4;let u=0,d=0,f=!1;for(u=0;u<a;++u){for(let m=0;m<c;m+=4)if(o[d+m]!==255){f=!0;break}if(!f)d+=c;else break}for(t.ascent=a-u,d=h-c,f=!1,u=l;u>a;--u){for(let m=0;m<c;m+=4)if(o[d+m]!==255){f=!0;break}if(!f)d-=c;else break}return t.descent=u-a,t.fontSize=t.ascent+t.descent,tt._fonts[s]=t,t}static clearMetrics(s=""){s?delete tt._fonts[s]:tt._fonts={}}static get _canvas(){if(!tt.__canvas){let s;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",Ro);if(e!=null&&e.measureText)return tt.__canvas=t,t;s=q.ADAPTER.createCanvas()}catch{s=q.ADAPTER.createCanvas()}s.width=s.height=10,tt.__canvas=s}return tt.__canvas}static get _context(){return tt.__context||(tt.__context=tt._canvas.getContext("2d",Ro)),tt.__context}};let ue=tt;ue.METRICS_STRING="|ÉqÅ";ue.BASELINE_SYMBOL="M";ue.BASELINE_MULTIPLIER=1.4;ue.HEIGHT_MULTIPLIER=2;ue.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>[...s.segment(t)].map(e=>e.segment)}return s=>[...s]})();ue.experimentalLetterSpacing=!1;ue._fonts={};ue._newlines=[10,13];ue._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const Nb=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],mr=class{constructor(s){this.styleID=0,this.reset(),Ml(this,s,s)}clone(){const s={};return Ml(s,this,mr.defaultStyle),new mr(s)}reset(){Ml(this,mr.defaultStyle,mr.defaultStyle)}get align(){return this._align}set align(s){this._align!==s&&(this._align=s,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(s){this._breakWords!==s&&(this._breakWords=s,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(s){this._dropShadow!==s&&(this._dropShadow=s,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(s){this._dropShadowAlpha!==s&&(this._dropShadowAlpha=s,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(s){this._dropShadowAngle!==s&&(this._dropShadowAngle=s,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(s){this._dropShadowBlur!==s&&(this._dropShadowBlur=s,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(s){const t=Cl(s);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(s){this._dropShadowDistance!==s&&(this._dropShadowDistance=s,this.styleID++)}get fill(){return this._fill}set fill(s){const t=Cl(s);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(s){this._fillGradientType!==s&&(this._fillGradientType=s,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(s){Lb(this._fillGradientStops,s)||(this._fillGradientStops=s,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(s){this.fontFamily!==s&&(this._fontFamily=s,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(s){this._fontSize!==s&&(this._fontSize=s,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(s){this._fontStyle!==s&&(this._fontStyle=s,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(s){this._fontVariant!==s&&(this._fontVariant=s,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(s){this._fontWeight!==s&&(this._fontWeight=s,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(s){this._letterSpacing!==s&&(this._letterSpacing=s,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(s){this._lineHeight!==s&&(this._lineHeight=s,this.styleID++)}get leading(){return this._leading}set leading(s){this._leading!==s&&(this._leading=s,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(s){this._lineJoin!==s&&(this._lineJoin=s,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(s){this._miterLimit!==s&&(this._miterLimit=s,this.styleID++)}get padding(){return this._padding}set padding(s){this._padding!==s&&(this._padding=s,this.styleID++)}get stroke(){return this._stroke}set stroke(s){const t=Cl(s);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(s){this._strokeThickness!==s&&(this._strokeThickness=s,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(s){this._textBaseline!==s&&(this._textBaseline=s,this.styleID++)}get trim(){return this._trim}set trim(s){this._trim!==s&&(this._trim=s,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(s){this._whiteSpace!==s&&(this._whiteSpace=s,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(s){this._wordWrap!==s&&(this._wordWrap=s,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(s){this._wordWrapWidth!==s&&(this._wordWrapWidth=s,this.styleID++)}toFontString(){const s=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let i=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!Nb.includes(i)&&(i=`"${i}"`),t[e]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${s} ${t.join(",")}`}};let zs=mr;zs.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:no.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Cl(s){const t=bt.shared;return Array.isArray(s)?s.map(e=>t.setValue(e).toHex()):t.setValue(s).toHex()}function Lb(s,t){if(!Array.isArray(s)||!Array.isArray(t)||s.length!==t.length)return!1;for(let e=0;e<s.length;++e)if(s[e]!==t[e])return!1;return!0}function Ml(s,t,e){for(const i in e)Array.isArray(t[i])?s[i]=t[i].slice():s[i]=t[i]}const Ob={texture:!0,children:!1,baseTexture:!0},gh=class extends Bs{constructor(s,t,e){let i=!1;e||(e=q.ADAPTER.createCanvas(),i=!0),e.width=3,e.height=3;const n=K.from(e);n.orig=new ft,n.trim=new ft,super(n),this._ownCanvas=i,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=gh.defaultResolution??q.RESOLUTION,this._autoResolution=gh.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=s,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return ue.experimentalLetterSpacing}static set experimentalLetterSpacing(s){rt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),ue.experimentalLetterSpacing=s}updateText(s){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&s)return;this._font=this._style.toFontString();const e=this.context,i=ue.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=i.width,r=i.height,a=i.lines,l=i.lineHeight,o=i.lineWidths,h=i.maxLineWidth,c=i.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let u,d;const f=t.dropShadow?2:1;for(let m=0;m<f;++m){const p=t.dropShadow&&m===0,g=p?Math.ceil(Math.max(1,r)+t.padding*2):0,v=g*this._resolution;if(p){e.fillStyle="black",e.strokeStyle="black";const x=t.dropShadowColor,y=t.dropShadowBlur*this._resolution,b=t.dropShadowDistance*this._resolution;e.shadowColor=bt.shared.setValue(x).setAlpha(t.dropShadowAlpha).toRgbaString(),e.shadowBlur=y,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*b,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*b+v}else e.fillStyle=this._generateFillStyle(t,a,i),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let _=(l-c.fontSize)/2;l-c.fontSize<0&&(_=0);for(let x=0;x<a.length;x++)u=t.strokeThickness/2,d=t.strokeThickness/2+x*l+c.ascent+_,t.align==="right"?u+=h-o[x]:t.align==="center"&&(u+=(h-o[x])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(a[x],u+t.padding,d+t.padding-g,!0),t.fill&&this.drawLetterSpacing(a[x],u+t.padding,d+t.padding-g)}this.updateTexture()}drawLetterSpacing(s,t,e,i=!1){const r=this._style.letterSpacing;let a=!1;if(ue.experimentalLetterSpacingSupported&&(ue.experimentalLetterSpacing?(this.context.letterSpacing=`${r}px`,this.context.textLetterSpacing=`${r}px`,a=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),r===0||a){i?this.context.strokeText(s,t,e):this.context.fillText(s,t,e);return}let l=t;const o=ue.graphemeSegmenter(s);let h=this.context.measureText(s).width,c=0;for(let u=0;u<o.length;++u){const d=o[u];i?this.context.strokeText(d,l,e):this.context.fillText(d,l,e);let f="";for(let m=u+1;m<o.length;++m)f+=o[m];c=this.context.measureText(f).width,l+=h-c+r,h=c}}updateTexture(){const s=this.canvas;if(this._style.trim){const r=_m(s);r.data&&(s.width=r.width,s.height=r.height,this.context.putImageData(r.data,0,0))}const t=this._texture,e=this._style,i=e.trim?0:e.padding,n=t.baseTexture;t.trim.width=t._frame.width=s.width/this._resolution,t.trim.height=t._frame.height=s.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-i*2,t.orig.height=t._frame.height-i*2,this._onTextureUpdate(),n.setRealSize(s.width,s.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0),this.updateText(!0),super._render(s)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(s,t){return this.updateText(!0),this._textureID===-1&&(s=!1),super.getBounds(s,t)}getLocalBounds(s){return this.updateText(!0),super.getLocalBounds.call(this,s)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(s,t,e){const i=s.fill;if(Array.isArray(i)){if(i.length===1)return i[0]}else return i;let n;const r=s.dropShadow?s.dropShadowDistance:0,a=s.padding||0,l=this.canvas.width/this._resolution-r-a*2,o=this.canvas.height/this._resolution-r-a*2,h=i.slice(),c=s.fillGradientStops.slice();if(!c.length){const u=h.length+1;for(let d=1;d<u;++d)c.push(d/u)}if(h.unshift(i[0]),c.unshift(0),h.push(i[i.length-1]),c.push(1),s.fillGradientType===no.LINEAR_VERTICAL){n=this.context.createLinearGradient(l/2,a,l/2,o+a);const u=e.fontProperties.fontSize+s.strokeThickness;for(let d=0;d<t.length;d++){const f=e.lineHeight*(d-1)+u,m=e.lineHeight*d;let p=m;d>0&&f>m&&(p=(m+f)/2);const g=m+u,v=e.lineHeight*(d+1);let _=g;d+1<t.length&&v<g&&(_=(g+v)/2);const x=(_-p)/o;for(let y=0;y<h.length;y++){let b=0;typeof c[y]=="number"?b=c[y]:b=y/h.length;let w=Math.min(1,Math.max(0,p/o+b*x));w=Number(w.toFixed(5)),n.addColorStop(w,h[y])}}}else{n=this.context.createLinearGradient(a,o/2,l+a,o/2);const u=h.length+1;let d=1;for(let f=0;f<h.length;f++){let m;typeof c[f]=="number"?m=c[f]:m=d/u,n.addColorStop(m,h[f]),d++}}return n}destroy(s){typeof s=="boolean"&&(s={children:s}),s=Object.assign({},Ob,s),super.destroy(s),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(s){this.updateText(!0);const t=ai(this.scale.x)||1;this.scale.x=t*s/this._texture.orig.width,this._width=s}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(s){this.updateText(!0);const t=ai(this.scale.y)||1;this.scale.y=t*s/this._texture.orig.height,this._height=s}get style(){return this._style}set style(s){s=s||{},s instanceof zs?this._style=s:this._style=new zs(s),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(s){s=String(s??""),this._text!==s&&(this._text=s,this.dirty=!0)}get resolution(){return this._resolution}set resolution(s){this._autoResolution=!1,this._resolution!==s&&(this._resolution=s,this.dirty=!0)}};let Ra=gh;Ra.defaultAutoResolution=!0;class Up{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function Vb(s,t){var i;let e=!1;if((i=s==null?void 0:s._textures)!=null&&i.length){for(let n=0;n<s._textures.length;n++)if(s._textures[n]instanceof K){const r=s._textures[n].baseTexture;t.includes(r)||(t.push(r),e=!0)}}return e}function Ub(s,t){if(s.baseTexture instanceof nt){const e=s.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Xb(s,t){if(s._texture&&s._texture instanceof K){const e=s._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Yb(s,t){return t instanceof Ra?(t.updateText(!0),!0):!1}function $b(s,t){if(t instanceof zs){const e=t.toFontString();return ue.measureFont(e),!0}return!1}function Gb(s,t){if(s instanceof Ra){t.includes(s.style)||t.push(s.style),t.includes(s)||t.push(s);const e=s._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function Wb(s,t){return s instanceof zs?(t.includes(s)||t.push(s),!0):!1}const Xp=class{constructor(s){this.limiter=new Up(Xp.uploadsPerFrame),this.renderer=s,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(Gb),this.registerFindHook(Wb),this.registerFindHook(Vb),this.registerFindHook(Ub),this.registerFindHook(Xb),this.registerUploadHook(Yb),this.registerUploadHook($b)}upload(s){return new Promise(t=>{s&&this.add(s),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Pt.system.addOnce(this.tick,this,mi.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const s=this.queue[0];let t=!1;if(s&&!s._destroyed){for(let e=0,i=this.uploadHooks.length;e<i;e++)if(this.uploadHooks[e](this.uploadHookHelper,s)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Pt.system.addOnce(this.tick,this,mi.UTILITY);else{this.ticking=!1;const s=this.completes.slice(0);this.completes.length=0;for(let t=0,e=s.length;t<e;t++)s[t]()}}registerFindHook(s){return s&&this.addHooks.push(s),this}registerUploadHook(s){return s&&this.uploadHooks.push(s),this}add(s){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](s,this.queue);t++);if(s instanceof fe)for(let t=s.children.length-1;t>=0;t--)this.add(s.children[t]);return this}destroy(){this.ticking&&Pt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Vr=Xp;Vr.uploadsPerFrame=4;Object.defineProperties(q,{UPLOADS_PER_FRAME:{get(){return Vr.uploadsPerFrame},set(s){rt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Vr.uploadsPerFrame=s}}});function Yp(s,t){return t instanceof nt?(t._glTextures[s.CONTEXT_UID]||s.texture.bind(t),!0):!1}function Hb(s,t){if(!(t instanceof Zn))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:i}=e;for(let n=0;n<i.length;n++){const{texture:r}=i[n].style;r&&Yp(s,r.baseTexture)}return e.batchable||s.geometry.bind(e,t._resolveDirectShader(s)),!0}function zb(s,t){return s instanceof Zn?(t.push(s),!0):!1}class Mc extends Vr{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(zb),this.registerUploadHook(Yp),this.registerUploadHook(Hb)}}Mc.extension={name:"prepare",type:j.RendererSystem};J.add(Mc);class jb{constructor(t){this.maxMilliseconds=t,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}class na extends Bs{constructor(t,e=!0){super(t[0]instanceof K?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Pt.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Pt.shared.add(this.update,this,mi.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,i=this.currentFrame;if(this._durations!==null){let n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];const r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let i=0;i<t.length;++i)e.push(K.from(t[i]));return new na(e)}static fromImages(t){const e=[];for(let i=0;i<t.length;++i)e.push(K.from(t[i]));return new na(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof K)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Pt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Pt.shared.add(this.update,this),this._isConnectedToTicker=!0))}}const lr=new at;class Ic extends Bs{constructor(t,e=100,i=100){super(t),this.tileTransform=new zn,this._width=e,this._height=i,this.uvMatrix=this.texture.uvMatrix||new Ta(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const e=this._texture;!e||!e.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,n)}getLocalBounds(t){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ft),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,lr);const e=this._width,i=this._height,n=-e*this.anchor._x;if(lr.x>=n&&lr.x<n+e){const r=-i*this.anchor._y;if(lr.y>=r&&lr.y<r+i)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,e){const i=t instanceof K?t:K.from(t,e);return new Ic(i,e.width,e.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}var qb=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Zb=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Kb=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,wf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,Qb=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Po=new Rt;class Rc extends qr{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Jh,this.state=qs.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Ms.from(wf,Qb,e),this.shader=t.context.webGLVersion>1?Ms.from(Zb,qb,e):Ms.from(wf,Kb,e)}render(t){const e=this.renderer,i=this.quad;let n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);const r=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-r,n[1]=n[3]=-a,n[2]=n[4]=1-r,n[5]=n[7]=1-a,i.invalidate();const l=t._texture,o=l.baseTexture,h=o.alphaMode>0,c=t.tileTransform.localTransform,u=t.uvMatrix;let d=o.isPowerOfTwo&&l.frame.width===o.width&&l.frame.height===o.height;d&&(o._glTextures[e.CONTEXT_UID]?d=o.wrapMode!==Ws.CLAMP:o.wrapMode===Ws.CLAMP&&(o.wrapMode=Ws.REPEAT));const f=d?this.simpleShader:this.shader,m=l.width,p=l.height,g=t._width,v=t._height;Po.set(c.a*m/g,c.b*m/v,c.c*p/g,c.d*p/v,c.tx/g,c.ty/v),Po.invert(),d?Po.prepend(u.mapCoord):(f.uniforms.uMapCoord=u.mapCoord.toArray(!0),f.uniforms.uClampFrame=u.uClampFrame,f.uniforms.uClampOffset=u.uClampOffset),f.uniforms.uTransform=Po.toArray(!0),f.uniforms.uColor=bt.shared.setValue(t.tint).premultiply(t.worldAlpha,h).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=l,e.shader.bind(f),e.geometry.bind(i),this.state.blendMode=Wh(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Rc.extension={name:"tilingSprite",type:j.RendererPlugin};J.add(Rc);const pr=class{constructor(s,t,e=null){this.linkedSheets=[],this._texture=s instanceof K?s:null,this.baseTexture=s instanceof nt?s:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const i=this.baseTexture.resource;this.resolution=this._updateResolution(e||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(s=null){const{scale:t}=this.data.meta;let e=ui(s,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(s=>{this._callback=s,this._batchIndex=0,this._frameKeys.length<=pr.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(s){let t=s;const e=pr.BATCH_SIZE;for(;t-s<e&&t<this._frameKeys.length;){const i=this._frameKeys[t],n=this._frames[i],r=n.frame;if(r){let a=null,l=null;const o=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,h=new ft(0,0,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution);n.rotated?a=new ft(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):a=new ft(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new ft(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[i]=new K(this.baseTexture,a,h,l,n.rotated?2:0,n.anchor,n.borders),K.addToCache(this.textures[i],i)}t++}}_processAnimations(){const s=this.data.animations||{};for(const t in s){this.animations[t]=[];for(let e=0;e<s[t].length;e++){const i=s[t][e];this.animations[t].push(this.textures[i])}}}_parseComplete(){const s=this._callback;this._callback=null,this._batchIndex=0,s.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*pr.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*pr.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(s=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,s&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let ra=pr;ra.BATCH_SIZE=1e3;const Jb=["jpg","png","jpeg","avif","webp"];function $p(s,t,e){const i={};if(s.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[n]=t.textures[n]}),!e){const n=It.dirname(s[0]);t.linkedSheets.forEach((r,a)=>{const l=$p([`${n}/${t.data.meta.related_multi_packs[a]}`],r,!0);Object.assign(i,l)})}return i}const Gp={extension:j.Asset,cache:{test:s=>s instanceof ra,getCacheableAssets:(s,t)=>$p(s,t,!1)},resolver:{test:s=>{const e=s.split("?")[0].split("."),i=e.pop(),n=e.pop();return i==="json"&&Jb.includes(n)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=q.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",extension:{type:j.LoadParser,priority:Ue.Normal},async testParse(s,t){return It.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var h,c;let i=It.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+s.meta.image;n=ia(n,t.src);const a=(await e.load([n]))[n],l=new ra(a.baseTexture,s,t.src);await l.parse();const o=(h=s==null?void 0:s.meta)==null?void 0:h.related_multi_packs;if(Array.isArray(o)){const u=[];for(const f of o){if(typeof f!="string")continue;let m=i+f;(c=t.data)!=null&&c.ignoreMultiPack||(m=ia(m,t.src),u.push(e.load({src:m,data:{ignoreMultiPack:!0}})))}const d=await Promise.all(u);l.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[l].concat(l.linkedSheets.filter(m=>m!==f))})}return l},unload(s){s.destroy(!0)}}};J.add(Gp);class Ur{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Tr{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const r in e){const a=e[r].match(/^[a-z]+/gm)[0],l=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(const h in l){const c=l[h].split("="),u=c[0],d=c[1].replace(/"/gm,""),f=parseFloat(d),m=isNaN(f)?d:f;o[u]=m}i[a].push(o)}const n=new Ur;return i.info.forEach(r=>n.info.push({face:r.face,size:parseInt(r.size,10)})),i.common.forEach(r=>n.common.push({lineHeight:parseInt(r.lineHeight,10)})),i.page.forEach(r=>n.page.push({id:parseInt(r.id,10),file:r.file})),i.char.forEach(r=>n.char.push({id:parseInt(r.id,10),page:parseInt(r.page,10),x:parseInt(r.x,10),y:parseInt(r.y,10),width:parseInt(r.width,10),height:parseInt(r.height,10),xoffset:parseInt(r.xoffset,10),yoffset:parseInt(r.yoffset,10),xadvance:parseInt(r.xadvance,10)})),i.kerning.forEach(r=>n.kerning.push({first:parseInt(r.first,10),second:parseInt(r.second,10),amount:parseInt(r.amount,10)})),i.distanceField.forEach(r=>n.distanceField.push({distanceRange:parseInt(r.distanceRange,10),fieldType:r.fieldType})),n}}class oa{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new Ur,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),o=t.getElementsByTagName("distanceField");for(let h=0;h<i.length;h++)e.info.push({face:i[h].getAttribute("face"),size:parseInt(i[h].getAttribute("size"),10)});for(let h=0;h<n.length;h++)e.common.push({lineHeight:parseInt(n[h].getAttribute("lineHeight"),10)});for(let h=0;h<r.length;h++)e.page.push({id:parseInt(r[h].getAttribute("id"),10)||0,file:r[h].getAttribute("file")});for(let h=0;h<a.length;h++){const c=a[h];e.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let h=0;h<l.length;h++)e.kerning.push({first:parseInt(l[h].getAttribute("first"),10),second:parseInt(l[h].getAttribute("second"),10),amount:parseInt(l[h].getAttribute("amount"),10)});for(let h=0;h<o.length;h++)e.distanceField.push({fieldType:o[h].getAttribute("fieldType"),distanceRange:parseInt(o[h].getAttribute("distanceRange"),10)});return e}}class aa{static test(t){return typeof t=="string"&&t.includes("<font>")?oa.test(q.ADAPTER.parseXML(t)):!1}static parse(t){return oa.parse(q.ADAPTER.parseXML(t))}}const Il=[Tr,oa,aa];function Wp(s){for(let t=0;t<Il.length;t++)if(Il[t].test(s))return Il[t];return null}function tw(s,t,e,i,n,r){const a=e.fill;if(Array.isArray(a)){if(a.length===1)return a[0]}else return a;let l;const o=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,c=s.width/i-o-h*2,u=s.height/i-o-h*2,d=a.slice(),f=e.fillGradientStops.slice();if(!f.length){const m=d.length+1;for(let p=1;p<m;++p)f.push(p/m)}if(d.unshift(a[0]),f.unshift(0),d.push(a[a.length-1]),f.push(1),e.fillGradientType===no.LINEAR_VERTICAL){l=t.createLinearGradient(c/2,h,c/2,u+h);let m=0;const g=(r.fontProperties.fontSize+e.strokeThickness)/u;for(let v=0;v<n.length;v++){const _=r.lineHeight*v;for(let x=0;x<d.length;x++){let y=0;typeof f[x]=="number"?y=f[x]:y=x/d.length;const b=_/u+y*g;let w=Math.max(m,b);w=Math.min(w,1),l.addColorStop(w,d[x]),m=w}}}else{l=t.createLinearGradient(h,u/2,c+h,u/2);const m=d.length+1;let p=1;for(let g=0;g<d.length;g++){let v;typeof f[g]=="number"?v=f[g]:v=p/m,l.addColorStop(v,d[g]),p++}}return l}function ew(s,t,e,i,n,r,a){const l=e.text,o=e.fontProperties;t.translate(i,n),t.scale(r,r);const h=a.strokeThickness/2,c=-(a.strokeThickness/2);if(t.font=a.toFontString(),t.lineWidth=a.strokeThickness,t.textBaseline=a.textBaseline,t.lineJoin=a.lineJoin,t.miterLimit=a.miterLimit,t.fillStyle=tw(s,t,a,r,[l],e),t.strokeStyle=a.stroke,a.dropShadow){const u=a.dropShadowColor,d=a.dropShadowBlur*r,f=a.dropShadowDistance*r;t.shadowColor=bt.shared.setValue(u).setAlpha(a.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(a.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(a.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;a.stroke&&a.strokeThickness&&t.strokeText(l,h,c+e.lineHeight-o.descent),a.fill&&t.fillText(l,h,c+e.lineHeight-o.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Uo(s){return s.codePointAt?s.codePointAt(0):s.charCodeAt(0)}function Hp(s){return Array.from?Array.from(s):s.split("")}function sw(s){typeof s=="string"&&(s=[s]);const t=[];for(let e=0,i=s.length;e<i;e++){const n=s[e];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const r=n[0].charCodeAt(0),a=n[1].charCodeAt(0);if(a<r)throw new Error("[BitmapFont]: Invalid character range.");for(let l=r,o=a;l<=o;l++)t.push(String.fromCharCode(l))}else t.push(...Hp(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const vs=class{constructor(s,t,e){var h;const[i]=s.info,[n]=s.common,[r]=s.page,[a]=s.distanceField,l=ui(r.file),o={};this._ownsTextures=e,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/l,this.chars={},this.pageTextures=o;for(let c=0;c<s.page.length;c++){const{id:u,file:d}=s.page[c];o[u]=t instanceof Array?t[c]:t[d],a!=null&&a.fieldType&&a.fieldType!=="none"&&(o[u].baseTexture.alphaMode=Je.NO_PREMULTIPLIED_ALPHA,o[u].baseTexture.mipmap=cs.OFF)}for(let c=0;c<s.char.length;c++){const{id:u,page:d}=s.char[c];let{x:f,y:m,width:p,height:g,xoffset:v,yoffset:_,xadvance:x}=s.char[c];f/=l,m/=l,p/=l,g/=l,v/=l,_/=l,x/=l;const y=new ft(f+o[d].frame.x/l,m+o[d].frame.y/l,p,g);this.chars[u]={xOffset:v,yOffset:_,xAdvance:x,kerning:{},texture:new K(o[d].baseTexture,y),page:d}}for(let c=0;c<s.kerning.length;c++){let{first:u,second:d,amount:f}=s.kerning[c];u/=l,d/=l,f/=l,this.chars[d]&&(this.chars[d].kerning[u]=f)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((h=a==null?void 0:a.fieldType)==null?void 0:h.toLowerCase())??"none"}destroy(){for(const s in this.chars)this.chars[s].texture.destroy(),this.chars[s].texture=null;for(const s in this.pageTextures)this._ownsTextures&&this.pageTextures[s].destroy(!0),this.pageTextures[s]=null;this.chars=null,this.pageTextures=null}static install(s,t,e){let i;if(s instanceof Ur)i=s;else{const r=Wp(s);if(!r)throw new Error("Unrecognized data format for font.");i=r.parse(s)}t instanceof K&&(t=[t]);const n=new vs(i,t,e);return vs.available[n.font]=n,n}static uninstall(s){const t=vs.available[s];if(!t)throw new Error(`No font found named '${s}'`);t.destroy(),delete vs.available[s]}static from(s,t,e){if(!s)throw new Error("[BitmapFont] Property `name` is required.");const{chars:i,padding:n,resolution:r,textureWidth:a,textureHeight:l,...o}=Object.assign({},vs.defaultOptions,e),h=sw(i),c=t instanceof zs?t:new zs(t),u=a,d=new Ur;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};let f=0,m=0,p,g,v,_=0;const x=[];for(let b=0;b<h.length;b++){p||(p=q.ADAPTER.createCanvas(),p.width=a,p.height=l,g=p.getContext("2d"),v=new nt(p,{resolution:r,...o}),x.push(new K(v)),d.page.push({id:x.length-1,file:""}));const w=h[b],E=ue.measureText(w,c,!1,p),S=E.width,A=Math.ceil(E.height),M=Math.ceil((c.fontStyle==="italic"?2:1)*S);if(m>=l-A*r){if(m===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${w}')`);--b,p=null,g=null,v=null,m=0,f=0,_=0;continue}if(_=Math.max(A+E.fontProperties.descent,_),M*r+f>=u){if(f===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${w}')`);--b,m+=_*r,m=Math.ceil(m),f=0,_=0;continue}ew(p,g,E,f,m,r,c);const I=Uo(E.text);d.char.push({id:I,page:x.length-1,x:f/r,y:m/r,width:M,height:A,xoffset:0,yoffset:0,xadvance:S-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),f+=(M+2*n)*r,f=Math.ceil(f)}for(let b=0,w=h.length;b<w;b++){const E=h[b];for(let S=0;S<w;S++){const A=h[S],M=g.measureText(E).width,I=g.measureText(A).width,R=g.measureText(E+A).width-(M+I);R&&d.kerning.push({first:Uo(E),second:Uo(A),amount:R})}}const y=new vs(d,x,!0);return vs.available[s]!==void 0&&vs.uninstall(s),vs.available[s]=y,y}};let Me=vs;Me.ALPHA=[["a","z"],["A","Z"]," "];Me.NUMERIC=[["0","9"]];Me.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Me.ASCII=[[" ","~"]];Me.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:vs.ALPHANUMERIC};Me.available={};var iw=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,nw=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Ef=[],Sf=[],Tf=[],zp=class extends fe{constructor(s,t={}){super();const{align:e,tint:i,maxWidth:n,letterSpacing:r,fontName:a,fontSize:l}=Object.assign({},zp.styleDefaults,t);if(!Me.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tintColor=new bt(i),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=s,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=r,this._anchor=new li(()=>{this.dirty=!0},this,0,0),this._roundPixels=q.ROUND_PIXELS,this.dirty=!0,this._resolution=q.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var M;const s=Me.available[this._fontName],t=this.fontSize,e=t/s.size,i=new at,n=[],r=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",o=Hp(l),h=this._maxWidth*s.size/t,c=s.distanceFieldType==="none"?Ef:Sf;let u=null,d=0,f=0,m=0,p=-1,g=0,v=0,_=0,x=0;for(let I=0;I<o.length;I++){const k=o[I],R=Uo(k);if(/(?:\s)/.test(k)&&(p=I,g=d,x++),k==="\r"||k===`
`){r.push(d),a.push(-1),f=Math.max(f,d),++m,++v,i.x=0,i.y+=s.lineHeight,u=null,x=0;continue}const P=s.chars[R];if(!P)continue;u&&P.kerning[u]&&(i.x+=P.kerning[u]);const B=Tf.pop()||{texture:K.EMPTY,line:0,charCode:0,prevSpaces:0,position:new at};B.texture=P.texture,B.line=m,B.charCode=R,B.position.x=Math.round(i.x+P.xOffset+this._letterSpacing/2),B.position.y=Math.round(i.y+P.yOffset),B.prevSpaces=x,n.push(B),d=B.position.x+Math.max(P.xAdvance-P.xOffset,P.texture.orig.width),i.x+=P.xAdvance+this._letterSpacing,_=Math.max(_,P.yOffset+P.texture.height),u=R,p!==-1&&h>0&&i.x>h&&(++v,en(n,1+p-v,1+I-p),I=p,p=-1,r.push(g),a.push(n.length>0?n[n.length-1].prevSpaces:0),f=Math.max(f,g),m++,i.x=0,i.y+=s.lineHeight,u=null,x=0)}const y=o[o.length-1];y!=="\r"&&y!==`
`&&(/(?:\s)/.test(y)&&(d=g),r.push(d),f=Math.max(f,d),a.push(-1));const b=[];for(let I=0;I<=m;I++){let k=0;this._align==="right"?k=f-r[I]:this._align==="center"?k=(f-r[I])/2:this._align==="justify"&&(k=a[I]<0?0:(f-r[I])/a[I]),b.push(k)}const w=n.length,E={},S=[],A=this._activePagesMeshData;c.push(...A);for(let I=0;I<w;I++){const k=n[I].texture,R=k.baseTexture.uid;if(!E[R]){let P=c.pop();if(!P){const L=new io;let O,G;s.distanceFieldType==="none"?(O=new Gn(K.EMPTY),G=Z.NORMAL):(O=new Gn(K.EMPTY,{program:as.from(nw,iw),uniforms:{uFWidth:0}}),G=Z.NORMAL_NPM);const U=new an(L,O);U.blendMode=G,P={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:U,vertices:null,uvs:null,indices:null}}P.index=0,P.indexCount=0,P.vertexCount=0,P.uvsCount=0,P.total=0;const{_textureCache:B}=this;B[R]=B[R]||new K(k.baseTexture),P.mesh.texture=B[R],P.mesh.tint=this._tintColor.value,S.push(P),E[R]=P}E[R].total++}for(let I=0;I<A.length;I++)S.includes(A[I])||this.removeChild(A[I].mesh);for(let I=0;I<S.length;I++)S[I].mesh.parent!==this&&this.addChild(S[I].mesh);this._activePagesMeshData=S;for(const I in E){const k=E[I],R=k.total;if(!(((M=k.indices)==null?void 0:M.length)>6*R)||k.vertices.length<an.BATCHABLE_SIZE*2)k.vertices=new Float32Array(4*2*R),k.uvs=new Float32Array(4*2*R),k.indices=new Uint16Array(6*R);else{const P=k.total,B=k.vertices;for(let L=P*4*2;L<B.length;L++)B[L]=0}k.mesh.size=6*R}for(let I=0;I<w;I++){const k=n[I];let R=k.position.x+b[k.line]*(this._align==="justify"?k.prevSpaces:1);this._roundPixels&&(R=Math.round(R));const P=R*e,B=k.position.y*e,L=k.texture,O=E[L.baseTexture.uid],G=L.frame,U=L._uvs,F=O.index++;O.indices[F*6+0]=0+F*4,O.indices[F*6+1]=1+F*4,O.indices[F*6+2]=2+F*4,O.indices[F*6+3]=0+F*4,O.indices[F*6+4]=2+F*4,O.indices[F*6+5]=3+F*4,O.vertices[F*8+0]=P,O.vertices[F*8+1]=B,O.vertices[F*8+2]=P+G.width*e,O.vertices[F*8+3]=B,O.vertices[F*8+4]=P+G.width*e,O.vertices[F*8+5]=B+G.height*e,O.vertices[F*8+6]=P,O.vertices[F*8+7]=B+G.height*e,O.uvs[F*8+0]=U.x0,O.uvs[F*8+1]=U.y0,O.uvs[F*8+2]=U.x1,O.uvs[F*8+3]=U.y1,O.uvs[F*8+4]=U.x2,O.uvs[F*8+5]=U.y2,O.uvs[F*8+6]=U.x3,O.uvs[F*8+7]=U.y3}this._textWidth=f*e,this._textHeight=(i.y+s.lineHeight)*e;for(const I in E){const k=E[I];if(this.anchor.x!==0||this.anchor.y!==0){let L=0;const O=this._textWidth*this.anchor.x,G=this._textHeight*this.anchor.y;for(let U=0;U<k.total;U++)k.vertices[L++]-=O,k.vertices[L++]-=G,k.vertices[L++]-=O,k.vertices[L++]-=G,k.vertices[L++]-=O,k.vertices[L++]-=G,k.vertices[L++]-=O,k.vertices[L++]-=G}this._maxLineHeight=_*e;const R=k.mesh.geometry.getBuffer("aVertexPosition"),P=k.mesh.geometry.getBuffer("aTextureCoord"),B=k.mesh.geometry.getIndex();R.data=k.vertices,P.data=k.uvs,B.data=k.indices,R.update(),P.update(),B.update()}for(let I=0;I<n.length;I++)Tf.push(n[I]);this._font=s,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:i}=Me.available[this._fontName];if(e!=="none"){const{a:n,b:r,c:a,d:l}=this.worldTransform,o=Math.sqrt(n*n+r*r),h=Math.sqrt(a*a+l*l),c=(Math.abs(o)+Math.abs(h))/2,u=this.fontSize/i,d=s._view.resolution;for(const f of this._activePagesMeshData)f.mesh.shader.uniforms.uFWidth=c*t*u*d}super._render(s)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const s=Me.available[this._fontName];if(!s)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==s&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(s){if(this.tint!==s){this._tintColor.setValue(s);for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=s}}get align(){return this._align}set align(s){this._align!==s&&(this._align=s,this.dirty=!0)}get fontName(){return this._fontName}set fontName(s){if(!Me.available[s])throw new Error(`Missing BitmapFont "${s}"`);this._fontName!==s&&(this._fontName=s,this.dirty=!0)}get fontSize(){return this._fontSize??Me.available[this._fontName].size}set fontSize(s){this._fontSize!==s&&(this._fontSize=s,this.dirty=!0)}get anchor(){return this._anchor}set anchor(s){typeof s=="number"?this._anchor.set(s):this._anchor.copyFrom(s)}get text(){return this._text}set text(s){s=String(s??""),this._text!==s&&(this._text=s,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(s){this._maxWidth!==s&&(this._maxWidth=s,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(s){this._letterSpacing!==s&&(this._letterSpacing=s,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(s){s!==this._roundPixels&&(this._roundPixels=s,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(s){this._autoResolution=!1,this._resolution!==s&&(this._resolution=s,this.dirty=!0)}destroy(s){const{_textureCache:t}=this,i=Me.available[this._fontName].distanceFieldType==="none"?Ef:Sf;i.push(...this._activePagesMeshData);for(const n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>t[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=K.EMPTY});for(const n in t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(s)}};let jp=zp;jp.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const rw=[".xml",".fnt"],qp={extension:{type:j.LoadParser,priority:Ue.Normal},name:"loadBitmapFont",test(s){return rw.includes(It.extname(s).toLowerCase())},async testParse(s){return Tr.test(s)||aa.test(s)},async parse(s,t,e){const i=Tr.test(s)?Tr.parse(s):aa.parse(s),{src:n}=t,{page:r}=i,a=[];for(let h=0;h<r.length;++h){const c=r[h].file;let u=It.join(It.dirname(n),c);u=ia(u,n),a.push(u)}const l=await e.load(a),o=a.map(h=>l[h]);return Me.install(i,o,!0)},async load(s,t){return(await q.ADAPTER.fetch(s)).text()},unload(s){s.destroy()}};J.add(qp);const En=class extends zs{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(s){return new En(Object.keys(En.defaultOptions).reduce((t,e)=>({...t,[e]:s[e]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(s=>{URL.revokeObjectURL(s.src),s.refs--,s.refs===0&&(s.fontFace&&document.fonts.delete(s.fontFace),delete En.availableFonts[s.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(s,t={}){const{availableFonts:e}=En;if(e[s]){const i=e[s];return this._fonts.push(i),i.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return q.ADAPTER.fetch(s).then(i=>i.blob()).then(async i=>new Promise((n,r)=>{const a=URL.createObjectURL(i),l=new FileReader;l.onload=()=>n([a,l.result]),l.onerror=r,l.readAsDataURL(i)})).then(async([i,n])=>{const r=Object.assign({family:It.basename(s,It.extname(s)),weight:"normal",style:"normal",src:i,dataSrc:n,refs:1,originalUrl:s,fontFace:null},t);e[s]=r,this._fonts.push(r),this.styleID++;const a=new FontFace(r.family,`url(${r.src})`,{weight:r.weight,style:r.style});r.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...s){const t=s.filter(e=>!this._overrides.includes(e));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...s){const t=s.filter(e=>this._overrides.includes(e));t.length>0&&(this._overrides=this._overrides.filter(e=>!t.includes(e)),this.styleID++)}toCSS(s){return[`transform: scale(${s})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((s,t)=>`${s}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style}; 
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(s){this._stylesheet!==s&&(this._stylesheet=s,this.styleID++)}normalizeColor(s){return Array.isArray(s)&&(s=Dn(s)),typeof s=="number"?fm(s):s}dropShadowToCSS(){let s=this.normalizeColor(this.dropShadowColor);const t=this.dropShadowAlpha,e=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);s.startsWith("#")&&t<1&&(s+=(t*255|0).toString(16).padStart(2,"0"));const n=`${e}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${s}`:`text-shadow: ${n} ${s}`}reset(){Object.assign(this,En.defaultOptions)}onBeforeDraw(){const{fontsDirty:s}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&s?new Promise(t=>setTimeout(t,100)):Promise.resolve()}get isSafari(){const{userAgent:s}=q.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(s)}set fillGradientStops(s){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(s){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(s){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(s){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(s){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(s){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(s){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};let Nn=En;Nn.availableFonts={};Nn.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const Sn=class extends Bs{constructor(s="",t={}){super(K.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this._loading=!1,this.localStyleID=-1,this.dirty=!1,this.ownsStyle=!1;const e=new Image,i=K.from(e,{scaleMode:q.SCALE_MODE,resourceOptions:{autoLoad:!1}});i.orig=new ft,i.trim=new ft,this.texture=i;const n="http://www.w3.org/2000/svg",r="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject"),o=document.createElementNS(r,"div"),h=document.createElementNS(r,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Sn.defaultMaxWidth,this.maxHeight=Sn.defaultMaxHeight,this._domElement=o,this._styleElement=h,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(h),this._foreignObject.appendChild(o),this._image=e,this._loadImage=new Image,this._autoResolution=Sn.defaultAutoResolution,this._resolution=Sn.defaultResolution??q.RESOLUTION,this.text=s,this.style=t}measureText(s){var l,o;const{text:t,style:e,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},s);Object.assign(this._domElement,{innerHTML:t,style:e.toCSS(i)}),this._styleElement.textContent=e.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const r=Math.min(this.maxWidth,Math.ceil(n.width)),a=Math.min(this.maxHeight,Math.ceil(n.height));return this._svgRoot.setAttribute("width",r.toString()),this._svgRoot.setAttribute("height",a.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),e!==this._style&&(Object.assign(this._domElement,{style:(l=this._style)==null?void 0:l.toCSS(i)}),this._styleElement.textContent=(o=this._style)==null?void 0:o.toGlobalCSS()),{width:r+e.padding*2,height:a+e.padding*2}}async updateText(s=!0){const{style:t,_image:e,_loadImage:i}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&s)return;const{width:n,height:r}=this.measureText();e.width=i.width=Math.ceil(Math.max(1,n)),e.height=i.height=Math.ceil(Math.max(1,r)),this._loading||(this._loading=!0,await new Promise(a=>{i.onload=async()=>{await t.onBeforeDraw(),this._loading=!1,e.src=i.src,i.onload=null,i.src="",this.updateTexture(),a()};const l=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`}))}get source(){return this._image}updateTexture(){const{style:s,texture:t,_image:e,resolution:i}=this,{padding:n}=s,{baseTexture:r}=t;t.trim.width=t._frame.width=e.width/i,t.trim.height=t._frame.height=e.height/i,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),r.setRealSize(e.width,e.height,i),this.dirty=!1}_render(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0),this.updateText(!0),super._render(s)}_renderCanvas(s){this._autoResolution&&this._resolution!==s.resolution&&(this._resolution=s.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(s)}getLocalBounds(s){return this.updateText(!0),super.getLocalBounds(s)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(s){var e,i,n,r,a;typeof s=="boolean"&&(s={children:s}),s=Object.assign({},Sn.defaultDestroyOptions,s),super.destroy(s);const t=null;this.ownsStyle&&((e=this._style)==null||e.cleanFonts()),this._style=t,(i=this._svgRoot)==null||i.remove(),this._svgRoot=t,(n=this._domElement)==null||n.remove(),this._domElement=t,(r=this._foreignObject)==null||r.remove(),this._foreignObject=t,(a=this._styleElement)==null||a.remove(),this._styleElement=t,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=t,this._image.src="",this._image=t}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(s){this.updateText(!0);const t=ai(this.scale.x)||1;this.scale.x=t*s/this._image.width/this.resolution,this._width=s}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(s){this.updateText(!0);const t=ai(this.scale.y)||1;this.scale.y=t*s/this._image.height/this.resolution,this._height=s}get style(){return this._style}set style(s){this._style!==s&&(s=s||{},s instanceof Nn?(this.ownsStyle=!1,this._style=s):s instanceof zs?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Nn.from(s)):(this.ownsStyle=!0,this._style=new Nn(s)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(s){s=String(s===""||s===null||s===void 0?" ":s),s=this.sanitiseText(s),this._text!==s&&(this._text=s,this.dirty=!0)}get resolution(){return this._resolution}set resolution(s){this._autoResolution=!1,this._resolution!==s&&(this._resolution=s,this.dirty=!0)}sanitiseText(s){return s.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};let ro=Sn;ro.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0};ro.defaultMaxWidth=2024;ro.defaultMaxHeight=2024;ro.defaultAutoResolution=!0;const tE=Object.freeze(Object.defineProperty({__proto__:null,ALPHA_MODES:Je,AbstractMultiResource:_c,AccessibilityManager:bc,AlphaFilter:Jm,AnimatedSprite:na,Application:wc,ArrayResource:qm,Assets:ur,AssetsClass:pp,Attribute:Pr,BLEND_MODES:Z,BUFFER_BITS:Yo,BUFFER_TYPE:As,BackgroundSystem:Zr,BaseImageResource:fi,BasePrepare:Vr,BaseRenderTexture:qh,BaseTexture:nt,BatchDrawCall:Qo,BatchGeometry:zh,BatchRenderer:is,BatchShaderGenerator:km,BatchSystem:jh,BatchTextureArray:Jo,BitmapFont:Me,BitmapFontData:Ur,BitmapText:jp,BlobResource:wp,BlurFilter:tp,BlurFilterPass:ea,Bounds:Fr,BrowserAdapter:Uf,Buffer:$t,BufferResource:Hn,BufferSystem:xc,CLEAR_MODES:Ss,COLOR_MASK_BITS:Vf,Cache:bn,CanvasResource:Zm,Circle:wa,Color:bt,ColorMatrixFilter:sa,CompressedTextureResource:Mi,Container:fe,ContextSystem:Kr,CountLimiter:Up,CubeResource:vc,DEG_TO_RAD:Em,DRAW_MODES:rs,DisplacementFilter:ep,DisplayObject:Bt,ENV:Fi,Ellipse:Ea,EventBoundary:np,EventSystem:$n,ExtensionType:j,Extract:Sc,FORMATS:z,FORMATS_TO_COMPONENTS:Sp,FXAAFilter:sp,FederatedDisplayObject:rp,FederatedEvent:jn,FederatedMouseEvent:Br,FederatedPointerEvent:es,FederatedWheelEvent:on,FillStyle:so,Filter:se,FilterState:Bm,FilterSystem:tc,Framebuffer:ta,FramebufferSystem:ec,GC_MODES:xa,GLFramebuffer:Dm,GLProgram:Vm,GLTexture:No,GRAPHICS_CURVES:Tb,GenerateTextureSystem:lc,Geometry:di,GeometrySystem:sc,Graphics:Zn,GraphicsData:Or,GraphicsGeometry:Ac,HTMLText:ro,HTMLTextStyle:Nn,IGLUniformData:W_,INSTALLED:Ko,INTERNAL_FORMATS:Ne,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:Nr,ImageBitmapResource:ji,ImageResource:Zh,LINE_CAP:Ai,LINE_JOIN:ss,LineStyle:Ia,LoaderParserPriority:Ue,MASK_TYPES:te,MIPMAP_MODES:cs,MSAA_QUALITY:jt,MaskData:Lm,MaskSystem:ic,Matrix:Rt,Mesh:an,MeshBatchUvs:Bp,MeshGeometry:io,MeshMaterial:Gn,MultisampleSystem:gc,NineSlicePlane:Pb,NoiseFilter:ip,ObjectRenderer:qr,ObjectRendererSystem:yc,ObservablePoint:li,PI_2:kr,PRECISION:ze,ParticleContainer:Fb,ParticleRenderer:Cc,PlaneGeometry:Np,PluginSystem:oc,Point:at,Polygon:Ci,Prepare:Mc,Program:as,ProjectionSystem:ac,Quad:Fm,QuadUv:Jh,RAD_TO_DEG:wm,RENDERER_TYPE:Fh,Rectangle:ft,RenderTexture:Di,RenderTexturePool:Qh,RenderTextureSystem:hc,Renderer:cn,ResizePlugin:Ec,Resource:Xn,RopeGeometry:Lp,RoundedRectangle:Sa,Runner:je,SAMPLER_TYPES:$o,SCALE_MODES:Oe,SHAPES:de,SVGResource:Yn,ScissorSystem:nc,Shader:Ms,ShaderSystem:cc,SimpleMesh:Vp,SimplePlane:Op,SimpleRope:kb,Sprite:Bs,SpriteMaskFilter:Nm,Spritesheet:ra,StartupSystem:Qr,State:qs,StateSystem:uc,StencilSystem:rc,SystemManager:Wm,TARGETS:Qi,TEXT_GRADIENT:no,TYPES:et,TYPES_TO_BYTES_PER_COMPONENT:dh,TYPES_TO_BYTES_PER_PIXEL:Tp,TemporaryDisplayObject:Km,Text:Ra,TextFormat:Tr,TextMetrics:ue,TextStyle:zs,Texture:K,TextureGCSystem:ns,TextureMatrix:Ta,TextureSystem:dc,TextureUvs:Kh,Ticker:Pt,TickerPlugin:mc,TilingSprite:Ic,TilingSpriteRenderer:Rc,TimeLimiter:jb,Transform:zn,TransformFeedback:lv,TransformFeedbackSystem:fc,UPDATE_PRIORITY:mi,UniformGroup:hs,VERSION:hv,VideoResource:Aa,ViewSystem:Jr,ViewableBuffer:Zo,WRAP_MODES:Ws,XMLFormat:oa,XMLStringFormat:aa,accessibleTarget:op,autoDetectFormat:Wp,autoDetectRenderer:zm,autoDetectResource:Hh,cacheTextureArray:gp,checkDataUrl:qn,checkExtension:Ve,checkMaxIfStatementsInShader:bm,convertToList:Hs,copySearchParams:ia,createStringVariations:lp,createTexture:to,createUBOElements:Ym,curves:Ri,defaultFilterVertex:pc,defaultVertex:jm,detectAvif:xp,detectCompressedTextures:bp,detectDefaults:_p,detectWebp:yp,extensions:J,filters:lh,generateProgram:Um,generateUniformBufferSync:Gm,getFontFamilyName:up,getTestContext:Mm,getUBOData:$m,graphicsUtils:Mb,groupD8:Ft,isMobile:Ts,isSingleItem:Dr,loadBitmapFont:qp,loadDDS:Cp,loadImageBitmap:fp,loadJson:hp,loadKTX:Mp,loadSVG:mp,loadTextures:eo,loadTxt:cp,loadWebFont:dp,parseDDS:Ep,parseKTX:Ap,resolveCompressedTextureUrl:Ip,resolveTextureUrl:vp,settings:q,spritesheetAsset:Gp,uniformParsers:sn,unsafeEvalSupported:Pm,utils:m_},Symbol.toStringTag,{value:"Module"}));let Zp;function ow(s){return Zp=s,s}function Xr(){return Zp}let aw=0;const xh=class extends Fs{constructor(s){super(),this.id=aw++,this.init(s)}set(s,t){if(this[s]===void 0)throw new Error(`Property with name ${s} does not exist.`);switch(s){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:s}=this._source;return s/this._duration}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(s){this._playing=!1,this._duration=s.source.duration;const t=this._source=s.source.cloneNode(!1);t.src=s.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),s.context.on("refresh",this.refresh,this),s.context.on("refreshPaused",this.refreshPaused,this),this._media=s}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(s){console.warn("HTML Audio does not support filters")}refresh(){const s=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=s.volume*(s.muted?0:1),i=t.volume*(t.muted?0:1),n=this._volume*(this._muted?0:1);this._source.volume=n*e*i,this._source.playbackRate=this._speed*s.speed*t.speed}refreshPaused(){const s=this._media.context,t=this._media.parent,e=this._paused||t.paused||s.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(s){const{start:t,end:e,speed:i,loop:n,volume:r,muted:a}=s;e&&console.assert(e>t,"End time is before start time"),this._speed=i,this._volume=r,this._loop=!!n,this._muted=a,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-xh.PADDING),this._end=Math.min(this._end+xh.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t,this._duration),Pt.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){Pt.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){Pt.shared.remove(this._onUpdate,this),this.removeAllListeners();const s=this._source;s&&(s.onended=null,s.onplay=null,s.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let Kp=xh;Kp.PADDING=.1;class lw extends Fs{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new Kp(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,i=this.parent;if(e.readyState===4){i.isLoaded=!0;const o=i.autoPlayStart();t&&setTimeout(()=>{t(null,i,o)},0);return}if(!i.url){t(new Error("sound.url or sound.source must be set"));return}e.src=i.url;const n=()=>{l(),i.isLoaded=!0;const o=i.autoPlayStart();t&&t(null,i,o)},r=()=>{l(),t&&t(new Error("Sound loading has been aborted"))},a=()=>{l();const o=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(o)):console.error(o)},l=()=>{e.removeEventListener("canplaythrough",n),e.removeEventListener("load",n),e.removeEventListener("abort",r),e.removeEventListener("error",a)};e.addEventListener("canplaythrough",n,!1),e.addEventListener("load",n,!1),e.addEventListener("abort",r,!1),e.addEventListener("error",a,!1),e.load()}}class hw{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}const la=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],cw=["audio/mpeg","audio/ogg"],yh={};function uw(s){const t={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"',...s||{}},e=document.createElement("audio"),i={},n=/^no$/;la.forEach(r=>{const a=e.canPlayType(`audio/${r}`).replace(n,""),l=t[r]?e.canPlayType(t[r]).replace(n,""):"";i[r]=!!a||!!l}),Object.assign(yh,i)}uw();class _h{static setParamValue(t,e){if(t.setValueAtTime){const i=Xr().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e}}let dw=0;class fw extends Fs{constructor(t){super(),this.id=dw++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(i=>i).forEach(i=>i.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const i=t.volume*(t.muted?0:1),n=e.volume*(e.muted?0:1),r=this._volume*(this._muted?0:1);_h.setParamValue(this._gain.gain,r*n*i),_h.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(i=>{e.connect(i.destination),e=i}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))}play(t){const{start:e,end:i,speed:n,loop:r,volume:a,muted:l,filters:o}=t;i&&console.assert(i>e,"End time is before start time"),this._paused=!1;const{source:h,gain:c}=this._media.nodes.cloneBufferSource();this._source=h,this._gain=c,this._speed=n,this._volume=a,this._loop=!!r,this._muted=l,this._filters=o,this.refresh();const u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){Pt.shared.remove(this._updateListener,this),t&&Pt.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),i=e-this._lastUpdate;if(i>0||t){const n=this._source.playbackRate.value;this._elapsed+=i*n,this._lastUpdate=e;const r=this._duration;let a;if(this._source.loopStart){const l=this._source.loopEnd-this._source.loopStart;a=(this._source.loopStart+this._elapsed%l)/r}else a=this._elapsed%r/r;this._progress=a,this.emit("progress",this._progress,r)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class Qp{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(i=>{e===null?this._input.connect(i.destination):e.connect(i.destination),e=i}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const Jp=class extends Qp{constructor(s){const t=s.audioContext,e=t.createBufferSource(),i=t.createGain(),n=t.createAnalyser();e.connect(n),n.connect(i),i.connect(s.destination),super(n,i),this.context=s,this.bufferSource=e,this.gain=i,this.analyser=n}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(Jp.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const s=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=s.buffer,_h.setParamValue(t.playbackRate,s.playbackRate.value),t.loop=s.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let tg=Jp;tg.BUFFER_SIZE=0;class mw{init(t){this.parent=t,this._nodes=new tg(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new fw(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,i=await q.ADAPTER.fetch(e);this._decode(await i.arrayBuffer(),t)}_decode(t,e){const i=(n,r)=>{if(n)e&&e(n);else{this.parent.isLoaded=!0,this.buffer=r;const a=this.parent.autoPlayStart();e&&e(null,this.parent,a)}};t instanceof AudioBuffer?i(null,t):this.parent.context.decode(t,i)}}const Tn=class{static from(s){let t={};typeof s=="string"?t.url=s:s instanceof ArrayBuffer||s instanceof AudioBuffer||s instanceof HTMLAudioElement?t.source=s:Array.isArray(s)?t.url=s:t=s,t={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...t},Object.freeze(t);const e=Xr().useLegacy?new lw:new mw;return new Tn(e,t)}constructor(s,t){this.media=s,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=Array.isArray(t.url)?this.preferUrl(t.url):t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}preferUrl(s){const[{url:t}]=s.map(e=>({url:e,ext:It.extname(e).slice(1)})).sort((e,i)=>la.indexOf(e.ext)-la.indexOf(i.ext));return t}get context(){return Xr().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get filters(){return this.media.filters}set filters(s){this.media.filters=s}addSprites(s,t){if(typeof s=="object"){const i={};for(const n in s)i[n]=this.addSprites(n,s[n]);return i}console.assert(!this._sprites[s],`Alias ${s} is already taken`);const e=new hw(this,t);return this._sprites[s]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(s){if(s){const t=this._sprites[s];t!==void 0&&(t.destroy(),delete this._sprites[s])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let s=this._instances.length-1;s>=0;s--)this._instances[s].stop();return this}play(s,t){let e;if(typeof s=="string"?e={sprite:s,loop:this.loop,complete:t}:typeof s=="function"?(e={},e.complete=s):e=s,e={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...e||{}},e.sprite){const n=e.sprite;console.assert(!!this._sprites[n],`Alias ${n} is not available`);const r=this._sprites[n];e.start=r.start+(e.start||0),e.end=r.end,e.speed=r.speed||1,e.loop=r.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return this._preloadQueue?new Promise(n=>{this._preloadQueue.push(()=>{n(this.play(e))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=e,new Promise((n,r)=>{this._preload((a,l,o)=>{this._preloadQueue.forEach(h=>h()),this._preloadQueue=null,a?r(a):(e.loaded&&e.loaded(a,l,o),n(o))})}));(this.singleInstance||e.singleInstance)&&this._removeInstances();const i=this._createInstance();return this._instances.push(i),this.isPlaying=!0,i.once("end",()=>{e.complete&&e.complete(this),this._onComplete(i)}),i.once("stop",()=>{this._onComplete(i)}),i.play(e),i}refresh(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refresh()}refreshPaused(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}_preload(s){this.media.load(s)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let s;return this.autoPlay&&(s=this.play(this._autoPlayOptions)),s}_removeInstances(){for(let s=this._instances.length-1;s>=0;s--)this._poolInstance(this._instances[s]);this._instances.length=0}_onComplete(s){if(this._instances){const t=this._instances.indexOf(s);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(s)}_createInstance(){if(Tn._pool.length>0){const s=Tn._pool.pop();return s.init(this.media),s}return this.media.create()}_poolInstance(s){s.destroy(),Tn._pool.indexOf(s)<0&&Tn._pool.push(s)}};let ha=Tn;ha._pool=[];class pw extends Fs{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}class Yr extends Qp{constructor(){const t=window,e=new Yr.AudioContext,i=e.createDynamicsCompressor(),n=e.createAnalyser();n.connect(i),i.connect(e.destination),super(n,i),this.autoPause=!0,this._ctx=e,this._offlineCtx=new Yr.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this.compressor=i,this.analyser=n,this.events=new Fs,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=e.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){const t=this._ctx.state;(t==="suspended"||t==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){!this._locked&&this.autoPause&&(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused())}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const i=r=>{e(new Error((r==null?void 0:r.message)||"Unable to decode file"))},n=this._offlineCtx.decodeAudioData(t,r=>{e(null,r)},i);n&&n.catch(i)}}class gw{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Yr),this._htmlAudioContext=new pw,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return Yr.AudioContext!==null}add(t,e){if(typeof t=="object"){const r={};for(const a in t){const l=this._getOptions(t[a],e);r[a]=this.add(a,l)}return r}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof ha)return this._sounds[t]=e,e;const i=this._getOptions(e),n=ha.from(i);return this._sounds[t]=n,n}_getOptions(t,e){let i;return typeof t=="string"?i={url:t}:Array.isArray(t)?i={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?i={source:t}:i=t,i={...i,...e||{}},i}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(t){this._webAudioContext.autoPause=!t}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const i=!!this._sounds[t];return e&&console.assert(i,`No sound matching alias '${t}'.`),i}isPlaying(){for(const t in this._sounds)if(this._sounds[t].isPlaying)return!0;return!1}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const i=this.find(t);return e!==void 0&&(i.volume=e),i.volume}speed(t,e){const i=this.find(t);return e!==void 0&&(i.speed=e),i.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}const Af=s=>{var e;const t=s.src;return((e=s==null?void 0:s.alias)==null?void 0:e[0])??It.basename(t,It.extname(t))},xw={extension:j.Asset,detection:{test:async()=>!0,add:async s=>[...s,...la.filter(t=>yh[t])],remove:async s=>s.filter(t=>s.includes(t))},loader:{extension:{type:[j.LoadParser],priority:Ue.High},test(s){const t=It.extname(s).slice(1);return!!yh[t]||cw.some(e=>s.startsWith(`data:${e}`))},async load(s,t){const e=await new Promise((i,n)=>ha.from({...t.data,url:s,preload:!0,loaded(r,a){var l,o;r?n(r):i(a),(o=(l=t.data)==null?void 0:l.loaded)==null||o.call(l,r,a)}}));return Xr().add(Af(t),e),e},async unload(s,t){Xr().remove(Af(t))}}};J.add(xw);const eE=ow(new gw);var dt=(s=>(s[s.Region=0]="Region",s[s.BoundingBox=1]="BoundingBox",s[s.Mesh=2]="Mesh",s[s.LinkedMesh=3]="LinkedMesh",s[s.Path=4]="Path",s[s.Point=5]="Point",s[s.Clipping=6]="Clipping",s))(dt||{});class ca{constructor(t,e=new Array,i=0,n=new DataView(t.buffer)){this.strings=e,this.index=i,this.buffer=n}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){const t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){const t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),i=e&127;return e&128&&(e=this.readByte(),i|=(e&127)<<7,e&128&&(e=this.readByte(),i|=(e&127)<<14,e&128&&(e=this.readByte(),i|=(e&127)<<21,e&128&&(e=this.readByte(),i|=(e&127)<<28)))),t?i:i>>>1^-(i&1)}readStringRef(){const t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let i=0;i<t;){const n=this.readUnsignedByte();switch(n>>4){case 12:case 13:e+=String.fromCharCode((n&31)<<6|this.readByte()&63),i+=2;break;case 14:e+=String.fromCharCode((n&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),i+=3;break;default:e+=String.fromCharCode(n),i++}}return e}readFloat(){const t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}}var T=(s=>(s[s.setup=0]="setup",s[s.first=1]="first",s[s.replace=2]="replace",s[s.add=3]="add",s))(T||{}),ct=(s=>(s[s.mixIn=0]="mixIn",s[s.mixOut=1]="mixOut",s))(ct||{}),Xt=(s=>(s[s.Fixed=0]="Fixed",s[s.Percent=1]="Percent",s))(Xt||{}),qt=(s=>(s[s.Tangent=0]="Tangent",s[s.Chain=1]="Chain",s[s.ChainScale=2]="ChainScale",s))(qt||{}),it=(s=>(s[s.Normal=0]="Normal",s[s.OnlyTranslation=1]="OnlyTranslation",s[s.NoRotationOrReflection=2]="NoRotationOrReflection",s[s.NoScale=3]="NoScale",s[s.NoScaleOrReflection=4]="NoScaleOrReflection",s))(it||{});function Cf(s){switch(s.toLowerCase()){case"nearest":return Le.Nearest;case"linear":return Le.Linear;case"mipmap":return Le.MipMap;case"mipmapnearestnearest":return Le.MipMapNearestNearest;case"mipmaplinearnearest":return Le.MipMapLinearNearest;case"mipmapnearestlinear":return Le.MipMapNearestLinear;case"mipmaplinearlinear":return Le.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${s}`)}}var Le=(s=>(s[s.Nearest=9728]="Nearest",s[s.Linear=9729]="Linear",s[s.MipMap=9987]="MipMap",s[s.MipMapNearestNearest=9984]="MipMapNearestNearest",s[s.MipMapLinearNearest=9985]="MipMapLinearNearest",s[s.MipMapNearestLinear=9986]="MipMapNearestLinear",s[s.MipMapLinearLinear=9987]="MipMapLinearLinear",s))(Le||{}),qi=(s=>(s[s.MirroredRepeat=33648]="MirroredRepeat",s[s.ClampToEdge=33071]="ClampToEdge",s[s.Repeat=10497]="Repeat",s))(qi||{});class vh{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){const t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){const t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){const t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){const t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){const t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}}class yw{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}}class bh{constructor(t,e,i){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,i)}addTexture(t,e){const i=this.pages;let n=null;for(let a=0;a<i.length;a++)if(i[a].baseTexture===e.baseTexture){n=i[a];break}if(n===null){n=new Mf,n.name="texturePage";const a=e.baseTexture;n.width=a.realWidth,n.height=a.realHeight,n.baseTexture=a,n.minFilter=n.magFilter=Le.Nearest,n.uWrap=qi.ClampToEdge,n.vWrap=qi.ClampToEdge,i.push(n)}const r=new If;return r.name=t,r.page=n,r.texture=e,r.index=-1,this.regions.push(r),r}addTextureHash(t,e){for(const i in t)t.hasOwnProperty(i)&&this.addTexture(e&&i.indexOf(".")!==-1?i.substr(0,i.lastIndexOf(".")):i,t[i])}addSpineAtlas(t,e,i){return this.load(t,e,i)}load(t,e,i){if(e==null)throw new Error("textureLoader cannot be null.");const n=new _w(t),r=new Array(4);let a=null;const l={};let o=null;l.size=()=>{a.width=parseInt(r[1]),a.height=parseInt(r[2])},l.format=()=>{},l.filter=()=>{a.minFilter=Cf(r[1]),a.magFilter=Cf(r[2])},l.repeat=()=>{r[1].indexOf("x")!=-1&&(a.uWrap=qi.Repeat),r[1].indexOf("y")!=-1&&(a.vWrap=qi.Repeat)},l.pma=()=>{a.pma=r[1]=="true"};const h={};h.xy=()=>{o.x=parseInt(r[1]),o.y=parseInt(r[2])},h.size=()=>{o.width=parseInt(r[1]),o.height=parseInt(r[2])},h.bounds=()=>{o.x=parseInt(r[1]),o.y=parseInt(r[2]),o.width=parseInt(r[3]),o.height=parseInt(r[4])},h.offset=()=>{o.offsetX=parseInt(r[1]),o.offsetY=parseInt(r[2])},h.orig=()=>{o.originalWidth=parseInt(r[1]),o.originalHeight=parseInt(r[2])},h.offsets=()=>{o.offsetX=parseInt(r[1]),o.offsetY=parseInt(r[2]),o.originalWidth=parseInt(r[3]),o.originalHeight=parseInt(r[4])},h.rotate=()=>{const d=r[1];let f=0;d.toLocaleLowerCase()=="true"?f=6:d.toLocaleLowerCase()=="false"?f=0:f=(720-parseFloat(d))%360/45,o.rotate=f},h.index=()=>{o.index=parseInt(r[1])};let c=n.readLine();for(;c!=null&&c.trim().length==0;)c=n.readLine();for(;!(c==null||c.trim().length==0||n.readEntry(r,c)==0);)c=n.readLine();const u=()=>{for(;;){if(c==null)return i&&i(this);if(c.trim().length==0)a=null,c=n.readLine();else if(a===null){for(a=new Mf,a.name=c.trim();n.readEntry(r,c=n.readLine())!=0;){const d=l[r[0]];d&&d()}this.pages.push(a),e(a.name,d=>{if(d===null)return this.pages.splice(this.pages.indexOf(a),1),i&&i(null);a.baseTexture=d,a.pma&&(d.alphaMode=Je.PMA),d.valid||d.setSize(a.width,a.height),a.setFilters(),(!a.width||!a.height)&&(a.width=d.realWidth,a.height=d.realHeight,(!a.width||!a.height)&&console.log(`ERROR spine atlas page ${a.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),u()});break}else{o=new yw;const d=new If;d.name=c,d.page=a;let f=null,m=null;for(;;){const y=n.readEntry(r,c=n.readLine());if(y==0)break;const b=h[r[0]];if(b)b();else{f==null&&(f=[],m=[]),f.push(r[0]);const w=[];for(let E=0;E<y;E++)w.push(parseInt(r[E+1]));m.push(w)}}o.originalWidth==0&&o.originalHeight==0&&(o.originalWidth=o.width,o.originalHeight=o.height);const p=a.baseTexture.resolution;o.x/=p,o.y/=p,o.width/=p,o.height/=p,o.originalWidth/=p,o.originalHeight/=p,o.offsetX/=p,o.offsetY/=p;const g=o.rotate%4!==0,v=new ft(o.x,o.y,g?o.height:o.width,g?o.width:o.height),_=new ft(0,0,o.originalWidth,o.originalHeight),x=new ft(o.offsetX,o.originalHeight-o.height-o.offsetY,o.width,o.height);d.texture=new K(d.page.baseTexture,v,_,x,o.rotate),d.index=o.index,d.texture.updateUvs(),this.regions.push(d)}}};u()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}}class _w{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(e==null||(e=e.trim(),e.length==0))return 0;const i=e.indexOf(":");if(i==-1)return 0;t[0]=e.substr(0,i).trim();for(let n=1,r=i+1;;n++){const a=e.indexOf(",",r);if(a==-1)return t[n]=e.substr(r).trim(),n;if(t[n]=e.substr(r,a-r).trim(),r=a+1,n==4)return 4}}}class Mf{constructor(){this.minFilter=Le.Nearest,this.magFilter=Le.Nearest,this.uWrap=qi.ClampToEdge,this.vWrap=qi.ClampToEdge}setFilters(){const t=this.baseTexture,e=this.minFilter;e==Le.Linear?t.scaleMode=Oe.LINEAR:this.minFilter==Le.Nearest?t.scaleMode=Oe.NEAREST:(t.mipmap=cs.POW2,e==Le.MipMapNearestNearest?t.scaleMode=Oe.NEAREST:t.scaleMode=Oe.LINEAR)}}class If extends vh{}class eg{constructor(){this.array=new Array}add(t){const e=this.contains(t);return this.array[t|0]=t|0,!e}contains(t){return this.array[t|0]!=null}remove(t){this.array[t|0]=void 0}clear(){this.array.length=0}}class sg{constructor(){this.entries={},this.size=0}add(t){const e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){const e=this.size;for(let i=0,n=t.length;i<n;i++)this.add(t[i]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const un=class{constructor(s=0,t=0,e=0,i=0){this.r=s,this.g=t,this.b=e,this.a=i}set(s,t,e,i){return this.r=s,this.g=t,this.b=e,this.a=i,this.clamp()}setFromColor(s){return this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this}setFromString(s){return s=s.charAt(0)=="#"?s.substr(1):s,this.r=parseInt(s.substr(0,2),16)/255,this.g=parseInt(s.substr(2,2),16)/255,this.b=parseInt(s.substr(4,2),16)/255,this.a=s.length!=8?1:parseInt(s.substr(6,2),16)/255,this}add(s,t,e,i){return this.r+=s,this.g+=t,this.b+=e,this.a+=i,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(s,t){s.r=((t&4278190080)>>>24)/255,s.g=((t&16711680)>>>16)/255,s.b=((t&65280)>>>8)/255,s.a=(t&255)/255}static rgb888ToColor(s,t){s.r=((t&16711680)>>>16)/255,s.g=((t&65280)>>>8)/255,s.b=(t&255)/255}static fromString(s){return new un().setFromString(s)}};let H=un;H.WHITE=new un(1,1,1,1);H.RED=new un(1,0,0,1);H.GREEN=new un(0,1,0,1);H.BLUE=new un(0,0,1,1);H.MAGENTA=new un(1,0,1,1);const hi=class{static clamp(s,t,e){return s<t?t:s>e?e:s}static cosDeg(s){return Math.cos(s*hi.degRad)}static sinDeg(s){return Math.sin(s*hi.degRad)}static signum(s){return Math.sign(s)}static toInt(s){return s>0?Math.floor(s):Math.ceil(s)}static cbrt(s){const t=Math.pow(Math.abs(s),.3333333333333333);return s<0?-t:t}static randomTriangular(s,t){return hi.randomTriangularWith(s,t,(s+t)*.5)}static randomTriangularWith(s,t,e){const i=Math.random(),n=t-s;return i<=(e-s)/n?s+Math.sqrt(i*n*(e-s)):t-Math.sqrt((1-i)*n*(t-e))}static isPowerOfTwo(s){return s&&(s&s-1)===0}};let C=hi;C.PI=3.1415927;C.PI2=hi.PI*2;C.radiansToDegrees=180/hi.PI;C.radDeg=hi.radiansToDegrees;C.degreesToRadians=hi.PI/180;C.degRad=hi.degreesToRadians;let vw=class{apply(t,e,i){return t+(e-t)*this.applyInternal(i)}};class bw extends vw{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(t*2,this.power)/2:Math.pow((t-1)*2,this.power)/(this.power%2==0?-2:2)+1}}class ig extends bw{applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}}const An=class{static arrayCopy(s,t,e,i,n){for(let r=t,a=i;r<t+n;r++,a++)e[a]=s[r]}static arrayFill(s,t,e,i){for(let n=t;n<e;n++)s[n]=i}static setArraySize(s,t,e=0){const i=s.length;if(i==t)return s;if(s.length=t,i<t)for(let n=i;n<t;n++)s[n]=e;return s}static ensureArrayCapacity(s,t,e=0){return s.length>=t?s:An.setArraySize(s,t,e)}static newArray(s,t){const e=new Array(s);for(let i=0;i<s;i++)e[i]=t;return e}static newFloatArray(s){if(An.SUPPORTS_TYPED_ARRAYS)return new Float32Array(s);const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=0;return t}static newShortArray(s){if(An.SUPPORTS_TYPED_ARRAYS)return new Int16Array(s);const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=0;return t}static toFloatArray(s){return An.SUPPORTS_TYPED_ARRAYS?new Float32Array(s):s}static toSinglePrecision(s){return An.SUPPORTS_TYPED_ARRAYS?Math.fround(s):s}static webkit602BugfixHelper(s,t){}static contains(s,t,e=!0){for(let i=0;i<s.length;i++)if(s[i]==t)return!0;return!1}static enumValue(s,t){return s[t[0].toUpperCase()+t.slice(1)]}};let D=An;D.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class Pa{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class $r{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){const t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){const t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class Pc{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new Pa(()=>D.newFloatArray(16))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");const i=this.boundingBoxes,n=this.polygons,r=this.polygonPool,a=t.slots,l=a.length;i.length=0,r.freeAll(n),n.length=0;for(let o=0;o<l;o++){const h=a[o];if(!h.bone.active)continue;const c=h.getAttachment();if(c!=null&&c.type===dt.BoundingBox){const u=c;i.push(u);let d=r.obtain();d.length!=u.worldVerticesLength&&(d=D.newFloatArray(u.worldVerticesLength)),n.push(d),u.computeWorldVertices(h,0,u.worldVerticesLength,d,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const r=this.polygons;for(let a=0,l=r.length;a<l;a++){const o=r[a],h=o;for(let c=0,u=o.length;c<u;c+=2){const d=h[c],f=h[c+1];t=Math.min(t,d),e=Math.min(e,f),i=Math.max(i,d),n=Math.max(n,f)}}this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,i,n){const r=this.minX,a=this.minY,l=this.maxX,o=this.maxY;if(t<=r&&i<=r||e<=a&&n<=a||t>=l&&i>=l||e>=o&&n>=o)return!1;const h=(n-e)/(i-t);let c=h*(r-t)+e;if(c>a&&c<o||(c=h*(l-t)+e,c>a&&c<o))return!0;let u=(a-e)/h+t;return u>r&&u<l||(u=(o-e)/h+t,u>r&&u<l)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){const i=this.polygons;for(let n=0,r=i.length;n<r;n++)if(this.containsPointPolygon(i[n],t,e))return this.boundingBoxes[n];return null}containsPointPolygon(t,e,i){const n=t,r=t.length;let a=r-2,l=!1;for(let o=0;o<r;o+=2){const h=n[o+1],c=n[a+1];if(h<i&&c>=i||c<i&&h>=i){const u=n[o];u+(i-h)/(c-h)*(n[a]-u)<e&&(l=!l)}a=o}return l}intersectsSegment(t,e,i,n){const r=this.polygons;for(let a=0,l=r.length;a<l;a++)if(this.intersectsSegmentPolygon(r[a],t,e,i,n))return this.boundingBoxes[a];return null}intersectsSegmentPolygon(t,e,i,n,r){const a=t,l=t.length,o=e-n,h=i-r,c=e*r-i*n;let u=a[l-2],d=a[l-1];for(let f=0;f<l;f+=2){const m=a[f],p=a[f+1],g=u*p-d*m,v=u-m,_=d-p,x=o*_-h*v,y=(c*v-o*g)/x;if((y>=u&&y<=m||y>=m&&y<=u)&&(y>=e&&y<=n||y>=n&&y<=e)){const b=(c*_-h*g)/x;if((b>=d&&b<=p||b>=p&&b<=d)&&(b>=i&&b<=r||b>=r&&b<=i))return!0}u=m,d=p}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");const e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}const ww={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0},xi=[0,0,0];class Ew extends Bs{constructor(){super(...arguments),this.region=null,this.attachment=null}}class Sw extends Vp{constructor(t,e,i,n,r){super(t,e,i,n,r),this.region=null,this.attachment=null}}const ng=class extends fe{constructor(s){if(super(),!s)throw new Error("The spineData param is required.");if(typeof s=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=s,this.createSkeleton(s),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){const i=this.skeleton.slots[t],n=i.getAttachment(),r=this.newContainer();if(this.slotContainers.push(r),this.addChild(r),this.tempClipContainers.push(null),!!n)if(n.type===dt.Region){const a=n.name,l=this.createSprite(i,n,a);i.currentSprite=l,i.currentSpriteName=a,r.addChild(l)}else if(n.type===dt.Mesh){const a=this.createMesh(i,n);i.currentMesh=a,i.currentMeshId=n.id,i.currentMeshName=n.name,r.addChild(a)}else n.type===dt.Clipping&&(this.createGraphics(i,n),r.addChild(i.clippingContainer),r.addChild(i.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(s){var t;s!=this._debug&&((t=this._debug)==null||t.unregisterSpine(this),s==null||s.registerSpine(this),this._debug=s)}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,this.updateTransform=s?ng.prototype.autoUpdateTransform:fe.prototype.updateTransform)}get tint(){return Dn(this.tintRgb)}set tint(s){this.tintRgb=$h(s,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit<"u"?this.localDelayLimit:ww.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(s){var h;const t=this.delayLimit;if(s>t&&(s=t),this.state.update(s),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();const e=this.skeleton.slots,i=this.color;let n=null,r=null;i?(n=i.light,r=i.dark):n=this.tintRgb;for(let c=0,u=e.length;c<u;c++){const d=e[c],f=d.getAttachment(),m=this.slotContainers[c];if(!f){m.visible=!1;continue}let p=null;f.sequence&&f.sequence.apply(d,f);let g=f.region;const v=f.color;switch(f!=null&&f.type){case dt.Region:if(m.transform.setFromMatrix(d.bone.matrix),g=f.region,d.currentMesh&&(d.currentMesh.visible=!1,d.currentMesh=null,d.currentMeshId=void 0,d.currentMeshName=void 0),!g){d.currentSprite&&(d.currentSprite.renderable=!1);break}if(!d.currentSpriteName||d.currentSpriteName!==f.name){const y=f.name;if(d.currentSprite&&(d.currentSprite.visible=!1),d.sprites=d.sprites||{},d.sprites[y]!==void 0)d.sprites[y].visible=!0;else{const b=this.createSprite(d,f,y);m.addChild(b)}d.currentSprite=d.sprites[y],d.currentSpriteName=y}d.currentSprite.renderable=!0,d.hackRegion||this.setSpriteRegion(f,d.currentSprite,g),d.currentSprite.color?p=d.currentSprite.color:(xi[0]=n[0]*d.color.r*v.r,xi[1]=n[1]*d.color.g*v.g,xi[2]=n[2]*d.color.b*v.b,d.currentSprite.tint=Dn(xi)),d.currentSprite.blendMode=d.blendMode;break;case dt.Mesh:if(d.currentSprite){d.currentSprite.visible=!1,d.currentSprite=null,d.currentSpriteName=void 0;const y=new zn;y._parentID=-1,y._worldID=m.transform._worldID,m.transform=y}if(!g){d.currentMesh&&(d.currentMesh.renderable=!1);break}const x=f.id;if(d.currentMeshId===void 0||d.currentMeshId!==x){const y=x;if(d.currentMesh&&(d.currentMesh.visible=!1),d.meshes=d.meshes||{},d.meshes[y]!==void 0)d.meshes[y].visible=!0;else{const b=this.createMesh(d,f);m.addChild(b)}d.currentMesh=d.meshes[y],d.currentMeshName=f.name,d.currentMeshId=y}d.currentMesh.renderable=!0,f.computeWorldVerticesOld(d,d.currentMesh.vertices),d.currentMesh.color?p=d.currentMesh.color:(xi[0]=n[0]*d.color.r*v.r,xi[1]=n[1]*d.color.g*v.g,xi[2]=n[2]*d.color.b*v.b,d.currentMesh.tint=Dn(xi)),d.currentMesh.blendMode=d.blendMode,d.hackRegion||this.setMeshRegion(f,d.currentMesh,g);break;case dt.Clipping:d.currentGraphics||(this.createGraphics(d,f),m.addChild(d.clippingContainer),m.addChild(d.currentGraphics)),this.updateGraphics(d,f),m.alpha=1,m.visible=!0;continue;default:m.visible=!1;continue}if(m.visible=!0,p){let _=d.color.r*v.r,x=d.color.g*v.g,y=d.color.b*v.b;p.setLight(n[0]*_+r[0]*(1-_),n[1]*x+r[1]*(1-x),n[2]*y+r[2]*(1-y)),d.darkColor?(_=d.darkColor.r,x=d.darkColor.g,y=d.darkColor.b):(_=0,x=0,y=0),p.setDark(n[0]*_+r[0]*(1-_),n[1]*x+r[1]*(1-x),n[2]*y+r[2]*(1-y))}m.alpha=d.color.a}const a=this.skeleton.drawOrder;let l=null,o=null;for(let c=0,u=a.length;c<u;c++){const d=e[a[c].data.index],f=this.slotContainers[a[c].data.index];if(o||f.parent!==null&&f.parent!==this&&(f.parent.removeChild(f),f.parent=this),d.currentGraphics&&d.getAttachment())o=d.clippingContainer,l=d.getAttachment(),o.children.length=0,this.children[c]=f,l.endSlot===d.data&&(l.endSlot=null);else if(o){let m=this.tempClipContainers[c];m||(m=this.tempClipContainers[c]=this.newContainer(),m.visible=!1),this.children[c]=m,f.parent=null,o.addChild(f),l.endSlot==d.data&&(o.renderable=!0,o=null,l=null)}else this.children[c]=f}(h=this._debug)==null||h.renderDebug(this)}setSpriteRegion(s,t,e){t.attachment===s&&t.region===e||(t.region=e,t.attachment=s,t.texture=e.texture,t.rotation=s.rotation*C.degRad,t.position.x=s.x,t.position.y=s.y,t.alpha=s.color.a,e.size?(t.scale.x=e.size.width/e.originalWidth,t.scale.y=-e.size.height/e.originalHeight):(t.scale.x=s.scaleX*s.width/e.originalWidth,t.scale.y=-s.scaleY*s.height/e.originalHeight))}setMeshRegion(s,t,e){t.attachment===s&&t.region===e||(t.region=e,t.attachment=s,t.texture=e.texture,e.texture.updateUvs(),t.uvBuffer.update(s.regionUVs))}autoUpdateTransform(){{this.lastTime=this.lastTime||Date.now();const s=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(s)}fe.prototype.updateTransform.call(this)}createSprite(s,t,e){let i=t.region;s.hackAttachment===t&&(i=s.hackRegion);const n=i?i.texture:null,r=this.newSprite(n);return r.anchor.set(.5),i&&this.setSpriteRegion(t,r,t.region),s.sprites=s.sprites||{},s.sprites[e]=r,r}createMesh(s,t){let e=t.region;s.hackAttachment===t&&(e=s.hackRegion,s.hackAttachment=null,s.hackRegion=null);const i=this.newMesh(e?e.texture:null,new Float32Array(t.regionUVs.length),t.regionUVs,new Uint16Array(t.triangles),rs.TRIANGLES);return typeof i._canvasPadding<"u"&&(i._canvasPadding=1.5),i.alpha=t.color.a,i.region=t.region,e&&this.setMeshRegion(t,i,e),s.meshes=s.meshes||{},s.meshes[t.id]=i,i}createGraphics(s,t){const e=this.newGraphics(),i=new Ci([]);return e.clear(),e.beginFill(16777215,1),e.drawPolygon(i),e.renderable=!1,s.currentGraphics=e,s.clippingContainer=this.newContainer(),s.clippingContainer.mask=s.currentGraphics,e}updateGraphics(s,t){const e=s.currentGraphics.geometry,i=e.graphicsData[0].shape.points,n=t.worldVerticesLength;i.length=n,t.computeWorldVertices(s,0,n,i,0,2),e.invalidate()}hackTextureBySlotIndex(s,t=null,e=null){const i=this.skeleton.slots[s];if(!i)return!1;const n=i.getAttachment();let r=n.region;return t?(r=new vh,r.texture=t,r.size=e,i.hackRegion=r,i.hackAttachment=n):(i.hackRegion=null,i.hackAttachment=null),i.currentSprite?this.setSpriteRegion(n,i.currentSprite,r):i.currentMesh&&this.setMeshRegion(n,i.currentMesh,r),!0}hackTextureBySlotName(s,t=null,e=null){const i=this.skeleton.findSlotIndex(s);return i==-1?!1:this.hackTextureBySlotIndex(i,t,e)}hackTextureAttachment(s,t,e,i=null){const n=this.skeleton.findSlotIndex(s),r=this.skeleton.getAttachmentByName(s,t);r.region.texture=e;const a=this.skeleton.slots[n];if(!a)return!1;const l=a.getAttachment();if(t===l.name){let o=r.region;return e?(o=new vh,o.texture=e,o.size=i,a.hackRegion=o,a.hackAttachment=l):(a.hackRegion=null,a.hackAttachment=null),a.currentSprite&&a.currentSprite.region!=o?(this.setSpriteRegion(l,a.currentSprite,o),a.currentSprite.region=o):a.currentMesh&&a.currentMesh.region!=o&&this.setMeshRegion(l,a.currentMesh,o),!0}return!1}newContainer(){return new fe}newSprite(s){return new Ew(s)}newGraphics(){return new Zn}newMesh(s,t,e,i,n){return new Sw(s,t,e,i,n)}transformHack(){return 1}hackAttachmentGroups(s,t,e){if(!s)return;const i=[],n=[];for(let r=0,a=this.skeleton.slots.length;r<a;r++){const l=this.skeleton.slots[r],o=l.currentSpriteName||l.currentMeshName||"",h=l.currentSprite||l.currentMesh;o.endsWith(s)?(h.parentGroup=t,n.push(h)):e&&h&&(h.parentGroup=e,i.push(h))}return[i,n]}destroy(s){this.debug=null;for(let t=0,e=this.skeleton.slots.length;t<e;t++){const i=this.skeleton.slots[t];for(const n in i.meshes)i.meshes[n].destroy(s);i.meshes=null;for(const n in i.sprites)i.sprites[n].destroy(s);i.sprites=null}for(let t=0,e=this.slotContainers.length;t<e;t++)this.slotContainers[t].destroy(s);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(s)}};let Kn=ng;Kn.clippingPolygon=[];Object.defineProperty(Kn.prototype,"visible",{get(){return this._visible},set(s){s!==this._visible&&(this._visible=s,s&&(this.lastTime=0))}});const Tw={extension:j.Asset,loader:{extension:{type:j.LoadParser,priority:Ue.Normal},test(s){return Ve(s,".atlas")},async load(s){return await(await q.ADAPTER.fetch(s)).text()},testParse(s,t){const e=Ve(t.src,".atlas"),i=typeof s=="string";return Promise.resolve(e&&i)},async parse(s,t,e){const i=t.data;let n=It.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");let r=null,a=null;const l=new Promise((c,u)=>{r=c,a=u});let o;const h=c=>{c||a(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),r(o)};if(i.image||i.images){const c=Object.assign(i.image?{default:i.image}:{},i.images);o=new bh(s,(u,d)=>{const f=c[u]||c.default;f&&f.baseTexture?d(f.baseTexture):d(f)},h)}else o=new bh(s,rg(e,n,i.imageMetadata),h);return await l},unload(s){s.dispose()}}},rg=(s,t,e)=>async(i,n)=>{const r=It.normalize([...t.split(It.sep),i].join(It.sep)),a=await s.load({src:r,data:e});n(a.baseTexture)};J.add(Tw);function Rf(s){return s.hasOwnProperty("bones")}function Aw(s){return s instanceof ArrayBuffer}class Cw{constructor(){}installLoader(){const t=this,e={extension:j.Asset,loader:{extension:{type:j.LoadParser,priority:Ue.Normal},test(i){return Ve(i,".skel")},async load(i){return await(await q.ADAPTER.fetch(i)).arrayBuffer()},testParse(i,n){var o;const r=Ve(n.src,".json")&&Rf(i),a=Ve(n.src,".skel")&&Aw(i),l=((o=n.data)==null?void 0:o.spineAtlas)===!1;return Promise.resolve(r&&!l||a)},async parse(i,n,r){const a=It.extname(n.src).toLowerCase(),l=It.basename(n.src,a);let o=It.dirname(n.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");const h=Ve(n.src,".json")&&Rf(i);let c=null,u=i;h?c=t.createJsonParser():(c=t.createBinaryParser(),u=new Uint8Array(i));const d=n.data||{},f=(d==null?void 0:d.spineSkeletonScale)??null;f&&(c.scale=f);const m=d.spineAtlas;if(m&&m.pages)return t.parseData(c,m,u);const p=d.atlasRawData;if(p){let _=null,x=null;const y=new Promise((E,S)=>{_=E,x=S}),b=new bh(p,rg(r,o,d.imageMetadata),E=>{E||x(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),_(b)}),w=await y;return t.parseData(c,w,u)}let g=d.spineAtlasFile;g||(g=`${o+l}.atlas`);const v=await r.load({src:g,data:d,alias:d.spineAtlasAlias});return t.parseData(c,v,u)}}};return J.add(e),e}}let kc=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const og=class extends kc{constructor(t){super(t),this.id=(og.nextID++&65535)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,i,n,r,a){i=r+(i>>1)*a;const l=t.bone.skeleton,o=t.deform;let h=this.vertices;const c=this.bones;if(c==null){o.length>0&&(h=o);const m=t.bone.matrix,p=m.tx,g=m.ty,v=m.a,_=m.c,x=m.b,y=m.d;for(let b=e,w=r;w<i;b+=2,w+=a){const E=h[b],S=h[b+1];n[w]=E*v+S*_+p,n[w+1]=E*x+S*y+g}return}let u=0,d=0;for(let m=0;m<e;m+=2){const p=c[u];u+=p+1,d+=p}const f=l.bones;if(o.length==0)for(let m=r,p=d*3;m<i;m+=a){let g=0,v=0,_=c[u++];for(_+=u;u<_;u++,p+=3){const x=f[c[u]].matrix,y=h[p],b=h[p+1],w=h[p+2];g+=(y*x.a+b*x.c+x.tx)*w,v+=(y*x.b+b*x.d+x.ty)*w}n[m]=g,n[m+1]=v}else{const m=o;for(let p=r,g=d*3,v=d<<1;p<i;p+=a){let _=0,x=0,y=c[u++];for(y+=u;u<y;u++,g+=3,v+=2){const b=f[c[u]].matrix,w=h[g]+m[v],E=h[g+1]+m[v+1],S=h[g+2];_+=(w*b.a+E*b.c+b.tx)*S,x+=(w*b.b+E*b.d+b.ty)*S}n[p]=_,n[p+1]=x}}}copyTo(t){this.bones!=null?(t.bones=new Array(this.bones.length),D.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices!=null?(t.vertices=D.newFloatArray(this.vertices.length),D.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}};let Ni=og;Ni.nextID=0;let ag=class lg extends Ni{constructor(t){super(t),this.type=dt.BoundingBox,this.color=new H(1,1,1,1)}copy(){const t=new lg(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}},hg=class cg extends Ni{constructor(t){super(t),this.type=dt.Clipping,this.color=new H(.2275,.2275,.8078,1)}copy(){const t=new cg(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}},ka=class wh extends Ni{constructor(t){super(t),this.type=dt.Mesh,this.color=new H(1,1,1,1),this.tempColor=new H(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh!=null)return this.newLinkedMesh();const t=new wh(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),D.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),D.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,this.edges!=null&&(t.edges=new Array(this.edges.length),D.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}newLinkedMesh(){const t=new wh(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(this.parentMesh!=null?this.parentMesh:this),t}},Gr=class ug extends Ni{constructor(t){super(t),this.type=dt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new H(1,1,1,1)}copy(){const t=new ug(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),D.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}},dg=class fg extends Ni{constructor(t){super(t),this.type=dt.Point,this.color=new H(.38,.94,0,1)}computeWorldPosition(t,e){const i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,i=C.cosDeg(this.rotation),n=C.sinDeg(this.rotation),r=i*e.a+n*e.c,a=i*e.b+n*e.d;return Math.atan2(a,r)*C.radDeg}copy(){const t=new fg(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}},Fc=class{constructor(t,e){if(this.deform=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new H,this.darkColor=t.darkColor==null?null:new H,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const re=class extends kc{constructor(t){super(t),this.type=dt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new H(1,1,1,1),this.offset=D.newFloatArray(8),this.uvs=D.newFloatArray(8),this.tempColor=new H(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,n=-this.height/2*this.scaleY+this.region.offsetY*e,r=i+this.region.width*t,a=n+this.region.height*e,l=this.rotation*Math.PI/180,o=Math.cos(l),h=Math.sin(l),c=i*o+this.x,u=i*h,d=n*o+this.y,f=n*h,m=r*o+this.x,p=r*h,g=a*o+this.y,v=a*h,_=this.offset;_[re.OX1]=c-f,_[re.OY1]=d+u,_[re.OX2]=c-v,_[re.OY2]=g+u,_[re.OX3]=m-v,_[re.OY3]=g+p,_[re.OX4]=m-f,_[re.OY4]=d+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,i,n){const r=this.offset,a=t instanceof Fc?t.bone.matrix:t.matrix,l=a.tx,o=a.ty,h=a.a,c=a.c,u=a.b,d=a.d;let f=0,m=0;f=r[re.OX1],m=r[re.OY1],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o,i+=n,f=r[re.OX2],m=r[re.OY2],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o,i+=n,f=r[re.OX3],m=r[re.OY3],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o,i+=n,f=r[re.OX4],m=r[re.OY4],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o}copy(){const t=new re(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,D.arrayCopy(this.uvs,0,t.uvs,0,8),D.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}};let lt=re;lt.OX1=0;lt.OY1=1;lt.OX2=2;lt.OY2=3;lt.OX3=4;lt.OY3=5;lt.OX4=6;lt.OY4=7;lt.X1=0;lt.Y1=1;lt.C1R=2;lt.C1G=3;lt.C1B=4;lt.C1A=5;lt.U1=6;lt.V1=7;lt.X2=8;lt.Y2=9;lt.C2R=10;lt.C2G=11;lt.C2B=12;lt.C2A=13;lt.U2=14;lt.V2=15;lt.X3=16;lt.Y3=17;lt.C3R=18;lt.C3G=19;lt.C3B=20;lt.C3A=21;lt.U3=22;lt.V3=23;lt.X4=24;lt.Y4=25;lt.C4R=26;lt.C4G=27;lt.C4B=28;lt.C4A=29;lt.U4=30;lt.V4=31;let Mw=class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,i,n){t.x+=C.randomTriangular(-this.jitterX,this.jitterY),t.y+=C.randomTriangular(-this.jitterX,this.jitterY)}end(){}};const mg=class{constructor(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}begin(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY}transform(t,e,i,n){const r=this.angle*C.degreesToRadians,a=t.x-this.worldX,l=t.y-this.worldY,o=Math.sqrt(a*a+l*l);if(o<this.radius){const h=mg.interpolation.apply(0,r,(this.radius-o)/this.radius),c=Math.cos(h),u=Math.sin(h);t.x=c*a-u*l+this.worldX,t.y=u*a+c*l+this.worldY}}end(){}};let pg=mg;pg.interpolation=new ig(2);let Zt=class{constructor(t,e,i){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(let n=0;n<e.length;n++)this.timelineIds[e[n].getPropertyId()]=!0;this.duration=i}hasTimeline(t){return this.timelineIds[t]==!0}apply(t,e,i,n,r,a,l,o){if(t==null)throw new Error("skeleton cannot be null.");n&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));const h=this.timelines;for(let c=0,u=h.length;c<u;c++)h[c].apply(t,e,i,r,a,l,o)}static binarySearch(t,e,i=1){let n=0,r=t.length/i-2;if(r==0)return i;let a=r>>>1;for(;;){if(t[(a+1)*i]<=e?n=a+1:r=a,n==r)return(n+1)*i;a=n+r>>>1}}static linearSearch(t,e,i){for(let n=0,r=t.length-i;n<=r;n+=i)if(t[n]>e)return n;return-1}};var gg=(s=>(s[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor",s))(gg||{});const Ht=class{constructor(t){if(t<=0)throw new Error(`frameCount must be > 0: ${t}`);this.curves=D.newFloatArray((t-1)*Ht.BEZIER_SIZE)}getFrameCount(){return this.curves.length/Ht.BEZIER_SIZE+1}setLinear(t){this.curves[t*Ht.BEZIER_SIZE]=Ht.LINEAR}setStepped(t){this.curves[t*Ht.BEZIER_SIZE]=Ht.STEPPED}getCurveType(t){const e=t*Ht.BEZIER_SIZE;if(e==this.curves.length)return Ht.LINEAR;const i=this.curves[e];return i==Ht.LINEAR?Ht.LINEAR:i==Ht.STEPPED?Ht.STEPPED:Ht.BEZIER}setCurve(t,e,i,n,r){const a=(-e*2+n)*.03,l=(-i*2+r)*.03,o=((e-n)*3+1)*.006,h=((i-r)*3+1)*.006;let c=a*2+o,u=l*2+h,d=e*.3+a+o*.16666667,f=i*.3+l+h*.16666667,m=t*Ht.BEZIER_SIZE;const p=this.curves;p[m++]=Ht.BEZIER;let g=d,v=f;for(let _=m+Ht.BEZIER_SIZE-1;m<_;m+=2)p[m]=g,p[m+1]=v,d+=c,f+=u,c+=o,u+=h,g+=d,v+=f}getCurvePercent(t,e){e=C.clamp(e,0,1);const i=this.curves;let n=t*Ht.BEZIER_SIZE;const r=i[n];if(r==Ht.LINEAR)return e;if(r==Ht.STEPPED)return 0;n++;let a=0;for(let o=n,h=n+Ht.BEZIER_SIZE-1;n<h;n+=2)if(a=i[n],a>=e){let c,u;return n==o?(c=0,u=0):(c=i[n-2],u=i[n-1]),u+(i[n+1]-u)*(e-c)/(a-c)}const l=i[n-1];return l+(1-l)*(e-a)/(1-a)}};let Xe=Ht;Xe.LINEAR=0;Xe.STEPPED=1;Xe.BEZIER=2;Xe.BEZIER_SIZE=10*2-1;const yi=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+yi.ROTATION]=i}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.rotation=h.data.rotation;return;case T.first:const p=h.data.rotation-h.rotation;h.rotation+=(p-(16384-(16384.499999999996-p/360|0))*360)*r}return}if(i>=o[o.length-yi.ENTRIES]){let p=o[o.length+yi.PREV_ROTATION];switch(a){case T.setup:h.rotation=h.data.rotation+p*r;break;case T.first:case T.replace:p+=h.data.rotation-h.rotation,p-=(16384-(16384.499999999996-p/360|0))*360;case T.add:h.rotation+=p*r}return}const c=Zt.binarySearch(o,i,yi.ENTRIES),u=o[c+yi.PREV_ROTATION],d=o[c],f=this.getCurvePercent((c>>1)-1,1-(i-d)/(o[c+yi.PREV_TIME]-d));let m=o[c+yi.ROTATION]-u;switch(m=u+(m-(16384-(16384.499999999996-m/360|0))*360)*f,a){case T.setup:h.rotation=h.data.rotation+(m-(16384-(16384.499999999996-m/360|0))*360)*r;break;case T.first:case T.replace:m+=h.data.rotation-h.rotation;case T.add:h.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*r}}};let ge=yi;ge.ENTRIES=2;ge.PREV_TIME=-2;ge.PREV_ROTATION=-1;ge.ROTATION=1;const be=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*be.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(t,e,i,n){t*=be.ENTRIES,this.frames[t]=e,this.frames[t+be.X]=i,this.frames[t+be.Y]=n}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.x=h.data.x,h.y=h.data.y;return;case T.first:h.x+=(h.data.x-h.x)*r,h.y+=(h.data.y-h.y)*r}return}let c=0,u=0;if(i>=o[o.length-be.ENTRIES])c=o[o.length+be.PREV_X],u=o[o.length+be.PREV_Y];else{const d=Zt.binarySearch(o,i,be.ENTRIES);c=o[d+be.PREV_X],u=o[d+be.PREV_Y];const f=o[d],m=this.getCurvePercent(d/be.ENTRIES-1,1-(i-f)/(o[d+be.PREV_TIME]-f));c+=(o[d+be.X]-c)*m,u+=(o[d+be.Y]-u)*m}switch(a){case T.setup:h.x=h.data.x+c*r,h.y=h.data.y+u*r;break;case T.first:case T.replace:h.x+=(h.data.x+c-h.x)*r,h.y+=(h.data.y+u-h.y)*r;break;case T.add:h.x+=c*r,h.y+=u*r}}};let qe=be;qe.ENTRIES=3;qe.PREV_TIME=-3;qe.PREV_X=-2;qe.PREV_Y=-1;qe.X=1;qe.Y=2;let Bc=class ms extends qe{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case T.first:h.scaleX+=(h.data.scaleX-h.scaleX)*r,h.scaleY+=(h.data.scaleY-h.scaleY)*r}return}let c=0,u=0;if(i>=o[o.length-ms.ENTRIES])c=o[o.length+ms.PREV_X]*h.data.scaleX,u=o[o.length+ms.PREV_Y]*h.data.scaleY;else{const d=Zt.binarySearch(o,i,ms.ENTRIES);c=o[d+ms.PREV_X],u=o[d+ms.PREV_Y];const f=o[d],m=this.getCurvePercent(d/ms.ENTRIES-1,1-(i-f)/(o[d+ms.PREV_TIME]-f));c=(c+(o[d+ms.X]-c)*m)*h.data.scaleX,u=(u+(o[d+ms.Y]-u)*m)*h.data.scaleY}if(r==1)a==T.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=u-h.data.scaleY):(h.scaleX=c,h.scaleY=u);else{let d=0,f=0;if(l==ct.mixOut)switch(a){case T.setup:d=h.data.scaleX,f=h.data.scaleY,h.scaleX=d+(Math.abs(c)*C.signum(d)-d)*r,h.scaleY=f+(Math.abs(u)*C.signum(f)-f)*r;break;case T.first:case T.replace:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*C.signum(d)-d)*r,h.scaleY=f+(Math.abs(u)*C.signum(f)-f)*r;break;case T.add:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*C.signum(d)-h.data.scaleX)*r,h.scaleY=f+(Math.abs(u)*C.signum(f)-h.data.scaleY)*r}else switch(a){case T.setup:d=Math.abs(h.data.scaleX)*C.signum(c),f=Math.abs(h.data.scaleY)*C.signum(u),h.scaleX=d+(c-d)*r,h.scaleY=f+(u-f)*r;break;case T.first:case T.replace:d=Math.abs(h.scaleX)*C.signum(c),f=Math.abs(h.scaleY)*C.signum(u),h.scaleX=d+(c-d)*r,h.scaleY=f+(u-f)*r;break;case T.add:d=C.signum(c),f=C.signum(u),h.scaleX=Math.abs(h.scaleX)*d+(c-Math.abs(h.data.scaleX)*d)*r,h.scaleY=Math.abs(h.scaleY)*f+(u-Math.abs(h.data.scaleY)*f)*r}}}},Dc=class ps extends qe{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case T.first:h.shearX+=(h.data.shearX-h.shearX)*r,h.shearY+=(h.data.shearY-h.shearY)*r}return}let c=0,u=0;if(i>=o[o.length-ps.ENTRIES])c=o[o.length+ps.PREV_X],u=o[o.length+ps.PREV_Y];else{const d=Zt.binarySearch(o,i,ps.ENTRIES);c=o[d+ps.PREV_X],u=o[d+ps.PREV_Y];const f=o[d],m=this.getCurvePercent(d/ps.ENTRIES-1,1-(i-f)/(o[d+ps.PREV_TIME]-f));c=c+(o[d+ps.X]-c)*m,u=u+(o[d+ps.Y]-u)*m}switch(a){case T.setup:h.shearX=h.data.shearX+c*r,h.shearY=h.data.shearY+u*r;break;case T.first:case T.replace:h.shearX+=(h.data.shearX+c-h.shearX)*r,h.shearY+=(h.data.shearY+u-h.shearY)*r;break;case T.add:h.shearX+=c*r,h.shearY+=u*r}}};const Dt=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*Dt.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(t,e,i,n,r,a){t*=Dt.ENTRIES,this.frames[t]=e,this.frames[t+Dt.R]=i,this.frames[t+Dt.G]=n,this.frames[t+Dt.B]=r,this.frames[t+Dt.A]=a}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.color.setFromColor(o.data.color);return;case T.first:const m=o.color,p=o.data.color;m.add((p.r-m.r)*r,(p.g-m.g)*r,(p.b-m.b)*r,(p.a-m.a)*r)}return}let c=0,u=0,d=0,f=0;if(i>=h[h.length-Dt.ENTRIES]){const m=h.length;c=h[m+Dt.PREV_R],u=h[m+Dt.PREV_G],d=h[m+Dt.PREV_B],f=h[m+Dt.PREV_A]}else{const m=Zt.binarySearch(h,i,Dt.ENTRIES);c=h[m+Dt.PREV_R],u=h[m+Dt.PREV_G],d=h[m+Dt.PREV_B],f=h[m+Dt.PREV_A];const p=h[m],g=this.getCurvePercent(m/Dt.ENTRIES-1,1-(i-p)/(h[m+Dt.PREV_TIME]-p));c+=(h[m+Dt.R]-c)*g,u+=(h[m+Dt.G]-u)*g,d+=(h[m+Dt.B]-d)*g,f+=(h[m+Dt.A]-f)*g}if(r==1)o.color.set(c,u,d,f);else{const m=o.color;a==T.setup&&m.setFromColor(o.data.color),m.add((c-m.r)*r,(u-m.g)*r,(d-m.b)*r,(f-m.a)*r)}}};let Ie=Dt;Ie.ENTRIES=5;Ie.PREV_TIME=-5;Ie.PREV_R=-4;Ie.PREV_G=-3;Ie.PREV_B=-2;Ie.PREV_A=-1;Ie.R=1;Ie.G=2;Ie.B=3;Ie.A=4;const yt=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*yt.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(t,e,i,n,r,a,l,o,h){t*=yt.ENTRIES,this.frames[t]=e,this.frames[t+yt.R]=i,this.frames[t+yt.G]=n,this.frames[t+yt.B]=r,this.frames[t+yt.A]=a,this.frames[t+yt.R2]=l,this.frames[t+yt.G2]=o,this.frames[t+yt.B2]=h}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.color.setFromColor(o.data.color),o.darkColor.setFromColor(o.data.darkColor);return;case T.first:const v=o.color,_=o.darkColor,x=o.data.color,y=o.data.darkColor;v.add((x.r-v.r)*r,(x.g-v.g)*r,(x.b-v.b)*r,(x.a-v.a)*r),_.add((y.r-_.r)*r,(y.g-_.g)*r,(y.b-_.b)*r,0)}return}let c=0,u=0,d=0,f=0,m=0,p=0,g=0;if(i>=h[h.length-yt.ENTRIES]){const v=h.length;c=h[v+yt.PREV_R],u=h[v+yt.PREV_G],d=h[v+yt.PREV_B],f=h[v+yt.PREV_A],m=h[v+yt.PREV_R2],p=h[v+yt.PREV_G2],g=h[v+yt.PREV_B2]}else{const v=Zt.binarySearch(h,i,yt.ENTRIES);c=h[v+yt.PREV_R],u=h[v+yt.PREV_G],d=h[v+yt.PREV_B],f=h[v+yt.PREV_A],m=h[v+yt.PREV_R2],p=h[v+yt.PREV_G2],g=h[v+yt.PREV_B2];const _=h[v],x=this.getCurvePercent(v/yt.ENTRIES-1,1-(i-_)/(h[v+yt.PREV_TIME]-_));c+=(h[v+yt.R]-c)*x,u+=(h[v+yt.G]-u)*x,d+=(h[v+yt.B]-d)*x,f+=(h[v+yt.A]-f)*x,m+=(h[v+yt.R2]-m)*x,p+=(h[v+yt.G2]-p)*x,g+=(h[v+yt.B2]-g)*x}if(r==1)o.color.set(c,u,d,f),o.darkColor.set(m,p,g,1);else{const v=o.color,_=o.darkColor;a==T.setup&&(v.setFromColor(o.data.color),_.setFromColor(o.data.darkColor)),v.add((c-v.r)*r,(u-v.g)*r,(d-v.b)*r,(f-v.a)*r),_.add((m-_.r)*r,(p-_.g)*r,(g-_.b)*r,0)}}};let Kt=yt;Kt.ENTRIES=8;Kt.PREV_TIME=-8;Kt.PREV_R=-7;Kt.PREV_G=-6;Kt.PREV_B=-5;Kt.PREV_A=-4;Kt.PREV_R2=-3;Kt.PREV_G2=-2;Kt.PREV_B2=-1;Kt.R=1;Kt.G=2;Kt.B=3;Kt.A=4;Kt.R2=5;Kt.G2=6;Kt.B2=7;let Zi=class{constructor(t){this.frames=D.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;if(l==ct.mixOut){a==T.setup&&this.setAttachment(t,o,o.data.attachmentName);return}const h=this.frames;if(i<h[0]){(a==T.setup||a==T.first)&&this.setAttachment(t,o,o.data.attachmentName);return}let c=0;i>=h[h.length-1]?c=h.length-1:c=Zt.binarySearch(h,i,1)-1;const u=this.attachmentNames[c];t.slots[this.slotIndex].setAttachment(u==null?null:t.getAttachment(this.slotIndex,u))}setAttachment(t,e,i){e.setAttachment(i==null?null:t.getAttachment(this.slotIndex,i))}},Pf=null,Nc=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t),this.frameVertices=new Array(t),Pf==null&&(Pf=D.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,i){this.frames[t]=e,this.frameVertices[t]=i}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=o.getAttachment();if(!(h instanceof Ni)||h.deformAttachment!=this.attachment)return;const c=o.deform;c.length==0&&(a=T.setup);const u=this.frameVertices,d=u[0].length,f=this.frames;if(i<f[0]){const y=h;switch(a){case T.setup:c.length=0;return;case T.first:if(r==1){c.length=0;break}const b=D.setArraySize(c,d);if(y.bones==null){const w=y.vertices;for(let E=0;E<d;E++)b[E]+=(w[E]-b[E])*r}else{r=1-r;for(let w=0;w<d;w++)b[w]*=r}}return}const m=D.setArraySize(c,d);if(i>=f[f.length-1]){const y=u[f.length-1];if(r==1)if(a==T.add){const b=h;if(b.bones==null){const w=b.vertices;for(let E=0;E<d;E++)m[E]+=y[E]-w[E]}else for(let w=0;w<d;w++)m[w]+=y[w]}else D.arrayCopy(y,0,m,0,d);else switch(a){case T.setup:{const w=h;if(w.bones==null){const E=w.vertices;for(let S=0;S<d;S++){const A=E[S];m[S]=A+(y[S]-A)*r}}else for(let E=0;E<d;E++)m[E]=y[E]*r;break}case T.first:case T.replace:for(let w=0;w<d;w++)m[w]+=(y[w]-m[w])*r;break;case T.add:const b=h;if(b.bones==null){const w=b.vertices;for(let E=0;E<d;E++)m[E]+=(y[E]-w[E])*r}else for(let w=0;w<d;w++)m[w]+=y[w]*r}return}const p=Zt.binarySearch(f,i),g=u[p-1],v=u[p],_=f[p],x=this.getCurvePercent(p-1,1-(i-_)/(f[p-1]-_));if(r==1)if(a==T.add){const y=h;if(y.bones==null){const b=y.vertices;for(let w=0;w<d;w++){const E=g[w];m[w]+=E+(v[w]-E)*x-b[w]}}else for(let b=0;b<d;b++){const w=g[b];m[b]+=w+(v[b]-w)*x}}else for(let y=0;y<d;y++){const b=g[y];m[y]=b+(v[y]-b)*x}else switch(a){case T.setup:{const b=h;if(b.bones==null){const w=b.vertices;for(let E=0;E<d;E++){const S=g[E],A=w[E];m[E]=A+(S+(v[E]-S)*x-A)*r}}else for(let w=0;w<d;w++){const E=g[w];m[w]=(E+(v[w]-E)*x)*r}break}case T.first:case T.replace:for(let b=0;b<d;b++){const w=g[b];m[b]+=(w+(v[b]-w)*x-m[b])*r}break;case T.add:const y=h;if(y.bones==null){const b=y.vertices;for(let w=0;w<d;w++){const E=g[w];m[w]+=(E+(v[w]-E)*x-b[w])*r}}else for(let b=0;b<d;b++){const w=g[b];m[b]+=(w+(v[b]-w)*x)*r}}}},Fa=class{constructor(t){this.frames=D.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,i,n,r,a,l){if(n==null)return;const o=this.frames,h=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,n,r,a,l),e=-1;else if(e>=o[h-1])return;if(i<o[0])return;let c=0;if(e<o[0])c=0;else{c=Zt.binarySearch(o,e);const u=o[c];for(;c>0&&o[c-1]==u;)c--}for(;c<h&&i>=o[c];c++)n.push(this.events[c])}},Ln=class{constructor(t){this.frames=D.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.drawOrders[t]=i}apply(t,e,i,n,r,a,l){const o=t.drawOrder,h=t.slots;if(l==ct.mixOut&&a==T.setup){D.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const c=this.frames;if(i<c[0]){(a==T.setup||a==T.first)&&D.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let u=0;i>=c[c.length-1]?u=c.length-1:u=Zt.binarySearch(c,i)-1;const d=this.drawOrders[u];if(d==null)D.arrayCopy(h,0,o,0,h.length);else for(let f=0,m=d.length;f<m;f++)o[f]=h[d[f]]}};const Et=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*Et.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(t,e,i,n,r,a,l){t*=Et.ENTRIES,this.frames[t]=e,this.frames[t+Et.MIX]=i,this.frames[t+Et.SOFTNESS]=n,this.frames[t+Et.BEND_DIRECTION]=r,this.frames[t+Et.COMPRESS]=a?1:0,this.frames[t+Et.STRETCH]=l?1:0}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.ikConstraints[this.ikConstraintIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch;return;case T.first:h.mix+=(h.data.mix-h.mix)*r,h.softness+=(h.data.softness-h.softness)*r,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}return}if(i>=o[o.length-Et.ENTRIES]){a==T.setup?(h.mix=h.data.mix+(o[o.length+Et.PREV_MIX]-h.data.mix)*r,h.softness=h.data.softness+(o[o.length+Et.PREV_SOFTNESS]-h.data.softness)*r,l==ct.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=o[o.length+Et.PREV_BEND_DIRECTION],h.compress=o[o.length+Et.PREV_COMPRESS]!=0,h.stretch=o[o.length+Et.PREV_STRETCH]!=0)):(h.mix+=(o[o.length+Et.PREV_MIX]-h.mix)*r,h.softness+=(o[o.length+Et.PREV_SOFTNESS]-h.softness)*r,l==ct.mixIn&&(h.bendDirection=o[o.length+Et.PREV_BEND_DIRECTION],h.compress=o[o.length+Et.PREV_COMPRESS]!=0,h.stretch=o[o.length+Et.PREV_STRETCH]!=0));return}const c=Zt.binarySearch(o,i,Et.ENTRIES),u=o[c+Et.PREV_MIX],d=o[c+Et.PREV_SOFTNESS],f=o[c],m=this.getCurvePercent(c/Et.ENTRIES-1,1-(i-f)/(o[c+Et.PREV_TIME]-f));a==T.setup?(h.mix=h.data.mix+(u+(o[c+Et.MIX]-u)*m-h.data.mix)*r,h.softness=h.data.softness+(d+(o[c+Et.SOFTNESS]-d)*m-h.data.softness)*r,l==ct.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=o[c+Et.PREV_BEND_DIRECTION],h.compress=o[c+Et.PREV_COMPRESS]!=0,h.stretch=o[c+Et.PREV_STRETCH]!=0)):(h.mix+=(u+(o[c+Et.MIX]-u)*m-h.mix)*r,h.softness+=(d+(o[c+Et.SOFTNESS]-d)*m-h.softness)*r,l==ct.mixIn&&(h.bendDirection=o[c+Et.PREV_BEND_DIRECTION],h.compress=o[c+Et.PREV_COMPRESS]!=0,h.stretch=o[c+Et.PREV_STRETCH]!=0))}};let xe=Et;xe.ENTRIES=6;xe.PREV_TIME=-6;xe.PREV_MIX=-5;xe.PREV_SOFTNESS=-4;xe.PREV_BEND_DIRECTION=-3;xe.PREV_COMPRESS=-2;xe.PREV_STRETCH=-1;xe.MIX=1;xe.SOFTNESS=2;xe.BEND_DIRECTION=3;xe.COMPRESS=4;xe.STRETCH=5;const Nt=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*Nt.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(t,e,i,n,r,a){t*=Nt.ENTRIES,this.frames[t]=e,this.frames[t+Nt.ROTATE]=i,this.frames[t+Nt.TRANSLATE]=n,this.frames[t+Nt.SCALE]=r,this.frames[t+Nt.SHEAR]=a}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.transformConstraints[this.transformConstraintIndex];if(!h.active)return;if(i<o[0]){const m=h.data;switch(a){case T.setup:h.rotateMix=m.rotateMix,h.translateMix=m.translateMix,h.scaleMix=m.scaleMix,h.shearMix=m.shearMix;return;case T.first:h.rotateMix+=(m.rotateMix-h.rotateMix)*r,h.translateMix+=(m.translateMix-h.translateMix)*r,h.scaleMix+=(m.scaleMix-h.scaleMix)*r,h.shearMix+=(m.shearMix-h.shearMix)*r}return}let c=0,u=0,d=0,f=0;if(i>=o[o.length-Nt.ENTRIES]){const m=o.length;c=o[m+Nt.PREV_ROTATE],u=o[m+Nt.PREV_TRANSLATE],d=o[m+Nt.PREV_SCALE],f=o[m+Nt.PREV_SHEAR]}else{const m=Zt.binarySearch(o,i,Nt.ENTRIES);c=o[m+Nt.PREV_ROTATE],u=o[m+Nt.PREV_TRANSLATE],d=o[m+Nt.PREV_SCALE],f=o[m+Nt.PREV_SHEAR];const p=o[m],g=this.getCurvePercent(m/Nt.ENTRIES-1,1-(i-p)/(o[m+Nt.PREV_TIME]-p));c+=(o[m+Nt.ROTATE]-c)*g,u+=(o[m+Nt.TRANSLATE]-u)*g,d+=(o[m+Nt.SCALE]-d)*g,f+=(o[m+Nt.SHEAR]-f)*g}if(a==T.setup){const m=h.data;h.rotateMix=m.rotateMix+(c-m.rotateMix)*r,h.translateMix=m.translateMix+(u-m.translateMix)*r,h.scaleMix=m.scaleMix+(d-m.scaleMix)*r,h.shearMix=m.shearMix+(f-m.shearMix)*r}else h.rotateMix+=(c-h.rotateMix)*r,h.translateMix+=(u-h.translateMix)*r,h.scaleMix+=(d-h.scaleMix)*r,h.shearMix+=(f-h.shearMix)*r}};let Re=Nt;Re.ENTRIES=5;Re.PREV_TIME=-5;Re.PREV_ROTATE=-4;Re.PREV_TRANSLATE=-3;Re.PREV_SCALE=-2;Re.PREV_SHEAR=-1;Re.ROTATE=1;Re.TRANSLATE=2;Re.SCALE=3;Re.SHEAR=4;const gs=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*gs.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(t,e,i){t*=gs.ENTRIES,this.frames[t]=e,this.frames[t+gs.VALUE]=i}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.position=h.data.position;return;case T.first:h.position+=(h.data.position-h.position)*r}return}let c=0;if(i>=o[o.length-gs.ENTRIES])c=o[o.length+gs.PREV_VALUE];else{const u=Zt.binarySearch(o,i,gs.ENTRIES);c=o[u+gs.PREV_VALUE];const d=o[u],f=this.getCurvePercent(u/gs.ENTRIES-1,1-(i-d)/(o[u+gs.PREV_TIME]-d));c+=(o[u+gs.VALUE]-c)*f}a==T.setup?h.position=h.data.position+(c-h.data.position)*r:h.position+=(c-h.position)*r}};let js=gs;js.ENTRIES=2;js.PREV_TIME=-2;js.PREV_VALUE=-1;js.VALUE=1;let Lc=class _i extends js{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.spacing=h.data.spacing;return;case T.first:h.spacing+=(h.data.spacing-h.spacing)*r}return}let c=0;if(i>=o[o.length-_i.ENTRIES])c=o[o.length+_i.PREV_VALUE];else{const u=Zt.binarySearch(o,i,_i.ENTRIES);c=o[u+_i.PREV_VALUE];const d=o[u],f=this.getCurvePercent(u/_i.ENTRIES-1,1-(i-d)/(o[u+_i.PREV_TIME]-d));c+=(o[u+_i.VALUE]-c)*f}a==T.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*r:h.spacing+=(c-h.spacing)*r}};const we=class extends Xe{constructor(t){super(t),this.frames=D.newFloatArray(t*we.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(t,e,i,n){t*=we.ENTRIES,this.frames[t]=e,this.frames[t+we.ROTATE]=i,this.frames[t+we.TRANSLATE]=n}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(i<o[0]){switch(a){case T.setup:h.rotateMix=h.data.rotateMix,h.translateMix=h.data.translateMix;return;case T.first:h.rotateMix+=(h.data.rotateMix-h.rotateMix)*r,h.translateMix+=(h.data.translateMix-h.translateMix)*r}return}let c=0,u=0;if(i>=o[o.length-we.ENTRIES])c=o[o.length+we.PREV_ROTATE],u=o[o.length+we.PREV_TRANSLATE];else{const d=Zt.binarySearch(o,i,we.ENTRIES);c=o[d+we.PREV_ROTATE],u=o[d+we.PREV_TRANSLATE];const f=o[d],m=this.getCurvePercent(d/we.ENTRIES-1,1-(i-f)/(o[d+we.PREV_TIME]-f));c+=(o[d+we.ROTATE]-c)*m,u+=(o[d+we.TRANSLATE]-u)*m}a==T.setup?(h.rotateMix=h.data.rotateMix+(c-h.data.rotateMix)*r,h.translateMix=h.data.translateMix+(u-h.data.translateMix)*r):(h.rotateMix+=(c-h.rotateMix)*r,h.translateMix+=(u-h.translateMix)*r)}};let Is=we;Is.ENTRIES=3;Is.PREV_TIME=-3;Is.PREV_ROTATE=-2;Is.PREV_TRANSLATE=-1;Is.ROTATE=1;Is.TRANSLATE=2;const Lt=class{constructor(t){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Oc(this),this.propertyIDs=new eg,this.animationsChanged=!1,this.trackEntryPool=new Pa(()=>new Ba),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r==null)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let a=t*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}let l=r.next;if(l!=null){const o=r.trackLast-l.delay;if(o>=0){for(l.delay=0,l.trackTime+=r.timeScale==0?0:(o/r.timeScale+t)*l.timeScale,r.trackTime+=a,this.setCurrent(i,l,!0);l.mixingFrom!=null;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&r.mixingFrom==null){e[i]=null,this.queue.end(r),this.disposeNext(r);continue}if(r.mixingFrom!=null&&this.updateMixingFrom(r,t)){let o=r.mixingFrom;for(r.mixingFrom=null,o!=null&&(o.mixingTo=null);o!=null;)this.queue.end(o),o=o.mixingFrom}r.trackTime+=a}this.queue.drain()}updateMixingFrom(t,e){const i=t.mixingFrom;if(i==null)return!0;const n=this.updateMixingFrom(i,e);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((i.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=i.mixingFrom,i.mixingFrom!=null&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),n):(i.trackTime+=e*i.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,i=this.tracks;let n=!1;for(let l=0,o=i.length;l<o;l++){const h=i[l];if(h==null||h.delay>0)continue;n=!0;const c=l==0?T.first:h.mixBlend;let u=h.alpha;h.mixingFrom!=null?u*=this.applyMixingFrom(h,t,c):h.trackTime>=h.trackEnd&&h.next==null&&(u=0);const d=h.animationLast,f=h.getAnimationTime(),m=h.animation.timelines.length,p=h.animation.timelines;if(l==0&&u==1||c==T.add)for(let g=0;g<m;g++){const v=p[g];v instanceof Zi?this.applyAttachmentTimeline(v,t,f,c,!0):v.apply(t,d,f,e,u,c,ct.mixIn)}else{const g=h.timelineMode,v=h.timelinesRotation.length==0;v&&D.setArraySize(h.timelinesRotation,m<<1,null);const _=h.timelinesRotation;for(let x=0;x<m;x++){const y=p[x],b=g[x]==Lt.SUBSEQUENT?c:T.setup;y instanceof ge?this.applyRotateTimeline(y,t,f,u,b,_,x<<1,v):y instanceof Zi?this.applyAttachmentTimeline(y,t,f,c,!0):y.apply(t,d,f,e,u,b,ct.mixIn)}}this.queueEvents(h,f),e.length=0,h.nextAnimationLast=f,h.nextTrackLast=h.trackTime}const r=this.unkeyedState+Lt.SETUP,a=t.slots;for(let l=0,o=t.slots.length;l<o;l++){const h=a[l];if(h.attachmentState==r){const c=h.data.attachmentName;h.setAttachment(c==null?null:t.getAttachment(h.data.index,c))}}return this.unkeyedState+=2,this.queue.drain(),n}applyMixingFrom(t,e,i){const n=t.mixingFrom;n.mixingFrom!=null&&this.applyMixingFrom(n,e,i);let r=0;t.mixDuration==0?(r=1,i==T.first&&(i=T.setup)):(r=t.mixTime/t.mixDuration,r>1&&(r=1),i!=T.first&&(i=n.mixBlend));const a=r<n.eventThreshold?this.events:null,l=r<n.attachmentThreshold,o=r<n.drawOrderThreshold,h=n.animationLast,c=n.getAnimationTime(),u=n.animation.timelines.length,d=n.animation.timelines,f=n.alpha*t.interruptAlpha,m=f*(1-r);if(i==T.add)for(let p=0;p<u;p++)d[p].apply(e,h,c,a,m,i,ct.mixOut);else{const p=n.timelineMode,g=n.timelineHoldMix,v=n.timelinesRotation.length==0;v&&D.setArraySize(n.timelinesRotation,u<<1,null);const _=n.timelinesRotation;n.totalAlpha=0;for(let x=0;x<u;x++){const y=d[x];let b=ct.mixOut,w,E=0;switch(p[x]){case Lt.SUBSEQUENT:if(!o&&y instanceof Ln)continue;w=i,E=m;break;case Lt.FIRST:w=T.setup,E=m;break;case Lt.HOLD_SUBSEQUENT:w=i,E=f;break;case Lt.HOLD_FIRST:w=T.setup,E=f;break;default:w=T.setup;const S=g[x];E=f*Math.max(0,1-S.mixTime/S.mixDuration);break}n.totalAlpha+=E,y instanceof ge?this.applyRotateTimeline(y,e,c,E,w,_,x<<1,v):y instanceof Zi?this.applyAttachmentTimeline(y,e,c,w,l):(o&&y instanceof Ln&&w==T.setup&&(b=ct.mixIn),y.apply(e,h,c,a,E,w,b))}}return t.mixDuration>0&&this.queueEvents(n,c),this.events.length=0,n.nextAnimationLast=c,n.nextTrackLast=n.trackTime,r}applyAttachmentTimeline(t,e,i,n,r){const a=e.slots[t.slotIndex];if(!a.bone.active)return;const l=t.frames;if(i<l[0])(n==T.setup||n==T.first)&&this.setAttachment(e,a,a.data.attachmentName,r);else{let o;i>=l[l.length-1]?o=l.length-1:o=Zt.binarySearch(l,i)-1,this.setAttachment(e,a,t.attachmentNames[o],r)}a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+Lt.SETUP)}setAttachment(t,e,i,n){e.setAttachment(i==null?null:t.getAttachment(e.data.index,i)),n&&(e.attachmentState=this.unkeyedState+Lt.CURRENT)}applyRotateTimeline(t,e,i,n,r,a,l,o){if(o&&(a[l]=0),n==1){t.apply(e,0,i,null,1,r,ct.mixIn);return}const h=t,c=h.frames,u=e.bones[h.boneIndex];if(!u.active)return;let d=0,f=0;if(i<c[0])switch(r){case T.setup:u.rotation=u.data.rotation;default:return;case T.first:d=u.rotation,f=u.data.rotation}else if(d=r==T.setup?u.data.rotation:u.rotation,i>=c[c.length-ge.ENTRIES])f=u.data.rotation+c[c.length+ge.PREV_ROTATION];else{const g=Zt.binarySearch(c,i,ge.ENTRIES),v=c[g+ge.PREV_ROTATION],_=c[g],x=h.getCurvePercent((g>>1)-1,1-(i-_)/(c[g+ge.PREV_TIME]-_));f=c[g+ge.ROTATION]-v,f-=(16384-(16384.499999999996-f/360|0))*360,f=v+f*x+u.data.rotation,f-=(16384-(16384.499999999996-f/360|0))*360}let m=0,p=f-d;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)m=a[l];else{let g=0,v=0;o?(g=0,v=p):(g=a[l],v=a[l+1]);const _=p>0;let x=g>=0;C.signum(v)!=C.signum(p)&&Math.abs(v)<=90&&(Math.abs(g)>180&&(g+=360*C.signum(g)),x=_),m=p+g-g%360,x!=_&&(m+=360*C.signum(g)),a[l]=m}a[l+1]=p,d+=m*n,u.rotation=d-(16384-(16384.499999999996-d/360|0))*360}queueEvents(t,e){const i=t.animationStart,n=t.animationEnd,r=n-i,a=t.trackLast%r,l=this.events;let o=0;const h=l.length;for(;o<h;o++){const u=l[o];if(u.time<a)break;u.time>n||this.queue.event(t,u)}let c=!1;for(t.loop?c=r==0||a>t.trackTime%r:c=e>=n&&t.animationLast<n,c&&this.queue.complete(t);o<h;o++)l[o].time<i||this.queue.event(t,l[o])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let i=e;for(;;){const n=i.mixingFrom;if(n==null)break;this.queue.end(n),i.mixingFrom=null,i.mixingTo=null,i=n}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,i){const n=this.expandToIndex(t);this.tracks[t]=e,n!=null&&(i&&this.queue.interrupt(n),e.mixingFrom=n,n.mixingTo=e,e.mixTime=0,n.mixingFrom!=null&&n.mixDuration>0&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,i){const n=this.data.skeletonData.findAnimation(e);if(n==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,n,i)}setAnimationWith(t,e,i){if(e==null)throw new Error("animation cannot be null.");let n=!0,r=this.expandToIndex(t);r!=null&&(r.nextTrackLast==-1?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,n=!1):this.disposeNext(r));const a=this.trackEntry(t,e,i,r);return this.setCurrent(t,a,n),this.queue.drain(),a}addAnimation(t,e,i,n){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,r,i,n)}addAnimationWith(t,e,i,n){if(e==null)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r!=null)for(;r.next!=null;)r=r.next;const a=this.trackEntry(t,e,i,r);if(r==null)this.setCurrent(t,a,!0),this.queue.drain();else if(r.next=a,n<=0){const l=r.animationEnd-r.animationStart;l!=0?(r.loop?n+=l*(1+(r.trackTime/l|0)):n+=Math.max(l,r.trackTime),n-=this.data.getMix(r.animation,e)):n=r.trackTime}return a.delay=n,a}setEmptyAnimation(t,e){const i=this.setAnimationWith(t,Lt.emptyAnimation,!1);return i.mixDuration=e,i.trackEnd=e,i}addEmptyAnimation(t,e,i){i<=0&&(i-=e);const n=this.addAnimationWith(t,Lt.emptyAnimation,!1,i);return n.mixDuration=e,n.trackEnd=e,n}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,n=this.tracks.length;i<n;i++){const r=this.tracks[i];r!=null&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(D.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,i,n){const r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=i,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=n==null?0:this.data.getMix(n.animation,e),r.mixBlend=T.replace,r}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let i=this.tracks[t];if(i!=null){for(;i.mixingFrom!=null;)i=i.mixingFrom;do(i.mixingFrom==null||i.mixBlend!=T.add)&&this.computeHold(i),i=i.mixingTo;while(i!=null)}}}computeHold(t){const e=t.mixingTo,i=t.animation.timelines,n=t.animation.timelines.length,r=D.setArraySize(t.timelineMode,n);t.timelineHoldMix.length=0;const a=D.setArraySize(t.timelineHoldMix,n),l=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let o=0;o<n;o++)r[o]=l.add(i[o].getPropertyId())?Lt.HOLD_FIRST:Lt.HOLD_SUBSEQUENT;return}t:for(let o=0;o<n;o++){const h=i[o],c=h.getPropertyId();if(!l.add(c))r[o]=Lt.SUBSEQUENT;else if(e==null||h instanceof Zi||h instanceof Ln||h instanceof Fa||!e.animation.hasTimeline(c))r[o]=Lt.FIRST;else{for(let u=e.mixingTo;u!=null;u=u.mixingTo)if(!u.animation.hasTimeline(c)){if(t.mixDuration>0){r[o]=Lt.HOLD_MIX,a[o]=u;continue t}break}r[o]=Lt.HOLD_FIRST}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,i){Lt.deprecatedWarning1||(Lt.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,i)}addAnimationByName(t,e,i,n){Lt.deprecatedWarning2||(Lt.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,i,n)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return Lt.deprecatedWarning3||(Lt.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let ts=Lt;ts.emptyAnimation=new Zt("<empty>",[],0);ts.SUBSEQUENT=0;ts.FIRST=1;ts.HOLD_SUBSEQUENT=2;ts.HOLD_FIRST=3;ts.HOLD_MIX=4;ts.SETUP=1;ts.CURRENT=2;ts.deprecatedWarning1=!1;ts.deprecatedWarning2=!1;ts.deprecatedWarning3=!1;const si=class{constructor(){this.mixBlend=T.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return si.deprecatedWarning1||(si.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){si.deprecatedWarning1||(si.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return si.deprecatedWarning2||(si.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){si.deprecatedWarning2||(si.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Ba=si;Ba.deprecatedWarning1=!1;Ba.deprecatedWarning2=!1;const Eh=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(Fe.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(Fe.interrupt),this.objects.push(t)}end(t){this.objects.push(Fe.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(Fe.dispose),this.objects.push(t)}complete(t){this.objects.push(Fe.complete),this.objects.push(t)}event(t,e){this.objects.push(Fe.event),this.objects.push(t),this.objects.push(e)}deprecateStuff(){return Eh.deprecatedWarning1||(Eh.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){const n=t[i],r=t[i+1];switch(n){case Fe.start:r.listener!=null&&r.listener.start&&r.listener.start(r);for(let o=0;o<e.length;o++)e[o].start&&e[o].start(r);r.onStart&&this.deprecateStuff()&&r.onStart(r.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(r.trackIndex);break;case Fe.interrupt:r.listener!=null&&r.listener.interrupt&&r.listener.interrupt(r);for(let o=0;o<e.length;o++)e[o].interrupt&&e[o].interrupt(r);break;case Fe.end:r.listener!=null&&r.listener.end&&r.listener.end(r);for(let o=0;o<e.length;o++)e[o].end&&e[o].end(r);r.onEnd&&this.deprecateStuff()&&r.onEnd(r.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(r.trackIndex);case Fe.dispose:r.listener!=null&&r.listener.dispose&&r.listener.dispose(r);for(let o=0;o<e.length;o++)e[o].dispose&&e[o].dispose(r);this.animState.trackEntryPool.free(r);break;case Fe.complete:r.listener!=null&&r.listener.complete&&r.listener.complete(r);for(let o=0;o<e.length;o++)e[o].complete&&e[o].complete(r);const a=C.toInt(r.loopsCount());r.onComplete&&this.deprecateStuff()&&r.onComplete(r.trackIndex,a),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(r.trackIndex,a);break;case Fe.event:const l=t[i+++2];r.listener!=null&&r.listener.event&&r.listener.event(r,l);for(let o=0;o<e.length;o++)e[o].event&&e[o].event(r,l);r.onEvent&&this.deprecateStuff()&&r.onEvent(r.trackIndex,l),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(r.trackIndex,l);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let Oc=Eh;Oc.deprecatedWarning1=!1;var Fe=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(Fe||{});let Iw=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}};const Sh=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,t==null)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){const n=this.skeletonData.findAnimation(t);if(n==null)throw new Error(`Animation not found: ${t}`);const r=this.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);this.setMixWith(n,r,i)}setMixByName(t,e,i){Sh.deprecatedWarning1||(Sh.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(t,e,i)}setMixWith(t,e,i){if(t==null)throw new Error("from cannot be null.");if(e==null)throw new Error("to cannot be null.");const n=`${t.name}.${e.name}`;this.animationToMixTime[n]=i}getMix(t,e){const i=`${t.name}.${e.name}`,n=this.animationToMixTime[i];return n===void 0?this.defaultMix:n}};let Vc=Sh;Vc.deprecatedWarning1=!1;let Uc=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,i){const n=this.atlas.findRegion(i);if(n==null)throw new Error(`Region not found in atlas: ${i} (region attachment: ${e})`);const r=new lt(e);return r.region=n,r}newMeshAttachment(t,e,i){const n=this.atlas.findRegion(i);if(n==null)throw new Error(`Region not found in atlas: ${i} (mesh attachment: ${e})`);const r=new ka(e);return r.region=n,r}newBoundingBoxAttachment(t,e){return new ag(e)}newPathAttachment(t,e){return new Gr(e)}newPointAttachment(t,e){return new dg(e)}newClippingAttachment(t,e){return new hg(e)}},Th=class{constructor(t,e,i){if(this.matrix=new Rt,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,n,r,a,l){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=n,this.ascaleY=r,this.ashearX=a,this.ashearY=l,this.appliedValid=!0;const o=this.parent,h=this.matrix,c=this.skeleton.scaleX,u=-this.skeleton.scaleY;if(o==null){const g=this.skeleton,v=i+90+l;h.a=C.cosDeg(i+a)*n*c,h.c=C.cosDeg(v)*r*c,h.b=C.sinDeg(i+a)*n*u,h.d=C.sinDeg(v)*r*u,h.tx=t*c+g.x,h.ty=e*u+g.y;return}let d=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=d*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case it.Normal:{const g=i+90+l,v=C.cosDeg(i+a)*n,_=C.cosDeg(g)*r,x=C.sinDeg(i+a)*n,y=C.sinDeg(g)*r;h.a=d*v+f*x,h.c=d*_+f*y,h.b=m*v+p*x,h.d=m*_+p*y;return}case it.OnlyTranslation:{const g=i+90+l;h.a=C.cosDeg(i+a)*n,h.c=C.cosDeg(g)*r,h.b=C.sinDeg(i+a)*n,h.d=C.sinDeg(g)*r;break}case it.NoRotationOrReflection:{let g=d*d+m*m,v=0;g>1e-4?(g=Math.abs(d*p-f*m)/g,d/=this.skeleton.scaleX,m/=this.skeleton.scaleY,f=m*g,p=d*g,v=Math.atan2(m,d)*C.radDeg):(d=0,m=0,v=90-Math.atan2(p,f)*C.radDeg);const _=i+a-v,x=i+l-v+90,y=C.cosDeg(_)*n,b=C.cosDeg(x)*r,w=C.sinDeg(_)*n,E=C.sinDeg(x)*r;h.a=d*y-f*w,h.c=d*b-f*E,h.b=m*y+p*w,h.d=m*b+p*E;break}case it.NoScale:case it.NoScaleOrReflection:{const g=C.cosDeg(i),v=C.sinDeg(i);let _=(d*g+f*v)/c,x=(m*g+p*v)/u,y=Math.sqrt(_*_+x*x);y>1e-5&&(y=1/y),_*=y,x*=y,y=Math.sqrt(_*_+x*x),this.data.transformMode==it.NoScale&&d*p-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(y=-y);const b=Math.PI/2+Math.atan2(x,_),w=Math.cos(b)*y,E=Math.sin(b)*y,S=C.cosDeg(a)*n,A=C.cosDeg(90+l)*r,M=C.sinDeg(a)*n,I=C.sinDeg(90+l)*r;h.a=_*S+w*M,h.c=_*A+w*I,h.b=x*S+E*M,h.d=x*A+E*I;break}}h.a*=c,h.c*=c,h.b*=u,h.d*=u}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*C.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*C.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*C.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*C.radDeg;return}const i=t.matrix,n=1/(i.a*i.d-i.b*i.c),r=e.tx-i.tx,a=e.ty-i.ty;this.ax=r*i.d*n-a*i.c*n,this.ay=a*i.a*n-r*i.b*n;const l=n*i.d,o=n*i.a,h=n*i.c,c=n*i.b,u=l*e.a-h*e.b,d=l*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+f*f),this.ascaleX>1e-4){const p=u*m-d*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(u*d+f*m,p)*C.radDeg,this.arotation=Math.atan2(f,u)*C.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,d)*C.radDeg}worldToLocal(t){const e=this.matrix,i=e.a,n=e.c,r=e.b,a=e.d,l=1/(i*a-n*r),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*a*l-h*n*l,t.y=h*i*l-o*r*l,t}localToWorld(t){const e=this.matrix,i=t.x,n=t.y;return t.x=i*e.a+n*e.c+e.tx,t.y=i*e.b+n*e.d+e.ty,t}worldToLocalRotation(t){const e=C.sinDeg(t),i=C.cosDeg(t),n=this.matrix;return Math.atan2(n.a*e-n.b*i,n.d*i-n.c*e)*C.radDeg}localToWorldRotation(t){const e=C.sinDeg(t),i=C.cosDeg(t),n=this.matrix;return Math.atan2(i*n.b+e*n.d,i*n.a+e*n.c)*C.radDeg}rotateWorld(t){const e=this.matrix,i=e.a,n=e.c,r=e.b,a=e.d,l=C.cosDeg(t),o=C.sinDeg(t);e.a=l*i-o*r,e.c=l*n-o*a,e.b=o*i+l*r,e.d=o*n+l*a,this.appliedValid=!1}},Xc=class{constructor(t,e,i){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=it.Normal,this.skinRequired=!1,this.color=new H,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}},Da=class{constructor(t,e,i){this.name=t,this.order=e,this.skinRequired=i}},Yc=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},$c=class{constructor(t){this.name=t}},xg=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix);break}}apply1(t,e,i,n,r,a,l){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,h=o.a;let c=o.c;const u=o.b;let d=o.d,f=-t.ashearX-t.arotation,m=0,p=0;switch(t.data.transformMode){case it.OnlyTranslation:m=e-t.worldX,p=i-t.worldY;break;case it.NoRotationOrReflection:const _=Math.abs(h*d-c*u)/(h*h+u*u),x=h/t.skeleton.scaleX,y=u/t.skeleton.scaleY;c=-y*_*t.skeleton.scaleX,d=x*_*t.skeleton.scaleY,f+=Math.atan2(y,x)*C.radDeg;default:const b=e-o.tx,w=i-o.ty,E=h*d-c*u;m=(b*d-w*c)/E-t.ax,p=(w*h-b*u)/E-t.ay}f+=Math.atan2(p,m)*C.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let g=t.ascaleX,v=t.ascaleY;if(n||r){switch(t.data.transformMode){case it.NoScale:case it.NoScaleOrReflection:m=e-t.worldX,p=i-t.worldY}const _=t.data.length*g,x=Math.sqrt(m*m+p*p);if(n&&x<_||r&&x>_&&_>1e-4){const y=(x/_-1)*l+1;g*=y,a&&(v*=y)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,g,v,t.ashearX,t.ashearY)}apply2(t,e,i,n,r,a,l,o){if(o==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const h=t.ax,c=t.ay;let u=t.ascaleX,d=u,f=t.ascaleY,m=e.ascaleX;const p=t.matrix;let g=0,v=0,_=0;u<0?(u=-u,g=180,_=-1):(g=0,_=1),f<0&&(f=-f,_=-_),m<0?(m=-m,v=180):v=0;const x=e.ax;let y=0,b=0,w=0,E=p.a,S=p.c,A=p.b,M=p.d;const I=Math.abs(u-f)<=1e-4;I?(y=e.ay,b=E*x+S*y+p.tx,w=A*x+M*y+p.ty):(y=0,b=E*x+p.tx,w=A*x+p.ty);const k=t.parent.matrix;E=k.a,S=k.c,A=k.b,M=k.d;const R=1/(E*M-S*A);let P=b-k.tx,B=w-k.ty;const L=(P*M-B*S)*R-h,O=(B*E-P*A)*R-c,G=Math.sqrt(L*L+O*O);let U=e.data.length*m,F,V;if(G<1e-4){this.apply1(t,i,n,!1,a,!1,o),e.updateWorldTransformWith(x,y,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}P=i-k.tx,B=n-k.ty;let X=(P*M-B*S)*R-h,Y=(B*E-P*A)*R-c,$=X*X+Y*Y;if(l!=0){l*=u*(m+1)/2;const st=Math.sqrt($),mt=st-G-U*u+l;if(mt>0){let ot=Math.min(1,mt/(l*2))-1;ot=(mt-l*(1-ot*ot))/st,X-=ot*X,Y-=ot*Y,$=X*X+Y*Y}}t:if(I){U*=u;let st=($-G*G-U*U)/(2*G*U);st<-1?st=-1:st>1&&(st=1,a&&(d*=(Math.sqrt($)/(G+U)-1)*o+1)),V=Math.acos(st)*r,E=G+U*st,S=U*Math.sin(V),F=Math.atan2(Y*E-X*S,X*E+Y*S)}else{E=u*U,S=f*U;const st=E*E,mt=S*S,ot=Math.atan2(Y,X);A=mt*G*G+st*$-st*mt;const xt=-2*mt*G,ut=mt-st;if(M=xt*xt-4*ut*A,M>=0){let Ge=Math.sqrt(M);xt<0&&(Ge=-Ge),Ge=-(xt+Ge)/2;const gi=Ge/ut,ye=A/Ge,Ks=Math.abs(gi)<Math.abs(ye)?gi:ye;if(Ks*Ks<=$){B=Math.sqrt($-Ks*Ks)*r,F=ot-Math.atan2(B,Ks),V=Math.atan2(B/f,(Ks-G)/u);break t}}let St=C.PI,At=G-E,Jt=At*At,Wt=0,me=0,$e=G+E,Pe=$e*$e,ke=0;A=-E*G/(st-mt),A>=-1&&A<=1&&(A=Math.acos(A),P=E*Math.cos(A)+G,B=S*Math.sin(A),M=P*P+B*B,M<Jt&&(St=A,Jt=M,At=P,Wt=B),M>Pe&&(me=A,Pe=M,$e=P,ke=B)),$<=(Jt+Pe)/2?(F=ot-Math.atan2(Wt*r,At),V=St*r):(F=ot-Math.atan2(ke*r,$e),V=me*r)}const W=Math.atan2(y,x)*_;let Q=t.arotation;F=(F-W)*C.radDeg+g-Q,F>180?F-=360:F<-180&&(F+=360),t.updateWorldTransformWith(h,c,Q+F*o,d,t.ascaleY,0,0),Q=e.arotation,V=((V+W)*C.radDeg-e.ashearX)*_+v-Q,V>180?V-=360:V<-180&&(V+=360),e.updateWorldTransformWith(x,y,Q+V*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},Gc=class extends Da{constructor(t){super(t,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}},Wc=class extends Da{constructor(t){super(t,0,!1),this.bones=new Array}};var ce=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s))(ce||{});const Wi=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let i=0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}isActive(){return this.active}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof Gr))return;const e=this.rotateMix,i=this.translateMix,n=i>0,r=e>0;if(!n&&!r)return;const a=this.data,l=a.spacingMode,o=l==ce.Length,h=a.rotateMode,c=h==qt.Tangent,u=h==qt.ChainScale,d=this.bones.length,f=c?d:d+1,m=this.bones,p=D.setArraySize(this.spaces,f);let g=null;const v=this.spacing;if(u||o){u&&(g=D.setArraySize(this.lengths,d));for(let E=0,S=f-1;E<S;){const A=m[E],M=A.data.length;if(M<Wi.epsilon)u&&(g[E]=0),p[++E]=0;else{const I=M*A.matrix.a,k=M*A.matrix.b,R=Math.sqrt(I*I+k*k);u&&(g[E]=R),p[++E]=(o?M+v:v)*R/M}}}else for(let E=1;E<f;E++)p[E]=v;const _=this.computeWorldPositions(t,f,c,a.positionMode==Xt.Percent,l==ce.Percent);let x=_[0],y=_[1],b=a.offsetRotation,w=!1;if(b==0)w=h==qt.Chain;else{w=!1;const E=this.target.bone.matrix;b*=E.a*E.d-E.b*E.c>0?C.degRad:-C.degRad}for(let E=0,S=3;E<d;E++,S+=3){const A=m[E],M=A.matrix;M.tx+=(x-M.tx)*i,M.ty+=(y-M.ty)*i;const I=_[S],k=_[S+1],R=I-x,P=k-y;if(u){const B=g[E];if(B!=0){const L=(Math.sqrt(R*R+P*P)/B-1)*e+1;M.a*=L,M.b*=L}}if(x=I,y=k,r){const B=M.a,L=M.c,O=M.b,G=M.d;let U=0,F=0,V=0;if(c&&(c?U=_[S-1]:p[E+1]==0?U=_[S+2]:U=Math.atan2(P,R)),U-=Math.atan2(O,B),w){F=Math.cos(U),V=Math.sin(U);const X=A.data.length;x+=(X*(F*B-V*O)-R)*e,y+=(X*(V*B+F*O)-P)*e}else U+=b;U>C.PI?U-=C.PI2:U<-C.PI&&(U+=C.PI2),U*=e,F=Math.cos(U),V=Math.sin(U),M.a=F*B-V*O,M.c=F*L-V*G,M.b=V*B+F*O,M.d=V*L+F*G}A.appliedValid=!1}}computeWorldPositions(t,e,i,n,r){const a=this.target;let l=this.position;const o=this.spaces,h=D.setArraySize(this.positions,e*3+2);let c=null;const u=t.closed;let d=t.worldVerticesLength,f=d/6,m=Wi.NONE;if(!t.constantSpeed){const U=t.lengths;f-=u?1:2;const F=U[f];if(n&&(l*=F),r)for(let V=0;V<e;V++)o[V]*=F;c=D.setArraySize(this.world,8);for(let V=0,X=0,Y=0;V<e;V++,X+=3){const $=o[V];l+=$;let W=l;if(u)W%=F,W<0&&(W+=F),Y=0;else if(W<0){m!=Wi.BEFORE&&(m=Wi.BEFORE,t.computeWorldVertices(a,2,4,c,0,2)),this.addBeforePosition(W,c,0,h,X);continue}else if(W>F){m!=Wi.AFTER&&(m=Wi.AFTER,t.computeWorldVertices(a,d-6,4,c,0,2)),this.addAfterPosition(W-F,c,0,h,X);continue}for(;;Y++){const Q=U[Y];if(!(W>Q)){if(Y==0)W/=Q;else{const st=U[Y-1];W=(W-st)/(Q-st)}break}}Y!=m&&(m=Y,u&&Y==f?(t.computeWorldVertices(a,d-4,4,c,0,2),t.computeWorldVertices(a,0,4,c,4,2)):t.computeWorldVertices(a,Y*6+2,8,c,0,2)),this.addCurvePosition(W,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,X,i||V>0&&$==0)}return h}u?(d+=2,c=D.setArraySize(this.world,d),t.computeWorldVertices(a,2,d-4,c,0,2),t.computeWorldVertices(a,0,2,c,d-4,2),c[d-2]=c[0],c[d-1]=c[1]):(f--,d-=4,c=D.setArraySize(this.world,d),t.computeWorldVertices(a,2,d,c,0,2));const p=D.setArraySize(this.curves,f);let g=0,v=c[0],_=c[1],x=0,y=0,b=0,w=0,E=0,S=0,A=0,M=0,I=0,k=0,R=0,P=0,B=0,L=0;for(let U=0,F=2;U<f;U++,F+=6)x=c[F],y=c[F+1],b=c[F+2],w=c[F+3],E=c[F+4],S=c[F+5],A=(v-x*2+b)*.1875,M=(_-y*2+w)*.1875,I=((x-b)*3-v+E)*.09375,k=((y-w)*3-_+S)*.09375,R=A*2+I,P=M*2+k,B=(x-v)*.75+A+I*.16666667,L=(y-_)*.75+M+k*.16666667,g+=Math.sqrt(B*B+L*L),B+=R,L+=P,R+=I,P+=k,g+=Math.sqrt(B*B+L*L),B+=R,L+=P,g+=Math.sqrt(B*B+L*L),B+=R+I,L+=P+k,g+=Math.sqrt(B*B+L*L),p[U]=g,v=E,_=S;if(n&&(l*=g),r)for(let U=0;U<e;U++)o[U]*=g;const O=this.segments;let G=0;for(let U=0,F=0,V=0,X=0;U<e;U++,F+=3){const Y=o[U];l+=Y;let $=l;if(u)$%=g,$<0&&($+=g),V=0;else if($<0){this.addBeforePosition($,c,0,h,F);continue}else if($>g){this.addAfterPosition($-g,c,d-4,h,F);continue}for(;;V++){const W=p[V];if(!($>W)){if(V==0)$/=W;else{const Q=p[V-1];$=($-Q)/(W-Q)}break}}if(V!=m){m=V;let W=V*6;for(v=c[W],_=c[W+1],x=c[W+2],y=c[W+3],b=c[W+4],w=c[W+5],E=c[W+6],S=c[W+7],A=(v-x*2+b)*.03,M=(_-y*2+w)*.03,I=((x-b)*3-v+E)*.006,k=((y-w)*3-_+S)*.006,R=A*2+I,P=M*2+k,B=(x-v)*.3+A+I*.16666667,L=(y-_)*.3+M+k*.16666667,G=Math.sqrt(B*B+L*L),O[0]=G,W=1;W<8;W++)B+=R,L+=P,R+=I,P+=k,G+=Math.sqrt(B*B+L*L),O[W]=G;B+=R,L+=P,G+=Math.sqrt(B*B+L*L),O[8]=G,B+=R+I,L+=P+k,G+=Math.sqrt(B*B+L*L),O[9]=G,X=0}for($*=G;;X++){const W=O[X];if(!($>W)){if(X==0)$/=W;else{const Q=O[X-1];$=X+($-Q)/(W-Q)}break}}this.addCurvePosition($*.1,v,_,x,y,b,w,E,S,h,F,i||U>0&&Y==0)}return h}addBeforePosition(t,e,i,n,r){const a=e[i],l=e[i+1],o=e[i+2]-a,h=e[i+3]-l,c=Math.atan2(h,o);n[r]=a+t*Math.cos(c),n[r+1]=l+t*Math.sin(c),n[r+2]=c}addAfterPosition(t,e,i,n,r){const a=e[i+2],l=e[i+3],o=a-e[i],h=l-e[i+1],c=Math.atan2(h,o);n[r]=a+t*Math.cos(c),n[r+1]=l+t*Math.sin(c),n[r+2]=c}addCurvePosition(t,e,i,n,r,a,l,o,h,c,u,d){(t==0||isNaN(t))&&(t=1e-4);const f=t*t,m=f*t,p=1-t,g=p*p,v=g*p,_=p*t,x=_*3,y=p*x,b=x*t,w=e*v+n*y+a*b+o*m,E=i*v+r*y+l*b+h*m;c[u]=w,c[u+1]=E,d&&(c[u+2]=Math.atan2(E-(i*g+r*_*2+l*f),w-(e*g+n*_*2+a*f)))}};let Qn=Wi;Qn.NONE=-1;Qn.BEFORE=-2;Qn.AFTER=-3;Qn.epsilon=1e-5;let yg=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new $r,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,u=l*c-o*h>0?C.degRad:-C.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let _=!1;const x=v.matrix;if(t!=0){const y=x.a,b=x.c,w=x.b,E=x.d;let S=Math.atan2(h,l)-Math.atan2(w,y)+d;S>C.PI?S-=C.PI2:S<-C.PI&&(S+=C.PI2),S*=t;const A=Math.cos(S),M=Math.sin(S);x.a=A*y-M*w,x.c=A*b-M*E,x.b=M*y+A*w,x.d=M*b+A*E,_=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=(y.x-x.tx)*e,x.ty+=(y.y-x.ty)*e,_=!0}if(i>0){let y=Math.sqrt(x.a*x.a+x.b*x.b),b=Math.sqrt(l*l+h*h);y>1e-5&&(y=(y+(b-y+this.data.offsetScaleX)*i)/y),x.a*=y,x.b*=y,y=Math.sqrt(x.c*x.c+x.d*x.d),b=Math.sqrt(o*o+c*c),y>1e-5&&(y=(y+(b-y+this.data.offsetScaleY)*i)/y),x.c*=y,x.d*=y,_=!0}if(n>0){const y=x.c,b=x.d,w=Math.atan2(b,y);let E=Math.atan2(c,o)-Math.atan2(h,l)-(w-Math.atan2(x.b,x.a));E>C.PI?E-=C.PI2:E<-C.PI&&(E+=C.PI2),E=w+(E+f)*n;const S=Math.sqrt(y*y+b*b);x.c=Math.cos(E)*S,x.d=Math.sin(E)*S,_=!0}_&&(v.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,u=l*c-o*h>0?C.degRad:-C.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let _=!1;const x=v.matrix;if(t!=0){const y=x.a,b=x.c,w=x.b,E=x.d;let S=Math.atan2(h,l)+d;S>C.PI?S-=C.PI2:S<-C.PI&&(S+=C.PI2),S*=t;const A=Math.cos(S),M=Math.sin(S);x.a=A*y-M*w,x.c=A*b-M*E,x.b=M*y+A*w,x.d=M*b+A*E,_=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=y.x*e,x.ty+=y.y*e,_=!0}if(i>0){let y=(Math.sqrt(l*l+h*h)-1+this.data.offsetScaleX)*i+1;x.a*=y,x.b*=y,y=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*i+1,x.c*=y,x.d*=y,_=!0}if(n>0){let y=Math.atan2(c,o)-Math.atan2(h,l);y>C.PI?y-=C.PI2:y<-C.PI&&(y+=C.PI2);const b=x.c,w=x.d;y=Math.atan2(w,b)+(y-C.PI/2+f)*n;const E=Math.sqrt(b*b+w*w);x.c=Math.cos(y)*E,x.d=Math.sin(y)*E,_=!0}_&&(v.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;if(t!=0){let g=r.arotation-c+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,c+=g*t}let u=h.ax,d=h.ay;e!=0&&(u+=(r.ax-u+this.data.offsetX)*e,d+=(r.ay-d+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f=(f+(r.ascaleX-f+this.data.offsetScaleX)*i)/f),m>1e-5&&(m=(m+(r.ascaleY-m+this.data.offsetScaleY)*i)/m));const p=h.ashearY;if(n>0){let g=r.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,h.shearY+=g*n}h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;t!=0&&(c+=(r.arotation+this.data.offsetRotation)*t);let u=h.ax,d=h.ay;e!=0&&(u+=(r.ax+this.data.offsetX)*e,d+=(r.ay+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f*=(r.ascaleX-1+this.data.offsetScaleX)*i+1),m>1e-5&&(m*=(r.ascaleY-1+this.data.offsetScaleY)*i+1));let p=h.ashearY;n>0&&(p+=(r.ashearY+this.data.offsetShearY)*n),h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}};const gr=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const i=t.bones[e];let n;if(i.parent==null)n=new Th(i,this,null);else{const r=this.bones[i.parent.index];n=new Th(i,this,r),r.children.push(n)}this.bones.push(n)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const i=t.slots[e],n=this.bones[i.boneData.index],r=new Fc(i,n);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const i=t.ikConstraints[e];this.ikConstraints.push(new xg(i,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const i=t.transformConstraints[e];this.transformConstraints.push(new yg(i,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const i=t.pathConstraints[e];this.pathConstraints.push(new Qn(i,this))}this.color=new H(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let c=0,u=e.length;c<u;c++){const d=e[c];d.sorted=d.data.skinRequired,d.active=!d.sorted}if(this.skin!=null){const c=this.skin.bones;for(let u=0,d=this.skin.bones.length;u<d;u++){let f=this.bones[c[u].index];do f.sorted=!1,f.active=!0,f=f.parent;while(f!=null)}}const i=this.ikConstraints,n=this.transformConstraints,r=this.pathConstraints,a=i.length,l=n.length,o=r.length,h=a+l+o;t:for(let c=0;c<h;c++){for(let u=0;u<a;u++){const d=i[u];if(d.data.order==c){this.sortIkConstraint(d);continue t}}for(let u=0;u<l;u++){const d=n[u];if(d.data.order==c){this.sortTransformConstraint(d);continue t}}for(let u=0;u<o;u++){const d=r[u];if(d.data.order==c){this.sortPathConstraint(d);continue t}}}for(let c=0,u=e.length;c<u;c++)this.sortBone(e[c])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&D.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target;this.sortBone(e);const i=t.bones,n=i[0];if(this.sortBone(n),i.length>1){const r=i[i.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(n.children),i[i.length-1].sorted=!0}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin!=null&&D.contains(this.skin.constraints,t.data,!0)),!t.active)return;const e=t.target,i=e.data.index,n=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,i,n),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,n);for(let o=0,h=this.data.skins.length;o<h;o++)this.sortPathConstraintAttachment(this.data.skins[o],i,n);const r=e.getAttachment();r instanceof Gr&&this.sortPathConstraintAttachmentWith(r,n);const a=t.bones,l=a.length;for(let o=0;o<l;o++)this.sortBone(a[o]);this._updateCache.push(t);for(let o=0;o<l;o++)this.sortReset(a[o].children);for(let o=0;o<l;o++)a[o].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin!=null&&D.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);const e=t.bones,i=e.length;if(t.data.local)for(let n=0;n<i;n++){const r=e[n];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(let n=0;n<i;n++)this.sortBone(e[n]);this._updateCache.push(t);for(let n=0;n<i;n++)this.sortReset(e[n].children);for(let n=0;n<i;n++)e[n].sorted=!0}sortPathConstraintAttachment(t,e,i){const n=t.attachments[e];if(n)for(const r in n)this.sortPathConstraintAttachmentWith(n[r],i)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Gr))return;const i=t.bones;if(i==null)this.sortBone(e);else{const n=this.bones;let r=0;for(;r<i.length;){const a=i[r++];for(let l=r+a;r<l;r++){const o=i[r];this.sortBone(n[o])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,i=t.length;e<i;e++){const n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}updateWorldTransform(){const t=this.updateCacheReset;for(let i=0,n=t.length;i<n;i++){const r=t[i];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}const e=this._updateCache;for(let i=0,n=e.length;i<n;i++)e[i].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let r=0,a=t.length;r<a;r++)t[r].setToSetupPose();const e=this.ikConstraints;for(let r=0,a=e.length;r<a;r++){const l=e[r];l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}const i=this.transformConstraints;for(let r=0,a=i.length;r<a;r++){const l=i[r],o=l.data;l.rotateMix=o.rotateMix,l.translateMix=o.translateMix,l.scaleMix=o.scaleMix,l.shearMix=o.shearMix}const n=this.pathConstraints;for(let r=0,a=n.length;r<a;r++){const l=n[r],o=l.data;l.position=o.position,l.spacing=o.spacing,l.rotateMix=o.rotateMix,l.translateMix=o.translateMix}}setSlotsToSetupPose(){const t=this.slots;D.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i],a=r.data.attachmentName;if(a!=null){const l=t.getAttachment(i,a);l!=null&&r.setAttachment(l)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const i=this.skin.getAttachment(t,e);if(i!=null)return i}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const i=this.slots;for(let n=0,r=i.length;n<r;n++){const a=i[n];if(a.data.name==t){let l=null;if(e!=null&&(l=this.getAttachment(n,e),l==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);a.setAttachment(l);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}getBounds(t,e,i=new Array(2)){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const n=this.drawOrder;let r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let h=0,c=n.length;h<c;h++){const u=n[h];if(!u.bone.active)continue;let d=0,f=null;const m=u.getAttachment();if(m instanceof lt)d=8,f=D.setArraySize(i,d,0),m.computeWorldVertices(u.bone,f,0,2);else if(m instanceof ka){const p=m;d=p.worldVerticesLength,f=D.setArraySize(i,d,0),p.computeWorldVertices(u,0,d,f,0,2)}if(f!=null)for(let p=0,g=f.length;p<g;p+=2){const v=f[p],_=f[p+1];r=Math.min(r,v),a=Math.min(a,_),l=Math.max(l,v),o=Math.max(o,_)}}t.set(r,a),e.set(l-r,o-a)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){gr.deprecatedWarning1||(gr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){gr.deprecatedWarning1||(gr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let Hc=gr;Hc.deprecatedWarning1=!1;let zc=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}},jc=class{constructor(t,e,i){if(this.color=new H(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(i==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}},qc=class extends Da{constructor(t){super(t,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}},Ah=class{constructor(t,e,i){this.slotIndex=t,this.name=e,this.attachment=i}},ua=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,t==null)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(i==null)throw new Error("attachment cannot be null.");const n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i}addSkin(t){for(let i=0;i<t.bones.length;i++){const n=t.bones[i];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==n){r=!0;break}r||this.bones.push(n)}for(let i=0;i<t.constraints.length;i++){const n=t.constraints[i];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let i=0;i<e.length;i++){const n=e[i];this.setAttachment(n.slotIndex,n.name,n.attachment)}}copySkin(t){for(let i=0;i<t.bones.length;i++){const n=t.bones[i];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==n){r=!0;break}r||this.bones.push(n)}for(let i=0;i<t.constraints.length;i++){const n=t.constraints[i];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let i=0;i<e.length;i++){const n=e[i];n.attachment!=null&&(n.attachment instanceof ka?(n.attachment=n.attachment.newLinkedMesh(),this.setAttachment(n.slotIndex,n.name,n.attachment)):(n.attachment=n.attachment.copy(),this.setAttachment(n.slotIndex,n.name,n.attachment)))}}getAttachment(t,e){const i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){const i=this.attachments[t];i&&(i[e]=null)}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const i=this.attachments[e];if(i)for(const n in i){const r=i[n];r&&t.push(new Ah(e,n,r))}}return t}getAttachmentsForSlot(t,e){const i=this.attachments[t];if(i)for(const n in i){const r=i[n];r&&e.push(new Ah(t,n,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let n=0;n<t.slots.length;n++){const r=t.slots[n],a=r.getAttachment();if(a&&i<e.attachments.length){const l=e.attachments[i];for(const o in l){const h=l[o];if(a==h){const c=this.getAttachment(i,o);c!=null&&r.setAttachment(c);break}}}i++}}};const Yt=class{constructor(s){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=s}readSkeletonData(s){const t=this.scale,e=new zc;e.name="";const i=new ca(s);e.hash=i.readString(),e.version=i.readString(),e.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),e.x=i.readFloat(),e.y=i.readFloat(),e.width=i.readFloat(),e.height=i.readFloat();const n=i.readBoolean();n&&(e.fps=i.readFloat(),e.imagesPath=i.readString(),e.audioPath=i.readString());let r=0;r=i.readInt(!0);for(let l=0;l<r;l++)i.strings.push(i.readString());r=i.readInt(!0);for(let l=0;l<r;l++){const o=i.readString(),h=l==0?null:e.bones[i.readInt(!0)],c=new Xc(l,o,h);c.rotation=i.readFloat(),c.x=i.readFloat()*t,c.y=i.readFloat()*t,c.scaleX=i.readFloat(),c.scaleY=i.readFloat(),c.shearX=i.readFloat(),c.shearY=i.readFloat(),c.length=i.readFloat()*t,c.transformMode=Yt.TransformModeValues[i.readInt(!0)],c.skinRequired=i.readBoolean(),n&&H.rgba8888ToColor(c.color,i.readInt32()),e.bones.push(c)}r=i.readInt(!0);for(let l=0;l<r;l++){const o=i.readString(),h=e.bones[i.readInt(!0)],c=new jc(l,o,h);H.rgba8888ToColor(c.color,i.readInt32());const u=i.readInt32();u!=-1&&H.rgb888ToColor(c.darkColor=new H,u),c.attachmentName=i.readStringRef(),c.blendMode=Yt.BlendModeValues[i.readInt(!0)],e.slots.push(c)}r=i.readInt(!0);for(let l=0,o;l<r;l++){const h=new Gc(i.readString());h.order=i.readInt(!0),h.skinRequired=i.readBoolean(),o=i.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[i.readInt(!0)]);h.target=e.bones[i.readInt(!0)],h.mix=i.readFloat(),h.softness=i.readFloat()*t,h.bendDirection=i.readByte(),h.compress=i.readBoolean(),h.stretch=i.readBoolean(),h.uniform=i.readBoolean(),e.ikConstraints.push(h)}r=i.readInt(!0);for(let l=0,o;l<r;l++){const h=new qc(i.readString());h.order=i.readInt(!0),h.skinRequired=i.readBoolean(),o=i.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[i.readInt(!0)]);h.target=e.bones[i.readInt(!0)],h.local=i.readBoolean(),h.relative=i.readBoolean(),h.offsetRotation=i.readFloat(),h.offsetX=i.readFloat()*t,h.offsetY=i.readFloat()*t,h.offsetScaleX=i.readFloat(),h.offsetScaleY=i.readFloat(),h.offsetShearY=i.readFloat(),h.rotateMix=i.readFloat(),h.translateMix=i.readFloat(),h.scaleMix=i.readFloat(),h.shearMix=i.readFloat(),e.transformConstraints.push(h)}r=i.readInt(!0);for(let l=0,o;l<r;l++){const h=new Wc(i.readString());h.order=i.readInt(!0),h.skinRequired=i.readBoolean(),o=i.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[i.readInt(!0)]);h.target=e.slots[i.readInt(!0)],h.positionMode=Yt.PositionModeValues[i.readInt(!0)],h.spacingMode=Yt.SpacingModeValues[i.readInt(!0)],h.rotateMode=Yt.RotateModeValues[i.readInt(!0)],h.offsetRotation=i.readFloat(),h.position=i.readFloat(),h.positionMode==Xt.Fixed&&(h.position*=t),h.spacing=i.readFloat(),(h.spacingMode==ce.Length||h.spacingMode==ce.Fixed)&&(h.spacing*=t),h.rotateMix=i.readFloat(),h.translateMix=i.readFloat(),e.pathConstraints.push(h)}const a=this.readSkin(i,e,!0,n);a!=null&&(e.defaultSkin=a,e.skins.push(a));{let l=e.skins.length;for(D.setArraySize(e.skins,r=l+i.readInt(!0));l<r;l++)e.skins[l]=this.readSkin(i,e,!1,n)}r=this.linkedMeshes.length;for(let l=0;l<r;l++){const o=this.linkedMeshes[l],h=o.skin==null?e.defaultSkin:e.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?c:o.mesh,o.mesh.setParentMesh(c)}this.linkedMeshes.length=0,r=i.readInt(!0);for(let l=0;l<r;l++){const o=new $c(i.readStringRef());o.intValue=i.readInt(!1),o.floatValue=i.readFloat(),o.stringValue=i.readString(),o.audioPath=i.readString(),o.audioPath!=null&&(o.volume=i.readFloat(),o.balance=i.readFloat()),e.events.push(o)}r=i.readInt(!0);for(let l=0;l<r;l++)e.animations.push(this.readAnimation(i,i.readString(),e));return e}readSkin(s,t,e,i){let n=null,r=0;if(e){if(r=s.readInt(!0),r==0)return null;n=new ua("default")}else{n=new ua(s.readStringRef()),n.bones.length=s.readInt(!0);for(let a=0,l=n.bones.length;a<l;a++)n.bones[a]=t.bones[s.readInt(!0)];for(let a=0,l=s.readInt(!0);a<l;a++)n.constraints.push(t.ikConstraints[s.readInt(!0)]);for(let a=0,l=s.readInt(!0);a<l;a++)n.constraints.push(t.transformConstraints[s.readInt(!0)]);for(let a=0,l=s.readInt(!0);a<l;a++)n.constraints.push(t.pathConstraints[s.readInt(!0)]);r=s.readInt(!0)}for(let a=0;a<r;a++){const l=s.readInt(!0);for(let o=0,h=s.readInt(!0);o<h;o++){const c=s.readStringRef(),u=this.readAttachment(s,t,n,l,c,i);u!=null&&n.setAttachment(l,c,u)}}return n}readAttachment(s,t,e,i,n,r){const a=this.scale;let l=s.readStringRef();l==null&&(l=n);const o=s.readByte();switch(Yt.AttachmentTypeValues[o]){case dt.Region:{let c=s.readStringRef();const u=s.readFloat(),d=s.readFloat(),f=s.readFloat(),m=s.readFloat(),p=s.readFloat(),g=s.readFloat(),v=s.readFloat(),_=s.readInt32();c==null&&(c=l);const x=this.attachmentLoader.newRegionAttachment(e,l,c);return x==null?null:(x.path=c,x.x=d*a,x.y=f*a,x.scaleX=m,x.scaleY=p,x.rotation=u,x.width=g*a,x.height=v*a,H.rgba8888ToColor(x.color,_),x)}case dt.BoundingBox:{const c=s.readInt(!0),u=this.readVertices(s,c),d=r?s.readInt32():0,f=this.attachmentLoader.newBoundingBoxAttachment(e,l);return f==null?null:(f.worldVerticesLength=c<<1,f.vertices=u.vertices,f.bones=u.bones,r&&H.rgba8888ToColor(f.color,d),f)}case dt.Mesh:{let c=s.readStringRef();const u=s.readInt32(),d=s.readInt(!0),f=this.readFloatArray(s,d<<1,1),m=this.readShortArray(s),p=this.readVertices(s,d),g=s.readInt(!0);let v=null,_=0,x=0;r&&(v=this.readShortArray(s),_=s.readFloat(),x=s.readFloat()),c==null&&(c=l);const y=this.attachmentLoader.newMeshAttachment(e,l,c);return y==null?null:(y.path=c,H.rgba8888ToColor(y.color,u),y.bones=p.bones,y.vertices=p.vertices,y.worldVerticesLength=d<<1,y.triangles=m,y.regionUVs=new Float32Array(f),y.hullLength=g<<1,r&&(y.edges=v,y.width=_*a,y.height=x*a),y)}case dt.LinkedMesh:{let c=s.readStringRef();const u=s.readInt32(),d=s.readStringRef(),f=s.readStringRef(),m=s.readBoolean();let p=0,g=0;r&&(p=s.readFloat(),g=s.readFloat()),c==null&&(c=l);const v=this.attachmentLoader.newMeshAttachment(e,l,c);return v==null?null:(v.path=c,H.rgba8888ToColor(v.color,u),r&&(v.width=p*a,v.height=g*a),this.linkedMeshes.push(new Rw(v,d,i,f,m)),v)}case dt.Path:{const c=s.readBoolean(),u=s.readBoolean(),d=s.readInt(!0),f=this.readVertices(s,d),m=D.newArray(d/3,0);for(let v=0,_=m.length;v<_;v++)m[v]=s.readFloat()*a;const p=r?s.readInt32():0,g=this.attachmentLoader.newPathAttachment(e,l);return g==null?null:(g.closed=c,g.constantSpeed=u,g.worldVerticesLength=d<<1,g.vertices=f.vertices,g.bones=f.bones,g.lengths=m,r&&H.rgba8888ToColor(g.color,p),g)}case dt.Point:{const c=s.readFloat(),u=s.readFloat(),d=s.readFloat(),f=r?s.readInt32():0,m=this.attachmentLoader.newPointAttachment(e,l);return m==null?null:(m.x=u*a,m.y=d*a,m.rotation=c,r&&H.rgba8888ToColor(m.color,f),m)}case dt.Clipping:{const c=s.readInt(!0),u=s.readInt(!0),d=this.readVertices(s,u),f=r?s.readInt32():0,m=this.attachmentLoader.newClippingAttachment(e,l);return m==null?null:(m.endSlot=t.slots[c],m.worldVerticesLength=u<<1,m.vertices=d.vertices,m.bones=d.bones,r&&H.rgba8888ToColor(m.color,f),m)}}return null}readVertices(s,t){const e=t<<1,i=new Pw,n=this.scale;if(!s.readBoolean())return i.vertices=this.readFloatArray(s,e,n),i;const r=new Array,a=new Array;for(let l=0;l<t;l++){const o=s.readInt(!0);a.push(o);for(let h=0;h<o;h++)a.push(s.readInt(!0)),r.push(s.readFloat()*n),r.push(s.readFloat()*n),r.push(s.readFloat())}return i.vertices=D.toFloatArray(r),i.bones=a,i}readFloatArray(s,t,e){const i=new Array(t);if(e==1)for(let n=0;n<t;n++)i[n]=s.readFloat();else for(let n=0;n<t;n++)i[n]=s.readFloat()*e;return i}readShortArray(s){const t=s.readInt(!0),e=new Array(t);for(let i=0;i<t;i++)e[i]=s.readShort();return e}readAnimation(s,t,e){const i=new Array,n=this.scale;let r=0;const a=new H,l=new H;for(let c=0,u=s.readInt(!0);c<u;c++){const d=s.readInt(!0);for(let f=0,m=s.readInt(!0);f<m;f++){const p=s.readByte(),g=s.readInt(!0);switch(p){case Yt.SLOT_ATTACHMENT:{const v=new Zi(g);v.slotIndex=d;for(let _=0;_<g;_++)v.setFrame(_,s.readFloat(),s.readStringRef());i.push(v),r=Math.max(r,v.frames[g-1]);break}case Yt.SLOT_COLOR:{const v=new Ie(g);v.slotIndex=d;for(let _=0;_<g;_++){const x=s.readFloat();H.rgba8888ToColor(a,s.readInt32()),v.setFrame(_,x,a.r,a.g,a.b,a.a),_<g-1&&this.readCurve(s,_,v)}i.push(v),r=Math.max(r,v.frames[(g-1)*Ie.ENTRIES]);break}case Yt.SLOT_TWO_COLOR:{const v=new Kt(g);v.slotIndex=d;for(let _=0;_<g;_++){const x=s.readFloat();H.rgba8888ToColor(a,s.readInt32()),H.rgb888ToColor(l,s.readInt32()),v.setFrame(_,x,a.r,a.g,a.b,a.a,l.r,l.g,l.b),_<g-1&&this.readCurve(s,_,v)}i.push(v),r=Math.max(r,v.frames[(g-1)*Kt.ENTRIES]);break}}}}for(let c=0,u=s.readInt(!0);c<u;c++){const d=s.readInt(!0);for(let f=0,m=s.readInt(!0);f<m;f++){const p=s.readByte(),g=s.readInt(!0);switch(p){case Yt.BONE_ROTATE:{const v=new ge(g);v.boneIndex=d;for(let _=0;_<g;_++)v.setFrame(_,s.readFloat(),s.readFloat()),_<g-1&&this.readCurve(s,_,v);i.push(v),r=Math.max(r,v.frames[(g-1)*ge.ENTRIES]);break}case Yt.BONE_TRANSLATE:case Yt.BONE_SCALE:case Yt.BONE_SHEAR:{let v,_=1;p==Yt.BONE_SCALE?v=new Bc(g):p==Yt.BONE_SHEAR?v=new Dc(g):(v=new qe(g),_=n),v.boneIndex=d;for(let x=0;x<g;x++)v.setFrame(x,s.readFloat(),s.readFloat()*_,s.readFloat()*_),x<g-1&&this.readCurve(s,x,v);i.push(v),r=Math.max(r,v.frames[(g-1)*qe.ENTRIES]);break}}}}for(let c=0,u=s.readInt(!0);c<u;c++){const d=s.readInt(!0),f=s.readInt(!0),m=new xe(f);m.ikConstraintIndex=d;for(let p=0;p<f;p++)m.setFrame(p,s.readFloat(),s.readFloat(),s.readFloat()*n,s.readByte(),s.readBoolean(),s.readBoolean()),p<f-1&&this.readCurve(s,p,m);i.push(m),r=Math.max(r,m.frames[(f-1)*xe.ENTRIES])}for(let c=0,u=s.readInt(!0);c<u;c++){const d=s.readInt(!0),f=s.readInt(!0),m=new Re(f);m.transformConstraintIndex=d;for(let p=0;p<f;p++)m.setFrame(p,s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat()),p<f-1&&this.readCurve(s,p,m);i.push(m),r=Math.max(r,m.frames[(f-1)*Re.ENTRIES])}for(let c=0,u=s.readInt(!0);c<u;c++){const d=s.readInt(!0),f=e.pathConstraints[d];for(let m=0,p=s.readInt(!0);m<p;m++){const g=s.readByte(),v=s.readInt(!0);switch(g){case Yt.PATH_POSITION:case Yt.PATH_SPACING:{let _,x=1;g==Yt.PATH_SPACING?(_=new Lc(v),(f.spacingMode==ce.Length||f.spacingMode==ce.Fixed)&&(x=n)):(_=new js(v),f.positionMode==Xt.Fixed&&(x=n)),_.pathConstraintIndex=d;for(let y=0;y<v;y++)_.setFrame(y,s.readFloat(),s.readFloat()*x),y<v-1&&this.readCurve(s,y,_);i.push(_),r=Math.max(r,_.frames[(v-1)*js.ENTRIES]);break}case Yt.PATH_MIX:{const _=new Is(v);_.pathConstraintIndex=d;for(let x=0;x<v;x++)_.setFrame(x,s.readFloat(),s.readFloat(),s.readFloat()),x<v-1&&this.readCurve(s,x,_);i.push(_),r=Math.max(r,_.frames[(v-1)*Is.ENTRIES]);break}}}}for(let c=0,u=s.readInt(!0);c<u;c++){const d=e.skins[s.readInt(!0)];for(let f=0,m=s.readInt(!0);f<m;f++){const p=s.readInt(!0);for(let g=0,v=s.readInt(!0);g<v;g++){const _=d.getAttachment(p,s.readStringRef()),x=_.bones!=null,y=_.vertices,b=x?y.length/3*2:y.length,w=s.readInt(!0),E=new Nc(w);E.slotIndex=p,E.attachment=_;for(let S=0;S<w;S++){const A=s.readFloat();let M,I=s.readInt(!0);if(I==0)M=x?D.newFloatArray(b):y;else{M=D.newFloatArray(b);const k=s.readInt(!0);if(I+=k,n==1)for(let R=k;R<I;R++)M[R]=s.readFloat();else for(let R=k;R<I;R++)M[R]=s.readFloat()*n;if(!x)for(let R=0,P=M.length;R<P;R++)M[R]+=y[R]}E.setFrame(S,A,M),S<w-1&&this.readCurve(s,S,E)}i.push(E),r=Math.max(r,E.frames[w-1])}}}const o=s.readInt(!0);if(o>0){const c=new Ln(o),u=e.slots.length;for(let d=0;d<o;d++){const f=s.readFloat(),m=s.readInt(!0),p=D.newArray(u,0);for(let x=u-1;x>=0;x--)p[x]=-1;const g=D.newArray(u-m,0);let v=0,_=0;for(let x=0;x<m;x++){const y=s.readInt(!0);for(;v!=y;)g[_++]=v++;p[v+s.readInt(!0)]=v++}for(;v<u;)g[_++]=v++;for(let x=u-1;x>=0;x--)p[x]==-1&&(p[x]=g[--_]);c.setFrame(d,f,p)}i.push(c),r=Math.max(r,c.frames[o-1])}const h=s.readInt(!0);if(h>0){const c=new Fa(h);for(let u=0;u<h;u++){const d=s.readFloat(),f=e.events[s.readInt(!0)],m=new Yc(d,f);m.intValue=s.readInt(!1),m.floatValue=s.readFloat(),m.stringValue=s.readBoolean()?s.readString():f.stringValue,m.data.audioPath!=null&&(m.volume=s.readFloat(),m.balance=s.readFloat()),c.setFrame(u,m)}i.push(c),r=Math.max(r,c.frames[h-1])}return new Zt(t,i,r)}readCurve(s,t,e){switch(s.readByte()){case Yt.CURVE_STEPPED:e.setStepped(t);break;case Yt.CURVE_BEZIER:this.setCurve(e,t,s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat());break}}setCurve(s,t,e,i,n,r){s.setCurve(t,e,i,n,r)}};let Qt=Yt;Qt.AttachmentTypeValues=[0,1,2,3,4,5,6];Qt.TransformModeValues=[it.Normal,it.OnlyTranslation,it.NoRotationOrReflection,it.NoScale,it.NoScaleOrReflection];Qt.PositionModeValues=[Xt.Fixed,Xt.Percent];Qt.SpacingModeValues=[ce.Length,ce.Fixed,ce.Percent];Qt.RotateModeValues=[qt.Tangent,qt.Chain,qt.ChainScale];Qt.BlendModeValues=[Z.NORMAL,Z.ADD,Z.MULTIPLY,Z.SCREEN];Qt.BONE_ROTATE=0;Qt.BONE_TRANSLATE=1;Qt.BONE_SCALE=2;Qt.BONE_SHEAR=3;Qt.SLOT_ATTACHMENT=0;Qt.SLOT_COLOR=1;Qt.SLOT_TWO_COLOR=2;Qt.PATH_POSITION=0;Qt.PATH_SPACING=1;Qt.PATH_MIX=2;Qt.CURVE_LINEAR=0;Qt.CURVE_STEPPED=1;Qt.CURVE_BEZIER=2;let Rw=class{constructor(t,e,i,n,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritDeform=r}},Pw=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}},kw=class extends Pc{},_g=class Cn{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,i=new zc,n=typeof t=="string"?JSON.parse(t):t,r=n.skeleton;if(r!=null){if(i.hash=r.hash,i.version=r.spine,i.version.substr(0,3)!=="3.8"){const a=`Spine 3.8 loader cant load version ${r.spine}. Please configure your pixi-spine bundle`;console.error(a)}i.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height,i.fps=r.fps,i.imagesPath=r.images}if(n.bones)for(let a=0;a<n.bones.length;a++){const l=n.bones[a];let o=null;const h=this.getValue(l,"parent",null);if(h!=null&&(o=i.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);const c=new Xc(i.bones.length,l.name,o);c.length=this.getValue(l,"length",0)*e,c.x=this.getValue(l,"x",0)*e,c.y=this.getValue(l,"y",0)*e,c.rotation=this.getValue(l,"rotation",0),c.scaleX=this.getValue(l,"scaleX",1),c.scaleY=this.getValue(l,"scaleY",1),c.shearX=this.getValue(l,"shearX",0),c.shearY=this.getValue(l,"shearY",0),c.transformMode=Cn.transformModeFromString(this.getValue(l,"transform","normal")),c.skinRequired=this.getValue(l,"skin",!1),i.bones.push(c)}if(n.slots)for(let a=0;a<n.slots.length;a++){const l=n.slots[a],o=l.name,h=l.bone,c=i.findBone(h);if(c==null)throw new Error(`Slot bone not found: ${h}`);const u=new jc(i.slots.length,o,c),d=this.getValue(l,"color",null);d!=null&&u.color.setFromString(d);const f=this.getValue(l,"dark",null);f!=null&&(u.darkColor=new H(1,1,1,1),u.darkColor.setFromString(f)),u.attachmentName=this.getValue(l,"attachment",null),u.blendMode=Cn.blendModeFromString(this.getValue(l,"blend","normal")),i.slots.push(u)}if(n.ik)for(let a=0;a<n.ik.length;a++){const l=n.ik[a],o=new Gc(l.name);o.order=this.getValue(l,"order",0),o.skinRequired=this.getValue(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const u=l.bones[c],d=i.findBone(u);if(d==null)throw new Error(`IK bone not found: ${u}`);o.bones.push(d)}const h=l.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`IK target bone not found: ${h}`);o.mix=this.getValue(l,"mix",1),o.softness=this.getValue(l,"softness",0)*e,o.bendDirection=this.getValue(l,"bendPositive",!0)?1:-1,o.compress=this.getValue(l,"compress",!1),o.stretch=this.getValue(l,"stretch",!1),o.uniform=this.getValue(l,"uniform",!1),i.ikConstraints.push(o)}if(n.transform)for(let a=0;a<n.transform.length;a++){const l=n.transform[a],o=new qc(l.name);o.order=this.getValue(l,"order",0),o.skinRequired=this.getValue(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const u=l.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}const h=l.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`Transform constraint target bone not found: ${h}`);o.local=this.getValue(l,"local",!1),o.relative=this.getValue(l,"relative",!1),o.offsetRotation=this.getValue(l,"rotation",0),o.offsetX=this.getValue(l,"x",0)*e,o.offsetY=this.getValue(l,"y",0)*e,o.offsetScaleX=this.getValue(l,"scaleX",0),o.offsetScaleY=this.getValue(l,"scaleY",0),o.offsetShearY=this.getValue(l,"shearY",0),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),o.scaleMix=this.getValue(l,"scaleMix",1),o.shearMix=this.getValue(l,"shearMix",1),i.transformConstraints.push(o)}if(n.path)for(let a=0;a<n.path.length;a++){const l=n.path[a],o=new Wc(l.name);o.order=this.getValue(l,"order",0),o.skinRequired=this.getValue(l,"skin",!1);for(let c=0;c<l.bones.length;c++){const u=l.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}const h=l.target;if(o.target=i.findSlot(h),o.target==null)throw new Error(`Path target slot not found: ${h}`);o.positionMode=Cn.positionModeFromString(this.getValue(l,"positionMode","percent")),o.spacingMode=Cn.spacingModeFromString(this.getValue(l,"spacingMode","length")),o.rotateMode=Cn.rotateModeFromString(this.getValue(l,"rotateMode","tangent")),o.offsetRotation=this.getValue(l,"rotation",0),o.position=this.getValue(l,"position",0),o.positionMode==Xt.Fixed&&(o.position*=e),o.spacing=this.getValue(l,"spacing",0),(o.spacingMode==ce.Length||o.spacingMode==ce.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),i.pathConstraints.push(o)}if(n.skins)for(let a=0;a<n.skins.length;a++){const l=n.skins[a],o=new ua(l.name);if(l.bones)for(let h=0;h<l.bones.length;h++){const c=i.findBone(l.bones[h]);if(c==null)throw new Error(`Skin bone not found: ${l.bones[a]}`);o.bones.push(c)}if(l.ik)for(let h=0;h<l.ik.length;h++){const c=i.findIkConstraint(l.ik[h]);if(c==null)throw new Error(`Skin IK constraint not found: ${l.ik[a]}`);o.constraints.push(c)}if(l.transform)for(let h=0;h<l.transform.length;h++){const c=i.findTransformConstraint(l.transform[h]);if(c==null)throw new Error(`Skin transform constraint not found: ${l.transform[a]}`);o.constraints.push(c)}if(l.path)for(let h=0;h<l.path.length;h++){const c=i.findPathConstraint(l.path[h]);if(c==null)throw new Error(`Skin path constraint not found: ${l.path[a]}`);o.constraints.push(c)}for(const h in l.attachments){const c=i.findSlot(h);if(c==null)throw new Error(`Slot not found: ${h}`);const u=l.attachments[h];for(const d in u){const f=this.readAttachment(u[d],o,c.index,d,i);f!=null&&o.setAttachment(c.index,d,f)}}i.skins.push(o),o.name=="default"&&(i.defaultSkin=o)}for(let a=0,l=this.linkedMeshes.length;a<l;a++){const o=this.linkedMeshes[a],h=o.skin==null?i.defaultSkin:i.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?c:o.mesh,o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,n.events)for(const a in n.events){const l=n.events[a],o=new $c(a);o.intValue=this.getValue(l,"int",0),o.floatValue=this.getValue(l,"float",0),o.stringValue=this.getValue(l,"string",""),o.audioPath=this.getValue(l,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(l,"volume",1),o.balance=this.getValue(l,"balance",0)),i.events.push(o)}if(n.animations)for(const a in n.animations){const l=n.animations[a];this.readAnimation(l,a,i)}return i}readAttachment(t,e,i,n,r){const a=this.scale;switch(n=this.getValue(t,"name",n),this.getValue(t,"type","region")){case"region":{const o=this.getValue(t,"path",n),h=this.attachmentLoader.newRegionAttachment(e,n,o);if(h==null)return null;h.path=o,h.x=this.getValue(t,"x",0)*a,h.y=this.getValue(t,"y",0)*a,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*a,h.height=t.height*a;const c=this.getValue(t,"color",null);return c!=null&&h.color.setFromString(c),h}case"boundingbox":{const o=this.attachmentLoader.newBoundingBoxAttachment(e,n);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{const o=this.getValue(t,"path",n),h=this.attachmentLoader.newMeshAttachment(e,n,o);if(h==null)return null;h.path=o;const c=this.getValue(t,"color",null);c!=null&&h.color.setFromString(c),h.width=this.getValue(t,"width",0)*a,h.height=this.getValue(t,"height",0)*a;const u=this.getValue(t,"parent",null);if(u!=null)return this.linkedMeshes.push(new Fw(h,this.getValue(t,"skin",null),i,u,this.getValue(t,"deform",!0))),h;const d=t.uvs;return this.readVertices(t,h,d.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(d),h.edges=this.getValue(t,"edges",null),h.hullLength=this.getValue(t,"hull",0)*2,h}case"path":{const o=this.attachmentLoader.newPathAttachment(e,n);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);const h=t.vertexCount;this.readVertices(t,o,h<<1);const c=D.newArray(h/3,0);for(let d=0;d<t.lengths.length;d++)c[d]=t.lengths[d]*a;o.lengths=c;const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"point":{const o=this.attachmentLoader.newPointAttachment(e,n);if(o==null)return null;o.x=this.getValue(t,"x",0)*a,o.y=this.getValue(t,"y",0)*a,o.rotation=this.getValue(t,"rotation",0);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"clipping":{const o=this.attachmentLoader.newClippingAttachment(e,n);if(o==null)return null;const h=this.getValue(t,"end",null);if(h!=null){const d=r.findSlot(h);if(d==null)throw new Error(`Clipping end slot not found: ${h}`);o.endSlot=d}const c=t.vertexCount;this.readVertices(t,o,c<<1);const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}}return null}readVertices(t,e,i){const n=this.scale;e.worldVerticesLength=i;const r=t.vertices;if(i==r.length){const o=D.toFloatArray(r);if(n!=1)for(let h=0,c=r.length;h<c;h++)o[h]*=n;e.vertices=o;return}const a=new Array,l=new Array;for(let o=0,h=r.length;o<h;){const c=r[o++];l.push(c);for(let u=o+c*4;o<u;o+=4)l.push(r[o]),a.push(r[o+1]*n),a.push(r[o+2]*n),a.push(r[o+3])}e.bones=l,e.vertices=D.toFloatArray(a)}readAnimation(t,e,i){const n=this.scale,r=new Array;let a=0;if(t.slots)for(const o in t.slots){const h=t.slots[o],c=i.findSlotIndex(o);if(c==-1)throw new Error(`Slot not found: ${o}`);for(const u in h){const d=h[u];if(u=="attachment"){const f=new Zi(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p];f.setFrame(m++,this.getValue(g,"time",0),g.name)}r.push(f),a=Math.max(a,f.frames[f.getFrameCount()-1])}else if(u=="color"){const f=new Ie(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p],v=new H;v.setFromString(g.color||"ffffffff"),f.setFrame(m,this.getValue(g,"time",0),v.r,v.g,v.b,v.a),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Ie.ENTRIES])}else if(u=="twoColor"){const f=new Kt(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p],v=new H,_=new H;v.setFromString(g.light),_.setFromString(g.dark),f.setFrame(m,this.getValue(g,"time",0),v.r,v.g,v.b,v.a,_.r,_.g,_.b),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Kt.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${u} (${o})`)}}if(t.bones)for(const o in t.bones){const h=t.bones[o],c=i.findBoneIndex(o);if(c==-1)throw new Error(`Bone not found: ${o}`);for(const u in h){const d=h[u];if(u==="rotate"){const f=new ge(d.length);f.boneIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p];f.setFrame(m,this.getValue(g,"time",0),this.getValue(g,"angle",0)),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*ge.ENTRIES])}else if(u==="translate"||u==="scale"||u==="shear"){let f=null,m=1,p=0;u==="scale"?(f=new Bc(d.length),p=1):u==="shear"?f=new Dc(d.length):(f=new qe(d.length),m=n),f.boneIndex=c;let g=0;for(let v=0;v<d.length;v++){const _=d[v],x=this.getValue(_,"x",p),y=this.getValue(_,"y",p);f.setFrame(g,this.getValue(_,"time",0),x*m,y*m),this.readCurve(_,f,g),g++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*qe.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${u} (${o})`)}}if(t.ik)for(const o in t.ik){const h=t.ik[o],c=i.findIkConstraint(o),u=new xe(h.length);u.ikConstraintIndex=i.ikConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){const m=h[f];u.setFrame(d,this.getValue(m,"time",0),this.getValue(m,"mix",1),this.getValue(m,"softness",0)*n,this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,u,d),d++}r.push(u),a=Math.max(a,u.frames[(u.getFrameCount()-1)*xe.ENTRIES])}if(t.transform)for(const o in t.transform){const h=t.transform[o],c=i.findTransformConstraint(o),u=new Re(h.length);u.transformConstraintIndex=i.transformConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){const m=h[f];u.setFrame(d,this.getValue(m,"time",0),this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,u,d),d++}r.push(u),a=Math.max(a,u.frames[(u.getFrameCount()-1)*Re.ENTRIES])}if(t.path)for(const o in t.path){const h=t.path[o],c=i.findPathConstraintIndex(o);if(c==-1)throw new Error(`Path constraint not found: ${o}`);const u=i.pathConstraints[c];for(const d in h){const f=h[d];if(d==="position"||d==="spacing"){let m=null,p=1;d==="spacing"?(m=new Lc(f.length),(u.spacingMode==ce.Length||u.spacingMode==ce.Fixed)&&(p=n)):(m=new js(f.length),u.positionMode==Xt.Fixed&&(p=n)),m.pathConstraintIndex=c;let g=0;for(let v=0;v<f.length;v++){const _=f[v];m.setFrame(g,this.getValue(_,"time",0),this.getValue(_,d,0)*p),this.readCurve(_,m,g),g++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*js.ENTRIES])}else if(d==="mix"){const m=new Is(f.length);m.pathConstraintIndex=c;let p=0;for(let g=0;g<f.length;g++){const v=f[g];m.setFrame(p,this.getValue(v,"time",0),this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1)),this.readCurve(v,m,p),p++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*Is.ENTRIES])}}}if(t.deform)for(const o in t.deform){const h=t.deform[o],c=i.findSkin(o);if(c!=null)for(const u in h){const d=h[u],f=i.findSlotIndex(u);if(f==-1)throw new Error(`Slot not found: ${d.name}`);for(const m in d){const p=d[m],g=c.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);const v=g.bones!=null,_=g.vertices,x=v?_.length/3*2:_.length,y=new Nc(p.length);y.slotIndex=f,y.attachment=g;let b=0;for(let w=0;w<p.length;w++){const E=p[w];let S;const A=this.getValue(E,"vertices",null);if(A==null)S=v?D.newFloatArray(x):_;else{S=D.newFloatArray(x);const M=this.getValue(E,"offset",0);if(D.arrayCopy(A,0,S,M,A.length),n!=1)for(let I=M,k=I+A.length;I<k;I++)S[I]*=n;if(!v)for(let I=0;I<x;I++)S[I]+=_[I]}y.setFrame(b,this.getValue(E,"time",0),S),this.readCurve(E,y,b),b++}r.push(y),a=Math.max(a,y.frames[y.getFrameCount()-1])}}}let l=t.drawOrder;if(l==null&&(l=t.draworder),l!=null){const o=new Ln(l.length),h=i.slots.length;let c=0;for(let u=0;u<l.length;u++){const d=l[u];let f=null;const m=this.getValue(d,"offsets",null);if(m!=null){f=D.newArray(h,-1);const p=D.newArray(h-m.length,0);let g=0,v=0;for(let _=0;_<m.length;_++){const x=m[_],y=i.findSlotIndex(x.slot);if(y==-1)throw new Error(`Slot not found: ${x.slot}`);for(;g!=y;)p[v++]=g++;f[g+x.offset]=g++}for(;g<h;)p[v++]=g++;for(let _=h-1;_>=0;_--)f[_]==-1&&(f[_]=p[--v])}o.setFrame(c++,this.getValue(d,"time",0),f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(t.events){const o=new Fa(t.events.length);let h=0;for(let c=0;c<t.events.length;c++){const u=t.events[c],d=i.findEvent(u.name);if(d==null)throw new Error(`Event not found: ${u.name}`);const f=new Yc(D.toSinglePrecision(this.getValue(u,"time",0)),d);f.intValue=this.getValue(u,"int",d.intValue),f.floatValue=this.getValue(u,"float",d.floatValue),f.stringValue=this.getValue(u,"string",d.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(u,"volume",1),f.balance=this.getValue(u,"balance",0)),o.setFrame(h++,f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new Zt(e,r,a))}readCurve(t,e,i){if(t.hasOwnProperty("curve"))if(t.curve==="stepped")e.setStepped(i);else{const n=t.curve;e.setCurve(i,n,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,i){return t[e]!==void 0?t[e]:i}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Z.NORMAL;if(t=="additive")return Z.ADD;if(t=="multiply")return Z.MULTIPLY;if(t=="screen")return Z.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return Xt.Fixed;if(t=="percent")return Xt.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return ce.Length;if(t=="fixed")return ce.Fixed;if(t=="percent")return ce.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return qt.Tangent;if(t=="chain")return qt.Chain;if(t=="chainscale")return qt.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return it.Normal;if(t=="onlytranslation")return it.OnlyTranslation;if(t=="norotationorreflection")return it.NoRotationOrReflection;if(t=="noscale")return it.NoScale;if(t=="noscaleorreflection")return it.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},Fw=class{constructor(t,e,i,n,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritDeform=r}},Bw=class extends Kn{createSkeleton(t){this.skeleton=new Hc(t),this.skeleton.updateWorldTransform(),this.stateData=new Vc(t),this.state=new ts(this.stateData)}};const Dw=Object.freeze(Object.defineProperty({__proto__:null,Animation:Zt,AnimationState:ts,AnimationStateAdapter:Iw,AnimationStateData:Vc,AtlasAttachmentLoader:Uc,Attachment:kc,AttachmentTimeline:Zi,Bone:Th,BoneData:Xc,BoundingBoxAttachment:ag,ClippingAttachment:hg,ColorTimeline:Ie,ConstraintData:Da,CurveTimeline:Xe,DeformTimeline:Nc,DrawOrderTimeline:Ln,Event:Yc,EventData:$c,EventQueue:Oc,EventTimeline:Fa,EventType:Fe,IkConstraint:xg,IkConstraintData:Gc,IkConstraintTimeline:xe,JitterEffect:Mw,MeshAttachment:ka,PathAttachment:Gr,PathConstraint:Qn,PathConstraintData:Wc,PathConstraintMixTimeline:Is,PathConstraintPositionTimeline:js,PathConstraintSpacingTimeline:Lc,PointAttachment:dg,RegionAttachment:lt,RotateTimeline:ge,ScaleTimeline:Bc,ShearTimeline:Dc,Skeleton:Hc,SkeletonBinary:Qt,SkeletonBounds:kw,SkeletonData:zc,SkeletonJson:_g,Skin:ua,SkinEntry:Ah,Slot:Fc,SlotData:jc,SpacingMode:ce,Spine:Bw,SwirlEffect:pg,TimelineType:gg,TrackEntry:Ba,TransformConstraint:yg,TransformConstraintData:qc,TransformConstraintTimeline:Re,TranslateTimeline:qe,TwoColorTimeline:Kt,VertexAttachment:Ni},Symbol.toStringTag,{value:"Module"}));let Zc=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}};const vg=class extends Zc{constructor(t){super(t),this.id=(vg.nextID++&65535)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)}computeWorldVertices(t,e,i,n,r,a){i=r+(i>>1)*a;const l=t.bone.skeleton,o=t.attachmentVertices;let h=this.vertices;const c=this.bones;if(c==null){o.length>0&&(h=o);const m=t.bone.matrix,p=m.tx,g=m.ty,v=m.a,_=m.c,x=m.b,y=m.d;for(let b=e,w=r;w<i;b+=2,w+=a){const E=h[b],S=h[b+1];n[w]=E*v+S*_+p,n[w+1]=E*x+S*y+g}return}let u=0,d=0;for(let m=0;m<e;m+=2){const p=c[u];u+=p+1,d+=p}const f=l.bones;if(o.length==0)for(let m=r,p=d*3;m<i;m+=a){let g=0,v=0,_=c[u++];for(_+=u;u<_;u++,p+=3){const x=f[c[u]].matrix,y=h[p],b=h[p+1],w=h[p+2];g+=(y*x.a+b*x.c+x.tx)*w,v+=(y*x.b+b*x.d+x.ty)*w}n[m]=g,n[m+1]=v}else{const m=o;for(let p=r,g=d*3,v=d<<1;p<i;p+=a){let _=0,x=0,y=c[u++];for(y+=u;u<y;u++,g+=3,v+=2){const b=f[c[u]].matrix,w=h[g]+m[v],E=h[g+1]+m[v+1],S=h[g+2];_+=(w*b.a+E*b.c+b.tx)*S,x+=(w*b.b+E*b.d+b.ty)*S}n[p]=_,n[p+1]=x}}}applyDeform(t){return this==t}};let Li=vg;Li.nextID=0;let bg=class extends Li{constructor(t){super(t),this.type=dt.BoundingBox,this.color=new H(1,1,1,1)}},wg=class extends Li{constructor(t){super(t),this.type=dt.Clipping,this.color=new H(.2275,.2275,.8078,1)}},Kc=class extends Li{constructor(t){super(t),this.type=dt.Mesh,this.color=new H(1,1,1,1),this.inheritDeform=!1,this.tempColor=new H(0,0,0,0)}applyDeform(t){return this==t||this.inheritDeform&&this.parentMesh==t}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},Wr=class extends Li{constructor(t){super(t),this.type=dt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new H(1,1,1,1)}},Eg=class extends Li{constructor(t){super(t),this.type=dt.Point,this.color=new H(.38,.94,0,1)}computeWorldPosition(t,e){const i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,i=C.cosDeg(this.rotation),n=C.sinDeg(this.rotation),r=i*e.a+n*e.c,a=i*e.b+n*e.d;return Math.atan2(a,r)*C.radDeg}},Qc=class{constructor(t,e){if(this.attachmentVertices=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new H,this.darkColor=t.darkColor==null?null:new H,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};const pe=class extends Zc{constructor(t){super(t),this.type=dt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new H(1,1,1,1),this.offset=D.newFloatArray(8),this.uvs=D.newFloatArray(8),this.tempColor=new H(1,1,1,1)}updateOffset(){const t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,n=-this.height/2*this.scaleY+this.region.offsetY*e,r=i+this.region.width*t,a=n+this.region.height*e,l=this.rotation*Math.PI/180,o=Math.cos(l),h=Math.sin(l),c=i*o+this.x,u=i*h,d=n*o+this.y,f=n*h,m=r*o+this.x,p=r*h,g=a*o+this.y,v=a*h,_=this.offset;_[pe.OX1]=c-f,_[pe.OY1]=d+u,_[pe.OX2]=c-v,_[pe.OY2]=g+u,_[pe.OX3]=m-v,_[pe.OY3]=g+p,_[pe.OX4]=m-f,_[pe.OY4]=d+p}setRegion(t){this.region=t;const e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,i,n){const r=this.offset,a=t instanceof Qc?t.bone.matrix:t.matrix,l=a.tx,o=a.ty,h=a.a,c=a.c,u=a.b,d=a.d;let f=0,m=0;f=r[pe.OX1],m=r[pe.OY1],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o,i+=n,f=r[pe.OX2],m=r[pe.OY2],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o,i+=n,f=r[pe.OX3],m=r[pe.OY3],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o,i+=n,f=r[pe.OX4],m=r[pe.OY4],e[i]=f*h+m*c+l,e[i+1]=f*u+m*d+o}};let ht=pe;ht.OX1=0;ht.OY1=1;ht.OX2=2;ht.OY2=3;ht.OX3=4;ht.OY3=5;ht.OX4=6;ht.OY4=7;ht.X1=0;ht.Y1=1;ht.C1R=2;ht.C1G=3;ht.C1B=4;ht.C1A=5;ht.U1=6;ht.V1=7;ht.X2=8;ht.Y2=9;ht.C2R=10;ht.C2G=11;ht.C2B=12;ht.C2A=13;ht.U2=14;ht.V2=15;ht.X3=16;ht.Y3=17;ht.C3R=18;ht.C3G=19;ht.C3B=20;ht.C3A=21;ht.U3=22;ht.V3=23;ht.X4=24;ht.Y4=25;ht.C4R=26;ht.C4G=27;ht.C4B=28;ht.C4A=29;ht.U4=30;ht.V4=31;class Nw{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,i,n){t.x+=C.randomTriangular(-this.jitterX,this.jitterY),t.y+=C.randomTriangular(-this.jitterX,this.jitterY)}end(){}}const Sg=class{constructor(s){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=s}begin(s){this.worldX=s.x+this.centerX,this.worldY=s.y+this.centerY}transform(s,t,e,i){const n=this.angle*C.degreesToRadians,r=s.x-this.worldX,a=s.y-this.worldY,l=Math.sqrt(r*r+a*a);if(l<this.radius){const o=Sg.interpolation.apply(0,n,(this.radius-l)/this.radius),h=Math.cos(o),c=Math.sin(o);s.x=h*r-c*a+this.worldX,s.y=c*r+h*a+this.worldY}}end(){}};let Tg=Sg;Tg.interpolation=new ig(2);let ne=class{constructor(t,e,i){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=i}apply(t,e,i,n,r,a,l,o){if(t==null)throw new Error("skeleton cannot be null.");n&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));const h=this.timelines;for(let c=0,u=h.length;c<u;c++)h[c].apply(t,e,i,r,a,l,o)}static binarySearch(t,e,i=1){let n=0,r=t.length/i-2;if(r==0)return i;let a=r>>>1;for(;;){if(t[(a+1)*i]<=e?n=a+1:r=a,n==r)return(n+1)*i;a=n+r>>>1}}static linearSearch(t,e,i){for(let n=0,r=t.length-i;n<=r;n+=i)if(t[n]>e)return n;return-1}};var Ag=(s=>(s[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor",s))(Ag||{});const zt=class{constructor(s){if(s<=0)throw new Error(`frameCount must be > 0: ${s}`);this.curves=D.newFloatArray((s-1)*zt.BEZIER_SIZE)}getFrameCount(){return this.curves.length/zt.BEZIER_SIZE+1}setLinear(s){this.curves[s*zt.BEZIER_SIZE]=zt.LINEAR}setStepped(s){this.curves[s*zt.BEZIER_SIZE]=zt.STEPPED}getCurveType(s){const t=s*zt.BEZIER_SIZE;if(t==this.curves.length)return zt.LINEAR;const e=this.curves[t];return e==zt.LINEAR?zt.LINEAR:e==zt.STEPPED?zt.STEPPED:zt.BEZIER}setCurve(s,t,e,i,n){const r=(-t*2+i)*.03,a=(-e*2+n)*.03,l=((t-i)*3+1)*.006,o=((e-n)*3+1)*.006;let h=r*2+l,c=a*2+o,u=t*.3+r+l*.16666667,d=e*.3+a+o*.16666667,f=s*zt.BEZIER_SIZE;const m=this.curves;m[f++]=zt.BEZIER;let p=u,g=d;for(let v=f+zt.BEZIER_SIZE-1;f<v;f+=2)m[f]=p,m[f+1]=g,u+=h,d+=c,h+=l,c+=o,p+=u,g+=d}getCurvePercent(s,t){t=C.clamp(t,0,1);const e=this.curves;let i=s*zt.BEZIER_SIZE;const n=e[i];if(n==zt.LINEAR)return t;if(n==zt.STEPPED)return 0;i++;let r=0;for(let l=i,o=i+zt.BEZIER_SIZE-1;i<o;i+=2)if(r=e[i],r>=t){let h,c;return i==l?(h=0,c=0):(h=e[i-2],c=e[i-1]),c+(e[i+1]-c)*(t-h)/(r-h)}const a=e[i-1];return a+(1-a)*(t-r)/(1-r)}};let Ye=zt;Ye.LINEAR=0;Ye.STEPPED=1;Ye.BEZIER=2;Ye.BEZIER_SIZE=10*2-1;const vi=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s<<1)}getPropertyId(){return 0+this.boneIndex}setFrame(s,t,e){s<<=1,this.frames[s]=t,this.frames[s+vi.ROTATION]=e}apply(s,t,e,i,n,r,a){const l=this.frames,o=s.bones[this.boneIndex];if(e<l[0]){switch(r){case T.setup:o.rotation=o.data.rotation;return;case T.first:const m=o.data.rotation-o.rotation;o.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*n}return}if(e>=l[l.length-vi.ENTRIES]){let m=l[l.length+vi.PREV_ROTATION];switch(r){case T.setup:o.rotation=o.data.rotation+m*n;break;case T.first:case T.replace:m+=o.data.rotation-o.rotation,m-=(16384-(16384.499999999996-m/360|0))*360;case T.add:o.rotation+=m*n}return}const h=ne.binarySearch(l,e,vi.ENTRIES),c=l[h+vi.PREV_ROTATION],u=l[h],d=this.getCurvePercent((h>>1)-1,1-(e-u)/(l[h+vi.PREV_TIME]-u));let f=l[h+vi.ROTATION]-c;switch(f=c+(f-(16384-(16384.499999999996-f/360|0))*360)*d,r){case T.setup:o.rotation=o.data.rotation+(f-(16384-(16384.499999999996-f/360|0))*360)*n;break;case T.first:case T.replace:f+=o.data.rotation-o.rotation;case T.add:o.rotation+=(f-(16384-(16384.499999999996-f/360|0))*360)*n}}};let Ce=vi;Ce.ENTRIES=2;Ce.PREV_TIME=-2;Ce.PREV_ROTATION=-1;Ce.ROTATION=1;const Ee=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*Ee.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(s,t,e,i){s*=Ee.ENTRIES,this.frames[s]=t,this.frames[s+Ee.X]=e,this.frames[s+Ee.Y]=i}apply(s,t,e,i,n,r,a){const l=this.frames,o=s.bones[this.boneIndex];if(e<l[0]){switch(r){case T.setup:o.x=o.data.x,o.y=o.data.y;return;case T.first:o.x+=(o.data.x-o.x)*n,o.y+=(o.data.y-o.y)*n}return}let h=0,c=0;if(e>=l[l.length-Ee.ENTRIES])h=l[l.length+Ee.PREV_X],c=l[l.length+Ee.PREV_Y];else{const u=ne.binarySearch(l,e,Ee.ENTRIES);h=l[u+Ee.PREV_X],c=l[u+Ee.PREV_Y];const d=l[u],f=this.getCurvePercent(u/Ee.ENTRIES-1,1-(e-d)/(l[u+Ee.PREV_TIME]-d));h+=(l[u+Ee.X]-h)*f,c+=(l[u+Ee.Y]-c)*f}switch(r){case T.setup:o.x=o.data.x+h*n,o.y=o.data.y+c*n;break;case T.first:case T.replace:o.x+=(o.data.x+h-o.x)*n,o.y+=(o.data.y+c-o.y)*n;break;case T.add:o.x+=h*n,o.y+=c*n}}};let Rs=Ee;Rs.ENTRIES=3;Rs.PREV_TIME=-3;Rs.PREV_X=-2;Rs.PREV_Y=-1;Rs.X=1;Rs.Y=2;let Cg=class xs extends Rs{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(i<o[0]){switch(a){case T.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case T.first:h.scaleX+=(h.data.scaleX-h.scaleX)*r,h.scaleY+=(h.data.scaleY-h.scaleY)*r}return}let c=0,u=0;if(i>=o[o.length-xs.ENTRIES])c=o[o.length+xs.PREV_X]*h.data.scaleX,u=o[o.length+xs.PREV_Y]*h.data.scaleY;else{const d=ne.binarySearch(o,i,xs.ENTRIES);c=o[d+xs.PREV_X],u=o[d+xs.PREV_Y];const f=o[d],m=this.getCurvePercent(d/xs.ENTRIES-1,1-(i-f)/(o[d+xs.PREV_TIME]-f));c=(c+(o[d+xs.X]-c)*m)*h.data.scaleX,u=(u+(o[d+xs.Y]-u)*m)*h.data.scaleY}if(r==1)a==T.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=u-h.data.scaleY):(h.scaleX=c,h.scaleY=u);else{let d=0,f=0;if(l==ct.mixOut)switch(a){case T.setup:d=h.data.scaleX,f=h.data.scaleY,h.scaleX=d+(Math.abs(c)*C.signum(d)-d)*r,h.scaleY=f+(Math.abs(u)*C.signum(f)-f)*r;break;case T.first:case T.replace:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*C.signum(d)-d)*r,h.scaleY=f+(Math.abs(u)*C.signum(f)-f)*r;break;case T.add:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*C.signum(d)-h.data.scaleX)*r,h.scaleY=f+(Math.abs(u)*C.signum(f)-h.data.scaleY)*r}else switch(a){case T.setup:d=Math.abs(h.data.scaleX)*C.signum(c),f=Math.abs(h.data.scaleY)*C.signum(u),h.scaleX=d+(c-d)*r,h.scaleY=f+(u-f)*r;break;case T.first:case T.replace:d=Math.abs(h.scaleX)*C.signum(c),f=Math.abs(h.scaleY)*C.signum(u),h.scaleX=d+(c-d)*r,h.scaleY=f+(u-f)*r;break;case T.add:d=C.signum(c),f=C.signum(u),h.scaleX=Math.abs(h.scaleX)*d+(c-Math.abs(h.data.scaleX)*d)*r,h.scaleY=Math.abs(h.scaleY)*f+(u-Math.abs(h.data.scaleY)*f)*r}}}},Mg=class ys extends Rs{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.bones[this.boneIndex];if(i<o[0]){switch(a){case T.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case T.first:h.shearX+=(h.data.shearX-h.shearX)*r,h.shearY+=(h.data.shearY-h.shearY)*r}return}let c=0,u=0;if(i>=o[o.length-ys.ENTRIES])c=o[o.length+ys.PREV_X],u=o[o.length+ys.PREV_Y];else{const d=ne.binarySearch(o,i,ys.ENTRIES);c=o[d+ys.PREV_X],u=o[d+ys.PREV_Y];const f=o[d],m=this.getCurvePercent(d/ys.ENTRIES-1,1-(i-f)/(o[d+ys.PREV_TIME]-f));c=c+(o[d+ys.X]-c)*m,u=u+(o[d+ys.Y]-u)*m}switch(a){case T.setup:h.shearX=h.data.shearX+c*r,h.shearY=h.data.shearY+u*r;break;case T.first:case T.replace:h.shearX+=(h.data.shearX+c-h.shearX)*r,h.shearY+=(h.data.shearY+u-h.shearY)*r;break;case T.add:h.shearX+=c*r,h.shearY+=u*r}}};const Ot=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*Ot.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(s,t,e,i,n,r){s*=Ot.ENTRIES,this.frames[s]=t,this.frames[s+Ot.R]=e,this.frames[s+Ot.G]=i,this.frames[s+Ot.B]=n,this.frames[s+Ot.A]=r}apply(s,t,e,i,n,r,a){const l=s.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(r){case T.setup:l.color.setFromColor(l.data.color);return;case T.first:const f=l.color,m=l.data.color;f.add((m.r-f.r)*n,(m.g-f.g)*n,(m.b-f.b)*n,(m.a-f.a)*n)}return}let h=0,c=0,u=0,d=0;if(e>=o[o.length-Ot.ENTRIES]){const f=o.length;h=o[f+Ot.PREV_R],c=o[f+Ot.PREV_G],u=o[f+Ot.PREV_B],d=o[f+Ot.PREV_A]}else{const f=ne.binarySearch(o,e,Ot.ENTRIES);h=o[f+Ot.PREV_R],c=o[f+Ot.PREV_G],u=o[f+Ot.PREV_B],d=o[f+Ot.PREV_A];const m=o[f],p=this.getCurvePercent(f/Ot.ENTRIES-1,1-(e-m)/(o[f+Ot.PREV_TIME]-m));h+=(o[f+Ot.R]-h)*p,c+=(o[f+Ot.G]-c)*p,u+=(o[f+Ot.B]-u)*p,d+=(o[f+Ot.A]-d)*p}if(n==1)l.color.set(h,c,u,d);else{const f=l.color;r==T.setup&&f.setFromColor(l.data.color),f.add((h-f.r)*n,(c-f.g)*n,(u-f.b)*n,(d-f.a)*n)}}};let Ze=Ot;Ze.ENTRIES=5;Ze.PREV_TIME=-5;Ze.PREV_R=-4;Ze.PREV_G=-3;Ze.PREV_B=-2;Ze.PREV_A=-1;Ze.R=1;Ze.G=2;Ze.B=3;Ze.A=4;const _t=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*_t.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(s,t,e,i,n,r,a,l,o){s*=_t.ENTRIES,this.frames[s]=t,this.frames[s+_t.R]=e,this.frames[s+_t.G]=i,this.frames[s+_t.B]=n,this.frames[s+_t.A]=r,this.frames[s+_t.R2]=a,this.frames[s+_t.G2]=l,this.frames[s+_t.B2]=o}apply(s,t,e,i,n,r,a){const l=s.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(r){case T.setup:l.color.setFromColor(l.data.color),l.darkColor.setFromColor(l.data.darkColor);return;case T.first:const g=l.color,v=l.darkColor,_=l.data.color,x=l.data.darkColor;g.add((_.r-g.r)*n,(_.g-g.g)*n,(_.b-g.b)*n,(_.a-g.a)*n),v.add((x.r-v.r)*n,(x.g-v.g)*n,(x.b-v.b)*n,0)}return}let h=0,c=0,u=0,d=0,f=0,m=0,p=0;if(e>=o[o.length-_t.ENTRIES]){const g=o.length;h=o[g+_t.PREV_R],c=o[g+_t.PREV_G],u=o[g+_t.PREV_B],d=o[g+_t.PREV_A],f=o[g+_t.PREV_R2],m=o[g+_t.PREV_G2],p=o[g+_t.PREV_B2]}else{const g=ne.binarySearch(o,e,_t.ENTRIES);h=o[g+_t.PREV_R],c=o[g+_t.PREV_G],u=o[g+_t.PREV_B],d=o[g+_t.PREV_A],f=o[g+_t.PREV_R2],m=o[g+_t.PREV_G2],p=o[g+_t.PREV_B2];const v=o[g],_=this.getCurvePercent(g/_t.ENTRIES-1,1-(e-v)/(o[g+_t.PREV_TIME]-v));h+=(o[g+_t.R]-h)*_,c+=(o[g+_t.G]-c)*_,u+=(o[g+_t.B]-u)*_,d+=(o[g+_t.A]-d)*_,f+=(o[g+_t.R2]-f)*_,m+=(o[g+_t.G2]-m)*_,p+=(o[g+_t.B2]-p)*_}if(n==1)l.color.set(h,c,u,d),l.darkColor.set(f,m,p,1);else{const g=l.color,v=l.darkColor;r==T.setup&&(g.setFromColor(l.data.color),v.setFromColor(l.data.darkColor)),g.add((h-g.r)*n,(c-g.g)*n,(u-g.b)*n,(d-g.a)*n),v.add((f-v.r)*n,(m-v.g)*n,(p-v.b)*n,0)}}};let ie=_t;ie.ENTRIES=8;ie.PREV_TIME=-8;ie.PREV_R=-7;ie.PREV_G=-6;ie.PREV_B=-5;ie.PREV_A=-4;ie.PREV_R2=-3;ie.PREV_G2=-2;ie.PREV_B2=-1;ie.R=1;ie.G=2;ie.B=3;ie.A=4;ie.R2=5;ie.G2=6;ie.B2=7;let da=class{constructor(t){this.frames=D.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(l==ct.mixOut&&a==T.setup){const d=o.data.attachmentName;o.setAttachment(d==null?null:t.getAttachment(this.slotIndex,d));return}const h=this.frames;if(i<h[0]){if(a==T.setup||a==T.first){const d=o.data.attachmentName;o.setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))}return}let c=0;i>=h[h.length-1]?c=h.length-1:c=ne.binarySearch(h,i,1)-1;const u=this.attachmentNames[c];t.slots[this.slotIndex].setAttachment(u==null?null:t.getAttachment(this.slotIndex,u))}},kf=null,Ig=class extends Ye{constructor(t){super(t),this.frames=D.newFloatArray(t),this.frameVertices=new Array(t),kf==null&&(kf=D.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,i){this.frames[t]=e,this.frameVertices[t]=i}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex],h=o.getAttachment();if(!(h instanceof Li)||!h.applyDeform(this.attachment))return;const c=o.attachmentVertices;c.length==0&&(a=T.setup);const u=this.frameVertices,d=u[0].length,f=this.frames;if(i<f[0]){const y=h;switch(a){case T.setup:c.length=0;return;case T.first:if(r==1){c.length=0;break}const b=D.setArraySize(c,d);if(y.bones==null){const w=y.vertices;for(let E=0;E<d;E++)b[E]+=(w[E]-b[E])*r}else{r=1-r;for(let w=0;w<d;w++)b[w]*=r}}return}const m=D.setArraySize(c,d);if(i>=f[f.length-1]){const y=u[f.length-1];if(r==1)if(a==T.add){const b=h;if(b.bones==null){const w=b.vertices;for(let E=0;E<d;E++)m[E]+=y[E]-w[E]}else for(let w=0;w<d;w++)m[w]+=y[w]}else D.arrayCopy(y,0,m,0,d);else switch(a){case T.setup:{const w=h;if(w.bones==null){const E=w.vertices;for(let S=0;S<d;S++){const A=E[S];m[S]=A+(y[S]-A)*r}}else for(let E=0;E<d;E++)m[E]=y[E]*r;break}case T.first:case T.replace:for(let w=0;w<d;w++)m[w]+=(y[w]-m[w])*r;case T.add:const b=h;if(b.bones==null){const w=b.vertices;for(let E=0;E<d;E++)m[E]+=(y[E]-w[E])*r}else for(let w=0;w<d;w++)m[w]+=y[w]*r}return}const p=ne.binarySearch(f,i),g=u[p-1],v=u[p],_=f[p],x=this.getCurvePercent(p-1,1-(i-_)/(f[p-1]-_));if(r==1)if(a==T.add){const y=h;if(y.bones==null){const b=y.vertices;for(let w=0;w<d;w++){const E=g[w];m[w]+=E+(v[w]-E)*x-b[w]}}else for(let b=0;b<d;b++){const w=g[b];m[b]+=w+(v[b]-w)*x}}else for(let y=0;y<d;y++){const b=g[y];m[y]=b+(v[y]-b)*x}else switch(a){case T.setup:{const b=h;if(b.bones==null){const w=b.vertices;for(let E=0;E<d;E++){const S=g[E],A=w[E];m[E]=A+(S+(v[E]-S)*x-A)*r}}else for(let w=0;w<d;w++){const E=g[w];m[w]=(E+(v[w]-E)*x)*r}break}case T.first:case T.replace:for(let b=0;b<d;b++){const w=g[b];m[b]+=(w+(v[b]-w)*x-m[b])*r}break;case T.add:const y=h;if(y.bones==null){const b=y.vertices;for(let w=0;w<d;w++){const E=g[w];m[w]+=(E+(v[w]-E)*x-b[w])*r}}else for(let b=0;b<d;b++){const w=g[b];m[b]+=(w+(v[b]-w)*x)*r}}}},Rg=class{constructor(t){this.frames=D.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,i,n,r,a,l){if(n==null)return;const o=this.frames,h=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,n,r,a,l),e=-1;else if(e>=o[h-1])return;if(i<o[0])return;let c=0;if(e<o[0])c=0;else{c=ne.binarySearch(o,e);const u=o[c];for(;c>0&&o[c-1]==u;)c--}for(;c<h&&i>=o[c];c++)n.push(this.events[c])}},fa=class{constructor(t){this.frames=D.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.drawOrders[t]=i}apply(t,e,i,n,r,a,l){const o=t.drawOrder,h=t.slots;if(l==ct.mixOut&&a==T.setup){D.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}const c=this.frames;if(i<c[0]){(a==T.setup||a==T.first)&&D.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let u=0;i>=c[c.length-1]?u=c.length-1:u=ne.binarySearch(c,i)-1;const d=this.drawOrders[u];if(d==null)D.arrayCopy(h,0,o,0,h.length);else for(let f=0,m=d.length;f<m;f++)o[f]=h[d[f]]}};const Ct=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*Ct.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(s,t,e,i,n,r){s*=Ct.ENTRIES,this.frames[s]=t,this.frames[s+Ct.MIX]=e,this.frames[s+Ct.BEND_DIRECTION]=i,this.frames[s+Ct.COMPRESS]=n?1:0,this.frames[s+Ct.STRETCH]=r?1:0}apply(s,t,e,i,n,r,a){const l=this.frames,o=s.ikConstraints[this.ikConstraintIndex];if(e<l[0]){switch(r){case T.setup:o.mix=o.data.mix,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case T.first:o.mix+=(o.data.mix-o.mix)*n,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}if(e>=l[l.length-Ct.ENTRIES]){r==T.setup?(o.mix=o.data.mix+(l[l.length+Ct.PREV_MIX]-o.data.mix)*n,a==ct.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=l[l.length+Ct.PREV_BEND_DIRECTION],o.compress=l[l.length+Ct.PREV_COMPRESS]!=0,o.stretch=l[l.length+Ct.PREV_STRETCH]!=0)):(o.mix+=(l[l.length+Ct.PREV_MIX]-o.mix)*n,a==ct.mixIn&&(o.bendDirection=l[l.length+Ct.PREV_BEND_DIRECTION],o.compress=l[l.length+Ct.PREV_COMPRESS]!=0,o.stretch=l[l.length+Ct.PREV_STRETCH]!=0));return}const h=ne.binarySearch(l,e,Ct.ENTRIES),c=l[h+Ct.PREV_MIX],u=l[h],d=this.getCurvePercent(h/Ct.ENTRIES-1,1-(e-u)/(l[h+Ct.PREV_TIME]-u));r==T.setup?(o.mix=o.data.mix+(c+(l[h+Ct.MIX]-c)*d-o.data.mix)*n,a==ct.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=l[h+Ct.PREV_BEND_DIRECTION],o.compress=l[h+Ct.PREV_COMPRESS]!=0,o.stretch=l[h+Ct.PREV_STRETCH]!=0)):(o.mix+=(c+(l[h+Ct.MIX]-c)*d-o.mix)*n,a==ct.mixIn&&(o.bendDirection=l[h+Ct.PREV_BEND_DIRECTION],o.compress=l[h+Ct.PREV_COMPRESS]!=0,o.stretch=l[h+Ct.PREV_STRETCH]!=0))}};let Ke=Ct;Ke.ENTRIES=5;Ke.PREV_TIME=-5;Ke.PREV_MIX=-4;Ke.PREV_BEND_DIRECTION=-3;Ke.PREV_COMPRESS=-2;Ke.PREV_STRETCH=-1;Ke.MIX=1;Ke.BEND_DIRECTION=2;Ke.COMPRESS=3;Ke.STRETCH=4;const Vt=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*Vt.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(s,t,e,i,n,r){s*=Vt.ENTRIES,this.frames[s]=t,this.frames[s+Vt.ROTATE]=e,this.frames[s+Vt.TRANSLATE]=i,this.frames[s+Vt.SCALE]=n,this.frames[s+Vt.SHEAR]=r}apply(s,t,e,i,n,r,a){const l=this.frames,o=s.transformConstraints[this.transformConstraintIndex];if(e<l[0]){const f=o.data;switch(r){case T.setup:o.rotateMix=f.rotateMix,o.translateMix=f.translateMix,o.scaleMix=f.scaleMix,o.shearMix=f.shearMix;return;case T.first:o.rotateMix+=(f.rotateMix-o.rotateMix)*n,o.translateMix+=(f.translateMix-o.translateMix)*n,o.scaleMix+=(f.scaleMix-o.scaleMix)*n,o.shearMix+=(f.shearMix-o.shearMix)*n}return}let h=0,c=0,u=0,d=0;if(e>=l[l.length-Vt.ENTRIES]){const f=l.length;h=l[f+Vt.PREV_ROTATE],c=l[f+Vt.PREV_TRANSLATE],u=l[f+Vt.PREV_SCALE],d=l[f+Vt.PREV_SHEAR]}else{const f=ne.binarySearch(l,e,Vt.ENTRIES);h=l[f+Vt.PREV_ROTATE],c=l[f+Vt.PREV_TRANSLATE],u=l[f+Vt.PREV_SCALE],d=l[f+Vt.PREV_SHEAR];const m=l[f],p=this.getCurvePercent(f/Vt.ENTRIES-1,1-(e-m)/(l[f+Vt.PREV_TIME]-m));h+=(l[f+Vt.ROTATE]-h)*p,c+=(l[f+Vt.TRANSLATE]-c)*p,u+=(l[f+Vt.SCALE]-u)*p,d+=(l[f+Vt.SHEAR]-d)*p}if(r==T.setup){const f=o.data;o.rotateMix=f.rotateMix+(h-f.rotateMix)*n,o.translateMix=f.translateMix+(c-f.translateMix)*n,o.scaleMix=f.scaleMix+(u-f.scaleMix)*n,o.shearMix=f.shearMix+(d-f.shearMix)*n}else o.rotateMix+=(h-o.rotateMix)*n,o.translateMix+=(c-o.translateMix)*n,o.scaleMix+=(u-o.scaleMix)*n,o.shearMix+=(d-o.shearMix)*n}};let Qe=Vt;Qe.ENTRIES=5;Qe.PREV_TIME=-5;Qe.PREV_ROTATE=-4;Qe.PREV_TRANSLATE=-3;Qe.PREV_SCALE=-2;Qe.PREV_SHEAR=-1;Qe.ROTATE=1;Qe.TRANSLATE=2;Qe.SCALE=3;Qe.SHEAR=4;const _s=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*_s.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(s,t,e){s*=_s.ENTRIES,this.frames[s]=t,this.frames[s+_s.VALUE]=e}apply(s,t,e,i,n,r,a){const l=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(e<l[0]){switch(r){case T.setup:o.position=o.data.position;return;case T.first:o.position+=(o.data.position-o.position)*n}return}let h=0;if(e>=l[l.length-_s.ENTRIES])h=l[l.length+_s.PREV_VALUE];else{const c=ne.binarySearch(l,e,_s.ENTRIES);h=l[c+_s.PREV_VALUE];const u=l[c],d=this.getCurvePercent(c/_s.ENTRIES-1,1-(e-u)/(l[c+_s.PREV_TIME]-u));h+=(l[c+_s.VALUE]-h)*d}r==T.setup?o.position=o.data.position+(h-o.data.position)*n:o.position+=(h-o.position)*n}};let Pi=_s;Pi.ENTRIES=2;Pi.PREV_TIME=-2;Pi.PREV_VALUE=-1;Pi.VALUE=1;let Pg=class bi extends Pi{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,i,n,r,a,l){const o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(i<o[0]){switch(a){case T.setup:h.spacing=h.data.spacing;return;case T.first:h.spacing+=(h.data.spacing-h.spacing)*r}return}let c=0;if(i>=o[o.length-bi.ENTRIES])c=o[o.length+bi.PREV_VALUE];else{const u=ne.binarySearch(o,i,bi.ENTRIES);c=o[u+bi.PREV_VALUE];const d=o[u],f=this.getCurvePercent(u/bi.ENTRIES-1,1-(i-d)/(o[u+bi.PREV_TIME]-d));c+=(o[u+bi.VALUE]-c)*f}a==T.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*r:h.spacing+=(c-h.spacing)*r}};const Se=class extends Ye{constructor(s){super(s),this.frames=D.newFloatArray(s*Se.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(s,t,e,i){s*=Se.ENTRIES,this.frames[s]=t,this.frames[s+Se.ROTATE]=e,this.frames[s+Se.TRANSLATE]=i}apply(s,t,e,i,n,r,a){const l=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(e<l[0]){switch(r){case T.setup:o.rotateMix=o.data.rotateMix,o.translateMix=o.data.translateMix;return;case T.first:o.rotateMix+=(o.data.rotateMix-o.rotateMix)*n,o.translateMix+=(o.data.translateMix-o.translateMix)*n}return}let h=0,c=0;if(e>=l[l.length-Se.ENTRIES])h=l[l.length+Se.PREV_ROTATE],c=l[l.length+Se.PREV_TRANSLATE];else{const u=ne.binarySearch(l,e,Se.ENTRIES);h=l[u+Se.PREV_ROTATE],c=l[u+Se.PREV_TRANSLATE];const d=l[u],f=this.getCurvePercent(u/Se.ENTRIES-1,1-(e-d)/(l[u+Se.PREV_TIME]-d));h+=(l[u+Se.ROTATE]-h)*f,c+=(l[u+Se.TRANSLATE]-c)*f}r==T.setup?(o.rotateMix=o.data.rotateMix+(h-o.data.rotateMix)*n,o.translateMix=o.data.translateMix+(c-o.data.translateMix)*n):(o.rotateMix+=(h-o.rotateMix)*n,o.translateMix+=(c-o.translateMix)*n)}};let pi=Se;pi.ENTRIES=3;pi.PREV_TIME=-3;pi.PREV_ROTATE=-2;pi.PREV_TRANSLATE=-1;pi.ROTATE=1;pi.TRANSLATE=2;const oe=class{constructor(t){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new Jc(this),this.propertyIDs=new eg,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new Pa(()=>new Na),this.data=t}update(t){t*=this.timeScale;const e=this.tracks;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r==null)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let a=t*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}let l=r.next;if(l!=null){const o=r.trackLast-l.delay;if(o>=0){for(l.delay=0,l.trackTime=r.timeScale==0?0:(o/r.timeScale+t)*l.timeScale,r.trackTime+=a,this.setCurrent(i,l,!0);l.mixingFrom!=null;)l.mixTime+=t,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&r.mixingFrom==null){e[i]=null,this.queue.end(r),this.disposeNext(r);continue}if(r.mixingFrom!=null&&this.updateMixingFrom(r,t)){let o=r.mixingFrom;for(r.mixingFrom=null,o!=null&&(o.mixingTo=null);o!=null;)this.queue.end(o),o=o.mixingFrom}r.trackTime+=a}this.queue.drain()}updateMixingFrom(t,e){const i=t.mixingFrom;if(i==null)return!0;const n=this.updateMixingFrom(i,e);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?((i.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=i.mixingFrom,i.mixingFrom!=null&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),n):(i.trackTime+=e*i.timeScale,t.mixTime+=e,!1)}apply(t){if(t==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const e=this.events,i=this.tracks;let n=!1;for(let r=0,a=i.length;r<a;r++){const l=i[r];if(l==null||l.delay>0)continue;n=!0;const o=r==0?T.first:l.mixBlend;let h=l.alpha;l.mixingFrom!=null?h*=this.applyMixingFrom(l,t,o):l.trackTime>=l.trackEnd&&l.next==null&&(h=0);const c=l.animationLast,u=l.getAnimationTime(),d=l.animation.timelines.length,f=l.animation.timelines;if(r==0&&h==1||o==T.add)for(let m=0;m<d;m++)f[m].apply(t,c,u,e,h,o,ct.mixIn);else{const m=l.timelineMode,p=l.timelinesRotation.length==0;p&&D.setArraySize(l.timelinesRotation,d<<1,null);const g=l.timelinesRotation;for(let v=0;v<d;v++){const _=f[v],x=m[v]==oe.SUBSEQUENT?o:T.setup;_ instanceof Ce?this.applyRotateTimeline(_,t,u,h,x,g,v<<1,p):_.apply(t,c,u,e,h,x,ct.mixIn)}}this.queueEvents(l,u),e.length=0,l.nextAnimationLast=u,l.nextTrackLast=l.trackTime}return this.queue.drain(),n}applyMixingFrom(t,e,i){const n=t.mixingFrom;n.mixingFrom!=null&&this.applyMixingFrom(n,e,i);let r=0;t.mixDuration==0?(r=1,i==T.first&&(i=T.setup)):(r=t.mixTime/t.mixDuration,r>1&&(r=1),i!=T.first&&(i=n.mixBlend));const a=r<n.eventThreshold?this.events:null,l=r<n.attachmentThreshold,o=r<n.drawOrderThreshold,h=n.animationLast,c=n.getAnimationTime(),u=n.animation.timelines.length,d=n.animation.timelines,f=n.alpha*t.interruptAlpha,m=f*(1-r);if(i==T.add)for(let p=0;p<u;p++)d[p].apply(e,h,c,a,m,i,ct.mixOut);else{const p=n.timelineMode,g=n.timelineHoldMix,v=n.timelinesRotation.length==0;v&&D.setArraySize(n.timelinesRotation,u<<1,null);const _=n.timelinesRotation;n.totalAlpha=0;for(let x=0;x<u;x++){const y=d[x];let b=ct.mixOut,w,E=0;switch(p[x]){case oe.SUBSEQUENT:if(!l&&y instanceof da||!o&&y instanceof fa)continue;w=i,E=m;break;case oe.FIRST:w=T.setup,E=m;break;case oe.HOLD:w=T.setup,E=f;break;default:w=T.setup;const S=g[x];E=f*Math.max(0,1-S.mixTime/S.mixDuration);break}n.totalAlpha+=E,y instanceof Ce?this.applyRotateTimeline(y,e,c,E,w,_,x<<1,v):(w==T.setup&&(y instanceof da?l&&(b=ct.mixOut):y instanceof fa&&o&&(b=ct.mixOut)),y.apply(e,h,c,a,E,w,b))}}return t.mixDuration>0&&this.queueEvents(n,c),this.events.length=0,n.nextAnimationLast=c,n.nextTrackLast=n.trackTime,r}applyRotateTimeline(t,e,i,n,r,a,l,o){if(o&&(a[l]=0),n==1){t.apply(e,0,i,null,1,r,ct.mixIn);return}const h=t,c=h.frames,u=e.bones[h.boneIndex];let d=0,f=0;if(i<c[0])switch(r){case T.setup:u.rotation=u.data.rotation;default:return;case T.first:d=u.rotation,f=u.data.rotation}else if(d=r==T.setup?u.data.rotation:u.rotation,i>=c[c.length-Ce.ENTRIES])f=u.data.rotation+c[c.length+Ce.PREV_ROTATION];else{const g=ne.binarySearch(c,i,Ce.ENTRIES),v=c[g+Ce.PREV_ROTATION],_=c[g],x=h.getCurvePercent((g>>1)-1,1-(i-_)/(c[g+Ce.PREV_TIME]-_));f=c[g+Ce.ROTATION]-v,f-=(16384-(16384.499999999996-f/360|0))*360,f=v+f*x+u.data.rotation,f-=(16384-(16384.499999999996-f/360|0))*360}let m=0,p=f-d;if(p-=(16384-(16384.499999999996-p/360|0))*360,p==0)m=a[l];else{let g=0,v=0;o?(g=0,v=p):(g=a[l],v=a[l+1]);const _=p>0;let x=g>=0;C.signum(v)!=C.signum(p)&&Math.abs(v)<=90&&(Math.abs(g)>180&&(g+=360*C.signum(g)),x=_),m=p+g-g%360,x!=_&&(m+=360*C.signum(g)),a[l]=m}a[l+1]=p,d+=m*n,u.rotation=d-(16384-(16384.499999999996-d/360|0))*360}queueEvents(t,e){const i=t.animationStart,n=t.animationEnd,r=n-i,a=t.trackLast%r,l=this.events;let o=0;const h=l.length;for(;o<h;o++){const u=l[o];if(u.time<a)break;u.time>n||this.queue.event(t,u)}let c=!1;for(t.loop?c=r==0||a>t.trackTime%r:c=e>=n&&t.animationLast<n,c&&this.queue.complete(t);o<h;o++)l[o].time<i||this.queue.event(t,l[o])}clearTracks(){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;const e=this.tracks[t];if(e==null)return;this.queue.end(e),this.disposeNext(e);let i=e;for(;;){const n=i.mixingFrom;if(n==null)break;this.queue.end(n),i.mixingFrom=null,i.mixingTo=null,i=n}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,i){const n=this.expandToIndex(t);this.tracks[t]=e,n!=null&&(i&&this.queue.interrupt(n),e.mixingFrom=n,n.mixingTo=e,e.mixTime=0,n.mixingFrom!=null&&n.mixDuration>0&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,i){const n=this.data.skeletonData.findAnimation(e);if(n==null)throw new Error(`Animation not found: ${e}`);return this.setAnimationWith(t,n,i)}setAnimationWith(t,e,i){if(e==null)throw new Error("animation cannot be null.");let n=!0,r=this.expandToIndex(t);r!=null&&(r.nextTrackLast==-1?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,n=!1):this.disposeNext(r));const a=this.trackEntry(t,e,i,r);return this.setCurrent(t,a,n),this.queue.drain(),a}addAnimation(t,e,i,n){const r=this.data.skeletonData.findAnimation(e);if(r==null)throw new Error(`Animation not found: ${e}`);return this.addAnimationWith(t,r,i,n)}addAnimationWith(t,e,i,n){if(e==null)throw new Error("animation cannot be null.");let r=this.expandToIndex(t);if(r!=null)for(;r.next!=null;)r=r.next;const a=this.trackEntry(t,e,i,r);if(r==null)this.setCurrent(t,a,!0),this.queue.drain();else if(r.next=a,n<=0){const l=r.animationEnd-r.animationStart;l!=0?(r.loop?n+=l*(1+(r.trackTime/l|0)):n+=Math.max(l,r.trackTime),n-=this.data.getMix(r.animation,e)):n=r.trackTime}return a.delay=n,a}setEmptyAnimation(t,e){const i=this.setAnimationWith(t,oe.emptyAnimation,!1);return i.mixDuration=e,i.trackEnd=e,i}addEmptyAnimation(t,e,i){i<=0&&(i-=e);const n=this.addAnimationWith(t,oe.emptyAnimation,!1,i);return n.mixDuration=e,n.trackEnd=e,n}setEmptyAnimations(t){const e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,n=this.tracks.length;i<n;i++){const r=this.tracks[i];r!=null&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(D.ensureArrayCapacity(this.tracks,t-this.tracks.length+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,i,n){const r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=i,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=n==null?0:this.data.getMix(n.animation,e),r}disposeNext(t){let e=t.next;for(;e!=null;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let t=0,e=this.tracks.length;t<e;t++){let i=this.tracks[t];if(i!=null){for(;i.mixingFrom!=null;)i=i.mixingFrom;do(i.mixingFrom==null||i.mixBlend!=T.add)&&this.setTimelineModes(i),i=i.mixingTo;while(i!=null)}}}setTimelineModes(t){const e=t.mixingTo,i=t.animation.timelines,n=t.animation.timelines.length,r=D.setArraySize(t.timelineMode,n);t.timelineHoldMix.length=0;const a=D.setArraySize(t.timelineHoldMix,n),l=this.propertyIDs;if(e!=null&&e.holdPrevious){for(let o=0;o<n;o++)l.add(i[o].getPropertyId()),r[o]=oe.HOLD;return}t:for(let o=0;o<n;o++){const h=i[o].getPropertyId();if(!l.add(h))r[o]=oe.SUBSEQUENT;else if(e==null||!this.hasTimeline(e,h))r[o]=oe.FIRST;else{for(let c=e.mixingTo;c!=null;c=c.mixingTo)if(!this.hasTimeline(c,h)){if(t.mixDuration>0){r[o]=oe.HOLD_MIX,a[o]=c;continue t}break}r[o]=oe.HOLD}}}hasTimeline(t,e){const i=t.animation.timelines;for(let n=0,r=i.length;n<r;n++)if(i[n].getPropertyId()==e)return!0;return!1}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(t==null)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(t,e,i){oe.deprecatedWarning1||(oe.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(t,e,i)}addAnimationByName(t,e,i,n){oe.deprecatedWarning2||(oe.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(t,e,i,n)}hasAnimation(t){return this.data.skeletonData.findAnimation(t)!==null}hasAnimationByName(t){return oe.deprecatedWarning3||(oe.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(t)}};let Zs=oe;Zs.emptyAnimation=new ne("<empty>",[],0);Zs.SUBSEQUENT=0;Zs.FIRST=1;Zs.HOLD=2;Zs.HOLD_MIX=3;Zs.deprecatedWarning1=!1;Zs.deprecatedWarning2=!1;Zs.deprecatedWarning3=!1;const ii=class{constructor(){this.mixBlend=T.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return ii.deprecatedWarning1||(ii.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(t){ii.deprecatedWarning1||(ii.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=t}get endTime(){return ii.deprecatedWarning2||(ii.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(t){ii.deprecatedWarning2||(ii.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=t}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let Na=ii;Na.deprecatedWarning1=!1;Na.deprecatedWarning2=!1;const Ch=class{constructor(s){this.objects=[],this.drainDisabled=!1,this.animState=s}start(s){this.objects.push(Be.start),this.objects.push(s),this.animState.animationsChanged=!0}interrupt(s){this.objects.push(Be.interrupt),this.objects.push(s)}end(s){this.objects.push(Be.end),this.objects.push(s),this.animState.animationsChanged=!0}dispose(s){this.objects.push(Be.dispose),this.objects.push(s)}complete(s){this.objects.push(Be.complete),this.objects.push(s)}event(s,t){this.objects.push(Be.event),this.objects.push(s),this.objects.push(t)}deprecateStuff(){return Ch.deprecatedWarning1||(Ch.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const s=this.objects,t=this.animState.listeners;for(let e=0;e<s.length;e+=2){const i=s[e],n=s[e+1];switch(i){case Be.start:n.listener!=null&&n.listener.start&&n.listener.start(n);for(let l=0;l<t.length;l++)t[l].start&&t[l].start(n);n.onStart&&this.deprecateStuff()&&n.onStart(n.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(n.trackIndex);break;case Be.interrupt:n.listener!=null&&n.listener.interrupt&&n.listener.interrupt(n);for(let l=0;l<t.length;l++)t[l].interrupt&&t[l].interrupt(n);break;case Be.end:n.listener!=null&&n.listener.end&&n.listener.end(n);for(let l=0;l<t.length;l++)t[l].end&&t[l].end(n);n.onEnd&&this.deprecateStuff()&&n.onEnd(n.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(n.trackIndex);case Be.dispose:n.listener!=null&&n.listener.dispose&&n.listener.dispose(n);for(let l=0;l<t.length;l++)t[l].dispose&&t[l].dispose(n);this.animState.trackEntryPool.free(n);break;case Be.complete:n.listener!=null&&n.listener.complete&&n.listener.complete(n);for(let l=0;l<t.length;l++)t[l].complete&&t[l].complete(n);const r=C.toInt(n.loopsCount());n.onComplete&&this.deprecateStuff()&&n.onComplete(n.trackIndex,r),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(n.trackIndex,r);break;case Be.event:const a=s[e+++2];n.listener!=null&&n.listener.event&&n.listener.event(n,a);for(let l=0;l<t.length;l++)t[l].event&&t[l].event(n,a);n.onEvent&&this.deprecateStuff()&&n.onEvent(n.trackIndex,a),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(n.trackIndex,a);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}};let Jc=Ch;Jc.deprecatedWarning1=!1;var Be=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(Be||{});class Lw{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const Mh=class{constructor(s){if(this.animationToMixTime={},this.defaultMix=0,s==null)throw new Error("skeletonData cannot be null.");this.skeletonData=s}setMix(s,t,e){const i=this.skeletonData.findAnimation(s);if(i==null)throw new Error(`Animation not found: ${s}`);const n=this.skeletonData.findAnimation(t);if(n==null)throw new Error(`Animation not found: ${t}`);this.setMixWith(i,n,e)}setMixByName(s,t,e){Mh.deprecatedWarning1||(Mh.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(s,t,e)}setMixWith(s,t,e){if(s==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");const i=`${s.name}.${t.name}`;this.animationToMixTime[i]=e}getMix(s,t){const e=`${s.name}.${t.name}`,i=this.animationToMixTime[e];return i===void 0?this.defaultMix:i}};let tu=Mh;tu.deprecatedWarning1=!1;let kg=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,i){const n=this.atlas.findRegion(i);if(n==null)throw new Error(`Region not found in atlas: ${i} (region attachment: ${e})`);const r=new ht(e);return r.region=n,r}newMeshAttachment(t,e,i){const n=this.atlas.findRegion(i);if(n==null)throw new Error(`Region not found in atlas: ${i} (mesh attachment: ${e})`);const r=new Kc(e);return r.region=n,r}newBoundingBoxAttachment(t,e){return new bg(e)}newPathAttachment(t,e){return new Wr(e)}newPointAttachment(t,e){return new Eg(e)}newClippingAttachment(t,e){return new wg(e)}},Ih=class{constructor(t,e,i){if(this.matrix=new Rt,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,n,r,a,l){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=n,this.ascaleY=r,this.ashearX=a,this.ashearY=l,this.appliedValid=!0;const o=this.parent,h=this.matrix,c=this.skeleton.scaleX,u=-this.skeleton.scaleY;if(o==null){const g=this.skeleton,v=i+90+l;h.a=C.cosDeg(i+a)*n*c,h.c=C.cosDeg(v)*r*c,h.b=C.sinDeg(i+a)*n*u,h.d=C.sinDeg(v)*r*u,h.tx=t*c+g.x,h.ty=e*u+g.y;return}let d=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=d*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case it.Normal:{const g=i+90+l,v=C.cosDeg(i+a)*n,_=C.cosDeg(g)*r,x=C.sinDeg(i+a)*n,y=C.sinDeg(g)*r;h.a=d*v+f*x,h.c=d*_+f*y,h.b=m*v+p*x,h.d=m*_+p*y;return}case it.OnlyTranslation:{const g=i+90+l;h.a=C.cosDeg(i+a)*n,h.c=C.cosDeg(g)*r,h.b=C.sinDeg(i+a)*n,h.d=C.sinDeg(g)*r;break}case it.NoRotationOrReflection:{let g=d*d+m*m,v=0;g>1e-4?(g=Math.abs(d*p-f*m)/g,f=m*g,p=d*g,v=Math.atan2(m,d)*C.radDeg):(d=0,m=0,v=90-Math.atan2(p,f)*C.radDeg);const _=i+a-v,x=i+l-v+90,y=C.cosDeg(_)*n,b=C.cosDeg(x)*r,w=C.sinDeg(_)*n,E=C.sinDeg(x)*r;h.a=d*y-f*w,h.c=d*b-f*E,h.b=m*y+p*w,h.d=m*b+p*E;break}case it.NoScale:case it.NoScaleOrReflection:{const g=C.cosDeg(i),v=C.sinDeg(i);let _=(d*g+f*v)/c,x=(m*g+p*v)/u,y=Math.sqrt(_*_+x*x);y>1e-5&&(y=1/y),_*=y,x*=y,y=Math.sqrt(_*_+x*x),this.data.transformMode==it.NoScale&&d*p-f*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY>0)&&(y=-y);const b=Math.PI/2+Math.atan2(x,_),w=Math.cos(b)*y,E=Math.sin(b)*y,S=C.cosDeg(a)*n,A=C.cosDeg(90+l)*r,M=C.sinDeg(a)*n,I=C.sinDeg(90+l)*r;h.a=_*S+w*M,h.c=_*A+w*I,h.b=x*S+E*M,h.d=x*A+E*I;break}}h.a*=c,h.c*=c,h.b*=u,h.d*=u}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*C.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*C.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;const t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*C.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*C.radDeg;return}const i=t.matrix,n=1/(i.a*i.d-i.b*i.c),r=e.tx-i.tx,a=e.ty-i.ty;this.ax=r*i.d*n-a*i.c*n,this.ay=a*i.a*n-r*i.b*n;const l=n*i.d,o=n*i.a,h=n*i.c,c=n*i.b,u=l*e.a-h*e.b,d=l*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+f*f),this.ascaleX>1e-4){const p=u*m-d*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(u*d+f*m,p)*C.radDeg,this.arotation=Math.atan2(f,u)*C.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,d)*C.radDeg}worldToLocal(t){const e=this.matrix,i=e.a,n=e.c,r=e.b,a=e.d,l=1/(i*a-n*r),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*a*l-h*n*l,t.y=h*i*l-o*r*l,t}localToWorld(t){const e=this.matrix,i=t.x,n=t.y;return t.x=i*e.a+n*e.c+e.tx,t.y=i*e.b+n*e.d+e.ty,t}worldToLocalRotation(t){const e=C.sinDeg(t),i=C.cosDeg(t),n=this.matrix;return Math.atan2(n.a*e-n.b*i,n.d*i-n.c*e)*C.radDeg}localToWorldRotation(t){const e=C.sinDeg(t),i=C.cosDeg(t),n=this.matrix;return Math.atan2(i*n.b+e*n.d,i*n.a+e*n.c)*C.radDeg}rotateWorld(t){const e=this.matrix,i=e.a,n=e.c,r=e.b,a=e.d,l=C.cosDeg(t),o=C.sinDeg(t);e.a=l*i-o*r,e.c=l*n-o*a,e.b=o*i+l*r,e.d=o*n+l*a,this.appliedValid=!1}},Fg=class{constructor(t,e,i){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=it.Normal,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}},Bg=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}},Dg=class{constructor(t){this.name=t}},Ng=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix);break}}apply1(t,e,i,n,r,a,l){t.appliedValid||t.updateAppliedTransform();const o=t.parent.matrix,h=1/(o.a*o.d-o.b*o.c),c=e-o.tx,u=i-o.ty,d=(c*o.d-u*o.c)*h-t.ax,f=(u*o.a-c*o.b)*h-t.ay;let m=Math.atan2(f,d)*C.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(m+=180),m>180?m-=360:m<-180&&(m+=360);let p=t.ascaleX,g=t.ascaleY;if(n||r){const v=t.data.length*p,_=Math.sqrt(d*d+f*f);if(n&&_<v||r&&_>v&&v>1e-4){const x=(_/v-1)*l+1;p*=x,a&&(g*=x)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+m*l,p,g,t.ashearX,t.ashearY)}apply2(t,e,i,n,r,a,l){if(l==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();const o=t.ax,h=t.ay;let c=t.ascaleX,u=c,d=t.ascaleY,f=e.ascaleX;const m=t.matrix;let p=0,g=0,v=0;c<0?(c=-c,p=180,v=-1):(p=0,v=1),d<0&&(d=-d,v=-v),f<0?(f=-f,g=180):g=0;const _=e.ax;let x=0,y=0,b=0,w=m.a,E=m.c,S=m.b,A=m.d;const M=Math.abs(c-d)<=1e-4;M?(x=e.ay,y=w*_+E*x+m.tx,b=S*_+A*x+m.ty):(x=0,y=w*_+m.tx,b=S*_+m.ty);const I=t.parent.matrix;w=I.a,E=I.c,S=I.b,A=I.d;const k=1/(w*A-E*S);let R=i-I.tx,P=n-I.ty;const B=(R*A-P*E)*k-o,L=(P*w-R*S)*k-h,O=B*B+L*L;R=y-I.tx,P=b-I.ty;const G=(R*A-P*E)*k-o,U=(P*w-R*S)*k-h,F=Math.sqrt(G*G+U*U);let V=e.data.length*f,X=0,Y=0;t:if(M){V*=c;let Q=(O-F*F-V*V)/(2*F*V);Q<-1?Q=-1:Q>1&&(Q=1,a&&F+V>1e-4&&(u*=(Math.sqrt(O)/(F+V)-1)*l+1)),Y=Math.acos(Q)*r,w=F+V*Q,E=V*Math.sin(Y),X=Math.atan2(L*w-B*E,B*w+L*E)}else{w=c*V,E=d*V;const Q=w*w,st=E*E,mt=Math.atan2(L,B);S=st*F*F+Q*O-Q*st;const ot=-2*st*F,xt=st-Q;if(A=ot*ot-4*xt*S,A>=0){let ke=Math.sqrt(A);ot<0&&(ke=-ke),ke=-(ot+ke)/2;const Ge=ke/xt,gi=S/ke,ye=Math.abs(Ge)<Math.abs(gi)?Ge:gi;if(ye*ye<=O){P=Math.sqrt(O-ye*ye)*r,X=mt-Math.atan2(P,ye),Y=Math.atan2(P/d,(ye-F)/c);break t}}let ut=C.PI,St=F-w,At=St*St,Jt=0,Wt=0,me=F+w,$e=me*me,Pe=0;S=-w*F/(Q-st),S>=-1&&S<=1&&(S=Math.acos(S),R=w*Math.cos(S)+F,P=E*Math.sin(S),A=R*R+P*P,A<At&&(ut=S,At=A,St=R,Jt=P),A>$e&&(Wt=S,$e=A,me=R,Pe=P)),O<=(At+$e)/2?(X=mt-Math.atan2(Jt*r,St),Y=ut*r):(X=mt-Math.atan2(Pe*r,me),Y=Wt*r)}const $=Math.atan2(x,_)*v;let W=t.arotation;X=(X-$)*C.radDeg+p-W,X>180?X-=360:X<-180&&(X+=360),t.updateWorldTransformWith(o,h,W+X*l,u,t.ascaleY,0,0),W=e.arotation,Y=((Y+$)*C.radDeg-e.ashearX)*v+g-W,Y>180?Y-=360:Y<-180&&(Y+=360),e.updateWorldTransformWith(_,x,W+Y*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}},Lg=class{constructor(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}},Og=class{constructor(t){this.order=0,this.bones=new Array,this.name=t}};var Es=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s))(Es||{});const Hi=class{constructor(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let i=0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}apply(){this.update()}update(){const t=this.target.getAttachment();if(!(t instanceof Wr))return;const e=this.rotateMix,i=this.translateMix,n=i>0,r=e>0;if(!n&&!r)return;const a=this.data,l=a.spacingMode,o=l==Es.Length,h=a.rotateMode,c=h==qt.Tangent,u=h==qt.ChainScale,d=this.bones.length,f=c?d:d+1,m=this.bones,p=D.setArraySize(this.spaces,f);let g=null;const v=this.spacing;if(u||o){u&&(g=D.setArraySize(this.lengths,d));for(let E=0,S=f-1;E<S;){const A=m[E],M=A.data.length;if(M<Hi.epsilon)u&&(g[E]=0),p[++E]=0;else{const I=M*A.matrix.a,k=M*A.matrix.b,R=Math.sqrt(I*I+k*k);u&&(g[E]=R),p[++E]=(o?M+v:v)*R/M}}}else for(let E=1;E<f;E++)p[E]=v;const _=this.computeWorldPositions(t,f,c,a.positionMode==Xt.Percent,l==Es.Percent);let x=_[0],y=_[1],b=a.offsetRotation,w=!1;if(b==0)w=h==qt.Chain;else{w=!1;const E=this.target.bone.matrix;b*=E.a*E.d-E.b*E.c>0?C.degRad:-C.degRad}for(let E=0,S=3;E<d;E++,S+=3){const A=m[E],M=A.matrix;M.tx+=(x-M.tx)*i,M.ty+=(y-M.ty)*i;const I=_[S],k=_[S+1],R=I-x,P=k-y;if(u){const B=g[E];if(B!=0){const L=(Math.sqrt(R*R+P*P)/B-1)*e+1;M.a*=L,M.b*=L}}if(x=I,y=k,r){const B=M.a,L=M.c,O=M.b,G=M.d;let U=0,F=0,V=0;if(c&&(c?U=_[S-1]:p[E+1]==0?U=_[S+2]:U=Math.atan2(P,R)),U-=Math.atan2(O,B),w){F=Math.cos(U),V=Math.sin(U);const X=A.data.length;x+=(X*(F*B-V*O)-R)*e,y+=(X*(V*B+F*O)-P)*e}else U+=b;U>C.PI?U-=C.PI2:U<-C.PI&&(U+=C.PI2),U*=e,F=Math.cos(U),V=Math.sin(U),M.a=F*B-V*O,M.c=F*L-V*G,M.b=V*B+F*O,M.d=V*L+F*G}A.appliedValid=!1}}computeWorldPositions(t,e,i,n,r){const a=this.target;let l=this.position;const o=this.spaces,h=D.setArraySize(this.positions,e*3+2);let c=null;const u=t.closed;let d=t.worldVerticesLength,f=d/6,m=Hi.NONE;if(!t.constantSpeed){const U=t.lengths;f-=u?1:2;const F=U[f];if(n&&(l*=F),r)for(let V=0;V<e;V++)o[V]*=F;c=D.setArraySize(this.world,8);for(let V=0,X=0,Y=0;V<e;V++,X+=3){const $=o[V];l+=$;let W=l;if(u)W%=F,W<0&&(W+=F),Y=0;else if(W<0){m!=Hi.BEFORE&&(m=Hi.BEFORE,t.computeWorldVertices(a,2,4,c,0,2)),this.addBeforePosition(W,c,0,h,X);continue}else if(W>F){m!=Hi.AFTER&&(m=Hi.AFTER,t.computeWorldVertices(a,d-6,4,c,0,2)),this.addAfterPosition(W-F,c,0,h,X);continue}for(;;Y++){const Q=U[Y];if(!(W>Q)){if(Y==0)W/=Q;else{const st=U[Y-1];W=(W-st)/(Q-st)}break}}Y!=m&&(m=Y,u&&Y==f?(t.computeWorldVertices(a,d-4,4,c,0,2),t.computeWorldVertices(a,0,4,c,4,2)):t.computeWorldVertices(a,Y*6+2,8,c,0,2)),this.addCurvePosition(W,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],h,X,i||V>0&&$==0)}return h}u?(d+=2,c=D.setArraySize(this.world,d),t.computeWorldVertices(a,2,d-4,c,0,2),t.computeWorldVertices(a,0,2,c,d-4,2),c[d-2]=c[0],c[d-1]=c[1]):(f--,d-=4,c=D.setArraySize(this.world,d),t.computeWorldVertices(a,2,d,c,0,2));const p=D.setArraySize(this.curves,f);let g=0,v=c[0],_=c[1],x=0,y=0,b=0,w=0,E=0,S=0,A=0,M=0,I=0,k=0,R=0,P=0,B=0,L=0;for(let U=0,F=2;U<f;U++,F+=6)x=c[F],y=c[F+1],b=c[F+2],w=c[F+3],E=c[F+4],S=c[F+5],A=(v-x*2+b)*.1875,M=(_-y*2+w)*.1875,I=((x-b)*3-v+E)*.09375,k=((y-w)*3-_+S)*.09375,R=A*2+I,P=M*2+k,B=(x-v)*.75+A+I*.16666667,L=(y-_)*.75+M+k*.16666667,g+=Math.sqrt(B*B+L*L),B+=R,L+=P,R+=I,P+=k,g+=Math.sqrt(B*B+L*L),B+=R,L+=P,g+=Math.sqrt(B*B+L*L),B+=R+I,L+=P+k,g+=Math.sqrt(B*B+L*L),p[U]=g,v=E,_=S;if(n&&(l*=g),r)for(let U=0;U<e;U++)o[U]*=g;const O=this.segments;let G=0;for(let U=0,F=0,V=0,X=0;U<e;U++,F+=3){const Y=o[U];l+=Y;let $=l;if(u)$%=g,$<0&&($+=g),V=0;else if($<0){this.addBeforePosition($,c,0,h,F);continue}else if($>g){this.addAfterPosition($-g,c,d-4,h,F);continue}for(;;V++){const W=p[V];if(!($>W)){if(V==0)$/=W;else{const Q=p[V-1];$=($-Q)/(W-Q)}break}}if(V!=m){m=V;let W=V*6;for(v=c[W],_=c[W+1],x=c[W+2],y=c[W+3],b=c[W+4],w=c[W+5],E=c[W+6],S=c[W+7],A=(v-x*2+b)*.03,M=(_-y*2+w)*.03,I=((x-b)*3-v+E)*.006,k=((y-w)*3-_+S)*.006,R=A*2+I,P=M*2+k,B=(x-v)*.3+A+I*.16666667,L=(y-_)*.3+M+k*.16666667,G=Math.sqrt(B*B+L*L),O[0]=G,W=1;W<8;W++)B+=R,L+=P,R+=I,P+=k,G+=Math.sqrt(B*B+L*L),O[W]=G;B+=R,L+=P,G+=Math.sqrt(B*B+L*L),O[8]=G,B+=R+I,L+=P+k,G+=Math.sqrt(B*B+L*L),O[9]=G,X=0}for($*=G;;X++){const W=O[X];if(!($>W)){if(X==0)$/=W;else{const Q=O[X-1];$=X+($-Q)/(W-Q)}break}}this.addCurvePosition($*.1,v,_,x,y,b,w,E,S,h,F,i||U>0&&Y==0)}return h}addBeforePosition(t,e,i,n,r){const a=e[i],l=e[i+1],o=e[i+2]-a,h=e[i+3]-l,c=Math.atan2(h,o);n[r]=a+t*Math.cos(c),n[r+1]=l+t*Math.sin(c),n[r+2]=c}addAfterPosition(t,e,i,n,r){const a=e[i+2],l=e[i+3],o=a-e[i],h=l-e[i+1],c=Math.atan2(h,o);n[r]=a+t*Math.cos(c),n[r+1]=l+t*Math.sin(c),n[r+2]=c}addCurvePosition(t,e,i,n,r,a,l,o,h,c,u,d){(t==0||isNaN(t))&&(t=1e-4);const f=t*t,m=f*t,p=1-t,g=p*p,v=g*p,_=p*t,x=_*3,y=p*x,b=x*t,w=e*v+n*y+a*b+o*m,E=i*v+r*y+l*b+h*m;c[u]=w,c[u+1]=E,d&&(c[u+2]=Math.atan2(E-(i*g+r*_*2+l*f),w-(e*g+n*_*2+a*f)))}getOrder(){return this.data.order}};let Jn=Hi;Jn.NONE=-1;Jn.BEFORE=-2;Jn.AFTER=-3;Jn.epsilon=1e-5;let Vg=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new $r,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,u=l*c-o*h>0?C.degRad:-C.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let _=!1;const x=v.matrix;if(t!=0){const y=x.a,b=x.c,w=x.b,E=x.d;let S=Math.atan2(h,l)-Math.atan2(w,y)+d;S>C.PI?S-=C.PI2:S<-C.PI&&(S+=C.PI2),S*=t;const A=Math.cos(S),M=Math.sin(S);x.a=A*y-M*w,x.c=A*b-M*E,x.b=M*y+A*w,x.d=M*b+A*E,_=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=(y.x-x.tx)*e,x.ty+=(y.y-x.ty)*e,_=!0}if(i>0){let y=Math.sqrt(x.a*x.a+x.b*x.b),b=Math.sqrt(l*l+h*h);y>1e-5&&(y=(y+(b-y+this.data.offsetScaleX)*i)/y),x.a*=y,x.b*=y,y=Math.sqrt(x.c*x.c+x.d*x.d),b=Math.sqrt(o*o+c*c),y>1e-5&&(y=(y+(b-y+this.data.offsetScaleY)*i)/y),x.c*=y,x.d*=y,_=!0}if(n>0){const y=x.c,b=x.d,w=Math.atan2(b,y);let E=Math.atan2(c,o)-Math.atan2(h,l)-(w-Math.atan2(x.b,x.a));E>C.PI?E-=C.PI2:E<-C.PI&&(E+=C.PI2),E=w+(E+f)*n;const S=Math.sqrt(y*y+b*b);x.c=Math.cos(E)*S,x.d=Math.sin(E)*S,_=!0}_&&(v.appliedValid=!1)}}applyRelativeWorld(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target,a=r.matrix,l=a.a,o=a.c,h=a.b,c=a.d,u=l*c-o*h>0?C.degRad:-C.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){const v=m[p];let _=!1;const x=v.matrix;if(t!=0){const y=x.a,b=x.c,w=x.b,E=x.d;let S=Math.atan2(h,l)+d;S>C.PI?S-=C.PI2:S<-C.PI&&(S+=C.PI2),S*=t;const A=Math.cos(S),M=Math.sin(S);x.a=A*y-M*w,x.c=A*b-M*E,x.b=M*y+A*w,x.d=M*b+A*E,_=!0}if(e!=0){const y=this.temp;r.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),x.tx+=y.x*e,x.ty+=y.y*e,_=!0}if(i>0){let y=(Math.sqrt(l*l+h*h)-1+this.data.offsetScaleX)*i+1;x.a*=y,x.b*=y,y=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*i+1,x.c*=y,x.d*=y,_=!0}if(n>0){let y=Math.atan2(c,o)-Math.atan2(h,l);y>C.PI?y-=C.PI2:y<-C.PI&&(y+=C.PI2);const b=x.c,w=x.d;y=Math.atan2(w,b)+(y-C.PI/2+f)*n;const E=Math.sqrt(b*b+w*w);x.c=Math.cos(y)*E,x.d=Math.sin(y)*E,_=!0}_&&(v.appliedValid=!1)}}applyAbsoluteLocal(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;if(t!=0){let g=r.arotation-c+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,c+=g*t}let u=h.ax,d=h.ay;e!=0&&(u+=(r.ax-u+this.data.offsetX)*e,d+=(r.ay-d+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f=(f+(r.ascaleX-f+this.data.offsetScaleX)*i)/f),m>1e-5&&(m=(m+(r.ascaleY-m+this.data.offsetScaleY)*i)/m));const p=h.ashearY;if(n>0){let g=r.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,h.shearY+=g*n}h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}applyRelativeLocal(){const t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();const a=this.bones;for(let l=0,o=a.length;l<o;l++){const h=a[l];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;t!=0&&(c+=(r.arotation+this.data.offsetRotation)*t);let u=h.ax,d=h.ay;e!=0&&(u+=(r.ax+this.data.offsetX)*e,d+=(r.ay+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f*=(r.ascaleX-1+this.data.offsetScaleX)*i+1),m>1e-5&&(m*=(r.ascaleY-1+this.data.offsetScaleY)*i+1));let p=h.ashearY;n>0&&(p+=(r.ashearY+this.data.offsetShearY)*n),h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}getOrder(){return this.data.order}};const xr=class{constructor(t){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,t==null)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){const i=t.bones[e];let n;if(i.parent==null)n=new Ih(i,this,null);else{const r=this.bones[i.parent.index];n=new Ih(i,this,r),r.children.push(n)}this.bones.push(n)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){const i=t.slots[e],n=this.bones[i.boneData.index],r=new Qc(i,n);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){const i=t.ikConstraints[e];this.ikConstraints.push(new Ng(i,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){const i=t.transformConstraints[e];this.transformConstraints.push(new Vg(i,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){const i=t.pathConstraints[e];this.pathConstraints.push(new Jn(i,this))}this.color=new H(1,1,1,1),this.updateCache()}updateCache(){const t=this._updateCache;t.length=0,this.updateCacheReset.length=0;const e=this.bones;for(let c=0,u=e.length;c<u;c++)e[c].sorted=!1;const i=this.ikConstraints,n=this.transformConstraints,r=this.pathConstraints,a=i.length,l=n.length,o=r.length,h=a+l+o;t:for(let c=0;c<h;c++){for(let u=0;u<a;u++){const d=i[u];if(d.data.order==c){this.sortIkConstraint(d);continue t}}for(let u=0;u<l;u++){const d=n[u];if(d.data.order==c){this.sortTransformConstraint(d);continue t}}for(let u=0;u<o;u++){const d=r[u];if(d.data.order==c){this.sortPathConstraint(d);continue t}}}for(let c=0,u=e.length;c<u;c++)this.sortBone(e[c])}sortIkConstraint(t){const e=t.target;this.sortBone(e);const i=t.bones,n=i[0];if(this.sortBone(n),i.length>1){const r=i[i.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(n.children),i[i.length-1].sorted=!0}sortPathConstraint(t){const e=t.target,i=e.data.index,n=e.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,i,n),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,n);for(let o=0,h=this.data.skins.length;o<h;o++)this.sortPathConstraintAttachment(this.data.skins[o],i,n);const r=e.getAttachment();r instanceof Wr&&this.sortPathConstraintAttachmentWith(r,n);const a=t.bones,l=a.length;for(let o=0;o<l;o++)this.sortBone(a[o]);this._updateCache.push(t);for(let o=0;o<l;o++)this.sortReset(a[o].children);for(let o=0;o<l;o++)a[o].sorted=!0}sortTransformConstraint(t){this.sortBone(t.target);const e=t.bones,i=e.length;if(t.data.local)for(let n=0;n<i;n++){const r=e[n];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(let n=0;n<i;n++)this.sortBone(e[n]);this._updateCache.push(t);for(let n=0;n<i;n++)this.sortReset(e[n].children);for(let n=0;n<i;n++)e[n].sorted=!0}sortPathConstraintAttachment(t,e,i){const n=t.attachments[e];if(n)for(const r in n)this.sortPathConstraintAttachmentWith(n[r],i)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Wr))return;const i=t.bones;if(i==null)this.sortBone(e);else{const n=this.bones;let r=0;for(;r<i.length;){const a=i[r++];for(let l=r+a;r<l;r++){const o=i[r];this.sortBone(n[o])}}}}sortBone(t){if(t.sorted)return;const e=t.parent;e!=null&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,i=t.length;e<i;e++){const n=t[e];n.sorted&&this.sortReset(n.children),n.sorted=!1}}updateWorldTransform(){const t=this.updateCacheReset;for(let i=0,n=t.length;i<n;i++){const r=t[i];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}const e=this._updateCache;for(let i=0,n=e.length;i<n;i++)e[i].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const t=this.bones;for(let r=0,a=t.length;r<a;r++)t[r].setToSetupPose();const e=this.ikConstraints;for(let r=0,a=e.length;r<a;r++){const l=e[r];l.bendDirection=l.data.bendDirection,l.mix=l.data.mix}const i=this.transformConstraints;for(let r=0,a=i.length;r<a;r++){const l=i[r],o=l.data;l.rotateMix=o.rotateMix,l.translateMix=o.translateMix,l.scaleMix=o.scaleMix,l.shearMix=o.shearMix}const n=this.pathConstraints;for(let r=0,a=n.length;r<a;r++){const l=n[r],o=l.data;l.position=o.position,l.spacing=o.spacing,l.rotateMix=o.rotateMix,l.translateMix=o.translateMix}}setSlotsToSetupPose(){const t=this.slots;D.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1}setSkinByName(t){const e=this.data.findSkin(t);if(e==null)throw new Error(`Skin not found: ${t}`);this.setSkin(e)}setSkin(t){if(t!=null)if(this.skin!=null)t.attachAll(this,this.skin);else{const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i],a=r.data.attachmentName;if(a!=null){const l=t.getAttachment(i,a);l!=null&&r.setAttachment(l)}}}this.skin=t}getAttachmentByName(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}getAttachment(t,e){if(e==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){const i=this.skin.getAttachment(t,e);if(i!=null)return i}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(t==null)throw new Error("slotName cannot be null.");const i=this.slots;for(let n=0,r=i.length;n<r;n++){const a=i[n];if(a.data.name==t){let l=null;if(e!=null&&(l=this.getAttachment(n,e),l==null))throw new Error(`Attachment not found: ${e}, for slot: ${t}`);a.setAttachment(l);return}}throw new Error(`Slot not found: ${t}`)}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==t)return r}return null}getBounds(t,e,i){if(t==null)throw new Error("offset cannot be null.");if(e==null)throw new Error("size cannot be null.");const n=this.drawOrder;let r=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(let h=0,c=n.length;h<c;h++){const u=n[h];let d=0,f=null;const m=u.getAttachment();if(m instanceof ht)d=8,f=D.setArraySize(i,d,0),m.computeWorldVertices(u.bone,f,0,2);else if(m instanceof Kc){const p=m;d=p.worldVerticesLength,f=D.setArraySize(i,d,0),p.computeWorldVertices(u,0,d,f,0,2)}if(f!=null)for(let p=0,g=f.length;p<g;p+=2){const v=f[p],_=f[p+1];r=Math.min(r,v),a=Math.min(a,_),l=Math.max(l,v),o=Math.max(o,_)}}t.set(r,a),e.set(l-r,o-a)}update(t){this.time+=t}get flipX(){return this.scaleX==-1}set flipX(t){xr.deprecatedWarning1||(xr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=t?1:-1}get flipY(){return this.scaleY==-1}set flipY(t){xr.deprecatedWarning1||(xr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=t?1:-1}};let eu=xr;eu.deprecatedWarning1=!1;let Ow=class extends Pc{},Ug=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");const e=this.skins;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");const e=this.events;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");const e=this.animations;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}},Xg=class{constructor(t,e,i){if(this.color=new H(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(i==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}},Yg=class{constructor(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,t==null)throw new Error("name cannot be null.");this.name=t}},$g=class{constructor(t){if(this.attachments=new Array,t==null)throw new Error("name cannot be null.");this.name=t}addAttachment(t,e,i){if(i==null)throw new Error("attachment cannot be null.");const n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i}getAttachment(t,e){const i=this.attachments[t];return i?i[e]:null}attachAll(t,e){let i=0;for(let n=0;n<t.slots.length;n++){const r=t.slots[n],a=r.getAttachment();if(a&&i<e.attachments.length){const l=e.attachments[i];for(const o in l){const h=l[o];if(a==h){const c=this.getAttachment(i,o);c!=null&&r.setAttachment(c);break}}}i++}}},Gg=class Mn{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,i=new Ug,n=typeof t=="string"?JSON.parse(t):t,r=n.skeleton;if(r!=null&&(i.hash=r.hash,i.version=r.spine,i.width=r.width,i.height=r.height,i.fps=r.fps,i.imagesPath=r.images),n.bones)for(let a=0;a<n.bones.length;a++){const l=n.bones[a];let o=null;const h=this.getValue(l,"parent",null);if(h!=null&&(o=i.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);const c=new Fg(i.bones.length,l.name,o);c.length=this.getValue(l,"length",0)*e,c.x=this.getValue(l,"x",0)*e,c.y=this.getValue(l,"y",0)*e,c.rotation=this.getValue(l,"rotation",0),c.scaleX=this.getValue(l,"scaleX",1),c.scaleY=this.getValue(l,"scaleY",1),c.shearX=this.getValue(l,"shearX",0),c.shearY=this.getValue(l,"shearY",0),c.transformMode=Mn.transformModeFromString(this.getValue(l,"transform","normal")),i.bones.push(c)}if(n.slots)for(let a=0;a<n.slots.length;a++){const l=n.slots[a],o=l.name,h=l.bone,c=i.findBone(h);if(c==null)throw new Error(`Slot bone not found: ${h}`);const u=new Xg(i.slots.length,o,c),d=this.getValue(l,"color",null);d!=null&&u.color.setFromString(d);const f=this.getValue(l,"dark",null);f!=null&&(u.darkColor=new H(1,1,1,1),u.darkColor.setFromString(f)),u.attachmentName=this.getValue(l,"attachment",null),u.blendMode=Mn.blendModeFromString(this.getValue(l,"blend","normal")),i.slots.push(u)}if(n.ik)for(let a=0;a<n.ik.length;a++){const l=n.ik[a],o=new Lg(l.name);o.order=this.getValue(l,"order",0);for(let c=0;c<l.bones.length;c++){const u=l.bones[c],d=i.findBone(u);if(d==null)throw new Error(`IK bone not found: ${u}`);o.bones.push(d)}const h=l.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`IK target bone not found: ${h}`);o.bendDirection=this.getValue(l,"bendPositive",!0)?1:-1,o.mix=this.getValue(l,"mix",1),i.ikConstraints.push(o)}if(n.transform)for(let a=0;a<n.transform.length;a++){const l=n.transform[a],o=new Yg(l.name);o.order=this.getValue(l,"order",0);for(let c=0;c<l.bones.length;c++){const u=l.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}const h=l.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`Transform constraint target bone not found: ${h}`);o.local=this.getValue(l,"local",!1),o.relative=this.getValue(l,"relative",!1),o.offsetRotation=this.getValue(l,"rotation",0),o.offsetX=this.getValue(l,"x",0)*e,o.offsetY=this.getValue(l,"y",0)*e,o.offsetScaleX=this.getValue(l,"scaleX",0),o.offsetScaleY=this.getValue(l,"scaleY",0),o.offsetShearY=this.getValue(l,"shearY",0),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),o.scaleMix=this.getValue(l,"scaleMix",1),o.shearMix=this.getValue(l,"shearMix",1),i.transformConstraints.push(o)}if(n.path)for(let a=0;a<n.path.length;a++){const l=n.path[a],o=new Og(l.name);o.order=this.getValue(l,"order",0);for(let c=0;c<l.bones.length;c++){const u=l.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}const h=l.target;if(o.target=i.findSlot(h),o.target==null)throw new Error(`Path target slot not found: ${h}`);o.positionMode=Mn.positionModeFromString(this.getValue(l,"positionMode","percent")),o.spacingMode=Mn.spacingModeFromString(this.getValue(l,"spacingMode","length")),o.rotateMode=Mn.rotateModeFromString(this.getValue(l,"rotateMode","tangent")),o.offsetRotation=this.getValue(l,"rotation",0),o.position=this.getValue(l,"position",0),o.positionMode==Xt.Fixed&&(o.position*=e),o.spacing=this.getValue(l,"spacing",0),(o.spacingMode==Es.Length||o.spacingMode==Es.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(l,"rotateMix",1),o.translateMix=this.getValue(l,"translateMix",1),i.pathConstraints.push(o)}if(n.skins)for(const a in n.skins){const l=n.skins[a],o=new $g(a);for(const h in l){const c=i.findSlotIndex(h);if(c==-1)throw new Error(`Slot not found: ${h}`);const u=l[h];for(const d in u){const f=this.readAttachment(u[d],o,c,d,i);f!=null&&o.addAttachment(c,d,f)}}i.skins.push(o),o.name=="default"&&(i.defaultSkin=o)}for(let a=0,l=this.linkedMeshes.length;a<l;a++){const o=this.linkedMeshes[a],h=o.skin==null?i.defaultSkin:i.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,n.events)for(const a in n.events){const l=n.events[a],o=new Dg(a);o.intValue=this.getValue(l,"int",0),o.floatValue=this.getValue(l,"float",0),o.stringValue=this.getValue(l,"string",""),o.audioPath=this.getValue(l,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(l,"volume",1),o.balance=this.getValue(l,"balance",0)),i.events.push(o)}if(n.animations)for(const a in n.animations){const l=n.animations[a];this.readAnimation(l,a,i)}return i}readAttachment(t,e,i,n,r){const a=this.scale;switch(n=this.getValue(t,"name",n),this.getValue(t,"type","region")){case"region":{const o=this.getValue(t,"path",n),h=this.attachmentLoader.newRegionAttachment(e,n,o);if(h==null)return null;h.path=o,h.x=this.getValue(t,"x",0)*a,h.y=this.getValue(t,"y",0)*a,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*a,h.height=t.height*a;const c=this.getValue(t,"color",null);return c!=null&&h.color.setFromString(c),h}case"boundingbox":{const o=this.attachmentLoader.newBoundingBoxAttachment(e,n);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{const o=this.getValue(t,"path",n),h=this.attachmentLoader.newMeshAttachment(e,n,o);if(h==null)return null;h.path=o;const c=this.getValue(t,"color",null);c!=null&&h.color.setFromString(c);const u=this.getValue(t,"parent",null);if(u!=null)return h.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new Vw(h,this.getValue(t,"skin",null),i,u)),h;const d=t.uvs;return this.readVertices(t,h,d.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(d),h.hullLength=this.getValue(t,"hull",0)*2,h}case"path":{const o=this.attachmentLoader.newPathAttachment(e,n);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);const h=t.vertexCount;this.readVertices(t,o,h<<1);const c=D.newArray(h/3,0);for(let d=0;d<t.lengths.length;d++)c[d]=t.lengths[d]*a;o.lengths=c;const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"point":{const o=this.attachmentLoader.newPointAttachment(e,n);if(o==null)return null;o.x=this.getValue(t,"x",0)*a,o.y=this.getValue(t,"y",0)*a,o.rotation=this.getValue(t,"rotation",0);const h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"clipping":{const o=this.attachmentLoader.newClippingAttachment(e,n);if(o==null)return null;const h=this.getValue(t,"end",null);if(h!=null){const d=r.findSlot(h);if(d==null)throw new Error(`Clipping end slot not found: ${h}`);o.endSlot=d}const c=t.vertexCount;this.readVertices(t,o,c<<1);const u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}}return null}readVertices(t,e,i){const n=this.scale;e.worldVerticesLength=i;const r=t.vertices;if(i==r.length){const o=D.toFloatArray(r);if(n!=1)for(let h=0,c=r.length;h<c;h++)o[h]*=n;e.vertices=o;return}const a=new Array,l=new Array;for(let o=0,h=r.length;o<h;){const c=r[o++];l.push(c);for(let u=o+c*4;o<u;o+=4)l.push(r[o]),a.push(r[o+1]*n),a.push(r[o+2]*n),a.push(r[o+3])}e.bones=l,e.vertices=D.toFloatArray(a)}readAnimation(t,e,i){const n=this.scale,r=new Array;let a=0;if(t.slots)for(const o in t.slots){const h=t.slots[o],c=i.findSlotIndex(o);if(c==-1)throw new Error(`Slot not found: ${o}`);for(const u in h){const d=h[u];if(u=="attachment"){const f=new da(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p];f.setFrame(m++,g.time,g.name)}r.push(f),a=Math.max(a,f.frames[f.getFrameCount()-1])}else if(u=="color"){const f=new Ze(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p],v=new H;v.setFromString(g.color||"ffffffff"),f.setFrame(m,g.time,v.r,v.g,v.b,v.a),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Ze.ENTRIES])}else if(u=="twoColor"){const f=new ie(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p],v=new H,_=new H;v.setFromString(g.light),_.setFromString(g.dark),f.setFrame(m,g.time,v.r,v.g,v.b,v.a,_.r,_.g,_.b),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*ie.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${u} (${o})`)}}if(t.bones)for(const o in t.bones){const h=t.bones[o],c=i.findBoneIndex(o);if(c==-1)throw new Error(`Bone not found: ${o}`);for(const u in h){const d=h[u];if(u==="rotate"){const f=new Ce(d.length);f.boneIndex=c;let m=0;for(let p=0;p<d.length;p++){const g=d[p];f.setFrame(m,g.time,g.angle),this.readCurve(g,f,m),m++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Ce.ENTRIES])}else if(u==="translate"||u==="scale"||u==="shear"){let f=null,m=1;u==="scale"?f=new Cg(d.length):u==="shear"?f=new Mg(d.length):(f=new Rs(d.length),m=n),f.boneIndex=c;let p=0;for(let g=0;g<d.length;g++){const v=d[g],_=this.getValue(v,"x",0),x=this.getValue(v,"y",0);f.setFrame(p,v.time,_*m,x*m),this.readCurve(v,f,p),p++}r.push(f),a=Math.max(a,f.frames[(f.getFrameCount()-1)*Rs.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${u} (${o})`)}}if(t.ik)for(const o in t.ik){const h=t.ik[o],c=i.findIkConstraint(o),u=new Ke(h.length);u.ikConstraintIndex=i.ikConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){const m=h[f];u.setFrame(d,m.time,this.getValue(m,"mix",1),this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,u,d),d++}r.push(u),a=Math.max(a,u.frames[(u.getFrameCount()-1)*Ke.ENTRIES])}if(t.transform)for(const o in t.transform){const h=t.transform[o],c=i.findTransformConstraint(o),u=new Qe(h.length);u.transformConstraintIndex=i.transformConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){const m=h[f];u.setFrame(d,m.time,this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,u,d),d++}r.push(u),a=Math.max(a,u.frames[(u.getFrameCount()-1)*Qe.ENTRIES])}if(t.paths)for(const o in t.paths){const h=t.paths[o],c=i.findPathConstraintIndex(o);if(c==-1)throw new Error(`Path constraint not found: ${o}`);const u=i.pathConstraints[c];for(const d in h){const f=h[d];if(d==="position"||d==="spacing"){let m=null,p=1;d==="spacing"?(m=new Pg(f.length),(u.spacingMode==Es.Length||u.spacingMode==Es.Fixed)&&(p=n)):(m=new Pi(f.length),u.positionMode==Xt.Fixed&&(p=n)),m.pathConstraintIndex=c;let g=0;for(let v=0;v<f.length;v++){const _=f[v];m.setFrame(g,_.time,this.getValue(_,d,0)*p),this.readCurve(_,m,g),g++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*Pi.ENTRIES])}else if(d==="mix"){const m=new pi(f.length);m.pathConstraintIndex=c;let p=0;for(let g=0;g<f.length;g++){const v=f[g];m.setFrame(p,v.time,this.getValue(v,"rotateMix",1),this.getValue(v,"translateMix",1)),this.readCurve(v,m,p),p++}r.push(m),a=Math.max(a,m.frames[(m.getFrameCount()-1)*pi.ENTRIES])}}}if(t.deform)for(const o in t.deform){const h=t.deform[o],c=i.findSkin(o);if(c!=null)for(const u in h){const d=h[u],f=i.findSlotIndex(u);if(f==-1)throw new Error(`Slot not found: ${d.name}`);for(const m in d){const p=d[m],g=c.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);const v=g.bones!=null,_=g.vertices,x=v?_.length/3*2:_.length,y=new Ig(p.length);y.slotIndex=f,y.attachment=g;let b=0;for(let w=0;w<p.length;w++){const E=p[w];let S;const A=this.getValue(E,"vertices",null);if(A==null)S=v?D.newFloatArray(x):_;else{S=D.newFloatArray(x);const M=this.getValue(E,"offset",0);if(D.arrayCopy(A,0,S,M,A.length),n!=1)for(let I=M,k=I+A.length;I<k;I++)S[I]*=n;if(!v)for(let I=0;I<x;I++)S[I]+=_[I]}y.setFrame(b,E.time,S),this.readCurve(E,y,b),b++}r.push(y),a=Math.max(a,y.frames[y.getFrameCount()-1])}}}let l=t.drawOrder;if(l==null&&(l=t.draworder),l!=null){const o=new fa(l.length),h=i.slots.length;let c=0;for(let u=0;u<l.length;u++){const d=l[u];let f=null;const m=this.getValue(d,"offsets",null);if(m!=null){f=D.newArray(h,-1);const p=D.newArray(h-m.length,0);let g=0,v=0;for(let _=0;_<m.length;_++){const x=m[_],y=i.findSlotIndex(x.slot);if(y==-1)throw new Error(`Slot not found: ${x.slot}`);for(;g!=y;)p[v++]=g++;f[g+x.offset]=g++}for(;g<h;)p[v++]=g++;for(let _=h-1;_>=0;_--)f[_]==-1&&(f[_]=p[--v])}o.setFrame(c++,d.time,f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(t.events){const o=new Rg(t.events.length);let h=0;for(let c=0;c<t.events.length;c++){const u=t.events[c],d=i.findEvent(u.name);if(d==null)throw new Error(`Event not found: ${u.name}`);const f=new Bg(D.toSinglePrecision(u.time),d);f.intValue=this.getValue(u,"int",d.intValue),f.floatValue=this.getValue(u,"float",d.floatValue),f.stringValue=this.getValue(u,"string",d.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(u,"volume",1),f.balance=this.getValue(u,"balance",0)),o.setFrame(h++,f)}r.push(o),a=Math.max(a,o.frames[o.getFrameCount()-1])}if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new ne(e,r,a))}readCurve(t,e,i){if(t.curve){if(t.curve==="stepped")e.setStepped(i);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){const n=t.curve;e.setCurve(i,n[0],n[1],n[2],n[3])}}}getValue(t,e,i){return t[e]!==void 0?t[e]:i}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Z.NORMAL;if(t=="additive")return Z.ADD;if(t=="multiply")return Z.MULTIPLY;if(t=="screen")return Z.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return Xt.Fixed;if(t=="percent")return Xt.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return Es.Length;if(t=="fixed")return Es.Fixed;if(t=="percent")return Es.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return qt.Tangent;if(t=="chain")return qt.Chain;if(t=="chainscale")return qt.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return it.Normal;if(t=="onlytranslation")return it.OnlyTranslation;if(t=="norotationorreflection")return it.NoRotationOrReflection;if(t=="noscale")return it.NoScale;if(t=="noscaleorreflection")return it.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},Vw=class{constructor(t,e,i,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n}},Uw=class extends Kn{createSkeleton(t){this.skeleton=new eu(t),this.skeleton.updateWorldTransform(),this.stateData=new tu(t),this.state=new Zs(this.stateData)}};const Xw=Object.freeze(Object.defineProperty({__proto__:null,Animation:ne,AnimationState:Zs,AnimationStateAdapter2:Lw,AnimationStateData:tu,AtlasAttachmentLoader:kg,Attachment:Zc,AttachmentTimeline:da,Bone:Ih,BoneData:Fg,BoundingBoxAttachment:bg,ClippingAttachment:wg,ColorTimeline:Ze,CurveTimeline:Ye,DeformTimeline:Ig,DrawOrderTimeline:fa,Event:Bg,EventData:Dg,EventQueue:Jc,EventTimeline:Rg,EventType:Be,IkConstraint:Ng,IkConstraintData:Lg,IkConstraintTimeline:Ke,JitterEffect:Nw,MeshAttachment:Kc,PathAttachment:Wr,PathConstraint:Jn,PathConstraintData:Og,PathConstraintMixTimeline:pi,PathConstraintPositionTimeline:Pi,PathConstraintSpacingTimeline:Pg,PointAttachment:Eg,RegionAttachment:ht,RotateTimeline:Ce,ScaleTimeline:Cg,ShearTimeline:Mg,Skeleton:eu,SkeletonBounds:Ow,SkeletonData:Ug,SkeletonJson:Gg,Skin:$g,Slot:Qc,SlotData:Xg,SpacingMode:Es,Spine:Uw,SwirlEffect:Tg,TimelineType:Ag,TrackEntry:Na,TransformConstraint:Vg,TransformConstraintData:Yg,TransformConstraintTimeline:Qe,TranslateTimeline:Rs,TwoColorTimeline:ie,VertexAttachment:Li},Symbol.toStringTag,{value:"Module"}));class su{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}}const Wg=class extends su{constructor(s){super(s),this.id=Wg.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(s,t){this.computeWorldVertices(s,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(s,t,e,i,n,r){e=n+(e>>1)*r;const a=s.bone.skeleton,l=s.deform;let o=this.vertices;const h=this.bones;if(!h){l.length>0&&(o=l);const f=s.bone.matrix,m=f.tx,p=f.ty,g=f.a,v=f.c,_=f.b,x=f.d;for(let y=t,b=n;b<e;y+=2,b+=r){const w=o[y],E=o[y+1];i[b]=w*g+E*v+m,i[b+1]=w*_+E*x+p}return}let c=0,u=0;for(let f=0;f<t;f+=2){const m=h[c];c+=m+1,u+=m}const d=a.bones;if(l.length==0)for(let f=n,m=u*3;f<e;f+=r){let p=0,g=0,v=h[c++];for(v+=c;c<v;c++,m+=3){const _=d[h[c]].matrix,x=o[m],y=o[m+1],b=o[m+2];p+=(x*_.a+y*_.c+_.tx)*b,g+=(x*_.b+y*_.d+_.ty)*b}i[f]=p,i[f+1]=g}else{const f=l;for(let m=n,p=u*3,g=u<<1;m<e;m+=r){let v=0,_=0,x=h[c++];for(x+=c;c<x;c++,p+=3,g+=2){const y=d[h[c]].matrix,b=o[p]+f[g],w=o[p+1]+f[g+1],E=o[p+2];v+=(b*y.a+w*y.c+y.tx)*E,_+=(b*y.b+w*y.d+y.ty)*E}i[m]=v,i[m+1]=_}}}copyTo(s){this.bones?(s.bones=new Array(this.bones.length),D.arrayCopy(this.bones,0,s.bones,0,this.bones.length)):s.bones=null,this.vertices&&(s.vertices=D.newFloatArray(this.vertices.length),D.arrayCopy(this.vertices,0,s.vertices,0,this.vertices.length)),s.worldVerticesLength=this.worldVerticesLength,s.timelineAttachment=this.timelineAttachment}};let Ps=Wg;Ps.nextID=0;class La extends Ps{constructor(t){super(t),this.type=dt.BoundingBox,this.color=new H(1,1,1,1)}copy(){const t=new La(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class Oa extends Ps{constructor(t){super(t),this.type=dt.Clipping,this.endSlot=null,this.color=new H(.2275,.2275,.8078,1)}copy(){const t=new Oa(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class ln extends Ps{constructor(t,e){super(t),this.type=dt.Mesh,this.region=null,this.triangles=[],this.color=new H(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new H(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();const t=new ln(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),D.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),D.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),D.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,i,n,r,a){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,i,n,r,a)}newLinkedMesh(){const t=new ln(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}}class hn extends Ps{constructor(t){super(t),this.type=dt.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new H(1,1,1,1)}copy(){const t=new hn(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),D.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class Va extends Ps{constructor(t){super(t),this.type=dt.Point,this.x=0,this.y=0,this.rotation=0,this.color=new H(.38,.94,0,1)}computeWorldPosition(t,e){const i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e}computeWorldRotation(t){const e=t.matrix,i=C.cosDeg(this.rotation),n=C.sinDeg(this.rotation),r=i*e.a+n*e.c,a=i*e.b+n*e.d;return Math.atan2(a,r)*C.radDeg}copy(){const t=new Va(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const Hg=class extends su{constructor(s,t){super(s),this.type=dt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new H(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=D.newFloatArray(8),this.uvs=D.newFloatArray(8),this.tempColor=new H(1,1,1,1),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");const s=this.region,t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,n=-this.height/2*this.scaleY+this.region.offsetY*e,r=i+this.region.width*t,a=n+this.region.height*e,l=this.rotation*Math.PI/180,o=Math.cos(l),h=Math.sin(l),c=this.x,u=this.y,d=i*o+c,f=i*h,m=n*o+u,p=n*h,g=r*o+c,v=r*h,_=a*o+u,x=a*h,y=this.offset;y[0]=d-p,y[1]=m+f,y[2]=d-x,y[3]=_+f,y[4]=g-x,y[5]=_+v,y[6]=g-p,y[7]=m+v;const b=this.uvs;s.degrees==90?(b[2]=s.u,b[3]=s.v2,b[4]=s.u,b[5]=s.v,b[6]=s.u2,b[7]=s.v,b[0]=s.u2,b[1]=s.v2):(b[0]=s.u,b[1]=s.v2,b[2]=s.u,b[3]=s.v,b[4]=s.u2,b[5]=s.v,b[6]=s.u2,b[7]=s.v2)}computeWorldVertices(s,t,e,i){this.sequence!=null&&this.sequence.apply(s,this);const n=s.bone,r=this.offset,a=n.matrix,l=a.tx,o=a.ty,h=a.a,c=a.c,u=a.b,d=a.d;let f=0,m=0;f=r[0],m=r[1],t[e]=f*h+m*c+l,t[e+1]=f*u+m*d+o,e+=i,f=r[2],m=r[3],t[e]=f*h+m*c+l,t[e+1]=f*u+m*d+o,e+=i,f=r[4],m=r[5],t[e]=f*h+m*c+l,t[e+1]=f*u+m*d+o,e+=i,f=r[6],m=r[7],t[e]=f*h+m*c+l,t[e+1]=f*u+m*d+o}copy(){const s=new Hg(this.name,this.path);return s.region=this.region,s.rendererObject=this.rendererObject,s.x=this.x,s.y=this.y,s.scaleX=this.scaleX,s.scaleY=this.scaleY,s.rotation=this.rotation,s.width=this.width,s.height=this.height,D.arrayCopy(this.uvs,0,s.uvs,0,8),D.arrayCopy(this.offset,0,s.offset,0,8),s.color.setFromColor(this.color),s.sequence=this.sequence!=null?this.sequence.copy():null,s}};let wt=Hg;wt.X1=0;wt.Y1=1;wt.C1R=2;wt.C1G=3;wt.C1B=4;wt.C1A=5;wt.U1=6;wt.V1=7;wt.X2=8;wt.Y2=9;wt.C2R=10;wt.C2G=11;wt.C2B=12;wt.C2A=13;wt.U2=14;wt.V2=15;wt.X3=16;wt.Y3=17;wt.C3R=18;wt.C3G=19;wt.C3B=20;wt.C3A=21;wt.U3=22;wt.V3=23;wt.X4=24;wt.Y4=25;wt.C4R=26;wt.C4G=27;wt.C4B=28;wt.C4A=29;wt.U4=30;wt.V4=31;const Xo=class{constructor(s){this.id=Xo.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(s)}copy(){const s=new Xo(this.regions.length);return D.arrayCopy(this.regions,0,s.regions,0,this.regions.length),s.start=this.start,s.digits=this.digits,s.setupIndex=this.setupIndex,s}apply(s,t){let e=s.sequenceIndex;e==-1&&(e=this.setupIndex),e>=this.regions.length&&(e=this.regions.length-1);const i=this.regions[e];t.region!=i&&(t.region=i)}getPath(s,t){let e=s;const i=(this.start+t).toString();for(let n=this.digits-i.length;n>0;n--)e+="0";return e+=i,e}static nextID(){return Xo._nextID++}};let Ua=Xo;Ua._nextID=0;var Xs=(s=>(s[s.hold=0]="hold",s[s.once=1]="once",s[s.loop=2]="loop",s[s.pingpong=3]="pingpong",s[s.onceReverse=4]="onceReverse",s[s.loopReverse=5]="loopReverse",s[s.pingpongReverse=6]="pingpongReverse",s))(Xs||{});const iu=[0,1,2,3,4,5,6];class Xa{constructor(t,e,i){if(this.timelines=[],this.timelineIds=new sg,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=i}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,i,n,r,a,l,o){if(!t)throw new Error("skeleton cannot be null.");n&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));const h=this.timelines;for(let c=0,u=h.length;c<u;c++)h[c].apply(t,e,i,r,a,l,o)}}const Tt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19};class Gt{constructor(t,e){this.propertyIds=e,this.frames=D.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){const i=t.length;for(let n=1;n<i;n++)if(t[n]>e)return n-1;return i-1}static search(t,e,i){const n=t.length;for(let r=i;r<n;r+=i)if(t[r]>e)return r-i;return n-i}}class Ds extends Gt{constructor(t,e,i){super(t,i),this.curves=D.newFloatArray(t+e*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){const e=this.getFrameCount()+t*18;if(this.curves.length>e){const i=D.newFloatArray(e);D.arrayCopy(this.curves,0,i,0,e),this.curves=i}}setBezier(t,e,i,n,r,a,l,o,h,c,u){const d=this.curves;let f=this.getFrameCount()+t*18;i==0&&(d[e]=2+f);const m=(n-a*2+o)*.03,p=(r-l*2+h)*.03,g=((a-o)*3-n+c)*.006,v=((l-h)*3-r+u)*.006;let _=m*2+g,x=p*2+v,y=(a-n)*.3+m+g*.16666667,b=(l-r)*.3+p+v*.16666667,w=n+y,E=r+b;for(let S=f+18;f<S;f+=2)d[f]=w,d[f+1]=E,y+=_,b+=x,_+=g,x+=v,w+=y,E+=b}getBezierValue(t,e,i,n){const r=this.curves;if(r[n]>t){const h=this.frames[e],c=this.frames[e+i];return c+(t-h)/(r[n]-h)*(r[n+1]-c)}const a=n+18;for(n+=2;n<a;n+=2)if(r[n]>=t){const h=r[n-2],c=r[n-1];return c+(t-h)/(r[n]-h)*(r[n+1]-c)}e+=this.getFrameEntries();const l=r[a-2],o=r[a-1];return o+(t-l)/(this.frames[e]-l)*(this.frames[e+i]-o)}}class Ns extends Ds{constructor(t,e,i){super(t,e,[i])}getFrameEntries(){return 2}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+1]=i}getCurveValue(t){const e=this.frames;let i=e.length-2;for(let r=2;r<=i;r+=2)if(e[r]>t){i=r-2;break}const n=this.curves[i>>1];switch(n){case 0:const r=e[i],a=e[i+1];return a+(t-r)/(e[i+2]-r)*(e[i+2+1]-a);case 1:return e[i+1]}return this.getBezierValue(t,i,1,n-2)}}class Ya extends Ds{constructor(t,e,i,n){super(t,e,[i,n])}getFrameEntries(){return 3}setFrame(t,e,i,n){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n}}class Hr extends Ns{constructor(t,e,i){super(t,e,`${Tt.rotate}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.rotation=o.data.rotation;return;case T.first:o.rotation+=(o.data.rotation-o.rotation)*r}return}let c=this.getCurveValue(i);switch(a){case T.setup:o.rotation=o.data.rotation+c*r;break;case T.first:case T.replace:c+=o.data.rotation-o.rotation;case T.add:o.rotation+=c*r}}}class nu extends Ya{constructor(t,e,i){super(t,e,`${Tt.x}|${i}`,`${Tt.y}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.x=o.data.x,o.y=o.data.y;return;case T.first:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}return}let c=0,u=0;const d=Gt.search(h,i,3),f=this.curves[d/3];switch(f){case 0:const m=h[d];c=h[d+1],u=h[d+2];const p=(i-m)/(h[d+3]-m);c+=(h[d+3+1]-c)*p,u+=(h[d+3+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}switch(a){case T.setup:o.x=o.data.x+c*r,o.y=o.data.y+u*r;break;case T.first:case T.replace:o.x+=(o.data.x+c-o.x)*r,o.y+=(o.data.y+u-o.y)*r;break;case T.add:o.x+=c*r,o.y+=u*r}}}class ru extends Ns{constructor(t,e,i){super(t,e,`${Tt.x}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.x=o.data.x;return;case T.first:o.x+=(o.data.x-o.x)*r}return}const c=this.getCurveValue(i);switch(a){case T.setup:o.x=o.data.x+c*r;break;case T.first:case T.replace:o.x+=(o.data.x+c-o.x)*r;break;case T.add:o.x+=c*r}}}class ou extends Ns{constructor(t,e,i){super(t,e,`${Tt.y}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.y=o.data.y;return;case T.first:o.y+=(o.data.y-o.y)*r}return}const c=this.getCurveValue(i);switch(a){case T.setup:o.y=o.data.y+c*r;break;case T.first:case T.replace:o.y+=(o.data.y+c-o.y)*r;break;case T.add:o.y+=c*r}}}class au extends Ya{constructor(t,e,i){super(t,e,`${Tt.scaleX}|${i}`,`${Tt.scaleY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.scaleX=o.data.scaleX,o.scaleY=o.data.scaleY;return;case T.first:o.scaleX+=(o.data.scaleX-o.scaleX)*r,o.scaleY+=(o.data.scaleY-o.scaleY)*r}return}let c,u;const d=Gt.search(h,i,3),f=this.curves[d/3];switch(f){case 0:const m=h[d];c=h[d+1],u=h[d+2];const p=(i-m)/(h[d+3]-m);c+=(h[d+3+1]-c)*p,u+=(h[d+3+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}if(c*=o.data.scaleX,u*=o.data.scaleY,r==1)a==T.add?(o.scaleX+=c-o.data.scaleX,o.scaleY+=u-o.data.scaleY):(o.scaleX=c,o.scaleY=u);else{let m=0,p=0;if(l==ct.mixOut)switch(a){case T.setup:m=o.data.scaleX,p=o.data.scaleY,o.scaleX=m+(Math.abs(c)*C.signum(m)-m)*r,o.scaleY=p+(Math.abs(u)*C.signum(p)-p)*r;break;case T.first:case T.replace:m=o.scaleX,p=o.scaleY,o.scaleX=m+(Math.abs(c)*C.signum(m)-m)*r,o.scaleY=p+(Math.abs(u)*C.signum(p)-p)*r;break;case T.add:o.scaleX+=(c-o.data.scaleX)*r,o.scaleY+=(u-o.data.scaleY)*r}else switch(a){case T.setup:m=Math.abs(o.data.scaleX)*C.signum(c),p=Math.abs(o.data.scaleY)*C.signum(u),o.scaleX=m+(c-m)*r,o.scaleY=p+(u-p)*r;break;case T.first:case T.replace:m=Math.abs(o.scaleX)*C.signum(c),p=Math.abs(o.scaleY)*C.signum(u),o.scaleX=m+(c-m)*r,o.scaleY=p+(u-p)*r;break;case T.add:o.scaleX+=(c-o.data.scaleX)*r,o.scaleY+=(u-o.data.scaleY)*r}}}}class lu extends Ns{constructor(t,e,i){super(t,e,`${Tt.scaleX}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.scaleX=o.data.scaleX;return;case T.first:o.scaleX+=(o.data.scaleX-o.scaleX)*r}return}const c=this.getCurveValue(i)*o.data.scaleX;if(r==1)a==T.add?o.scaleX+=c-o.data.scaleX:o.scaleX=c;else{let u=0;if(l==ct.mixOut)switch(a){case T.setup:u=o.data.scaleX,o.scaleX=u+(Math.abs(c)*C.signum(u)-u)*r;break;case T.first:case T.replace:u=o.scaleX,o.scaleX=u+(Math.abs(c)*C.signum(u)-u)*r;break;case T.add:o.scaleX+=(c-o.data.scaleX)*r}else switch(a){case T.setup:u=Math.abs(o.data.scaleX)*C.signum(c),o.scaleX=u+(c-u)*r;break;case T.first:case T.replace:u=Math.abs(o.scaleX)*C.signum(c),o.scaleX=u+(c-u)*r;break;case T.add:o.scaleX+=(c-o.data.scaleX)*r}}}}class hu extends Ns{constructor(t,e,i){super(t,e,`${Tt.scaleY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.scaleY=o.data.scaleY;return;case T.first:o.scaleY+=(o.data.scaleY-o.scaleY)*r}return}const c=this.getCurveValue(i)*o.data.scaleY;if(r==1)a==T.add?o.scaleY+=c-o.data.scaleY:o.scaleY=c;else{let u=0;if(l==ct.mixOut)switch(a){case T.setup:u=o.data.scaleY,o.scaleY=u+(Math.abs(c)*C.signum(u)-u)*r;break;case T.first:case T.replace:u=o.scaleY,o.scaleY=u+(Math.abs(c)*C.signum(u)-u)*r;break;case T.add:o.scaleY+=(c-o.data.scaleY)*r}else switch(a){case T.setup:u=Math.abs(o.data.scaleY)*C.signum(c),o.scaleY=u+(c-u)*r;break;case T.first:case T.replace:u=Math.abs(o.scaleY)*C.signum(c),o.scaleY=u+(c-u)*r;break;case T.add:o.scaleY+=(c-o.data.scaleY)*r}}}}class cu extends Ya{constructor(t,e,i){super(t,e,`${Tt.shearX}|${i}`,`${Tt.shearY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.shearX=o.data.shearX,o.shearY=o.data.shearY;return;case T.first:o.shearX+=(o.data.shearX-o.shearX)*r,o.shearY+=(o.data.shearY-o.shearY)*r}return}let c=0,u=0;const d=Gt.search(h,i,3),f=this.curves[d/3];switch(f){case 0:const m=h[d];c=h[d+1],u=h[d+2];const p=(i-m)/(h[d+3]-m);c+=(h[d+3+1]-c)*p,u+=(h[d+3+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}switch(a){case T.setup:o.shearX=o.data.shearX+c*r,o.shearY=o.data.shearY+u*r;break;case T.first:case T.replace:o.shearX+=(o.data.shearX+c-o.shearX)*r,o.shearY+=(o.data.shearY+u-o.shearY)*r;break;case T.add:o.shearX+=c*r,o.shearY+=u*r}}}class uu extends Ns{constructor(t,e,i){super(t,e,`${Tt.shearX}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.shearX=o.data.shearX;return;case T.first:o.shearX+=(o.data.shearX-o.shearX)*r}return}const c=this.getCurveValue(i);switch(a){case T.setup:o.shearX=o.data.shearX+c*r;break;case T.first:case T.replace:o.shearX+=(o.data.shearX+c-o.shearX)*r;break;case T.add:o.shearX+=c*r}}}class du extends Ns{constructor(t,e,i){super(t,e,`${Tt.shearY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,n,r,a,l){const o=t.bones[this.boneIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.shearY=o.data.shearY;return;case T.first:o.shearY+=(o.data.shearY-o.shearY)*r}return}const c=this.getCurveValue(i);switch(a){case T.setup:o.shearY=o.data.shearY+c*r;break;case T.first:case T.replace:o.shearY+=(o.data.shearY+c-o.shearY)*r;break;case T.add:o.shearY+=c*r}}}class fu extends Ds{constructor(t,e,i){super(t,e,[`${Tt.rgb}|${i}`,`${Tt.alpha}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 5}setFrame(t,e,i,n,r,a){t*=5,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=r,this.frames[t+4]=a}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color;if(i<h[0]){const v=o.data.color;switch(a){case T.setup:c.setFromColor(v);return;case T.first:c.add((v.r-c.r)*r,(v.g-c.g)*r,(v.b-c.b)*r,(v.a-c.a)*r)}return}let u=0,d=0,f=0,m=0;const p=Gt.search(h,i,5),g=this.curves[p/5];switch(g){case 0:const v=h[p];u=h[p+1],d=h[p+2],f=h[p+3],m=h[p+4];const _=(i-v)/(h[p+5]-v);u+=(h[p+5+1]-u)*_,d+=(h[p+5+2]-d)*_,f+=(h[p+5+3]-f)*_,m+=(h[p+5+4]-m)*_;break;case 1:u=h[p+1],d=h[p+2],f=h[p+3],m=h[p+4];break;default:u=this.getBezierValue(i,p,1,g-2),d=this.getBezierValue(i,p,2,g+18-2),f=this.getBezierValue(i,p,3,g+18*2-2),m=this.getBezierValue(i,p,4,g+18*3-2)}r==1?c.set(u,d,f,m):(a==T.setup&&c.setFromColor(o.data.color),c.add((u-c.r)*r,(d-c.g)*r,(f-c.b)*r,(m-c.a)*r))}}class mu extends Ds{constructor(t,e,i){super(t,e,[`${Tt.rgb}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 4}setFrame(t,e,i,n,r){t<<=2,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=r}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color;if(i<h[0]){const g=o.data.color;switch(a){case T.setup:c.r=g.r,c.g=g.g,c.b=g.b;return;case T.first:c.r+=(g.r-c.r)*r,c.g+=(g.g-c.g)*r,c.b+=(g.b-c.b)*r}return}let u=0,d=0,f=0;const m=Gt.search(h,i,4),p=this.curves[m>>2];switch(p){case 0:const g=h[m];u=h[m+1],d=h[m+2],f=h[m+3];const v=(i-g)/(h[m+4]-g);u+=(h[m+4+1]-u)*v,d+=(h[m+4+2]-d)*v,f+=(h[m+4+3]-f)*v;break;case 1:u=h[m+1],d=h[m+2],f=h[m+3];break;default:u=this.getBezierValue(i,m,1,p-2),d=this.getBezierValue(i,m,2,p+18-2),f=this.getBezierValue(i,m,3,p+18*2-2)}if(r==1)c.r=u,c.g=d,c.b=f;else{if(a==T.setup){const g=o.data.color;c.r=g.r,c.g=g.g,c.b=g.b}c.r+=(u-c.r)*r,c.g+=(d-c.g)*r,c.b+=(f-c.b)*r}}}class pu extends Ns{constructor(t,e,i){super(t,e,`${Tt.alpha}|${i}`),this.slotIndex=0,this.slotIndex=i}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=o.color;if(i<this.frames[0]){const u=o.data.color;switch(a){case T.setup:h.a=u.a;return;case T.first:h.a+=(u.a-h.a)*r}return}const c=this.getCurveValue(i);r==1?h.a=c:(a==T.setup&&(h.a=o.data.color.a),h.a+=(c-h.a)*r)}}class gu extends Ds{constructor(t,e,i){super(t,e,[`${Tt.rgb}|${i}`,`${Tt.alpha}|${i}`,`${Tt.rgb2}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 8}setFrame(t,e,i,n,r,a,l,o,h){t<<=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=r,this.frames[t+4]=a,this.frames[t+5]=l,this.frames[t+6]=o,this.frames[t+7]=h}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color,u=o.darkColor;if(i<h[0]){const b=o.data.color,w=o.data.darkColor;switch(a){case T.setup:c.setFromColor(b),u.r=w.r,u.g=w.g,u.b=w.b;return;case T.first:c.add((b.r-c.r)*r,(b.g-c.g)*r,(b.b-c.b)*r,(b.a-c.a)*r),u.r+=(w.r-u.r)*r,u.g+=(w.g-u.g)*r,u.b+=(w.b-u.b)*r}return}let d=0,f=0,m=0,p=0,g=0,v=0,_=0;const x=Gt.search(h,i,8),y=this.curves[x>>3];switch(y){case 0:const b=h[x];d=h[x+1],f=h[x+2],m=h[x+3],p=h[x+4],g=h[x+5],v=h[x+6],_=h[x+7];const w=(i-b)/(h[x+8]-b);d+=(h[x+8+1]-d)*w,f+=(h[x+8+2]-f)*w,m+=(h[x+8+3]-m)*w,p+=(h[x+8+4]-p)*w,g+=(h[x+8+5]-g)*w,v+=(h[x+8+6]-v)*w,_+=(h[x+8+7]-_)*w;break;case 1:d=h[x+1],f=h[x+2],m=h[x+3],p=h[x+4],g=h[x+5],v=h[x+6],_=h[x+7];break;default:d=this.getBezierValue(i,x,1,y-2),f=this.getBezierValue(i,x,2,y+18-2),m=this.getBezierValue(i,x,3,y+18*2-2),p=this.getBezierValue(i,x,4,y+18*3-2),g=this.getBezierValue(i,x,5,y+18*4-2),v=this.getBezierValue(i,x,6,y+18*5-2),_=this.getBezierValue(i,x,7,y+18*6-2)}if(r==1)c.set(d,f,m,p),u.r=g,u.g=v,u.b=_;else{if(a==T.setup){c.setFromColor(o.data.color);const b=o.data.darkColor;u.r=b.r,u.g=b.g,u.b=b.b}c.add((d-c.r)*r,(f-c.g)*r,(m-c.b)*r,(p-c.a)*r),u.r+=(g-u.r)*r,u.g+=(v-u.g)*r,u.b+=(_-u.b)*r}}}class xu extends Ds{constructor(t,e,i){super(t,e,[`${Tt.rgb}|${i}`,`${Tt.rgb2}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 7}setFrame(t,e,i,n,r,a,l,o){t*=7,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=r,this.frames[t+4]=a,this.frames[t+5]=l,this.frames[t+6]=o}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=this.frames,c=o.color,u=o.darkColor;if(i<h[0]){const y=o.data.color,b=o.data.darkColor;switch(a){case T.setup:c.r=y.r,c.g=y.g,c.b=y.b,u.r=b.r,u.g=b.g,u.b=b.b;return;case T.first:c.r+=(y.r-c.r)*r,c.g+=(y.g-c.g)*r,c.b+=(y.b-c.b)*r,u.r+=(b.r-u.r)*r,u.g+=(b.g-u.g)*r,u.b+=(b.b-u.b)*r}return}let d=0,f=0,m=0,p=0,g=0,v=0;const _=Gt.search(h,i,7),x=this.curves[_/7];switch(x){case 0:const y=h[_];d=h[_+1],f=h[_+2],m=h[_+3],p=h[_+4],g=h[_+5],v=h[_+6];const b=(i-y)/(h[_+7]-y);d+=(h[_+7+1]-d)*b,f+=(h[_+7+2]-f)*b,m+=(h[_+7+3]-m)*b,p+=(h[_+7+4]-p)*b,g+=(h[_+7+5]-g)*b,v+=(h[_+7+6]-v)*b;break;case 1:d=h[_+1],f=h[_+2],m=h[_+3],p=h[_+4],g=h[_+5],v=h[_+6];break;default:d=this.getBezierValue(i,_,1,x-2),f=this.getBezierValue(i,_,2,x+18-2),m=this.getBezierValue(i,_,3,x+18*2-2),p=this.getBezierValue(i,_,4,x+18*3-2),g=this.getBezierValue(i,_,5,x+18*4-2),v=this.getBezierValue(i,_,6,x+18*5-2)}if(r==1)c.r=d,c.g=f,c.b=m,u.r=p,u.g=g,u.b=v;else{if(a==T.setup){const y=o.data.color,b=o.data.darkColor;c.r=y.r,c.g=y.g,c.b=y.b,u.r=b.r,u.g=b.g,u.b=b.b}c.r+=(d-c.r)*r,c.g+=(f-c.g)*r,c.b+=(m-c.b)*r,u.r+=(p-u.r)*r,u.g+=(g-u.g)*r,u.b+=(v-u.b)*r}}}class Ki extends Gt{constructor(t,e){super(t,[`${Tt.attachment}|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(o.bone.active){if(l==ct.mixOut){a==T.setup&&this.setAttachment(t,o,o.data.attachmentName);return}if(i<this.frames[0]){(a==T.setup||a==T.first)&&this.setAttachment(t,o,o.data.attachmentName);return}this.setAttachment(t,o,this.attachmentNames[Gt.search1(this.frames,i)])}}setAttachment(t,e,i){e.setAttachment(i?t.getAttachment(this.slotIndex,i):null)}}class yu extends Ds{constructor(t,e,i,n){super(t,e,[`${Tt.deform}|${i}|${n.id}`]),this.slotIndex=0,this.slotIndex=i,this.attachment=n,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.vertices[t]=i}setBezier(t,e,i,n,r,a,l,o,h,c,u){const d=this.curves;let f=this.getFrameCount()+t*18;i==0&&(d[e]=2+f);const m=(n-a*2+o)*.03,p=h*.03-l*.06,g=((a-o)*3-n+c)*.006,v=(l-h+.33333333)*.018;let _=m*2+g,x=p*2+v,y=(a-n)*.3+m+g*.16666667,b=l*.3+p+v*.16666667,w=n+y,E=b;for(let S=f+18;f<S;f+=2)d[f]=w,d[f+1]=E,y+=_,b+=x,_+=g,x+=v,w+=y,E+=b}getCurvePercent(t,e){const i=this.curves;let n=i[e];switch(n){case 0:const o=this.frames[e];return(t-o)/(this.frames[e+this.getFrameEntries()]-o);case 1:return 0}if(n-=2,i[n]>t){const o=this.frames[e];return i[n+1]*(t-o)/(i[n]-o)}const r=n+18;for(n+=2;n<r;n+=2)if(i[n]>=t){const o=i[n-2],h=i[n-1];return h+(t-o)/(i[n]-o)*(i[n+1]-h)}const a=i[r-2],l=i[r-1];return l+(1-l)*(t-a)/(this.frames[e+this.getFrameEntries()]-a)}apply(t,e,i,n,r,a,l){const o=t.slots[this.slotIndex];if(!o.bone.active)return;const h=o.getAttachment();if(!h||!(h instanceof Ps)||h.timelineAttachment!=this.attachment)return;const c=o.deform;c.length==0&&(a=T.setup);const u=this.vertices,d=u[0].length,f=this.frames;if(i<f[0]){switch(a){case T.setup:c.length=0;return;case T.first:if(r==1){c.length=0;return}c.length=d;const _=h;if(_.bones){r=1-r;for(let x=0;x<d;x++)c[x]*=r}else{const x=_.vertices;for(let y=0;y<d;y++)c[y]+=(x[y]-c[y])*r}}return}if(c.length=d,i>=f[f.length-1]){const _=u[f.length-1];if(r==1)if(a==T.add){const x=h;if(x.bones)for(let y=0;y<d;y++)c[y]+=_[y];else{const y=x.vertices;for(let b=0;b<d;b++)c[b]+=_[b]-y[b]}}else D.arrayCopy(_,0,c,0,d);else switch(a){case T.setup:{const y=h;if(y.bones)for(let b=0;b<d;b++)c[b]=_[b]*r;else{const b=y.vertices;for(let w=0;w<d;w++){const E=b[w];c[w]=E+(_[w]-E)*r}}break}case T.first:case T.replace:for(let y=0;y<d;y++)c[y]+=(_[y]-c[y])*r;break;case T.add:const x=h;if(x.bones)for(let y=0;y<d;y++)c[y]+=_[y]*r;else{const y=x.vertices;for(let b=0;b<d;b++)c[b]+=(_[b]-y[b])*r}}return}const m=Gt.search1(f,i),p=this.getCurvePercent(i,m),g=u[m],v=u[m+1];if(r==1)if(a==T.add){const _=h;if(_.bones)for(let x=0;x<d;x++){const y=g[x];c[x]+=y+(v[x]-y)*p}else{const x=_.vertices;for(let y=0;y<d;y++){const b=g[y];c[y]+=b+(v[y]-b)*p-x[y]}}}else for(let _=0;_<d;_++){const x=g[_];c[_]=x+(v[_]-x)*p}else switch(a){case T.setup:{const x=h;if(x.bones)for(let y=0;y<d;y++){const b=g[y];c[y]=(b+(v[y]-b)*p)*r}else{const y=x.vertices;for(let b=0;b<d;b++){const w=g[b],E=y[b];c[b]=E+(w+(v[b]-w)*p-E)*r}}break}case T.first:case T.replace:for(let x=0;x<d;x++){const y=g[x];c[x]+=(y+(v[x]-y)*p-c[x])*r}break;case T.add:const _=h;if(_.bones)for(let x=0;x<d;x++){const y=g[x];c[x]+=(y+(v[x]-y)*p)*r}else{const x=_.vertices;for(let y=0;y<d;y++){const b=g[y];c[y]+=(b+(v[y]-b)*p-x[y])*r}}}}}const zg=class extends Gt{constructor(s){super(s,zg.propertyIds),this.events=new Array(s)}getFrameCount(){return this.frames.length}setFrame(s,t){this.frames[s]=t.time,this.events[s]=t}apply(s,t,e,i,n,r,a){if(!i)return;const l=this.frames,o=this.frames.length;if(t>e)this.apply(s,t,Number.MAX_VALUE,i,n,r,a),t=-1;else if(t>=l[o-1])return;if(e<l[0])return;let h=0;if(t<l[0])h=0;else{h=Gt.search1(l,t)+1;const c=l[h];for(;h>0&&l[h-1]==c;)h--}for(;h<o&&e>=l[h];h++)i.push(this.events[h])}};let oo=zg;oo.propertyIds=[`${Tt.event}`];const jg=class extends Gt{constructor(s){super(s,jg.propertyIds),this.drawOrders=new Array(s)}getFrameCount(){return this.frames.length}setFrame(s,t,e){this.frames[s]=t,this.drawOrders[s]=e}apply(s,t,e,i,n,r,a){if(a==ct.mixOut){r==T.setup&&D.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);return}if(e<this.frames[0]){(r==T.setup||r==T.first)&&D.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);return}const l=Gt.search1(this.frames,e),o=this.drawOrders[l];if(!o)D.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);else{const h=s.drawOrder,c=s.slots;for(let u=0,d=o.length;u<d;u++)h[u]=c[o[u]]}}};let nn=jg;nn.propertyIds=[`${Tt.drawOrder}`];class _u extends Ds{constructor(t,e,i){super(t,e,[`${Tt.ikConstraint}|${i}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=i}getFrameEntries(){return 6}setFrame(t,e,i,n,r,a,l){t*=6,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=r,this.frames[t+4]=a?1:0,this.frames[t+5]=l?1:0}apply(t,e,i,n,r,a,l){const o=t.ikConstraints[this.ikConstraintIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case T.first:o.mix+=(o.data.mix-o.mix)*r,o.softness+=(o.data.softness-o.softness)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let c=0,u=0;const d=Gt.search(h,i,6),f=this.curves[d/6];switch(f){case 0:const m=h[d];c=h[d+1],u=h[d+2];const p=(i-m)/(h[d+6]-m);c+=(h[d+6+1]-c)*p,u+=(h[d+6+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}a==T.setup?(o.mix=o.data.mix+(c-o.data.mix)*r,o.softness=o.data.softness+(u-o.data.softness)*r,l==ct.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=h[d+3],o.compress=h[d+4]!=0,o.stretch=h[d+5]!=0)):(o.mix+=(c-o.mix)*r,o.softness+=(u-o.softness)*r,l==ct.mixIn&&(o.bendDirection=h[d+3],o.compress=h[d+4]!=0,o.stretch=h[d+5]!=0))}}class vu extends Ds{constructor(t,e,i){super(t,e,[`${Tt.transformConstraint}|${i}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=i}getFrameEntries(){return 7}setFrame(t,e,i,n,r,a,l,o){const h=this.frames;t*=7,h[t]=e,h[t+1]=i,h[t+2]=n,h[t+3]=r,h[t+4]=a,h[t+5]=l,h[t+6]=o}apply(t,e,i,n,r,a,l){const o=t.transformConstraints[this.transformConstraintIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){const _=o.data;switch(a){case T.setup:o.mixRotate=_.mixRotate,o.mixX=_.mixX,o.mixY=_.mixY,o.mixScaleX=_.mixScaleX,o.mixScaleY=_.mixScaleY,o.mixShearY=_.mixShearY;return;case T.first:o.mixRotate+=(_.mixRotate-o.mixRotate)*r,o.mixX+=(_.mixX-o.mixX)*r,o.mixY+=(_.mixY-o.mixY)*r,o.mixScaleX+=(_.mixScaleX-o.mixScaleX)*r,o.mixScaleY+=(_.mixScaleY-o.mixScaleY)*r,o.mixShearY+=(_.mixShearY-o.mixShearY)*r}return}let c,u,d,f,m,p;const g=Gt.search(h,i,7),v=this.curves[g/7];switch(v){case 0:const _=h[g];c=h[g+1],u=h[g+2],d=h[g+3],f=h[g+4],m=h[g+5],p=h[g+6];const x=(i-_)/(h[g+7]-_);c+=(h[g+7+1]-c)*x,u+=(h[g+7+2]-u)*x,d+=(h[g+7+3]-d)*x,f+=(h[g+7+4]-f)*x,m+=(h[g+7+5]-m)*x,p+=(h[g+7+6]-p)*x;break;case 1:c=h[g+1],u=h[g+2],d=h[g+3],f=h[g+4],m=h[g+5],p=h[g+6];break;default:c=this.getBezierValue(i,g,1,v-2),u=this.getBezierValue(i,g,2,v+18-2),d=this.getBezierValue(i,g,3,v+18*2-2),f=this.getBezierValue(i,g,4,v+18*3-2),m=this.getBezierValue(i,g,5,v+18*4-2),p=this.getBezierValue(i,g,6,v+18*5-2)}if(a==T.setup){const _=o.data;o.mixRotate=_.mixRotate+(c-_.mixRotate)*r,o.mixX=_.mixX+(u-_.mixX)*r,o.mixY=_.mixY+(d-_.mixY)*r,o.mixScaleX=_.mixScaleX+(f-_.mixScaleX)*r,o.mixScaleY=_.mixScaleY+(m-_.mixScaleY)*r,o.mixShearY=_.mixShearY+(p-_.mixShearY)*r}else o.mixRotate+=(c-o.mixRotate)*r,o.mixX+=(u-o.mixX)*r,o.mixY+=(d-o.mixY)*r,o.mixScaleX+=(f-o.mixScaleX)*r,o.mixScaleY+=(m-o.mixScaleY)*r,o.mixShearY+=(p-o.mixShearY)*r}}class bu extends Ns{constructor(t,e,i){super(t,e,`${Tt.pathConstraintPosition}|${i}`),this.pathConstraintIndex=0,this.pathConstraintIndex=i}apply(t,e,i,n,r,a,l){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.position=o.data.position;return;case T.first:o.position+=(o.data.position-o.position)*r}return}const c=this.getCurveValue(i);a==T.setup?o.position=o.data.position+(c-o.data.position)*r:o.position+=(c-o.position)*r}}class wu extends Ns{constructor(t,e,i){super(t,e,`${Tt.pathConstraintSpacing}|${i}`),this.pathConstraintIndex=0,this.pathConstraintIndex=i}apply(t,e,i,n,r,a,l){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.spacing=o.data.spacing;return;case T.first:o.spacing+=(o.data.spacing-o.spacing)*r}return}const c=this.getCurveValue(i);a==T.setup?o.spacing=o.data.spacing+(c-o.data.spacing)*r:o.spacing+=(c-o.spacing)*r}}class Eu extends Ds{constructor(t,e,i){super(t,e,[`${Tt.pathConstraintMix}|${i}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=i}getFrameEntries(){return 4}setFrame(t,e,i,n,r){const a=this.frames;t<<=2,a[t]=e,a[t+1]=i,a[t+2]=n,a[t+3]=r}apply(t,e,i,n,r,a,l){const o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;const h=this.frames;if(i<h[0]){switch(a){case T.setup:o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,o.mixY=o.data.mixY;return;case T.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*r,o.mixX+=(o.data.mixX-o.mixX)*r,o.mixY+=(o.data.mixY-o.mixY)*r}return}let c,u,d;const f=Gt.search(h,i,4),m=this.curves[f>>2];switch(m){case 0:const p=h[f];c=h[f+1],u=h[f+2],d=h[f+3];const g=(i-p)/(h[f+4]-p);c+=(h[f+4+1]-c)*g,u+=(h[f+4+2]-u)*g,d+=(h[f+4+3]-d)*g;break;case 1:c=h[f+1],u=h[f+2],d=h[f+3];break;default:c=this.getBezierValue(i,f,1,m-2),u=this.getBezierValue(i,f,2,m+18-2),d=this.getBezierValue(i,f,3,m+18*2-2)}if(a==T.setup){const p=o.data;o.mixRotate=p.mixRotate+(c-p.mixRotate)*r,o.mixX=p.mixX+(u-p.mixX)*r,o.mixY=p.mixY+(d-p.mixY)*r}else o.mixRotate+=(c-o.mixRotate)*r,o.mixX+=(u-o.mixX)*r,o.mixY+=(d-o.mixY)*r}}const wi=class extends Gt{constructor(s,t,e){super(s,[`${Tt.sequence}|${t}|${e.sequence.id}`]),this.slotIndex=t,this.attachment=e}getFrameEntries(){return wi.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(s,t,e,i,n){const r=this.frames;s*=wi.ENTRIES,r[s]=t,r[s+wi.MODE]=e|i<<4,r[s+wi.DELAY]=n}apply(s,t,e,i,n,r,a){const l=s.slots[this.slotIndex];if(!l.bone.active)return;const o=l.attachment,h=this.attachment;if(o!=h&&(!(o instanceof Ps)||o.timelineAttachment!=h))return;const c=this.frames;if(e<c[0]){(r==T.setup||r==T.first)&&(l.sequenceIndex=-1);return}const u=Gt.search(c,e,wi.ENTRIES),d=c[u],f=c[u+wi.MODE],m=c[u+wi.DELAY];if(!this.attachment.sequence)return;let p=f>>4;const g=this.attachment.sequence.regions.length,v=iu[f&15];if(v!=Xs.hold)switch(p+=(e-d)/m+1e-5|0,v){case Xs.once:p=Math.min(g-1,p);break;case Xs.loop:p%=g;break;case Xs.pingpong:{const _=(g<<1)-2;p=_==0?0:p%_,p>=g&&(p=_-p);break}case Xs.onceReverse:p=Math.max(g-1-p,0);break;case Xs.loopReverse:p=g-1-p%g;break;case Xs.pingpongReverse:{const _=(g<<1)-2;p=_==0?0:(p+g-1)%_,p>=g&&(p=_-p)}}l.sequenceIndex=p}};let tr=wi;tr.ENTRIES=3;tr.MODE=1;tr.DELAY=2;const Us=class{constructor(s){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new qg(this),this.propertyIDs=new sg,this.animationsChanged=!1,this.trackEntryPool=new Pa(()=>new $a),this.data=s}static emptyAnimation(){return Us._emptyAnimation}update(s){s*=this.timeScale;const t=this.tracks;for(let e=0,i=t.length;e<i;e++){const n=t[e];if(!n)continue;n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;let r=s*n.timeScale;if(n.delay>0){if(n.delay-=r,n.delay>0)continue;r=-n.delay,n.delay=0}let a=n.next;if(a){const l=n.trackLast-a.delay;if(l>=0){for(a.delay=0,a.trackTime+=n.timeScale==0?0:(l/n.timeScale+s)*a.timeScale,n.trackTime+=r,this.setCurrent(e,a,!0);a.mixingFrom;)a.mixTime+=s,a=a.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&!n.mixingFrom){t[e]=null,this.queue.end(n),this.clearNext(n);continue}if(n.mixingFrom&&this.updateMixingFrom(n,s)){let l=n.mixingFrom;for(n.mixingFrom=null,l&&(l.mixingTo=null);l;)this.queue.end(l),l=l.mixingFrom}n.trackTime+=r}this.queue.drain()}updateMixingFrom(s,t){const e=s.mixingFrom;if(!e)return!0;const i=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,s.mixTime>0&&s.mixTime>=s.mixDuration?((e.totalAlpha==0||s.mixDuration==0)&&(s.mixingFrom=e.mixingFrom,e.mixingFrom&&(e.mixingFrom.mixingTo=s),s.interruptAlpha=e.interruptAlpha,this.queue.end(e)),i):(e.trackTime+=t*e.timeScale,s.mixTime+=t,!1)}apply(s){if(!s)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();const t=this.events,e=this.tracks;let i=!1;for(let a=0,l=e.length;a<l;a++){const o=e[a];if(!o||o.delay>0)continue;i=!0;const h=a==0?T.first:o.mixBlend;let c=o.alpha;o.mixingFrom?c*=this.applyMixingFrom(o,s,h):o.trackTime>=o.trackEnd&&!o.next&&(c=0);const u=o.animationLast,d=o.getAnimationTime();let f=d,m=t;o.reverse&&(f=o.animation.duration-f,m=null);const p=o.animation.timelines,g=p.length;if(a==0&&c==1||h==T.add)for(let v=0;v<g;v++){const _=p[v];_ instanceof Ki?this.applyAttachmentTimeline(_,s,f,h,!0):_.apply(s,u,f,m,c,h,ct.mixIn)}else{const v=o.timelineMode,_=o.shortestRotation,x=!_&&o.timelinesRotation.length!=g<<1;x&&(o.timelinesRotation.length=g<<1);for(let y=0;y<g;y++){const b=p[y],w=v[y]==Rl?h:T.setup;!_&&b instanceof Hr?this.applyRotateTimeline(b,s,f,c,w,o.timelinesRotation,y<<1,x):b instanceof Ki?this.applyAttachmentTimeline(b,s,f,h,!0):b.apply(s,u,f,m,c,w,ct.mixIn)}}this.queueEvents(o,d),t.length=0,o.nextAnimationLast=d,o.nextTrackLast=o.trackTime}const n=this.unkeyedState+Df,r=s.slots;for(let a=0,l=s.slots.length;a<l;a++){const o=r[a];if(o.attachmentState==n){const h=o.data.attachmentName;o.setAttachment(h?s.getAttachment(o.data.index,h):null)}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(s,t,e){const i=s.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,t,e);let n=0;s.mixDuration==0?(n=1,e==T.first&&(e=T.setup)):(n=s.mixTime/s.mixDuration,n>1&&(n=1),e!=T.first&&(e=i.mixBlend));const r=n<i.attachmentThreshold,a=n<i.drawOrderThreshold,l=i.animation.timelines,o=l.length,h=i.alpha*s.interruptAlpha,c=h*(1-n),u=i.animationLast,d=i.getAnimationTime();let f=d,m=null;if(i.reverse?f=i.animation.duration-f:n<i.eventThreshold&&(m=this.events),e==T.add)for(let p=0;p<o;p++)l[p].apply(t,u,f,m,c,e,ct.mixOut);else{const p=i.timelineMode,g=i.timelineHoldMix,v=i.shortestRotation,_=!v&&i.timelinesRotation.length!=o<<1;_&&(i.timelinesRotation.length=o<<1),i.totalAlpha=0;for(let x=0;x<o;x++){const y=l[x];let b=ct.mixOut,w,E=0;switch(p[x]){case Rl:if(!a&&y instanceof nn)continue;w=e,E=c;break;case Ff:w=T.setup,E=c;break;case Bf:w=e,E=h;break;case Pl:w=T.setup,E=h;break;default:w=T.setup;const S=g[x];E=h*Math.max(0,1-S.mixTime/S.mixDuration);break}i.totalAlpha+=E,!v&&y instanceof Hr?this.applyRotateTimeline(y,t,f,E,w,i.timelinesRotation,x<<1,_):y instanceof Ki?this.applyAttachmentTimeline(y,t,f,w,r):(a&&y instanceof nn&&w==T.setup&&(b=ct.mixIn),y.apply(t,u,f,m,E,w,b))}}return s.mixDuration>0&&this.queueEvents(i,d),this.events.length=0,i.nextAnimationLast=d,i.nextTrackLast=i.trackTime,n}applyAttachmentTimeline(s,t,e,i,n){const r=t.slots[s.slotIndex];r.bone.active&&(e<s.frames[0]?(i==T.setup||i==T.first)&&this.setAttachment(t,r,r.data.attachmentName,n):this.setAttachment(t,r,s.attachmentNames[Gt.search1(s.frames,e)],n),r.attachmentState<=this.unkeyedState&&(r.attachmentState=this.unkeyedState+Df))}setAttachment(s,t,e,i){t.setAttachment(e?s.getAttachment(t.data.index,e):null),i&&(t.attachmentState=this.unkeyedState+Gw)}applyRotateTimeline(s,t,e,i,n,r,a,l){if(l&&(r[a]=0),i==1){s.apply(t,0,e,null,1,n,ct.mixIn);return}const o=t.bones[s.boneIndex];if(!o.active)return;const h=s.frames;let c=0,u=0;if(e<h[0])switch(n){case T.setup:o.rotation=o.data.rotation;default:return;case T.first:c=o.rotation,u=o.data.rotation}else c=n==T.setup?o.data.rotation:o.rotation,u=o.data.rotation+s.getCurveValue(e);let d=0,f=u-c;if(f-=(16384-(16384.499999999996-f/360|0))*360,f==0)d=r[a];else{let m=0,p=0;l?(m=0,p=f):(m=r[a],p=r[a+1]);const g=f>0;let v=m>=0;C.signum(p)!=C.signum(f)&&Math.abs(p)<=90&&(Math.abs(m)>180&&(m+=360*C.signum(m)),v=g),d=f+m-m%360,v!=g&&(d+=360*C.signum(m)),r[a]=d}r[a+1]=f,o.rotation=c+d*i}queueEvents(s,t){const e=s.animationStart,i=s.animationEnd,n=i-e,r=s.trackLast%n,a=this.events;let l=0;const o=a.length;for(;l<o;l++){const c=a[l];if(c.time<r)break;c.time>i||this.queue.event(s,c)}let h=!1;for(s.loop?h=n==0||r>s.trackTime%n:h=t>=i&&s.animationLast<i,h&&this.queue.complete(s);l<o;l++){const c=a[l];c.time<e||this.queue.event(s,c)}}clearTracks(){const s=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=s,this.queue.drain()}clearTrack(s){if(s>=this.tracks.length)return;const t=this.tracks[s];if(!t)return;this.queue.end(t),this.clearNext(t);let e=t;for(;;){const i=e.mixingFrom;if(!i)break;this.queue.end(i),e.mixingFrom=null,e.mixingTo=null,e=i}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(s,t,e){const i=this.expandToIndex(s);this.tracks[s]=t,t.previous=null,i&&(e&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)}setAnimation(s,t,e=!1){const i=this.data.skeletonData.findAnimation(t);if(!i)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(s,i,e)}setAnimationWith(s,t,e=!1){if(!t)throw new Error("animation cannot be null.");let i=!0,n=this.expandToIndex(s);n&&(n.nextTrackLast==-1?(this.tracks[s]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,i=!1):this.clearNext(n));const r=this.trackEntry(s,t,e,n);return this.setCurrent(s,r,i),this.queue.drain(),r}addAnimation(s,t,e=!1,i=0){const n=this.data.skeletonData.findAnimation(t);if(!n)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(s,n,e,i)}addAnimationWith(s,t,e=!1,i=0){if(!t)throw new Error("animation cannot be null.");let n=this.expandToIndex(s);if(n)for(;n.next;)n=n.next;const r=this.trackEntry(s,t,e,n);return n?(n.next=r,r.previous=n,i<=0&&(i+=n.getTrackComplete()-r.mixDuration)):(this.setCurrent(s,r,!0),this.queue.drain()),r.delay=i,r}setEmptyAnimation(s,t=0){const e=this.setAnimationWith(s,Us.emptyAnimation(),!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(s,t=0,e=0){const i=this.addAnimationWith(s,Us.emptyAnimation(),!1,e);return e<=0&&(i.delay+=i.mixDuration-t),i.mixDuration=t,i.trackEnd=t,i}setEmptyAnimations(s=0){const t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++){const n=this.tracks[e];n&&this.setEmptyAnimation(n.trackIndex,s)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(s){return s<this.tracks.length?this.tracks[s]:(D.ensureArrayCapacity(this.tracks,s+1,null),this.tracks.length=s+1,null)}trackEntry(s,t,e,i){const n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=s,n.animation=t,n.loop=e,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.attachmentThreshold=0,n.drawOrderThreshold=0,n.animationStart=0,n.animationEnd=t.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=i?this.data.getMix(i.animation,t):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=T.replace,n}clearNext(s){let t=s.next;for(;t;)this.queue.dispose(t),t=t.next;s.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();const s=this.tracks;for(let t=0,e=s.length;t<e;t++){let i=s[t];if(i){for(;i.mixingFrom;)i=i.mixingFrom;do(!i.mixingTo||i.mixBlend!=T.add)&&this.computeHold(i),i=i.mixingTo;while(i)}}}computeHold(s){const t=s.mixingTo,e=s.animation.timelines,i=s.animation.timelines.length,n=s.timelineMode;n.length=i;const r=s.timelineHoldMix;r.length=0;const a=this.propertyIDs;if(t&&t.holdPrevious){for(let l=0;l<i;l++)n[l]=a.addAll(e[l].getPropertyIds())?Pl:Bf;return}t:for(let l=0;l<i;l++){const o=e[l],h=o.getPropertyIds();if(!a.addAll(h))n[l]=Rl;else if(!t||o instanceof Ki||o instanceof nn||o instanceof oo||!t.animation.hasTimeline(h))n[l]=Ff;else{for(let c=t.mixingTo;c;c=c.mixingTo)if(!c.animation.hasTimeline(h)){if(s.mixDuration>0){n[l]=$w,r[l]=c;continue t}break}n[l]=Pl}}}getCurrent(s){return s>=this.tracks.length?null:this.tracks[s]}addListener(s){if(!s)throw new Error("listener cannot be null.");this.listeners.push(s)}removeListener(s){const t=this.listeners.indexOf(s);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(s,t,e){Us.deprecatedWarning1||(Us.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(s,t,e)}addAnimationByName(s,t,e,i){Us.deprecatedWarning2||(Us.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(s,t,e,i)}hasAnimation(s){return this.data.skeletonData.findAnimation(s)!==null}hasAnimationByName(s){return Us.deprecatedWarning3||(Us.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(s)}};let er=Us;er._emptyAnimation=new Xa("<empty>",[],0);er.deprecatedWarning1=!1;er.deprecatedWarning2=!1;er.deprecatedWarning3=!1;const ni=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=T.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){const s=this.animationEnd-this.animationStart;return s==0?this.animationStart:this.trackTime%s+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(s){this.animationLast=s,this.nextAnimationLast=s}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){const s=this.animationEnd-this.animationStart;if(s!=0){if(this.loop)return s*(1+(this.trackTime/s|0));if(this.trackTime<s)return s}return this.trackTime}get time(){return ni.deprecatedWarning1||(ni.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(s){ni.deprecatedWarning1||(ni.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=s}get endTime(){return ni.deprecatedWarning2||(ni.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(s){ni.deprecatedWarning2||(ni.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=s}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}};let $a=ni;$a.deprecatedWarning1=!1;$a.deprecatedWarning2=!1;class qg{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(De.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(De.interrupt),this.objects.push(t)}end(t){this.objects.push(De.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(De.dispose),this.objects.push(t)}complete(t){this.objects.push(De.complete),this.objects.push(t)}event(t,e){this.objects.push(De.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;const t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){const n=t[i],r=t[i+1];switch(n){case De.start:r.listener&&r.listener.start&&r.listener.start(r);for(let l=0;l<e.length;l++){const o=e[l];o.start&&o.start(r)}break;case De.interrupt:r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(let l=0;l<e.length;l++){const o=e[l];o.interrupt&&o.interrupt(r)}break;case De.end:r.listener&&r.listener.end&&r.listener.end(r);for(let l=0;l<e.length;l++){const o=e[l];o.end&&o.end(r)}case De.dispose:r.listener&&r.listener.dispose&&r.listener.dispose(r);for(let l=0;l<e.length;l++){const o=e[l];o.dispose&&o.dispose(r)}this.animState.trackEntryPool.free(r);break;case De.complete:r.listener&&r.listener.complete&&r.listener.complete(r);for(let l=0;l<e.length;l++){const o=e[l];o.complete&&o.complete(r)}break;case De.event:const a=t[i+++2];r.listener&&r.listener.event&&r.listener.event(r,a);for(let l=0;l<e.length;l++){const o=e[l];o.event&&o.event(r,a)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var De=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(De||{});class Yw{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}}const Rl=0,Ff=1,Bf=2,Pl=3,$w=4,Df=1,Gw=2;class Zg{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){const n=this.skeletonData.findAnimation(t);if(!n)throw new Error(`Animation not found: ${t}`);const r=this.skeletonData.findAnimation(e);if(!r)throw new Error(`Animation not found: ${e}`);this.setMixWith(n,r,i)}setMixWith(t,e,i){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");const n=`${t.name}.${e.name}`;this.animationToMixTime[n]=i}getMix(t,e){const i=`${t.name}.${e.name}`,n=this.animationToMixTime[i];return n===void 0?this.defaultMix:n}}class Su{constructor(t){this.atlas=t}loadSequence(t,e,i){const n=i.regions;for(let r=0,a=n.length;r<a;r++){const l=i.getPath(e,r),o=this.atlas.findRegion(l);if(o==null)throw new Error(`Region not found in atlas: ${l} (sequence: ${t})`);n[r]=o,n[r].renderObject=n[r]}}newRegionAttachment(t,e,i,n){const r=new wt(e,i);if(n!=null)this.loadSequence(e,i,n);else{const a=this.atlas.findRegion(i);if(!a)throw new Error(`Region not found in atlas: ${i} (region attachment: ${e})`);a.renderObject=a,r.region=a}return r}newMeshAttachment(t,e,i,n){const r=new ln(e,i);if(n!=null)this.loadSequence(e,i,n);else{const a=this.atlas.findRegion(i);if(!a)throw new Error(`Region not found in atlas: ${i} (mesh attachment: ${e})`);a.renderObject=a,r.region=a}return r}newBoundingBoxAttachment(t,e){return new La(e)}newPathAttachment(t,e){return new hn(e)}newPointAttachment(t,e){return new Va(e)}newClippingAttachment(t,e){return new Oa(e)}}class Rh{constructor(t,e,i){if(this.matrix=new Rt,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,n,r,a,l){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=n,this.ascaleY=r,this.ashearX=a,this.ashearY=l;const o=this.parent,h=this.matrix,c=this.skeleton.scaleX,u=-this.skeleton.scaleY;if(!o){const g=this.skeleton,v=i+90+l;h.a=C.cosDeg(i+a)*n*c,h.c=C.cosDeg(v)*r*c,h.b=C.sinDeg(i+a)*n*u,h.d=C.sinDeg(v)*r*u,h.tx=t*c+g.x,h.ty=e*u+g.y;return}let d=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=d*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case it.Normal:{const g=i+90+l,v=C.cosDeg(i+a)*n,_=C.cosDeg(g)*r,x=C.sinDeg(i+a)*n,y=C.sinDeg(g)*r;h.a=d*v+f*x,h.c=d*_+f*y,h.b=m*v+p*x,h.d=m*_+p*y;return}case it.OnlyTranslation:{const g=i+90+l;h.a=C.cosDeg(i+a)*n,h.c=C.cosDeg(g)*r,h.b=C.sinDeg(i+a)*n,h.d=C.sinDeg(g)*r;break}case it.NoRotationOrReflection:{let g=d*d+m*m,v=0;g>1e-4?(g=Math.abs(d*p-f*m)/g,d/=c,m/=u,f=m*g,p=d*g,v=Math.atan2(m,d)*C.radDeg):(d=0,m=0,v=90-Math.atan2(p,f)*C.radDeg);const _=i+a-v,x=i+l-v+90,y=C.cosDeg(_)*n,b=C.cosDeg(x)*r,w=C.sinDeg(_)*n,E=C.sinDeg(x)*r;h.a=d*y-f*w,h.c=d*b-f*E,h.b=m*y+p*w,h.d=m*b+p*E;break}case it.NoScale:case it.NoScaleOrReflection:{const g=C.cosDeg(i),v=C.sinDeg(i);let _=(d*g+f*v)/c,x=(m*g+p*v)/u,y=Math.sqrt(_*_+x*x);y>1e-5&&(y=1/y),_*=y,x*=y,y=Math.sqrt(_*_+x*x),this.data.transformMode==it.NoScale&&d*p-f*m<0!=(c<0!=u<0)&&(y=-y);const b=Math.PI/2+Math.atan2(x,_),w=Math.cos(b)*y,E=Math.sin(b)*y,S=C.cosDeg(a)*n,A=C.cosDeg(90+l)*r,M=C.sinDeg(a)*n,I=C.sinDeg(90+l)*r;h.a=_*S+w*M,h.c=_*A+w*I,h.b=x*S+E*M,h.d=x*A+E*I;break}}h.a*=c,h.c*=c,h.b*=u,h.d*=u}setToSetupPose(){const t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*C.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*C.radDeg}getWorldScaleX(){const t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){const t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){const t=this.parent,e=this.matrix;if(!t){this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*C.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*C.radDeg;return}const i=t.matrix,n=1/(i.a*i.d-i.b*i.c),r=e.tx-i.tx,a=e.ty-i.ty;this.ax=r*i.d*n-a*i.c*n,this.ay=a*i.a*n-r*i.b*n;const l=n*i.d,o=n*i.a,h=n*i.c,c=n*i.b,u=l*e.a-h*e.b,d=l*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+f*f),this.ascaleX>1e-4){const p=u*m-d*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(u*d+f*m,p)*C.radDeg,this.arotation=Math.atan2(f,u)*C.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,d)*C.radDeg}worldToLocal(t){const e=this.matrix,i=e.a,n=e.c,r=e.b,a=e.d,l=1/(i*a-n*r),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*a*l-h*n*l,t.y=h*i*l-o*r*l,t}localToWorld(t){const e=this.matrix,i=t.x,n=t.y;return t.x=i*e.a+n*e.c+e.tx,t.y=i*e.b+n*e.d+e.ty,t}worldToLocalRotation(t){const e=C.sinDeg(t),i=C.cosDeg(t),n=this.matrix;return Math.atan2(n.a*e-n.b*i,n.d*i-n.c*e)*C.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;const e=C.sinDeg(t),i=C.cosDeg(t),n=this.matrix;return Math.atan2(i*n.b+e*n.d,i*n.a+e*n.c)*C.radDeg}rotateWorld(t){const e=this.matrix,i=e.a,n=e.c,r=e.b,a=e.d,l=C.cosDeg(t),o=C.sinDeg(t);e.a=l*i-o*r,e.c=l*n-o*a,e.b=o*i+l*r,e.d=o*n+l*a}}class Tu{constructor(t,e,i){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=it.Normal,this.skinRequired=!1,this.color=new H,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}}class Ga{constructor(t,e,i){this.name=t,this.order=e,this.skinRequired=i}}let Au=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};class Cu{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}}class Kg{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let n=0;n<t.bones.length;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}`);this.bones.push(r)}const i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=i}isActive(){return this.active}update(){if(this.mix==0)return;const t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,i,n,r,a,l){const o=t.parent.matrix;if(!o)throw new Error("IK bone must have parent.");const h=o.a;let c=o.c;const u=o.b;let d=o.d,f=-t.ashearX-t.arotation,m=0,p=0;const g=t.skeleton.scaleX,v=-t.skeleton.scaleY;switch(t.data.transformMode){case it.OnlyTranslation:m=e-t.worldX,p=i-t.worldY,p=-p;break;case it.NoRotationOrReflection:const y=Math.abs(h*d-c*u)/(h*h+u*u),b=h/g,w=u/v;c=-w*y*g,d=b*y*v,f+=Math.atan2(w,b)*C.radDeg;default:const E=e-o.tx,S=i-o.ty,A=h*d-c*u;m=(E*d-S*c)/A-t.ax,p=(S*h-E*u)/A-t.ay}f+=Math.atan2(p,m)*C.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let _=t.ascaleX,x=t.ascaleY;if(n||r){switch(t.data.transformMode){case it.NoScale:case it.NoScaleOrReflection:m=e-t.worldX,p=i-t.worldY}const y=t.data.length*_,b=Math.sqrt(m*m+p*p);if(n&&b<y||r&&b>y&&y>1e-4){const w=(b/y-1)*l+1;_*=w,a&&(x*=w)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*l,_,x,t.ashearX,t.ashearY)}apply2(t,e,i,n,r,a,l,o,h){const c=t.ax,u=t.ay;let d=t.ascaleX,f=t.ascaleY,m=d,p=f,g=e.ascaleX;const v=t.matrix;let _=0,x=0,y=0;d<0?(d=-d,_=180,y=-1):(_=0,y=1),f<0&&(f=-f,y=-y),g<0?(g=-g,x=180):x=0;const b=e.ax;let w=0,E=0,S=0,A=v.a,M=v.c,I=v.b,k=v.d;const R=Math.abs(d-f)<=1e-4;!R||a?(w=0,E=A*b+v.tx,S=I*b+v.ty):(w=e.ay,E=A*b+M*w+v.tx,S=I*b+k*w+v.ty);const P=t.parent.matrix;if(!P)throw new Error("IK parent must itself have a parent.");A=P.a,M=P.c,I=P.b,k=P.d;const B=1/(A*k-M*I);let L=E-P.tx,O=S-P.ty;const G=(L*k-O*M)*B-c,U=(O*A-L*I)*B-u,F=Math.sqrt(G*G+U*U);let V=e.data.length*g,X,Y;if(F<1e-4){this.apply1(t,i,n,!1,a,!1,h),e.updateWorldTransformWith(b,w,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}L=i-P.tx,O=n-P.ty;let $=(L*k-O*M)*B-c,W=(O*A-L*I)*B-u,Q=$*$+W*W;if(o!=0){o*=d*(g+1)*.5;const ot=Math.sqrt(Q),xt=ot-F-V*d+o;if(xt>0){let ut=Math.min(1,xt/(o*2))-1;ut=(xt-o*(1-ut*ut))/ot,$-=ut*$,W-=ut*W,Q=$*$+W*W}}t:if(R){V*=d;let ot=(Q-F*F-V*V)/(2*F*V);ot<-1?(ot=-1,Y=Math.PI*r):ot>1?(ot=1,Y=0,a&&(A=(Math.sqrt(Q)/(F+V)-1)*h+1,m*=A,l&&(p*=A))):Y=Math.acos(ot)*r,A=F+V*ot,M=V*Math.sin(Y),X=Math.atan2(W*A-$*M,$*A+W*M)}else{A=d*V,M=f*V;const ot=A*A,xt=M*M,ut=Math.atan2(W,$);I=xt*F*F+ot*Q-ot*xt;const St=-2*xt*F,At=xt-ot;if(k=St*St-4*At*I,k>=0){let ye=Math.sqrt(k);St<0&&(ye=-ye),ye=-(St+ye)*.5;const Ks=ye/At,rd=I/ye,dn=Math.abs(Ks)<Math.abs(rd)?Ks:rd;if(dn*dn<=Q){O=Math.sqrt(Q-dn*dn)*r,X=ut-Math.atan2(O,dn),Y=Math.atan2(O/f,(dn-F)/d);break t}}let Jt=C.PI,Wt=F-A,me=Wt*Wt,$e=0,Pe=0,ke=F+A,Ge=ke*ke,gi=0;I=-A*F/(ot-xt),I>=-1&&I<=1&&(I=Math.acos(I),L=A*Math.cos(I)+F,O=M*Math.sin(I),k=L*L+O*O,k<me&&(Jt=I,me=k,Wt=L,$e=O),k>Ge&&(Pe=I,Ge=k,ke=L,gi=O)),Q<=(me+Ge)*.5?(X=ut-Math.atan2($e*r,Wt),Y=Jt*r):(X=ut-Math.atan2(gi*r,ke),Y=Pe*r)}const st=Math.atan2(w,b)*y;let mt=t.arotation;X=(X-st)*C.radDeg+_-mt,X>180?X-=360:X<-180&&(X+=360),t.updateWorldTransformWith(c,u,mt+X*h,m,p,0,0),mt=e.arotation,Y=((Y+st)*C.radDeg-e.ashearX)*y+x-mt,Y>180?Y-=360:Y<-180&&(Y+=360),e.updateWorldTransformWith(b,w,mt+Y*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class Mu extends Ga{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Iu extends Ga{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=Xt.Fixed,this.spacingMode=ee.Fixed,this.rotateMode=qt.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var ee=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s[s.Proportional=3]="Proportional",s))(ee||{});const ri=class{constructor(s,t){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!s)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=s,this.bones=new Array;for(let i=0,n=s.bones.length;i<n;i++){const r=t.findBone(s.bones[i].name);if(!r)throw new Error(`Couldn't find bone ${s.bones[i].name}.`);this.bones.push(r)}const e=t.findSlot(s.target.name);if(!e)throw new Error(`Couldn't find target bone ${s.target.name}`);this.target=e,this.position=s.position,this.spacing=s.spacing,this.mixRotate=s.mixRotate,this.mixX=s.mixX,this.mixY=s.mixY}isActive(){return this.active}update(){const s=this.target.getAttachment();if(!(s instanceof hn))return;const t=this.mixRotate,e=this.mixX,i=this.mixY;if(t==0&&e==0&&i==0)return;const n=this.data,r=n.rotateMode==qt.Tangent,a=n.rotateMode==qt.ChainScale,l=this.bones,o=l.length,h=r?o:o+1,c=D.setArraySize(this.spaces,h),u=a?this.lengths=D.setArraySize(this.lengths,o):[],d=this.spacing;switch(n.spacingMode){case ee.Percent:if(a)for(let y=0,b=h-1;y<b;y++){const w=l[y],E=w.data.length;if(E<ri.epsilon)u[y]=0;else{const S=E*w.matrix.a,A=E*w.matrix.b;u[y]=Math.sqrt(S*S+A*A)}}D.arrayFill(c,1,h,d);break;case ee.Proportional:let _=0;for(let y=0,b=h-1;y<b;){const w=l[y],E=w.data.length;if(E<ri.epsilon)a&&(u[y]=0),c[++y]=d;else{const S=E*w.matrix.a,A=E*w.matrix.b,M=Math.sqrt(S*S+A*A);a&&(u[y]=M),c[++y]=M,_+=M}}if(_>0){_=h/_*d;for(let y=1;y<h;y++)c[y]*=_}break;default:const x=n.spacingMode==ee.Length;for(let y=0,b=h-1;y<b;){const w=l[y],E=w.data.length;if(E<ri.epsilon)a&&(u[y]=0),c[++y]=d;else{const S=E*w.matrix.a,A=E*w.matrix.b,M=Math.sqrt(S*S+A*A);a&&(u[y]=M),c[++y]=(x?E+d:d)*M/E}}}const f=this.computeWorldPositions(s,h,r);let m=f[0],p=f[1],g=n.offsetRotation,v=!1;if(g==0)v=n.rotateMode==qt.Chain;else{v=!1;const _=this.target.bone.matrix;g*=_.a*_.d-_.b*_.c>0?C.degRad:-C.degRad}for(let _=0,x=3;_<o;_++,x+=3){const y=l[_],b=y.matrix;b.tx+=(m-b.tx)*e,b.ty+=(p-b.ty)*i;const w=f[x],E=f[x+1],S=w-m,A=E-p;if(a){const M=u[_];if(M!=0){const I=(Math.sqrt(S*S+A*A)/M-1)*t+1;b.a*=I,b.b*=I}}if(m=w,p=E,t>0){const M=b.a,I=b.c,k=b.b,R=b.d;let P=0,B=0,L=0;if(r?P=f[x-1]:c[_+1]==0?P=f[x+2]:P=Math.atan2(A,S),P-=Math.atan2(k,M),v){B=Math.cos(P),L=Math.sin(P);const O=y.data.length;m+=(O*(B*M-L*k)-S)*t,p+=(O*(L*M+B*k)-A)*t}else P+=g;P>C.PI?P-=C.PI2:P<-C.PI&&(P+=C.PI2),P*=t,B=Math.cos(P),L=Math.sin(P),b.a=B*M-L*k,b.c=B*I-L*R,b.b=L*M+B*k,b.d=L*I+B*R}y.updateAppliedTransform()}}computeWorldPositions(s,t,e){const i=this.target;let n=this.position;const r=this.spaces,a=D.setArraySize(this.positions,t*3+2);let l=this.world;const o=s.closed;let h=s.worldVerticesLength,c=h/6,u=ri.NONE;if(!s.constantSpeed){const O=s.lengths;c-=o?1:2;const G=O[c];this.data.positionMode==Xt.Percent&&(n*=G);let U;switch(this.data.spacingMode){case ee.Percent:U=G;break;case ee.Proportional:U=G/t;break;default:U=1}l=D.setArraySize(this.world,8);for(let F=0,V=0,X=0;F<t;F++,V+=3){const Y=r[F]*U;n+=Y;let $=n;if(o)$%=G,$<0&&($+=G),X=0;else if($<0){u!=ri.BEFORE&&(u=ri.BEFORE,s.computeWorldVertices(i,2,4,l,0,2)),this.addBeforePosition($,l,0,a,V);continue}else if($>G){u!=ri.AFTER&&(u=ri.AFTER,s.computeWorldVertices(i,h-6,4,l,0,2)),this.addAfterPosition($-G,l,0,a,V);continue}for(;;X++){const W=O[X];if(!($>W)){if(X==0)$/=W;else{const Q=O[X-1];$=($-Q)/(W-Q)}break}}X!=u&&(u=X,o&&X==c?(s.computeWorldVertices(i,h-4,4,l,0,2),s.computeWorldVertices(i,0,4,l,4,2)):s.computeWorldVertices(i,X*6+2,8,l,0,2)),this.addCurvePosition($,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],a,V,e||F>0&&Y==0)}return a}o?(h+=2,l=D.setArraySize(this.world,h),s.computeWorldVertices(i,2,h-4,l,0,2),s.computeWorldVertices(i,0,2,l,h-4,2),l[h-2]=l[0],l[h-1]=l[1]):(c--,h-=4,l=D.setArraySize(this.world,h),s.computeWorldVertices(i,2,h,l,0,2));const d=D.setArraySize(this.curves,c);let f=0,m=l[0],p=l[1],g=0,v=0,_=0,x=0,y=0,b=0,w=0,E=0,S=0,A=0,M=0,I=0,k=0,R=0;for(let O=0,G=2;O<c;O++,G+=6)g=l[G],v=l[G+1],_=l[G+2],x=l[G+3],y=l[G+4],b=l[G+5],w=(m-g*2+_)*.1875,E=(p-v*2+x)*.1875,S=((g-_)*3-m+y)*.09375,A=((v-x)*3-p+b)*.09375,M=w*2+S,I=E*2+A,k=(g-m)*.75+w+S*.16666667,R=(v-p)*.75+E+A*.16666667,f+=Math.sqrt(k*k+R*R),k+=M,R+=I,M+=S,I+=A,f+=Math.sqrt(k*k+R*R),k+=M,R+=I,f+=Math.sqrt(k*k+R*R),k+=M+S,R+=I+A,f+=Math.sqrt(k*k+R*R),d[O]=f,m=y,p=b;this.data.positionMode==Xt.Percent&&(n*=f);let P;switch(this.data.spacingMode){case ee.Percent:P=f;break;case ee.Proportional:P=f/t;break;default:P=1}const B=this.segments;let L=0;for(let O=0,G=0,U=0,F=0;O<t;O++,G+=3){const V=r[O]*P;n+=V;let X=n;if(o)X%=f,X<0&&(X+=f),U=0;else if(X<0){this.addBeforePosition(X,l,0,a,G);continue}else if(X>f){this.addAfterPosition(X-f,l,h-4,a,G);continue}for(;;U++){const Y=d[U];if(!(X>Y)){if(U==0)X/=Y;else{const $=d[U-1];X=(X-$)/(Y-$)}break}}if(U!=u){u=U;let Y=U*6;for(m=l[Y],p=l[Y+1],g=l[Y+2],v=l[Y+3],_=l[Y+4],x=l[Y+5],y=l[Y+6],b=l[Y+7],w=(m-g*2+_)*.03,E=(p-v*2+x)*.03,S=((g-_)*3-m+y)*.006,A=((v-x)*3-p+b)*.006,M=w*2+S,I=E*2+A,k=(g-m)*.3+w+S*.16666667,R=(v-p)*.3+E+A*.16666667,L=Math.sqrt(k*k+R*R),B[0]=L,Y=1;Y<8;Y++)k+=M,R+=I,M+=S,I+=A,L+=Math.sqrt(k*k+R*R),B[Y]=L;k+=M,R+=I,L+=Math.sqrt(k*k+R*R),B[8]=L,k+=M+S,R+=I+A,L+=Math.sqrt(k*k+R*R),B[9]=L,F=0}for(X*=L;;F++){const Y=B[F];if(!(X>Y)){if(F==0)X/=Y;else{const $=B[F-1];X=F+(X-$)/(Y-$)}break}}this.addCurvePosition(X*.1,m,p,g,v,_,x,y,b,a,G,e||O>0&&V==0)}return a}addBeforePosition(s,t,e,i,n){const r=t[e],a=t[e+1],l=t[e+2]-r,o=t[e+3]-a,h=Math.atan2(o,l);i[n]=r+s*Math.cos(h),i[n+1]=a+s*Math.sin(h),i[n+2]=h}addAfterPosition(s,t,e,i,n){const r=t[e+2],a=t[e+3],l=r-t[e],o=a-t[e+1],h=Math.atan2(o,l);i[n]=r+s*Math.cos(h),i[n+1]=a+s*Math.sin(h),i[n+2]=h}addCurvePosition(s,t,e,i,n,r,a,l,o,h,c,u){if(s==0||isNaN(s)){h[c]=t,h[c+1]=e,h[c+2]=Math.atan2(n-e,i-t);return}const d=s*s,f=d*s,m=1-s,p=m*m,g=p*m,v=m*s,_=v*3,x=m*_,y=_*s,b=t*g+i*x+r*y+l*f,w=e*g+n*x+a*y+o*f;h[c]=b,h[c+1]=w,u&&(s<.001?h[c+2]=Math.atan2(n-e,i-t):h[c+2]=Math.atan2(w-(e*p+n*v*2+a*d),b-(t*p+i*v*2+r*d)))}};let sr=ri;sr.NONE=-1;sr.BEFORE=-2;sr.AFTER=-3;sr.epsilon=1e-5;class Qg{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new H,this.darkColor=t.darkColor?new H:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof Ps)||!(this.attachment instanceof Ps)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Jg{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new $r,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let n=0;n<t.bones.length;n++){const r=e.findBone(t.bones[n].name);if(!r)throw new Error(`Couldn't find bone ${t.bones[n].name}.`);this.bones.push(r)}const i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=i}isActive(){return this.active}update(){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleX==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){const t=this.mixRotate,e=this.mixX,i=this.mixY,n=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=e!=0||i!=0,o=this.target,h=o.matrix,c=h.a,u=h.c,d=h.b,f=h.d,m=c*f-u*d>0?C.degRad:-C.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,v=this.bones;for(let _=0,x=v.length;_<x;_++){const y=v[_],b=y.matrix;if(t!=0){const w=b.a,E=b.c,S=b.b,A=b.d;let M=Math.atan2(d,c)-Math.atan2(S,w)+p;M>C.PI?M-=C.PI2:M<-C.PI&&(M+=C.PI2),M*=t;const I=Math.cos(M),k=Math.sin(M);b.a=I*w-k*S,b.c=I*E-k*A,b.b=k*w+I*S,b.d=k*E+I*A}if(l){const w=this.temp;o.localToWorld(w.set(this.data.offsetX,this.data.offsetY)),b.tx+=(w.x-b.tx)*e,b.ty+=(w.y-b.ty)*i}if(n!=0){let w=Math.sqrt(b.a*b.a+b.b*b.b);w!=0&&(w=(w+(Math.sqrt(c*c+d*d)-w+this.data.offsetScaleX)*n)/w),b.a*=w,b.b*=w}if(r!=0){let w=Math.sqrt(b.c*b.c+b.d*b.d);w!=0&&(w=(w+(Math.sqrt(u*u+f*f)-w+this.data.offsetScaleY)*r)/w),b.c*=w,b.d*=w}if(a>0){const w=b.c,E=b.d,S=Math.atan2(E,w);let A=Math.atan2(f,u)-Math.atan2(d,c)-(S-Math.atan2(b.b,b.a));A>C.PI?A-=C.PI2:A<-C.PI&&(A+=C.PI2),A=S+(A+g)*a;const M=Math.sqrt(w*w+E*E);b.c=Math.cos(A)*M,b.d=Math.sin(A)*M}y.updateAppliedTransform()}}applyRelativeWorld(){const t=this.mixRotate,e=this.mixX,i=this.mixY,n=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=e!=0||i!=0,o=this.target,h=o.matrix,c=h.a,u=h.c,d=h.b,f=h.d,m=c*f-u*d>0?C.degRad:-C.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,v=this.bones;for(let _=0,x=v.length;_<x;_++){const y=v[_],b=y.matrix;if(t!=0){const w=b.a,E=b.c,S=b.b,A=b.d;let M=Math.atan2(d,c)+p;M>C.PI?M-=C.PI2:M<-C.PI&&(M+=C.PI2),M*=t;const I=Math.cos(M),k=Math.sin(M);b.a=I*w-k*S,b.c=I*E-k*A,b.b=k*w+I*S,b.d=k*E+I*A}if(l){const w=this.temp;o.localToWorld(w.set(this.data.offsetX,this.data.offsetY)),b.tx+=w.x*e,b.ty+=w.y*i}if(n!=0){const w=(Math.sqrt(c*c+d*d)-1+this.data.offsetScaleX)*n+1;b.a*=w,b.b*=w}if(r!=0){const w=(Math.sqrt(u*u+f*f)-1+this.data.offsetScaleY)*r+1;b.c*=w,b.d*=w}if(a>0){let w=Math.atan2(f,u)-Math.atan2(d,c);w>C.PI?w-=C.PI2:w<-C.PI&&(w+=C.PI2);const E=b.c,S=b.d;w=Math.atan2(S,E)+(w-C.PI/2+g)*a;const A=Math.sqrt(E*E+S*S);b.c=Math.cos(w)*A,b.d=Math.sin(w)*A}y.updateAppliedTransform()}}applyAbsoluteLocal(){const t=this.mixRotate,e=this.mixX,i=this.mixY,n=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=this.target,o=this.bones;for(let h=0,c=o.length;h<c;h++){const u=o[h];let d=u.arotation;if(t!=0){let _=l.arotation-d+this.data.offsetRotation;_-=(16384-(16384.499999999996-_/360|0))*360,d+=_*t}let f=u.ax,m=u.ay;f+=(l.ax-f+this.data.offsetX)*e,m+=(l.ay-m+this.data.offsetY)*i;let p=u.ascaleX,g=u.ascaleY;n!=0&&p!=0&&(p=(p+(l.ascaleX-p+this.data.offsetScaleX)*n)/p),r!=0&&g!=0&&(g=(g+(l.ascaleY-g+this.data.offsetScaleY)*r)/g);let v=u.ashearY;if(a!=0){let _=l.ashearY-v+this.data.offsetShearY;_-=(16384-(16384.499999999996-_/360|0))*360,v+=_*a}u.updateWorldTransformWith(f,m,d,p,g,u.ashearX,v)}}applyRelativeLocal(){const t=this.mixRotate,e=this.mixX,i=this.mixY,n=this.mixScaleX,r=this.mixScaleY,a=this.mixShearY,l=this.target,o=this.bones;for(let h=0,c=o.length;h<c;h++){const u=o[h],d=u.arotation+(l.arotation+this.data.offsetRotation)*t,f=u.ax+(l.ax+this.data.offsetX)*e,m=u.ay+(l.ay+this.data.offsetY)*i,p=u.ascaleX*((l.ascaleX-1+this.data.offsetScaleX)*n+1),g=u.ascaleY*((l.ascaleY-1+this.data.offsetScaleY)*r+1),v=u.ashearY+(l.ashearY+this.data.offsetShearY)*a;u.updateWorldTransformWith(f,m,d,p,g,u.ashearX,v)}}}const yr=class{constructor(s){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!s)throw new Error("data cannot be null.");this.data=s,this.bones=new Array;for(let t=0;t<s.bones.length;t++){const e=s.bones[t];let i;if(!e.parent)i=new Rh(e,this,null);else{const n=this.bones[e.parent.index];i=new Rh(e,this,n),n.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<s.slots.length;t++){const e=s.slots[t],i=this.bones[e.boneData.index],n=new Qg(e,i);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let t=0;t<s.ikConstraints.length;t++){const e=s.ikConstraints[t];this.ikConstraints.push(new Kg(e,this))}this.transformConstraints=new Array;for(let t=0;t<s.transformConstraints.length;t++){const e=s.transformConstraints[t];this.transformConstraints.push(new Jg(e,this))}this.pathConstraints=new Array;for(let t=0;t<s.pathConstraints.length;t++){const e=s.pathConstraints[t];this.pathConstraints.push(new sr(e,this))}this.color=new H(1,1,1,1),this.updateCache()}updateCache(){const s=this._updateCache;s.length=0;const t=this.bones;for(let h=0,c=t.length;h<c;h++){const u=t[h];u.sorted=u.data.skinRequired,u.active=!u.sorted}if(this.skin){const h=this.skin.bones;for(let c=0,u=this.skin.bones.length;c<u;c++){let d=this.bones[h[c].index];do d.sorted=!1,d.active=!0,d=d.parent;while(d)}}const e=this.ikConstraints,i=this.transformConstraints,n=this.pathConstraints,r=e.length,a=i.length,l=n.length,o=r+a+l;t:for(let h=0;h<o;h++){for(let c=0;c<r;c++){const u=e[c];if(u.data.order==h){this.sortIkConstraint(u);continue t}}for(let c=0;c<a;c++){const u=i[c];if(u.data.order==h){this.sortTransformConstraint(u);continue t}}for(let c=0;c<l;c++){const u=n[c];if(u.data.order==h){this.sortPathConstraint(u);continue t}}}for(let h=0,c=t.length;h<c;h++)this.sortBone(t[h])}sortIkConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin&&D.contains(this.skin.constraints,s.data,!0)),!s.active)return;const t=s.target;this.sortBone(t);const e=s.bones,i=e[0];if(this.sortBone(i),e.length==1)this._updateCache.push(s),this.sortReset(i.children);else{const n=e[e.length-1];this.sortBone(n),this._updateCache.push(s),this.sortReset(i.children),n.sorted=!0}}sortPathConstraint(s){if(s.active=s.target.bone.isActive()&&(!s.data.skinRequired||this.skin&&D.contains(this.skin.constraints,s.data,!0)),!s.active)return;const t=s.target,e=t.data.index,i=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,e,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,i);for(let l=0,o=this.data.skins.length;l<o;l++)this.sortPathConstraintAttachment(this.data.skins[l],e,i);const n=t.getAttachment();n instanceof hn&&this.sortPathConstraintAttachmentWith(n,i);const r=s.bones,a=r.length;for(let l=0;l<a;l++)this.sortBone(r[l]);this._updateCache.push(s);for(let l=0;l<a;l++)this.sortReset(r[l].children);for(let l=0;l<a;l++)r[l].sorted=!0}sortTransformConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin&&D.contains(this.skin.constraints,s.data,!0)),!s.active)return;this.sortBone(s.target);const t=s.bones,e=t.length;if(s.data.local)for(let i=0;i<e;i++){const n=t[i];this.sortBone(n.parent),this.sortBone(n)}else for(let i=0;i<e;i++)this.sortBone(t[i]);this._updateCache.push(s);for(let i=0;i<e;i++)this.sortReset(t[i].children);for(let i=0;i<e;i++)t[i].sorted=!0}sortPathConstraintAttachment(s,t,e){const i=s.attachments[t];if(i)for(const n in i)this.sortPathConstraintAttachmentWith(i[n],e)}sortPathConstraintAttachmentWith(s,t){if(!(s instanceof hn))return;const e=s.bones;if(!e)this.sortBone(t);else{const i=this.bones;for(let n=0,r=e.length;n<r;){let a=e[n++];for(a+=n;n<a;)this.sortBone(i[e[n++]])}}}sortBone(s){if(!s||s.sorted)return;const t=s.parent;t&&this.sortBone(t),s.sorted=!0,this._updateCache.push(s)}sortReset(s){for(let t=0,e=s.length;t<e;t++){const i=s[t];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(){const s=this.bones;for(let e=0,i=s.length;e<i;e++){const n=s[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY}const t=this._updateCache;for(let e=0,i=t.length;e<i;e++)t[e].update()}updateWorldTransformWith(s){const t=this.getRootBone(),e=s.matrix.a,i=s.matrix.c,n=s.matrix.b,r=s.matrix.d;t.matrix.tx=e*this.x+i*this.y+s.worldX,t.matrix.ty=n*this.x+r*this.y+s.worldY;const a=t.rotation+90+t.shearY,l=C.cosDeg(t.rotation+t.shearX)*t.scaleX,o=C.cosDeg(a)*t.scaleY,h=C.sinDeg(t.rotation+t.shearX)*t.scaleX,c=C.sinDeg(a)*t.scaleY,u=this.scaleX,d=-this.scaleY;t.matrix.a=(e*l+i*h)*u,t.matrix.c=(e*o+i*c)*u,t.matrix.b=(n*l+r*h)*d,t.matrix.d=(n*o+r*c)*d;const f=this._updateCache;for(let m=0,p=f.length;m<p;m++){const g=f[m];g!=t&&g.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){const s=this.bones;for(let n=0,r=s.length;n<r;n++)s[n].setToSetupPose();const t=this.ikConstraints;for(let n=0,r=t.length;n<r;n++){const a=t[n];a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}const e=this.transformConstraints;for(let n=0,r=e.length;n<r;n++){const a=e[n],l=a.data;a.mixRotate=l.mixRotate,a.mixX=l.mixX,a.mixY=l.mixY,a.mixScaleX=l.mixScaleX,a.mixScaleY=l.mixScaleY,a.mixShearY=l.mixShearY}const i=this.pathConstraints;for(let n=0,r=i.length;n<r;n++){const a=i[n],l=a.data;a.position=l.position,a.spacing=l.spacing,a.mixRotate=l.mixRotate,a.mixX=l.mixX,a.mixY=l.mixY}}setSlotsToSetupPose(){const s=this.slots;D.arrayCopy(s,0,this.drawOrder,0,s.length);for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(s){if(!s)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,i=t.length;e<i;e++){const n=t[e];if(n.data.name==s)return n}return null}findBoneIndex(s){if(!s)throw new Error("boneName cannot be null.");const t=this.bones;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}findSlot(s){if(!s)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,i=t.length;e<i;e++){const n=t[e];if(n.data.name==s)return n}return null}findSlotIndex(s){if(!s)throw new Error("slotName cannot be null.");const t=this.slots;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}setSkinByName(s){const t=this.data.findSkin(s);if(!t)throw new Error(`Skin not found: ${s}`);this.setSkin(t)}setSkin(s){if(s!=this.skin){if(s)if(this.skin)s.attachAll(this,this.skin);else{const t=this.slots;for(let e=0,i=t.length;e<i;e++){const n=t[e],r=n.data.attachmentName;if(r){const a=s.getAttachment(e,r);a&&n.setAttachment(a)}}}this.skin=s,this.updateCache()}}getAttachmentByName(s,t){const e=this.data.findSlot(s);if(!e)throw new Error(`Can't find slot with name ${s}`);return this.getAttachment(e.index,t)}getAttachment(s,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){const e=this.skin.getAttachment(s,t);if(e)return e}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(s,t):null}setAttachment(s,t){if(!s)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.data.name==s){let a=null;if(t&&(a=this.getAttachment(i,t),!a))throw new Error(`Attachment not found: ${t}, for slot: ${s}`);r.setAttachment(a);return}}throw new Error(`Slot not found: ${s}`)}findIkConstraint(s){if(!s)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let e=0,i=t.length;e<i;e++){const n=t[e];if(n.data.name==s)return n}return null}findTransformConstraint(s){if(!s)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let e=0,i=t.length;e<i;e++){const n=t[e];if(n.data.name==s)return n}return null}findPathConstraint(s){if(!s)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let e=0,i=t.length;e<i;e++){const n=t[e];if(n.data.name==s)return n}return null}getBoundsRect(){const s=new $r,t=new $r;return this.getBounds(s,t),{x:s.x,y:s.y,width:t.x,height:t.y}}getBounds(s,t,e=new Array(2)){if(!s)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");const i=this.drawOrder;let n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let o=0,h=i.length;o<h;o++){const c=i[o];if(!c.bone.active)continue;let u=0,d=null;const f=c.getAttachment();if(f instanceof wt)u=8,d=D.setArraySize(e,u,0),f.computeWorldVertices(c,d,0,2);else if(f instanceof ln){const m=f;u=m.worldVerticesLength,d=D.setArraySize(e,u,0),m.computeWorldVertices(c,0,u,d,0,2)}if(d)for(let m=0,p=d.length;m<p;m+=2){const g=d[m],v=d[m+1];n=Math.min(n,g),r=Math.min(r,v),a=Math.max(a,g),l=Math.max(l,v)}}s.set(n,r),t.set(a-n,l-r)}get flipX(){return this.scaleX==-1}set flipX(s){yr.deprecatedWarning1||(yr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=s?1:-1}get flipY(){return this.scaleY==-1}set flipY(s){yr.deprecatedWarning1||(yr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=s?1:-1}};let Ru=yr;Ru.deprecatedWarning1=!1;class Pu{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");const e=this.bones;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");const e=this.slots;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");const e=this.skins;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");const e=this.events;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");const e=this.animations;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++){const r=e[i];if(r.name==t)return r}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");const e=this.pathConstraints;for(let i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1}}class ku{constructor(t,e,i){if(this.index=0,this.color=new H(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=Z.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}}class Fu extends Ga{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Ph{constructor(t,e,i){this.slotIndex=t,this.name=e,this.attachment=i}}class ma{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(!i)throw new Error("attachment cannot be null.");const n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i}addSkin(t){for(let i=0;i<t.bones.length;i++){const n=t.bones[i];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==n){r=!0;break}r||this.bones.push(n)}for(let i=0;i<t.constraints.length;i++){const n=t.constraints[i];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let i=0;i<e.length;i++){const n=e[i];this.setAttachment(n.slotIndex,n.name,n.attachment)}}copySkin(t){for(let i=0;i<t.bones.length;i++){const n=t.bones[i];let r=!1;for(let a=0;a<this.bones.length;a++)if(this.bones[a]==n){r=!0;break}r||this.bones.push(n)}for(let i=0;i<t.constraints.length;i++){const n=t.constraints[i];let r=!1;for(let a=0;a<this.constraints.length;a++)if(this.constraints[a]==n){r=!0;break}r||this.constraints.push(n)}const e=t.getAttachments();for(let i=0;i<e.length;i++){const n=e[i];n.attachment&&(n.attachment instanceof ln?(n.attachment=n.attachment.newLinkedMesh(),this.setAttachment(n.slotIndex,n.name,n.attachment)):(n.attachment=n.attachment.copy(),this.setAttachment(n.slotIndex,n.name,n.attachment)))}}getAttachment(t,e){const i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){const i=this.attachments[t];i&&delete i[e]}getAttachments(){const t=new Array;for(let e=0;e<this.attachments.length;e++){const i=this.attachments[e];if(i)for(const n in i){const r=i[n];r&&t.push(new Ph(e,n,r))}}return t}getAttachmentsForSlot(t,e){const i=this.attachments[t];if(i)for(const n in i){const r=i[n];r&&e.push(new Ph(t,n,r))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let n=0;n<t.slots.length;n++){const r=t.slots[n],a=r.getAttachment();if(a&&i<e.attachments.length){const l=e.attachments[i];for(const o in l){const h=l[o];if(a==h){const c=this.getAttachment(i,o);c&&r.setAttachment(c);break}}}i++}}}class Bu{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,i=new Pu;i.name="";const n=new ca(t),r=n.readInt32(),a=n.readInt32();i.hash=a==0&&r==0?null:a.toString(16)+r.toString(16),i.version=n.readString();const l=i.version.substr(0,3);if(l!=="4.0"&&l!=="4.1"){const u=`Spine 4.1 loader cant load version ${i.version}. Please configure your pixi-spine bundle`;console.error(u)}this.ver40=l==="4.0",i.x=n.readFloat(),i.y=n.readFloat(),i.width=n.readFloat(),i.height=n.readFloat();const o=n.readBoolean();o&&(i.fps=n.readFloat(),i.imagesPath=n.readString(),i.audioPath=n.readString());let h=0;h=n.readInt(!0);for(let u=0;u<h;u++){const d=n.readString();if(!d)throw new Error("String in string table must not be null.");n.strings.push(d)}h=n.readInt(!0);for(let u=0;u<h;u++){const d=n.readString();if(!d)throw new Error("Bone name must not be null.");const f=u==0?null:i.bones[n.readInt(!0)],m=new Tu(u,d,f);m.rotation=n.readFloat(),m.x=n.readFloat()*e,m.y=n.readFloat()*e,m.scaleX=n.readFloat(),m.scaleY=n.readFloat(),m.shearX=n.readFloat(),m.shearY=n.readFloat(),m.length=n.readFloat()*e,m.transformMode=n.readInt(!0),m.skinRequired=n.readBoolean(),o&&H.rgba8888ToColor(m.color,n.readInt32()),i.bones.push(m)}h=n.readInt(!0);for(let u=0;u<h;u++){const d=n.readString();if(!d)throw new Error("Slot name must not be null.");const f=i.bones[n.readInt(!0)],m=new ku(u,d,f);H.rgba8888ToColor(m.color,n.readInt32());const p=n.readInt32();p!=-1&&H.rgb888ToColor(m.darkColor=new H,p),m.attachmentName=n.readStringRef(),m.blendMode=n.readInt(!0),i.slots.push(m)}h=n.readInt(!0);for(let u=0,d;u<h;u++){const f=n.readString();if(!f)throw new Error("IK constraint data name must not be null.");const m=new Mu(f);m.order=n.readInt(!0),m.skinRequired=n.readBoolean(),d=n.readInt(!0);for(let p=0;p<d;p++)m.bones.push(i.bones[n.readInt(!0)]);m.target=i.bones[n.readInt(!0)],m.mix=n.readFloat(),m.softness=n.readFloat()*e,m.bendDirection=n.readByte(),m.compress=n.readBoolean(),m.stretch=n.readBoolean(),m.uniform=n.readBoolean(),i.ikConstraints.push(m)}h=n.readInt(!0);for(let u=0,d;u<h;u++){const f=n.readString();if(!f)throw new Error("Transform constraint data name must not be null.");const m=new Fu(f);m.order=n.readInt(!0),m.skinRequired=n.readBoolean(),d=n.readInt(!0);for(let p=0;p<d;p++)m.bones.push(i.bones[n.readInt(!0)]);m.target=i.bones[n.readInt(!0)],m.local=n.readBoolean(),m.relative=n.readBoolean(),m.offsetRotation=n.readFloat(),m.offsetX=n.readFloat()*e,m.offsetY=n.readFloat()*e,m.offsetScaleX=n.readFloat(),m.offsetScaleY=n.readFloat(),m.offsetShearY=n.readFloat(),m.mixRotate=n.readFloat(),m.mixX=n.readFloat(),m.mixY=n.readFloat(),m.mixScaleX=n.readFloat(),m.mixScaleY=n.readFloat(),m.mixShearY=n.readFloat(),i.transformConstraints.push(m)}h=n.readInt(!0);for(let u=0,d;u<h;u++){const f=n.readString();if(!f)throw new Error("Path constraint data name must not be null.");const m=new Iu(f);m.order=n.readInt(!0),m.skinRequired=n.readBoolean(),d=n.readInt(!0);for(let p=0;p<d;p++)m.bones.push(i.bones[n.readInt(!0)]);m.target=i.slots[n.readInt(!0)],m.positionMode=n.readInt(!0),m.spacingMode=n.readInt(!0),m.rotateMode=n.readInt(!0),m.offsetRotation=n.readFloat(),m.position=n.readFloat(),m.positionMode==Xt.Fixed&&(m.position*=e),m.spacing=n.readFloat(),(m.spacingMode==ee.Length||m.spacingMode==ee.Fixed)&&(m.spacing*=e),m.mixRotate=n.readFloat(),m.mixX=n.readFloat(),m.mixY=n.readFloat(),i.pathConstraints.push(m)}const c=this.readSkin(n,i,!0,o);c&&(i.defaultSkin=c,i.skins.push(c));{let u=i.skins.length;for(D.setArraySize(i.skins,h=u+n.readInt(!0));u<h;u++){const d=this.readSkin(n,i,!1,o);if(!d)throw new Error("readSkin() should not have returned null.");i.skins[u]=d}}h=this.linkedMeshes.length;for(let u=0;u<h;u++){const d=this.linkedMeshes[u],f=d.skin?i.findSkin(d.skin):i.defaultSkin;if(!f)throw new Error("Not skin found for linked mesh.");if(!d.parent)throw new Error("Linked mesh parent must not be null");const m=f.getAttachment(d.slotIndex,d.parent);if(!m)throw new Error(`Parent mesh not found: ${d.parent}`);d.mesh.timelineAttachment=d.inheritTimeline?m:d.mesh,d.mesh.setParentMesh(m)}this.linkedMeshes.length=0,h=n.readInt(!0);for(let u=0;u<h;u++){const d=n.readStringRef();if(!d)throw new Error;const f=new Cu(d);f.intValue=n.readInt(!1),f.floatValue=n.readFloat(),f.stringValue=n.readString(),f.audioPath=n.readString(),f.audioPath&&(f.volume=n.readFloat(),f.balance=n.readFloat()),i.events.push(f)}h=n.readInt(!0);for(let u=0;u<h;u++){const d=n.readString();if(!d)throw new Error("Animatio name must not be null.");i.animations.push(this.readAnimation(n,d,i))}return i}readSkin(t,e,i,n){let r=null,a=0;if(i){if(a=t.readInt(!0),a==0)return null;r=new ma("default")}else{const l=t.readStringRef();if(!l)throw new Error("Skin name must not be null.");r=new ma(l),r.bones.length=t.readInt(!0);for(let o=0,h=r.bones.length;o<h;o++)r.bones[o]=e.bones[t.readInt(!0)];for(let o=0,h=t.readInt(!0);o<h;o++)r.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let o=0,h=t.readInt(!0);o<h;o++)r.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let o=0,h=t.readInt(!0);o<h;o++)r.constraints.push(e.pathConstraints[t.readInt(!0)]);a=t.readInt(!0)}for(let l=0;l<a;l++){const o=t.readInt(!0);for(let h=0,c=t.readInt(!0);h<c;h++){const u=t.readStringRef();if(!u)throw new Error("Attachment name must not be null");const d=this.readAttachment(t,e,r,o,u,n);d&&r.setAttachment(o,u,d)}}return r}readAttachment(t,e,i,n,r,a){const l=this.scale;let o=t.readStringRef();switch(o||(o=r),t.readByte()){case dt.Region:{let h=t.readStringRef();const c=t.readFloat(),u=t.readFloat(),d=t.readFloat(),f=t.readFloat(),m=t.readFloat(),p=t.readFloat(),g=t.readFloat(),v=t.readInt32(),_=this.readSequence(t);h||(h=o);const x=this.attachmentLoader.newRegionAttachment(i,o,h,_);return x?(x.path=h,x.x=u*l,x.y=d*l,x.scaleX=f,x.scaleY=m,x.rotation=c,x.width=p*l,x.height=g*l,H.rgba8888ToColor(x.color,v),x.sequence=_,_==null&&x.updateRegion(),x):null}case dt.BoundingBox:{const h=t.readInt(!0),c=this.readVertices(t,h),u=a?t.readInt32():0,d=this.attachmentLoader.newBoundingBoxAttachment(i,o);return d?(d.worldVerticesLength=h<<1,d.vertices=c.vertices,d.bones=c.bones,a&&H.rgba8888ToColor(d.color,u),d):null}case dt.Mesh:{let h=t.readStringRef();const c=t.readInt32(),u=t.readInt(!0),d=this.readFloatArray(t,u<<1,1),f=this.readShortArray(t),m=this.readVertices(t,u),p=t.readInt(!0),g=this.readSequence(t);let v=[],_=0,x=0;a&&(v=this.readShortArray(t),_=t.readFloat(),x=t.readFloat()),h||(h=o);const y=this.attachmentLoader.newMeshAttachment(i,o,h,g);return y?(y.path=h,H.rgba8888ToColor(y.color,c),y.bones=m.bones,y.vertices=m.vertices,y.worldVerticesLength=u<<1,y.triangles=f,y.regionUVs=new Float32Array(d),y.hullLength=p<<1,y.sequence=g,a&&(y.edges=v,y.width=_*l,y.height=x*l),y):null}case dt.LinkedMesh:{let h=t.readStringRef();const c=t.readInt32(),u=t.readStringRef(),d=t.readStringRef(),f=t.readBoolean(),m=this.readSequence(t);let p=0,g=0;a&&(p=t.readFloat(),g=t.readFloat()),h||(h=o);const v=this.attachmentLoader.newMeshAttachment(i,o,h,m);return v?(v.path=h,H.rgba8888ToColor(v.color,c),v.sequence=m,a&&(v.width=p*l,v.height=g*l),this.linkedMeshes.push(new Ww(v,u,n,d,f)),v):null}case dt.Path:{const h=t.readBoolean(),c=t.readBoolean(),u=t.readInt(!0),d=this.readVertices(t,u),f=D.newArray(u/3,0);for(let g=0,v=f.length;g<v;g++)f[g]=t.readFloat()*l;const m=a?t.readInt32():0,p=this.attachmentLoader.newPathAttachment(i,o);return p?(p.closed=h,p.constantSpeed=c,p.worldVerticesLength=u<<1,p.vertices=d.vertices,p.bones=d.bones,p.lengths=f,a&&H.rgba8888ToColor(p.color,m),p):null}case dt.Point:{const h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=a?t.readInt32():0,f=this.attachmentLoader.newPointAttachment(i,o);return f?(f.x=c*l,f.y=u*l,f.rotation=h,a&&H.rgba8888ToColor(f.color,d),f):null}case dt.Clipping:{const h=t.readInt(!0),c=t.readInt(!0),u=this.readVertices(t,c),d=a?t.readInt32():0,f=this.attachmentLoader.newClippingAttachment(i,o);return f?(f.endSlot=e.slots[h],f.worldVerticesLength=c<<1,f.vertices=u.vertices,f.bones=u.bones,a&&H.rgba8888ToColor(f.color,d),f):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;const e=new Ua(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?Nf:t.readByte()}readVertices(t,e){const i=this.scale,n=e<<1,r=new Hw;if(!t.readBoolean())return r.vertices=this.readFloatArray(t,n,i),r;const a=new Array,l=new Array;for(let o=0;o<e;o++){const h=t.readInt(!0);l.push(h);for(let c=0;c<h;c++)l.push(t.readInt(!0)),a.push(t.readFloat()*i),a.push(t.readFloat()*i),a.push(t.readFloat())}return r.vertices=D.toFloatArray(a),r.bones=l,r}readFloatArray(t,e,i){const n=new Array(e);if(i==1)for(let r=0;r<e;r++)n[r]=t.readFloat();else for(let r=0;r<e;r++)n[r]=t.readFloat()*i;return n}readShortArray(t){const e=t.readInt(!0),i=new Array(e);for(let n=0;n<e;n++)i[n]=t.readShort();return i}readAnimation(t,e,i){t.readInt(!0);const n=new Array,r=this.scale;for(let h=0,c=t.readInt(!0);h<c;h++){const u=t.readInt(!0);for(let d=0,f=t.readInt(!0);d<f;d++){const m=t.readByte(),p=t.readInt(!0),g=p-1;switch(m){case i1:{const v=new Ki(p,u);for(let _=0;_<p;_++)v.setFrame(_,t.readFloat(),t.readStringRef());n.push(v);break}case n1:{const v=t.readInt(!0),_=new fu(p,v,u);let x=t.readFloat(),y=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255;for(let S=0,A=0;_.setFrame(S,x,y,b,w,E),S!=g;S++){const M=t.readFloat(),I=t.readUnsignedByte()/255,k=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255;switch(t.readByte()){case bs:_.setStepped(S);break;case ws:gt(t,_,A++,S,0,x,M,y,I,1),gt(t,_,A++,S,1,x,M,b,k,1),gt(t,_,A++,S,2,x,M,w,R,1),gt(t,_,A++,S,3,x,M,E,P,1)}x=M,y=I,b=k,w=R,E=P}n.push(_);break}case r1:{const v=t.readInt(!0),_=new mu(p,v,u);let x=t.readFloat(),y=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255;for(let E=0,S=0;_.setFrame(E,x,y,b,w),E!=g;E++){const A=t.readFloat(),M=t.readUnsignedByte()/255,I=t.readUnsignedByte()/255,k=t.readUnsignedByte()/255;switch(t.readByte()){case bs:_.setStepped(E);break;case ws:gt(t,_,S++,E,0,x,A,y,M,1),gt(t,_,S++,E,1,x,A,b,I,1),gt(t,_,S++,E,2,x,A,w,k,1)}x=A,y=M,b=I,w=k}n.push(_);break}case o1:{const v=t.readInt(!0),_=new gu(p,v,u);let x=t.readFloat(),y=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255;for(let I=0,k=0;_.setFrame(I,x,y,b,w,E,S,A,M),I!=g;I++){const R=t.readFloat(),P=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,L=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,G=t.readUnsignedByte()/255,U=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255;switch(t.readByte()){case bs:_.setStepped(I);break;case ws:gt(t,_,k++,I,0,x,R,y,P,1),gt(t,_,k++,I,1,x,R,b,B,1),gt(t,_,k++,I,2,x,R,w,L,1),gt(t,_,k++,I,3,x,R,E,O,1),gt(t,_,k++,I,4,x,R,S,G,1),gt(t,_,k++,I,5,x,R,A,U,1),gt(t,_,k++,I,6,x,R,M,F,1)}x=R,y=P,b=B,w=L,E=O,S=G,A=U,M=F}n.push(_);break}case a1:{const v=t.readInt(!0),_=new xu(p,v,u);let x=t.readFloat(),y=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255;for(let M=0,I=0;_.setFrame(M,x,y,b,w,E,S,A),M!=g;M++){const k=t.readFloat(),R=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,L=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,G=t.readUnsignedByte()/255;switch(t.readByte()){case bs:_.setStepped(M);break;case ws:gt(t,_,I++,M,0,x,k,y,R,1),gt(t,_,I++,M,1,x,k,b,P,1),gt(t,_,I++,M,2,x,k,w,B,1),gt(t,_,I++,M,3,x,k,E,L,1),gt(t,_,I++,M,4,x,k,S,O,1),gt(t,_,I++,M,5,x,k,A,G,1)}x=k,y=R,b=P,w=B,E=L,S=O,A=G}n.push(_);break}case l1:{const v=new pu(p,t.readInt(!0),u);let _=t.readFloat(),x=t.readUnsignedByte()/255;for(let y=0,b=0;v.setFrame(y,_,x),y!=g;y++){const w=t.readFloat(),E=t.readUnsignedByte()/255;switch(t.readByte()){case bs:v.setStepped(y);break;case ws:gt(t,v,b++,y,0,_,w,x,E,1)}_=w,x=E}n.push(v)}}}}for(let h=0,c=t.readInt(!0);h<c;h++){const u=t.readInt(!0);for(let d=0,f=t.readInt(!0);d<f;d++){const m=t.readByte(),p=t.readInt(!0),g=t.readInt(!0);switch(m){case zw:n.push(ti(t,new Hr(p,g,u),1));break;case jw:n.push(kl(t,new nu(p,g,u),r));break;case qw:n.push(ti(t,new ru(p,g,u),r));break;case Zw:n.push(ti(t,new ou(p,g,u),r));break;case Kw:n.push(kl(t,new au(p,g,u),1));break;case Qw:n.push(ti(t,new lu(p,g,u),1));break;case Jw:n.push(ti(t,new hu(p,g,u),1));break;case t1:n.push(kl(t,new cu(p,g,u),1));break;case e1:n.push(ti(t,new uu(p,g,u),1));break;case s1:n.push(ti(t,new du(p,g,u),1))}}}for(let h=0,c=t.readInt(!0);h<c;h++){const u=t.readInt(!0),d=t.readInt(!0),f=d-1,m=new _u(d,t.readInt(!0),u);let p=t.readFloat(),g=t.readFloat(),v=t.readFloat()*r;for(let _=0,x=0;m.setFrame(_,p,g,v,t.readByte(),t.readBoolean(),t.readBoolean()),_!=f;_++){const y=t.readFloat(),b=t.readFloat(),w=t.readFloat()*r;switch(t.readByte()){case bs:m.setStepped(_);break;case ws:gt(t,m,x++,_,0,p,y,g,b,1),gt(t,m,x++,_,1,p,y,v,w,r)}p=y,g=b,v=w}n.push(m)}for(let h=0,c=t.readInt(!0);h<c;h++){const u=t.readInt(!0),d=t.readInt(!0),f=d-1,m=new vu(d,t.readInt(!0),u);let p=t.readFloat(),g=t.readFloat(),v=t.readFloat(),_=t.readFloat(),x=t.readFloat(),y=t.readFloat(),b=t.readFloat();for(let w=0,E=0;m.setFrame(w,p,g,v,_,x,y,b),w!=f;w++){const S=t.readFloat(),A=t.readFloat(),M=t.readFloat(),I=t.readFloat(),k=t.readFloat(),R=t.readFloat(),P=t.readFloat();switch(t.readByte()){case bs:m.setStepped(w);break;case ws:gt(t,m,E++,w,0,p,S,g,A,1),gt(t,m,E++,w,1,p,S,v,M,1),gt(t,m,E++,w,2,p,S,_,I,1),gt(t,m,E++,w,3,p,S,x,k,1),gt(t,m,E++,w,4,p,S,y,R,1),gt(t,m,E++,w,5,p,S,b,P,1)}p=S,g=A,v=M,_=I,x=k,y=R,b=P}n.push(m)}for(let h=0,c=t.readInt(!0);h<c;h++){const u=t.readInt(!0),d=i.pathConstraints[u];for(let f=0,m=t.readInt(!0);f<m;f++)switch(t.readByte()){case c1:n.push(ti(t,new bu(t.readInt(!0),t.readInt(!0),u),d.positionMode==Xt.Fixed?r:1));break;case u1:n.push(ti(t,new wu(t.readInt(!0),t.readInt(!0),u),d.spacingMode==ee.Length||d.spacingMode==ee.Fixed?r:1));break;case d1:const p=new Eu(t.readInt(!0),t.readInt(!0),u);let g=t.readFloat(),v=t.readFloat(),_=t.readFloat(),x=t.readFloat();for(let y=0,b=0,w=p.getFrameCount()-1;p.setFrame(y,g,v,_,x),y!=w;y++){const E=t.readFloat(),S=t.readFloat(),A=t.readFloat(),M=t.readFloat();switch(t.readByte()){case bs:p.setStepped(y);break;case ws:gt(t,p,b++,y,0,g,E,v,S,1),gt(t,p,b++,y,1,g,E,_,A,1),gt(t,p,b++,y,2,g,E,x,M,1)}g=E,v=S,_=A,x=M}n.push(p)}}for(let h=0,c=t.readInt(!0);h<c;h++){const u=i.skins[t.readInt(!0)];for(let d=0,f=t.readInt(!0);d<f;d++){const m=t.readInt(!0);for(let p=0,g=t.readInt(!0);p<g;p++){const v=t.readStringRef();if(!v)throw new Error("attachmentName must not be null.");const _=u.getAttachment(m,v),x=this.readDeformTimelineType(t),y=t.readInt(!0),b=y-1;switch(x){case Nf:{const w=_,E=w.bones,S=w.vertices,A=E?S.length/3*2:S.length,M=t.readInt(!0),I=new yu(y,M,m,w);let k=t.readFloat();for(let R=0,P=0;;R++){let B,L=t.readInt(!0);if(L==0)B=E?D.newFloatArray(A):S;else{B=D.newFloatArray(A);const G=t.readInt(!0);if(L+=G,r==1)for(let U=G;U<L;U++)B[U]=t.readFloat();else for(let U=G;U<L;U++)B[U]=t.readFloat()*r;if(!E)for(let U=0,F=B.length;U<F;U++)B[U]+=S[U]}if(I.setFrame(R,k,B),R==b)break;const O=t.readFloat();switch(t.readByte()){case bs:I.setStepped(R);break;case ws:gt(t,I,P++,R,0,k,O,0,1,1)}k=O}n.push(I);break}case h1:{const w=new tr(y,m,_);for(let E=0;E<y;E++){const S=t.readFloat(),A=t.readInt32();w.setFrame(E,S,iu[A&15],A>>4,t.readFloat())}n.push(w);break}}}}}const a=t.readInt(!0);if(a>0){const h=new nn(a),c=i.slots.length;for(let u=0;u<a;u++){const d=t.readFloat(),f=t.readInt(!0),m=D.newArray(c,0);for(let _=c-1;_>=0;_--)m[_]=-1;const p=D.newArray(c-f,0);let g=0,v=0;for(let _=0;_<f;_++){const x=t.readInt(!0);for(;g!=x;)p[v++]=g++;m[g+t.readInt(!0)]=g++}for(;g<c;)p[v++]=g++;for(let _=c-1;_>=0;_--)m[_]==-1&&(m[_]=p[--v]);h.setFrame(u,d,m)}n.push(h)}const l=t.readInt(!0);if(l>0){const h=new oo(l);for(let c=0;c<l;c++){const u=t.readFloat(),d=i.events[t.readInt(!0)],f=new Au(u,d);f.intValue=t.readInt(!1),f.floatValue=t.readFloat(),f.stringValue=t.readBoolean()?t.readString():d.stringValue,f.data.audioPath&&(f.volume=t.readFloat(),f.balance=t.readFloat()),h.setFrame(c,f)}n.push(h)}let o=0;for(let h=0,c=n.length;h<c;h++)o=Math.max(o,n[h].getDuration());return new Xa(e,n,o)}}Bu.BlendModeValues=[Z.NORMAL,Z.ADD,Z.MULTIPLY,Z.SCREEN];let Ww=class{constructor(t,e,i,n,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritTimeline=r}};class Hw{constructor(t=null,e=null){this.bones=t,this.vertices=e}}function ti(s,t,e){let i=s.readFloat(),n=s.readFloat()*e;for(let r=0,a=0,l=t.getFrameCount()-1;t.setFrame(r,i,n),r!=l;r++){const o=s.readFloat(),h=s.readFloat()*e;switch(s.readByte()){case bs:t.setStepped(r);break;case ws:gt(s,t,a++,r,0,i,o,n,h,e)}i=o,n=h}return t}function kl(s,t,e){let i=s.readFloat(),n=s.readFloat()*e,r=s.readFloat()*e;for(let a=0,l=0,o=t.getFrameCount()-1;t.setFrame(a,i,n,r),a!=o;a++){const h=s.readFloat(),c=s.readFloat()*e,u=s.readFloat()*e;switch(s.readByte()){case bs:t.setStepped(a);break;case ws:gt(s,t,l++,a,0,i,h,n,c,e),gt(s,t,l++,a,1,i,h,r,u,e)}i=h,n=c,r=u}return t}function gt(s,t,e,i,n,r,a,l,o,h){t.setBezier(e,i,n,r,l,s.readFloat(),s.readFloat()*h,s.readFloat(),s.readFloat()*h,a,o)}const zw=0,jw=1,qw=2,Zw=3,Kw=4,Qw=5,Jw=6,t1=7,e1=8,s1=9,i1=0,n1=1,r1=2,o1=3,a1=4,l1=5,Nf=0,h1=1,c1=0,u1=1,d1=2,bs=1,ws=2;class f1 extends Pc{}class Wa{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){const e=this.scale,i=new Pu,n=typeof t=="string"?JSON.parse(t):t,r=n.skeleton;if(r){i.hash=r.hash,i.version=r.spine;const a=i.version.substr(0,3);if(a!=="4.0"&&a!=="4.1"){const l=`Spine 4.1 loader cant load version ${r.spine}. Please configure your pixi-spine bundle`;console.error(l)}i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height,i.fps=r.fps,i.imagesPath=r.images}if(n.bones)for(let a=0;a<n.bones.length;a++){const l=n.bones[a];let o=null;const h=N(l,"parent",null);if(h!=null&&(o=i.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);const c=new Tu(i.bones.length,l.name,o);c.length=N(l,"length",0)*e,c.x=N(l,"x",0)*e,c.y=N(l,"y",0)*e,c.rotation=N(l,"rotation",0),c.scaleX=N(l,"scaleX",1),c.scaleY=N(l,"scaleY",1),c.shearX=N(l,"shearX",0),c.shearY=N(l,"shearY",0),c.transformMode=D.enumValue(it,N(l,"transform","Normal")),c.skinRequired=N(l,"skin",!1);const u=N(l,"color",null);u&&c.color.setFromString(u),i.bones.push(c)}if(n.slots)for(let a=0;a<n.slots.length;a++){const l=n.slots[a],o=i.findBone(l.bone);if(!o)throw new Error(`Couldn't find bone ${l.bone} for slot ${l.name}`);const h=new ku(i.slots.length,l.name,o),c=N(l,"color",null);c&&h.color.setFromString(c);const u=N(l,"dark",null);u&&(h.darkColor=H.fromString(u)),h.attachmentName=N(l,"attachment",null),h.blendMode=Wa.blendModeFromString(N(l,"blend","normal")),i.slots.push(h)}if(n.ik)for(let a=0;a<n.ik.length;a++){const l=n.ik[a],o=new Mu(l.name);o.order=N(l,"order",0),o.skinRequired=N(l,"skin",!1);for(let h=0;h<l.bones.length;h++){const c=l.bones[h],u=i.findBone(c);if(u==null)throw new Error(`IK bone not found: ${c}`);o.bones.push(u)}o.target=i.findBone(l.target),o.mix=N(l,"mix",1),o.softness=N(l,"softness",0)*e,o.bendDirection=N(l,"bendPositive",!0)?1:-1,o.compress=N(l,"compress",!1),o.stretch=N(l,"stretch",!1),o.uniform=N(l,"uniform",!1),i.ikConstraints.push(o)}if(n.transform)for(let a=0;a<n.transform.length;a++){const l=n.transform[a],o=new Fu(l.name);o.order=N(l,"order",0),o.skinRequired=N(l,"skin",!1);for(let u=0;u<l.bones.length;u++){const d=l.bones[u],f=i.findBone(d);if(!f)throw new Error(`Couldn't find bone ${d} for transform constraint ${l.name}.`);o.bones.push(f)}const h=l.target,c=i.findBone(h);if(!c)throw new Error(`Couldn't find target bone ${h} for transform constraint ${l.name}.`);o.target=c,o.local=N(l,"local",!1),o.relative=N(l,"relative",!1),o.offsetRotation=N(l,"rotation",0),o.offsetX=N(l,"x",0)*e,o.offsetY=N(l,"y",0)*e,o.offsetScaleX=N(l,"scaleX",0),o.offsetScaleY=N(l,"scaleY",0),o.offsetShearY=N(l,"shearY",0),o.mixRotate=N(l,"mixRotate",1),o.mixX=N(l,"mixX",1),o.mixY=N(l,"mixY",o.mixX),o.mixScaleX=N(l,"mixScaleX",1),o.mixScaleY=N(l,"mixScaleY",o.mixScaleX),o.mixShearY=N(l,"mixShearY",1),i.transformConstraints.push(o)}if(n.path)for(let a=0;a<n.path.length;a++){const l=n.path[a],o=new Iu(l.name);o.order=N(l,"order",0),o.skinRequired=N(l,"skin",!1);for(let u=0;u<l.bones.length;u++){const d=l.bones[u],f=i.findBone(d);if(!f)throw new Error(`Couldn't find bone ${d} for path constraint ${l.name}.`);o.bones.push(f)}const h=l.target,c=i.findSlot(h);if(!c)throw new Error(`Couldn't find target slot ${h} for path constraint ${l.name}.`);o.target=c,o.positionMode=D.enumValue(Xt,N(l,"positionMode","Percent")),o.spacingMode=D.enumValue(ee,N(l,"spacingMode","Length")),o.rotateMode=D.enumValue(qt,N(l,"rotateMode","Tangent")),o.offsetRotation=N(l,"rotation",0),o.position=N(l,"position",0),o.positionMode==Xt.Fixed&&(o.position*=e),o.spacing=N(l,"spacing",0),(o.spacingMode==ee.Length||o.spacingMode==ee.Fixed)&&(o.spacing*=e),o.mixRotate=N(l,"mixRotate",1),o.mixX=N(l,"mixX",1),o.mixY=N(l,"mixY",o.mixX),i.pathConstraints.push(o)}if(n.skins)for(let a=0;a<n.skins.length;a++){const l=n.skins[a],o=new ma(l.name);if(l.bones)for(let h=0;h<l.bones.length;h++){const c=l.bones[h],u=i.findBone(c);if(!u)throw new Error(`Couldn't find bone ${c} for skin ${l.name}.`);o.bones.push(u)}if(l.ik)for(let h=0;h<l.ik.length;h++){const c=l.ik[h],u=i.findIkConstraint(c);if(!u)throw new Error(`Couldn't find IK constraint ${c} for skin ${l.name}.`);o.constraints.push(u)}if(l.transform)for(let h=0;h<l.transform.length;h++){const c=l.transform[h],u=i.findTransformConstraint(c);if(!u)throw new Error(`Couldn't find transform constraint ${c} for skin ${l.name}.`);o.constraints.push(u)}if(l.path)for(let h=0;h<l.path.length;h++){const c=l.path[h],u=i.findPathConstraint(c);if(!u)throw new Error(`Couldn't find path constraint ${c} for skin ${l.name}.`);o.constraints.push(u)}for(const h in l.attachments){const c=i.findSlot(h);if(!c)throw new Error(`Couldn't find slot ${h} for skin ${l.name}.`);const u=l.attachments[h];for(const d in u){const f=this.readAttachment(u[d],o,c.index,d,i);f&&o.setAttachment(c.index,d,f)}}i.skins.push(o),o.name=="default"&&(i.defaultSkin=o)}for(let a=0,l=this.linkedMeshes.length;a<l;a++){const o=this.linkedMeshes[a],h=o.skin?i.findSkin(o.skin):i.defaultSkin;if(!h)throw new Error(`Skin not found: ${o.skin}`);const c=h.getAttachment(o.slotIndex,o.parent);if(!c)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.timelineAttachment=o.inheritTimeline?c:o.mesh,o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,n.events)for(const a in n.events){const l=n.events[a],o=new Cu(a);o.intValue=N(l,"int",0),o.floatValue=N(l,"float",0),o.stringValue=N(l,"string",""),o.audioPath=N(l,"audio",null),o.audioPath&&(o.volume=N(l,"volume",1),o.balance=N(l,"balance",0)),i.events.push(o)}if(n.animations)for(const a in n.animations){const l=n.animations[a];this.readAnimation(l,a,i)}return i}readAttachment(t,e,i,n,r){const a=this.scale;switch(n=N(t,"name",n),N(t,"type","region")){case"region":{const l=N(t,"path",n),o=this.readSequence(N(t,"sequence",null)),h=this.attachmentLoader.newRegionAttachment(e,n,l,o);if(!h)return null;h.path=l,h.x=N(t,"x",0)*a,h.y=N(t,"y",0)*a,h.scaleX=N(t,"scaleX",1),h.scaleY=N(t,"scaleY",1),h.rotation=N(t,"rotation",0),h.width=t.width*a,h.height=t.height*a,h.sequence=o;const c=N(t,"color",null);return c&&h.color.setFromString(c),h}case"boundingbox":{const l=this.attachmentLoader.newBoundingBoxAttachment(e,n);if(!l)return null;this.readVertices(t,l,t.vertexCount<<1);const o=N(t,"color",null);return o&&l.color.setFromString(o),l}case"mesh":case"linkedmesh":{const l=N(t,"path",n),o=this.readSequence(N(t,"sequence",null)),h=this.attachmentLoader.newMeshAttachment(e,n,l,o);if(!h)return null;h.path=l;const c=N(t,"color",null);c&&h.color.setFromString(c),h.width=N(t,"width",0)*a,h.height=N(t,"height",0)*a,h.sequence=o;const u=N(t,"parent",null);if(u)return this.linkedMeshes.push(new m1(h,N(t,"skin",null),i,u,N(t,"timelines",!0))),h;const d=t.uvs;return this.readVertices(t,h,d.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(d),h.edges=N(t,"edges",null),h.hullLength=N(t,"hull",0)*2,h}case"path":{const l=this.attachmentLoader.newPathAttachment(e,n);if(!l)return null;l.closed=N(t,"closed",!1),l.constantSpeed=N(t,"constantSpeed",!0);const o=t.vertexCount;this.readVertices(t,l,o<<1);const h=D.newArray(o/3,0);for(let u=0;u<t.lengths.length;u++)h[u]=t.lengths[u]*a;l.lengths=h;const c=N(t,"color",null);return c&&l.color.setFromString(c),l}case"point":{const l=this.attachmentLoader.newPointAttachment(e,n);if(!l)return null;l.x=N(t,"x",0)*a,l.y=N(t,"y",0)*a,l.rotation=N(t,"rotation",0);const o=N(t,"color",null);return o&&l.color.setFromString(o),l}case"clipping":{const l=this.attachmentLoader.newClippingAttachment(e,n);if(!l)return null;const o=N(t,"end",null);if(o!=null){const u=r.findSlot(o);if(u==null)throw new Error(`Clipping end slot not found: ${o}`);l.endSlot=u}const h=t.vertexCount;this.readVertices(t,l,h<<1);const c=N(t,"color",null);return c&&l.color.setFromString(c),l}}return null}readSequence(t){if(t==null)return null;const e=new Ua(N(t,"count",0));return e.start=N(t,"start",1),e.digits=N(t,"digits",0),e.setupIndex=N(t,"setup",0),e}readVertices(t,e,i){const n=this.scale;e.worldVerticesLength=i;const r=t.vertices;if(i==r.length){const o=D.toFloatArray(r);if(n!=1)for(let h=0,c=r.length;h<c;h++)o[h]*=n;e.vertices=o;return}const a=new Array,l=new Array;for(let o=0,h=r.length;o<h;){const c=r[o++];l.push(c);for(let u=o+c*4;o<u;o+=4)l.push(r[o]),a.push(r[o+1]*n),a.push(r[o+2]*n),a.push(r[o+3])}e.bones=l,e.vertices=D.toFloatArray(a)}readAnimation(t,e,i){const n=this.scale,r=new Array;if(t.slots)for(const l in t.slots){const o=t.slots[l],h=i.findSlot(l);if(!h)throw new Error(`Slot not found: ${l}`);const c=h.index;for(const u in o){const d=o[u];if(!d)continue;const f=d.length;if(u=="attachment"){const m=new Ki(f,c);for(let p=0;p<f;p++){const g=d[p];m.setFrame(p,N(g,"time",0),N(g,"name",null))}r.push(m)}else if(u=="rgba"){const m=new fu(f,f<<2,c);let p=d[0],g=N(p,"time",0),v=H.fromString(p.color);for(let _=0,x=0;;_++){m.setFrame(_,g,v.r,v.g,v.b,v.a);const y=d[_+1];if(!y){m.shrink(x);break}const b=N(y,"time",0),w=H.fromString(y.color),E=p.curve;E&&(x=vt(E,m,x,_,0,g,b,v.r,w.r,1),x=vt(E,m,x,_,1,g,b,v.g,w.g,1),x=vt(E,m,x,_,2,g,b,v.b,w.b,1),x=vt(E,m,x,_,3,g,b,v.a,w.a,1)),g=b,v=w,p=y}r.push(m)}else if(u=="rgb"){const m=new mu(f,f*3,c);let p=d[0],g=N(p,"time",0),v=H.fromString(p.color);for(let _=0,x=0;;_++){m.setFrame(_,g,v.r,v.g,v.b);const y=d[_+1];if(!y){m.shrink(x);break}const b=N(y,"time",0),w=H.fromString(y.color),E=p.curve;E&&(x=vt(E,m,x,_,0,g,b,v.r,w.r,1),x=vt(E,m,x,_,1,g,b,v.g,w.g,1),x=vt(E,m,x,_,2,g,b,v.b,w.b,1)),g=b,v=w,p=y}r.push(m)}else if(u=="alpha")r.push(Os(d,new pu(f,f,c),0,1));else if(u=="rgba2"){const m=new gu(f,f*7,c);let p=d[0],g=N(p,"time",0),v=H.fromString(p.light),_=H.fromString(p.dark);for(let x=0,y=0;;x++){m.setFrame(x,g,v.r,v.g,v.b,v.a,_.r,_.g,_.b);const b=d[x+1];if(!b){m.shrink(y);break}const w=N(b,"time",0),E=H.fromString(b.light),S=H.fromString(b.dark),A=p.curve;A&&(y=vt(A,m,y,x,0,g,w,v.r,E.r,1),y=vt(A,m,y,x,1,g,w,v.g,E.g,1),y=vt(A,m,y,x,2,g,w,v.b,E.b,1),y=vt(A,m,y,x,3,g,w,v.a,E.a,1),y=vt(A,m,y,x,4,g,w,_.r,S.r,1),y=vt(A,m,y,x,5,g,w,_.g,S.g,1),y=vt(A,m,y,x,6,g,w,_.b,S.b,1)),g=w,v=E,_=S,p=b}r.push(m)}else if(u=="rgb2"){const m=new xu(f,f*6,c);let p=d[0],g=N(p,"time",0),v=H.fromString(p.light),_=H.fromString(p.dark);for(let x=0,y=0;;x++){m.setFrame(x,g,v.r,v.g,v.b,_.r,_.g,_.b);const b=d[x+1];if(!b){m.shrink(y);break}const w=N(b,"time",0),E=H.fromString(b.light),S=H.fromString(b.dark),A=p.curve;A&&(y=vt(A,m,y,x,0,g,w,v.r,E.r,1),y=vt(A,m,y,x,1,g,w,v.g,E.g,1),y=vt(A,m,y,x,2,g,w,v.b,E.b,1),y=vt(A,m,y,x,3,g,w,_.r,S.r,1),y=vt(A,m,y,x,4,g,w,_.g,S.g,1),y=vt(A,m,y,x,5,g,w,_.b,S.b,1)),g=w,v=E,_=S,p=b}r.push(m)}}}if(t.bones)for(const l in t.bones){const o=t.bones[l],h=i.findBone(l);if(!h)throw new Error(`Bone not found: ${l}`);const c=h.index;for(const u in o){const d=o[u],f=d.length;if(f!=0){if(u==="rotate")r.push(Os(d,new Hr(f,f,c),0,1));else if(u==="translate"){const m=new nu(f,f<<1,c);r.push(Fl(d,m,"x","y",0,n))}else if(u==="translatex"){const m=new ru(f,f,c);r.push(Os(d,m,0,n))}else if(u==="translatey"){const m=new ou(f,f,c);r.push(Os(d,m,0,n))}else if(u==="scale"){const m=new au(f,f<<1,c);r.push(Fl(d,m,"x","y",1,1))}else if(u==="scalex"){const m=new lu(f,f,c);r.push(Os(d,m,1,1))}else if(u==="scaley"){const m=new hu(f,f,c);r.push(Os(d,m,1,1))}else if(u==="shear"){const m=new cu(f,f<<1,c);r.push(Fl(d,m,"x","y",0,1))}else if(u==="shearx"){const m=new uu(f,f,c);r.push(Os(d,m,0,1))}else if(u==="sheary"){const m=new du(f,f,c);r.push(Os(d,m,0,1))}}}}if(t.ik)for(const l in t.ik){const o=t.ik[l];let h=o[0];if(!h)continue;const c=i.findIkConstraint(l);if(!c)throw new Error(`IK Constraint not found: ${l}`);const u=i.ikConstraints.indexOf(c),d=new _u(o.length,o.length<<1,u);let f=N(h,"time",0),m=N(h,"mix",1),p=N(h,"softness",0)*n;for(let g=0,v=0;;g++){d.setFrame(g,f,m,p,N(h,"bendPositive",!0)?1:-1,N(h,"compress",!1),N(h,"stretch",!1));const _=o[g+1];if(!_){d.shrink(v);break}const x=N(_,"time",0),y=N(_,"mix",1),b=N(_,"softness",0)*n,w=h.curve;w&&(v=vt(w,d,v,g,0,f,x,m,y,1),v=vt(w,d,v,g,1,f,x,p,b,n)),f=x,m=y,p=b,h=_}r.push(d)}if(t.transform)for(const l in t.transform){const o=t.transform[l];let h=o[0];if(!h)continue;const c=i.findTransformConstraint(l);if(!c)throw new Error(`Transform constraint not found: ${l}`);const u=i.transformConstraints.indexOf(c),d=new vu(o.length,o.length*6,u);let f=N(h,"time",0),m=N(h,"mixRotate",1),p=N(h,"mixX",1),g=N(h,"mixY",p),v=N(h,"mixScaleX",1),_=N(h,"mixScaleY",v);const x=N(h,"mixShearY",1);for(let y=0,b=0;;y++){d.setFrame(y,f,m,p,g,v,_,x);const w=o[y+1];if(!w){d.shrink(b);break}const E=N(w,"time",0),S=N(w,"mixRotate",1),A=N(w,"mixX",1),M=N(w,"mixY",A),I=N(w,"mixScaleX",1),k=N(w,"mixScaleY",I),R=N(w,"mixShearY",1),P=h.curve;P&&(b=vt(P,d,b,y,0,f,E,m,S,1),b=vt(P,d,b,y,1,f,E,p,A,1),b=vt(P,d,b,y,2,f,E,g,M,1),b=vt(P,d,b,y,3,f,E,v,I,1),b=vt(P,d,b,y,4,f,E,_,k,1),b=vt(P,d,b,y,5,f,E,x,R,1)),f=E,m=S,p=A,g=M,v=I,_=k,v=I,h=w}r.push(d)}if(t.path)for(const l in t.path){const o=t.path[l],h=i.findPathConstraint(l);if(!h)throw new Error(`Path constraint not found: ${l}`);const c=i.pathConstraints.indexOf(h);for(const u in o){const d=o[u];let f=d[0];if(!f)continue;const m=d.length;if(u==="position"){const p=new bu(m,m,c);r.push(Os(d,p,0,h.positionMode==Xt.Fixed?n:1))}else if(u==="spacing"){const p=new wu(m,m,c);r.push(Os(d,p,0,h.spacingMode==ee.Length||h.spacingMode==ee.Fixed?n:1))}else if(u==="mix"){const p=new Eu(m,m*3,c);let g=N(f,"time",0),v=N(f,"mixRotate",1),_=N(f,"mixX",1),x=N(f,"mixY",_);for(let y=0,b=0;;y++){p.setFrame(y,g,v,_,x);const w=d[y+1];if(!w){p.shrink(b);break}const E=N(w,"time",0),S=N(w,"mixRotate",1),A=N(w,"mixX",1),M=N(w,"mixY",A),I=f.curve;I&&(b=vt(I,p,b,y,0,g,E,v,S,1),b=vt(I,p,b,y,1,g,E,_,A,1),b=vt(I,p,b,y,2,g,E,x,M,1)),g=E,v=S,_=A,x=M,f=w}r.push(p)}}}if(t.deform){t.attachments={};for(const l in t.deform){const o=t.deform[l],h=t.attachments[l]={};for(const c in o){const u=o[c],d=h[c]={};for(const f in u)d[f]={deform:u[f]}}}}if(t.attachments)for(const l in t.attachments){const o=t.attachments[l],h=i.findSkin(l);if(h!=null)for(const c in o){const u=o[c],d=i.findSlot(c);if(!d)throw new Error(`Slot not found: ${c}`);const f=d.index;for(const m in u){const p=u[m],g=h.getAttachment(f,m);for(const v in p){const _=p[v];let x=_[0];if(x){if(v=="deform"){const y=g.bones,b=g.vertices,w=y?b.length/3*2:b.length,E=new yu(_.length,_.length,f,g);let S=N(x,"time",0);for(let A=0,M=0;;A++){let I;const k=N(x,"vertices",null);if(!k)I=y?D.newFloatArray(w):b;else{I=D.newFloatArray(w);const L=N(x,"offset",0);if(D.arrayCopy(k,0,I,L,k.length),n!=1)for(let O=L,G=O+k.length;O<G;O++)I[O]*=n;if(!y)for(let O=0;O<w;O++)I[O]+=b[O]}E.setFrame(A,S,I);const R=_[A+1];if(!R){E.shrink(M);break}const P=N(R,"time",0),B=x.curve;B&&(M=vt(B,E,M,A,0,S,P,0,1,1)),S=P,x=R}r.push(E)}else if(v=="sequence"){const y=new tr(_.length,f,g);let b=0;for(let w=0;w<_.length;w++){const E=N(x,"delay",b),S=N(x,"time",0),A=Xs[N(x,"mode","hold")],M=N(x,"index",0);y.setFrame(w,S,A,M,E),b=E,x=_[w+1]}r.push(y)}}}}}}if(t.drawOrder){const l=new nn(t.drawOrder.length),o=i.slots.length;let h=0;for(let c=0;c<t.drawOrder.length;c++,h++){const u=t.drawOrder[c];let d=null;const f=N(u,"offsets",null);if(f){d=D.newArray(o,-1);const m=D.newArray(o-f.length,0);let p=0,g=0;for(let v=0;v<f.length;v++){const _=f[v],x=i.findSlot(_.slot);if(!x)throw new Error(`Slot not found: ${x}`);const y=x.index;for(;p!=y;)m[g++]=p++;d[p+_.offset]=p++}for(;p<o;)m[g++]=p++;for(let v=o-1;v>=0;v--)d[v]==-1&&(d[v]=m[--g])}l.setFrame(h,N(u,"time",0),d)}r.push(l)}if(t.events){const l=new oo(t.events.length);let o=0;for(let h=0;h<t.events.length;h++,o++){const c=t.events[h],u=i.findEvent(c.name);if(!u)throw new Error(`Event not found: ${c.name}`);const d=new Au(D.toSinglePrecision(N(c,"time",0)),u);d.intValue=N(c,"int",u.intValue),d.floatValue=N(c,"float",u.floatValue),d.stringValue=N(c,"string",u.stringValue),d.data.audioPath&&(d.volume=N(c,"volume",1),d.balance=N(c,"balance",0)),l.setFrame(o,d)}r.push(l)}let a=0;for(let l=0,o=r.length;l<o;l++)a=Math.max(a,r[l].getDuration());if(isNaN(a))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new Xa(e,r,a))}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Z.NORMAL;if(t=="additive")return Z.ADD;if(t=="multiply")return Z.MULTIPLY;if(t=="screen")return Z.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}}class m1{constructor(t,e,i,n,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritTimeline=r}}function Os(s,t,e,i){let n=s[0],r=N(n,"time",0),a=N(n,"value",e)*i,l=0;for(let o=0;;o++){t.setFrame(o,r,a);const h=s[o+1];if(!h)return t.shrink(l),t;const c=N(h,"time",0),u=N(h,"value",e)*i;n.curve&&(l=vt(n.curve,t,l,o,0,r,c,a,u,i)),r=c,a=u,n=h}}function Fl(s,t,e,i,n,r){let a=s[0],l=N(a,"time",0),o=N(a,e,n)*r,h=N(a,i,n)*r,c=0;for(let u=0;;u++){t.setFrame(u,l,o,h);const d=s[u+1];if(!d)return t.shrink(c),t;const f=N(d,"time",0),m=N(d,e,n)*r,p=N(d,i,n)*r,g=a.curve;g&&(c=vt(g,t,c,u,0,l,f,o,m,r),c=vt(g,t,c,u,1,l,f,h,p,r)),l=f,o=m,h=p,a=d}}function vt(s,t,e,i,n,r,a,l,o,h){if(s=="stepped")return t.setStepped(i),e;const c=n<<2,u=s[c],d=s[c+1]*h,f=s[c+2],m=s[c+3]*h;return t.setBezier(e,i,n,r,l,u,d,f,m,a,o),e+1}function N(s,t,e){return s[t]!==void 0?s[t]:e}let p1=class extends Kn{createSkeleton(t){this.skeleton=new Ru(t),this.skeleton.updateWorldTransform(),this.stateData=new Zg(t),this.state=new er(this.stateData)}};const g1=Object.freeze(Object.defineProperty({__proto__:null,AlphaTimeline:pu,Animation:Xa,AnimationState:er,AnimationStateAdapter:Yw,AnimationStateData:Zg,AtlasAttachmentLoader:Su,Attachment:su,AttachmentTimeline:Ki,Bone:Rh,BoneData:Tu,BoundingBoxAttachment:La,ClippingAttachment:Oa,ConstraintData:Ga,CurveTimeline:Ds,CurveTimeline1:Ns,CurveTimeline2:Ya,DeformTimeline:yu,DrawOrderTimeline:nn,Event:Au,EventData:Cu,EventQueue:qg,EventTimeline:oo,EventType:De,IkConstraint:Kg,IkConstraintData:Mu,IkConstraintTimeline:_u,MeshAttachment:ln,PathAttachment:hn,PathConstraint:sr,PathConstraintData:Iu,PathConstraintMixTimeline:Eu,PathConstraintPositionTimeline:bu,PathConstraintSpacingTimeline:wu,PointAttachment:Va,RGB2Timeline:xu,RGBA2Timeline:gu,RGBATimeline:fu,RGBTimeline:mu,RegionAttachment:wt,RotateTimeline:Hr,ScaleTimeline:au,ScaleXTimeline:lu,ScaleYTimeline:hu,Sequence:Ua,SequenceMode:Xs,SequenceModeValues:iu,SequenceTimeline:tr,ShearTimeline:cu,ShearXTimeline:uu,ShearYTimeline:du,Skeleton:Ru,SkeletonBinary:Bu,SkeletonBounds:f1,SkeletonData:Pu,SkeletonJson:Wa,Skin:ma,SkinEntry:Ph,Slot:Qg,SlotData:ku,SpacingMode:ee,Spine:p1,Timeline:Gt,TrackEntry:$a,TransformConstraint:Jg,TransformConstraintData:Fu,TransformConstraintTimeline:vu,TranslateTimeline:nu,TranslateXTimeline:ru,TranslateYTimeline:ou,VertexAttachment:Ps},Symbol.toStringTag,{value:"Module"}));var ls=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.VER37=37]="VER37",s[s.VER38=38]="VER38",s[s.VER40=40]="VER40",s[s.VER41=41]="VER41",s))(ls||{});function pa(s){const t=s.substr(0,3),e=Math.floor(Number(t)*10+.001);return t==="3.7"?37:t==="3.8"?38:t==="4.0"?40:t==="4.1"?41:e<37?37:0}class x1{constructor(){this.scale=1}readSkeletonData(t,e){let i=null,n=this.readVersionOldFormat(e),r=pa(n);if(r===ls.VER38&&(i=new Qt(new Uc(t))),n=this.readVersionNewFormat(e),r=pa(n),(r===ls.VER40||r===ls.VER41)&&(i=new Bu(new Su(t))),!i){const a=`Unsupported version of spine model ${n}, please update pixi-spine`;console.error(a)}return i.scale=this.scale,i.readSkeletonData(e)}readVersionOldFormat(t){const e=new ca(t);let i;try{e.readString(),i=e.readString()}catch{i=""}return i||""}readVersionNewFormat(t){const e=new ca(t);e.readInt32(),e.readInt32();let i;try{i=e.readString()}catch{i=""}return i||""}}class y1{constructor(){this.scale=1}readSkeletonData(t,e){const i=e.skeleton.spine,n=pa(i);let r=null;if(n===ls.VER37&&(r=new Gg(new kg(t))),n===ls.VER38&&(r=new _g(new Uc(t))),(n===ls.VER40||n===ls.VER41)&&(r=new Wa(new Su(t))),!r){const a=`Unsupported version of spine model ${i}, please update pixi-spine`;console.error(a)}return r.scale=this.scale,r.readSkeletonData(e)}}class _1 extends Cw{createBinaryParser(){return new x1}createJsonParser(){return new y1}parseData(t,e,i){return{spineData:t.readSkeletonData(e,i),spineAtlas:e}}}class FS extends Kn{createSkeleton(t){const e=pa(t.version);let i=null;if(e===ls.VER37&&(i=Xw),e===ls.VER38&&(i=Dw),(e===ls.VER40||e===ls.VER41)&&(i=g1),!i){const n=`Cant detect version of spine model ${t.version}`;console.error(n)}this.skeleton=new i.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new i.AnimationStateData(t),this.state=new i.AnimationState(this.stateData)}}new _1().installLoader();var _r;typeof self>"u"&&typeof process<"u"&&process.hrtime?_r=function(){var s=process.hrtime();return s[0]*1e3+s[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?_r=self.performance.now.bind(self.performance):Date.now!==void 0?_r=Date.now:_r=function(){return new Date().getTime()};var Rn=_r,Lf=function(){function s(){this._tweens={},this._tweensAddedDuringUpdate={}}return s.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(e){return t._tweens[e]})},s.prototype.removeAll=function(){this._tweens={}},s.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},s.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},s.prototype.update=function(t,e){var i=Object.keys(this._tweens);if(i.length===0)return!1;for(t=t!==void 0?t:Rn();i.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var r=this._tweens[i[n]];r&&r.update(t)===!1&&(r.playing=!1,e||delete this._tweens[i[n]])}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},s}(),Ar={Linear:{None:function(s){return s}},Quadratic:{In:function(s){return s*s},Out:function(s){return s*(2-s)},InOut:function(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)}},Cubic:{In:function(s){return s*s*s},Out:function(s){return--s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)}},Quartic:{In:function(s){return s*s*s*s},Out:function(s){return 1- --s*s*s*s},InOut:function(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)}},Quintic:{In:function(s){return s*s*s*s*s},Out:function(s){return--s*s*s*s*s+1},InOut:function(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)}},Sinusoidal:{In:function(s){return 1-Math.cos(s*Math.PI/2)},Out:function(s){return Math.sin(s*Math.PI/2)},InOut:function(s){return .5*(1-Math.cos(Math.PI*s))}},Exponential:{In:function(s){return s===0?0:Math.pow(1024,s-1)},Out:function(s){return s===1?1:1-Math.pow(2,-10*s)},InOut:function(s){return s===0?0:s===1?1:(s*=2)<1?.5*Math.pow(1024,s-1):.5*(-Math.pow(2,-10*(s-1))+2)}},Circular:{In:function(s){return 1-Math.sqrt(1-s*s)},Out:function(s){return Math.sqrt(1- --s*s)},InOut:function(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)}},Elastic:{In:function(s){return s===0?0:s===1?1:-Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI)},Out:function(s){return s===0?0:s===1?1:Math.pow(2,-10*s)*Math.sin((s-.1)*5*Math.PI)+1},InOut:function(s){return s===0?0:s===1?1:(s*=2,s<1?-.5*Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI):.5*Math.pow(2,-10*(s-1))*Math.sin((s-1.1)*5*Math.PI)+1)}},Back:{In:function(s){var t=1.70158;return s*s*((t+1)*s-t)},Out:function(s){var t=1.70158;return--s*s*((t+1)*s+t)+1},InOut:function(s){var t=2.5949095;return(s*=2)<1?.5*(s*s*((t+1)*s-t)):.5*((s-=2)*s*((t+1)*s+t)+2)}},Bounce:{In:function(s){return 1-Ar.Bounce.Out(1-s)},Out:function(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},InOut:function(s){return s<.5?Ar.Bounce.In(s*2)*.5:Ar.Bounce.Out(s*2-1)*.5+.5}}},Pn={Linear:function(s,t){var e=s.length-1,i=e*t,n=Math.floor(i),r=Pn.Utils.Linear;return t<0?r(s[0],s[1],i):t>1?r(s[e],s[e-1],e-i):r(s[n],s[n+1>e?e:n+1],i-n)},Bezier:function(s,t){for(var e=0,i=s.length-1,n=Math.pow,r=Pn.Utils.Bernstein,a=0;a<=i;a++)e+=n(1-t,i-a)*n(t,a)*s[a]*r(i,a);return e},CatmullRom:function(s,t){var e=s.length-1,i=e*t,n=Math.floor(i),r=Pn.Utils.CatmullRom;return s[0]===s[e]?(t<0&&(n=Math.floor(i=e*(1+t))),r(s[(n-1+e)%e],s[n],s[(n+1)%e],s[(n+2)%e],i-n)):t<0?s[0]-(r(s[0],s[0],s[1],s[1],-i)-s[0]):t>1?s[e]-(r(s[e],s[e],s[e-1],s[e-1],i-e)-s[e]):r(s[n?n-1:0],s[n],s[e<n+1?e:n+1],s[e<n+2?e:n+2],i-n)},Utils:{Linear:function(s,t,e){return(t-s)*e+s},Bernstein:function(s,t){var e=Pn.Utils.Factorial;return e(s)/e(t)/e(s-t)},Factorial:function(){var s=[1];return function(t){var e=1;if(s[t])return s[t];for(var i=t;i>1;i--)e*=i;return s[t]=e,e}}(),CatmullRom:function(s,t,e,i,n){var r=(e-s)*.5,a=(i-t)*.5,l=n*n,o=n*l;return(2*t-2*e+r+a)*o+(-3*t+3*e-2*r-a)*l+r*n+t}}},t0=function(){function s(){}return s._nextId=0,s.nextId=function(){return s._nextId++},s}(),e0=function(){function s(t,e){this.playing=!1,this.paused=!1,this.pauseStart=0,this.valuesStart={},this.valuesEnd={},this.valuesStartRepeat={},this.durationValue=1e3,this.repeatValue=0,this.yoyoValue=!1,this.reversed=!1,this.delayTime=0,this.startTime=0,this.easingFunction=Ar.Linear.None,this.interpolationFunction=Pn.Linear,this.chainedTweens=[],this.onStartCallbackFired=!1,this.id=t0.nextId(),this.object=t,this.groupRef=e||s.TWEEN}return s.inject=function(t){s.TWEEN=t},s.prototype.getId=function(){return this.id},s.prototype.isPlaying=function(){return this.playing},s.prototype.isPaused=function(){return this.paused},s.prototype.to=function(t,e){return this.valuesEnd=Object.create(t),e!==void 0&&(this.durationValue=e),this},s.prototype.duration=function(t){return this.durationValue=t,this},s.prototype.start=function(t){this.groupRef.add(this),this.playing=!0,this.paused=!1,this.onStartCallbackFired=!1,this.startTime=t!==void 0?typeof t=="string"?Rn()+parseFloat(t):t:Rn(),this.startTime+=this.delayTime;for(var e in this.valuesEnd){if(this.valuesEnd[e]instanceof Array){if(this.valuesEnd[e].length===0)continue;this.valuesEnd[e]=[this.object[e]].concat(this.valuesEnd[e])}this.object[e]!==void 0&&(typeof this.valuesStart[e]>"u"&&(this.valuesStart[e]=this.object[e]),this.valuesStart[e]instanceof Array||(this.valuesStart[e]*=1),this.valuesStartRepeat[e]=this.valuesStart[e]||0)}return this},s.prototype.stop=function(){return this.playing?(this.groupRef.remove(this),this.playing=!1,this.paused=!1,this.onStopCallback&&this.onStopCallback(this.object),this.stopChainedTweens(),this):this},s.prototype.end=function(){return this.update(1/0),this},s.prototype.pause=function(t){return this.paused||!this.playing?this:(this.paused=!0,this.pauseStart=t===void 0?Rn():t,this.groupRef.remove(this),this)},s.prototype.resume=function(t){return!this.paused||!this.playing?this:(this.paused=!1,this.startTime+=(t===void 0?Rn():t)-this.pauseStart,this.pauseStart=0,this.groupRef.add(this),this)},s.prototype.stopChainedTweens=function(){for(var t=0,e=this.chainedTweens.length;t<e;t++)this.chainedTweens[t].stop()},s.prototype.group=function(t){return this.groupRef=t,this},s.prototype.delay=function(t){return this.delayTime=t,this},s.prototype.repeat=function(t){return this.repeatValue=t,this},s.prototype.repeatDelay=function(t){return this.repeatDelayTime=t,this},s.prototype.yoyo=function(t){return this.yoyoValue=t,this},s.prototype.easing=function(t){return this.easingFunction=t,this},s.prototype.interpolation=function(t){return this.interpolationFunction=t,this},s.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.chainedTweens=t,this},s.prototype.onStart=function(t){return this.onStartCallback=t,this},s.prototype.onUpdate=function(t){return this.onUpdateCallback=t,this},s.prototype.onRepeat=function(t){return this.onRepeatCallback=t,this},s.prototype.onComplete=function(t){return this.onCompleteCallback=t,this},s.prototype.onStop=function(t){return this.onStopCallback=t,this},s.prototype.update=function(t){t===void 0&&(t=0);var e,i,n;if(t<this.startTime)return!0;this.onStartCallbackFired===!1&&(this.onStartCallback&&this.onStartCallback(this.object),this.onStartCallbackFired=!0),i=(t-this.startTime)/this.durationValue,i=this.durationValue===0||i>1?1:i,n=this.easingFunction(i);for(e in this.valuesEnd)if(this.valuesStart[e]!==void 0){var r=this.valuesStart[e]||0,a=this.valuesEnd[e];a instanceof Array?this.object[e]=this.interpolationFunction(a,n):(typeof a=="string"&&(a.charAt(0)==="+"||a.charAt(0)==="-"?a=r+parseFloat(a):a=parseFloat(a)),typeof a=="number"&&(this.object[e]=r+(a-r)*n))}if(this.onUpdateCallback&&this.onUpdateCallback(this.object,i),i===1)if(this.repeatValue>0){isFinite(this.repeatValue)&&this.repeatValue--;for(e in this.valuesStartRepeat){if(typeof this.valuesEnd[e]=="string"&&(this.valuesStartRepeat[e]=this.valuesStartRepeat[e]+parseFloat(this.valuesEnd[e])),this.yoyoValue){var l=this.valuesStartRepeat[e];this.valuesStartRepeat[e]=this.valuesEnd[e],this.valuesEnd[e]=l}this.valuesStart[e]=this.valuesStartRepeat[e]}return this.yoyoValue&&(this.reversed=!this.reversed),this.repeatDelayTime!==void 0?this.startTime=t+this.repeatDelayTime:this.startTime=t+this.delayTime,this.onRepeatCallback&&this.onRepeatCallback(this.object),!0}else{this.onCompleteCallback&&this.onCompleteCallback(this.object);for(var o=0,h=this.chainedTweens.length;o<h;o++)this.chainedTweens[o].start(this.startTime+this.durationValue);return!1}return!0},s}(),v1="18.6.0",b1=globalThis&&globalThis.__extends||function(){var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},s(t,e)};return function(t,e){s(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),w1=function(s){b1(t,s);function t(){var e=s!==null&&s.apply(this,arguments)||this;return e.version=v1,e.now=Rn,e.Group=Lf,e.Easing=Ar,e.Interpolation=Pn,e.nextId=t0.nextId,e.Tween=e0,e}return t}(Lf),E1=new w1;e0.inject(E1);var S1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,T1=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;const s0=class extends se{constructor(t){const e=Object.assign({},s0.defaults,t),{outerStrength:i,innerStrength:n,color:r,knockout:a,quality:l,alpha:o}=e,h=Math.round(e.distance);super(S1,T1.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/l/h).toFixed(7)}`).replace(/__DIST__/gi,`${h.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:r,outerStrength:i,innerStrength:n,padding:h,knockout:a,alpha:o})}get color(){return Dn(this.uniforms.glowColor)}set color(t){$h(t,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(t){this.uniforms.outerStrength=t}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(t){this.uniforms.innerStrength=t}get knockout(){return this.uniforms.knockout}set knockout(t){this.uniforms.knockout=t}get alpha(){return this.uniforms.alpha}set alpha(t){this.uniforms.alpha=t}};let A1=s0;A1.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var C1=Object.defineProperty,Du=(s,t)=>{for(var e in t)C1(s,e,{get:t[e],enumerable:!0})},M1={};Du(M1,{convertFileSrc:()=>R1,invoke:()=>i0,transformCallback:()=>kh});function I1(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function kh(s,t=!1){let e=I1(),i=`_${e}`;return Object.defineProperty(window,i,{value:n=>(t&&Reflect.deleteProperty(window,i),s==null?void 0:s(n)),writable:!1,configurable:!0}),e}async function i0(s,t={}){return new Promise((e,i)=>{let n=kh(a=>{e(a),Reflect.deleteProperty(window,`_${r}`)},!0),r=kh(a=>{i(a),Reflect.deleteProperty(window,`_${n}`)},!0);window.__TAURI_IPC__({cmd:s,callback:n,error:r,...t})})}function R1(s,t="asset"){return window.__TAURI__.convertFileSrc(s,t)}async function ki(s){return i0("tauri",s)}var P1={};Du(P1,{Body:()=>vr,Client:()=>o0,Response:()=>r0,ResponseType:()=>n0,fetch:()=>F1,getClient:()=>a0});var n0=(s=>(s[s.JSON=1]="JSON",s[s.Text=2]="Text",s[s.Binary=3]="Binary",s))(n0||{});async function k1(s){let t={},e=async(i,n)=>{if(n!==null){let r;typeof n=="string"?r=n:n instanceof Uint8Array||Array.isArray(n)?r=Array.from(n):n instanceof File?r={file:Array.from(new Uint8Array(await n.arrayBuffer())),mime:n.type,fileName:n.name}:typeof n.file=="string"?r={file:n.file,mime:n.mime,fileName:n.fileName}:r={file:Array.from(n.file),mime:n.mime,fileName:n.fileName},t[String(i)]=r}};if(s instanceof FormData)for(let[i,n]of s)await e(i,n);else for(let[i,n]of Object.entries(s))await e(i,n);return t}var vr=class{constructor(s,t){this.type=s,this.payload=t}static form(s){return new vr("Form",s)}static json(s){return new vr("Json",s)}static text(s){return new vr("Text",s)}static bytes(s){return new vr("Bytes",Array.from(s instanceof ArrayBuffer?new Uint8Array(s):s))}},r0=class{constructor(t){this.url=t.url,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.headers=t.headers,this.rawHeaders=t.rawHeaders,this.data=t.data}},o0=class{constructor(s){this.id=s}async drop(){return ki({__tauriModule:"Http",message:{cmd:"dropClient",client:this.id}})}async request(s){var e;let t=!s.responseType||s.responseType===1;return t&&(s.responseType=2),((e=s.body)==null?void 0:e.type)==="Form"&&(s.body.payload=await k1(s.body.payload)),ki({__tauriModule:"Http",message:{cmd:"httpRequest",client:this.id,options:s}}).then(i=>{let n=new r0(i);if(t){try{n.data=JSON.parse(n.data)}catch(r){if(n.ok&&n.data==="")n.data={};else if(n.ok)throw Error(`Failed to parse response \`${n.data}\` as JSON: ${r};
              try setting the \`responseType\` option to \`ResponseType.Text\` or \`ResponseType.Binary\` if the API does not return a JSON response.`)}return n}return n})}async get(s,t){return this.request({method:"GET",url:s,...t})}async post(s,t,e){return this.request({method:"POST",url:s,body:t,...e})}async put(s,t,e){return this.request({method:"PUT",url:s,body:t,...e})}async patch(s,t){return this.request({method:"PATCH",url:s,...t})}async delete(s,t){return this.request({method:"DELETE",url:s,...t})}};async function a0(s){return ki({__tauriModule:"Http",message:{cmd:"createClient",options:s}}).then(t=>new o0(t))}var Bl=null;async function F1(s,t){return Bl===null&&(Bl=await a0()),Bl.request({url:s,method:(t==null?void 0:t.method)??"GET",...t})}function Te(s){return"Minified Redux error #"+s+"; visit https://redux.js.org/Errors?code="+s+" for the full message or use the non-minified dev environment for full errors. "}var Of=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Dl=function(){return Math.random().toString(36).substring(7).split("").join(".")},ga={INIT:"@@redux/INIT"+Dl(),REPLACE:"@@redux/REPLACE"+Dl(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Dl()}};function B1(s){if(typeof s!="object"||s===null)return!1;for(var t=s;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(s)===t}function D1(s,t,e){var i;if(typeof t=="function"&&typeof e=="function"||typeof e=="function"&&typeof arguments[3]=="function")throw new Error(Te(0));if(typeof t=="function"&&typeof e>"u"&&(e=t,t=void 0),typeof e<"u"){if(typeof e!="function")throw new Error(Te(1));return e(D1)(s,t)}if(typeof s!="function")throw new Error(Te(2));var n=s,r=t,a=[],l=a,o=!1;function h(){l===a&&(l=a.slice())}function c(){if(o)throw new Error(Te(3));return r}function u(p){if(typeof p!="function")throw new Error(Te(4));if(o)throw new Error(Te(5));var g=!0;return h(),l.push(p),function(){if(g){if(o)throw new Error(Te(6));g=!1,h();var _=l.indexOf(p);l.splice(_,1),a=null}}}function d(p){if(!B1(p))throw new Error(Te(7));if(typeof p.type>"u")throw new Error(Te(8));if(o)throw new Error(Te(9));try{o=!0,r=n(r,p)}finally{o=!1}for(var g=a=l,v=0;v<g.length;v++){var _=g[v];_()}return p}function f(p){if(typeof p!="function")throw new Error(Te(10));n=p,d({type:ga.REPLACE})}function m(){var p,g=u;return p={subscribe:function(_){if(typeof _!="object"||_===null)throw new Error(Te(11));function x(){_.next&&_.next(c())}x();var y=g(x);return{unsubscribe:y}}},p[Of]=function(){return this},p}return d({type:ga.INIT}),i={dispatch:d,subscribe:u,getState:c,replaceReducer:f},i[Of]=m,i}function N1(s){Object.keys(s).forEach(function(t){var e=s[t],i=e(void 0,{type:ga.INIT});if(typeof i>"u")throw new Error(Te(12));if(typeof e(void 0,{type:ga.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Te(13))})}function NS(s){for(var t=Object.keys(s),e={},i=0;i<t.length;i++){var n=t[i];typeof s[n]=="function"&&(e[n]=s[n])}var r=Object.keys(e),a;try{N1(e)}catch(l){a=l}return function(o,h){if(o===void 0&&(o={}),a)throw a;for(var c=!1,u={},d=0;d<r.length;d++){var f=r[d],m=e[f],p=o[f],g=m(p,h);if(typeof g>"u")throw h&&h.type,new Error(Te(14));u[f]=g,c=c||g!==p}return c=c||r.length!==Object.keys(o).length,c?u:o}}/*!
 * @pixi/particle-emitter - v5.0.8
 * Compiled Mon, 28 Nov 2022 04:01:38 UTC
 *
 * @pixi/particle-emitter is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */class Gs{constructor(t,e,i){this.value=t,this.time=e,this.next=null,this.isStepped=!1,i?this.ease=typeof i=="function"?i:c0(i):this.ease=null}static createList(t){if("list"in t){const i=t.list;let n;const{value:r,time:a}=i[0],l=n=new Gs(typeof r=="string"?ko(r):r,a,t.ease);if(i.length>2||i.length===2&&i[1].value!==r)for(let o=1;o<i.length;++o){const{value:h,time:c}=i[o];n.next=new Gs(typeof h=="string"?ko(h):h,c),n=n.next}return l.isStepped=!!t.isStepped,l}const e=new Gs(typeof t.start=="string"?ko(t.start):t.start,0);return t.end!==t.start&&(e.next=new Gs(typeof t.end=="string"?ko(t.end):t.end,1)),e}}let zr=K.from;const $s=Math.PI/180;function ci(s,t){if(!s)return;const e=Math.sin(s),i=Math.cos(s),n=t.x*i-t.y*e,r=t.x*e+t.y*i;t.x=n,t.y=r}function Ha(s,t,e){return s<<16|t<<8|e}function l0(s){return Math.sqrt(s.x*s.x+s.y*s.y)}function L1(s){const t=1/l0(s);s.x*=t,s.y*=t}function h0(s,t){s.x*=t,s.y*=t}function ko(s,t){t||(t={}),s.charAt(0)==="#"?s=s.substr(1):s.indexOf("0x")===0&&(s=s.substr(2));let e;return s.length===8&&(e=s.substr(0,2),s=s.substr(2)),t.r=parseInt(s.substr(0,2),16),t.g=parseInt(s.substr(2,2),16),t.b=parseInt(s.substr(4,2),16),e&&(t.a=parseInt(e,16)),t}function c0(s){const t=s.length,e=1/t;return function(i){const n=t*i|0,r=(i-n*e)*t,a=s[n]||s[t-1];return a.s+r*(2*(1-r)*(a.cp-a.s)+r*(a.e-a.s))}}function O1(s){return s?(s=s.toUpperCase().replace(/ /g,"_"),Z[s]||Z.NORMAL):Z.NORMAL}class Nl extends Bs{constructor(t){super(),this.prevChild=this.nextChild=null,this.emitter=t,this.config={},this.anchor.x=this.anchor.y=.5,this.maxLife=0,this.age=0,this.agePercent=0,this.oneOverLife=0,this.next=null,this.prev=null,this.init=this.init,this.kill=this.kill}init(t){this.maxLife=t,this.age=this.agePercent=0,this.rotation=0,this.position.x=this.position.y=0,this.scale.x=this.scale.y=1,this.tint=16777215,this.alpha=1,this.oneOverLife=1/this.maxLife,this.visible=!0}kill(){this.emitter.recycle(this)}destroy(){this.parent&&this.parent.removeChild(this),this.emitter=this.next=this.prev=null,super.destroy()}}var kt;(function(s){s[s.Spawn=0]="Spawn",s[s.Normal=2]="Normal",s[s.Late=5]="Late"})(kt||(kt={}));const Ll=Pt.shared,Ui=Symbol("Position particle per emitter position");class Mt{constructor(t,e){this.initBehaviors=[],this.updateBehaviors=[],this.recycleBehaviors=[],this.minLifetime=0,this.maxLifetime=0,this.customEase=null,this._frequency=1,this.spawnChance=1,this.maxParticles=1e3,this.emitterLifetime=-1,this.spawnPos=new at,this.particlesPerWave=1,this.rotation=0,this.ownerPos=new at,this._prevEmitterPos=new at,this._prevPosIsValid=!1,this._posChanged=!1,this._parent=null,this.addAtBack=!1,this.particleCount=0,this._emit=!1,this._spawnTimer=0,this._emitterLife=-1,this._activeParticlesFirst=null,this._activeParticlesLast=null,this._poolFirst=null,this._origConfig=null,this._autoUpdate=!1,this._destroyWhenComplete=!1,this._completeCallback=null,this.parent=t,e&&this.init(e),this.recycle=this.recycle,this.update=this.update,this.rotate=this.rotate,this.updateSpawnPos=this.updateSpawnPos,this.updateOwnerPos=this.updateOwnerPos}static registerBehavior(t){Mt.knownBehaviors[t.type]=t}get frequency(){return this._frequency}set frequency(t){typeof t=="number"&&t>0?this._frequency=t:this._frequency=1}get parent(){return this._parent}set parent(t){this.cleanup(),this._parent=t}init(t){if(!t)return;this.cleanup(),this._origConfig=t,this.minLifetime=t.lifetime.min,this.maxLifetime=t.lifetime.max,t.ease?this.customEase=typeof t.ease=="function"?t.ease:c0(t.ease):this.customEase=null,this.particlesPerWave=1,t.particlesPerWave&&t.particlesPerWave>1&&(this.particlesPerWave=t.particlesPerWave),this.frequency=t.frequency,this.spawnChance=typeof t.spawnChance=="number"&&t.spawnChance>0?t.spawnChance:1,this.emitterLifetime=t.emitterLifetime||-1,this.maxParticles=t.maxParticles>0?t.maxParticles:1e3,this.addAtBack=!!t.addAtBack,this.rotation=0,this.ownerPos.set(0),t.pos?this.spawnPos.copyFrom(t.pos):this.spawnPos.set(0),this._prevEmitterPos.copyFrom(this.spawnPos),this._prevPosIsValid=!1,this._spawnTimer=0,this.emit=t.emit===void 0?!0:!!t.emit,this.autoUpdate=!!t.autoUpdate;const e=t.behaviors.map(i=>{const n=Mt.knownBehaviors[i.type];return n?new n(i.config):(console.error(`Unknown behavior: ${i.type}`),null)}).filter(i=>!!i);e.push(Ui),e.sort((i,n)=>i===Ui?n.order===kt.Spawn?1:-1:n===Ui?i.order===kt.Spawn?-1:1:i.order-n.order),this.initBehaviors=e.slice(),this.updateBehaviors=e.filter(i=>i!==Ui&&i.updateParticle),this.recycleBehaviors=e.filter(i=>i!==Ui&&i.recycleParticle)}getBehavior(t){return Mt.knownBehaviors[t]&&this.initBehaviors.find(e=>e instanceof Mt.knownBehaviors[t])||null}fillPool(t){for(;t>0;--t){const e=new Nl(this);e.next=this._poolFirst,this._poolFirst=e}}recycle(t,e=!1){for(let i=0;i<this.recycleBehaviors.length;++i)this.recycleBehaviors[i].recycleParticle(t,!e);t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t===this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t===this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),t.prev=null,t.next=this._poolFirst,this._poolFirst=t,t.parent&&t.parent.removeChild(t),--this.particleCount}rotate(t){if(this.rotation===t)return;const e=t-this.rotation;this.rotation=t,ci(e,this.spawnPos),this._posChanged=!0}updateSpawnPos(t,e){this._posChanged=!0,this.spawnPos.x=t,this.spawnPos.y=e}updateOwnerPos(t,e){this._posChanged=!0,this.ownerPos.x=t,this.ownerPos.y=e}resetPositionTracking(){this._prevPosIsValid=!1}get emit(){return this._emit}set emit(t){this._emit=!!t,this._emitterLife=this.emitterLifetime}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){this._autoUpdate&&!t?Ll.remove(this.update,this):!this._autoUpdate&&t&&Ll.add(this.update,this),this._autoUpdate=!!t}playOnceAndDestroy(t){this.autoUpdate=!0,this.emit=!0,this._destroyWhenComplete=!0,this._completeCallback=t}playOnce(t){this.emit=!0,this._completeCallback=t}update(t){if(this._autoUpdate&&(t=Ll.elapsedMS*.001),!this._parent)return;for(let a=this._activeParticlesFirst,l;a;a=l)if(l=a.next,a.age+=t,a.age>a.maxLife||a.age<0)this.recycle(a);else{let o=a.age*a.oneOverLife;this.customEase&&(this.customEase.length===4?o=this.customEase(o,0,1,1):o=this.customEase(o)),a.agePercent=o;for(let h=0;h<this.updateBehaviors.length;++h)if(this.updateBehaviors[h].updateParticle(a,t)){this.recycle(a);break}}let e,i;this._prevPosIsValid&&(e=this._prevEmitterPos.x,i=this._prevEmitterPos.y);const n=this.ownerPos.x+this.spawnPos.x,r=this.ownerPos.y+this.spawnPos.y;if(this._emit)for(this._spawnTimer-=t<0?0:t;this._spawnTimer<=0;){if(this._emitterLife>=0&&(this._emitterLife-=this._frequency,this._emitterLife<=0)){this._spawnTimer=0,this._emitterLife=0,this.emit=!1;break}if(this.particleCount>=this.maxParticles){this._spawnTimer+=this._frequency;continue}let a,l;if(this._prevPosIsValid&&this._posChanged){const c=1+this._spawnTimer/t;a=(n-e)*c+e,l=(r-i)*c+i}else a=n,l=r;let o=null,h=null;for(let c=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),u=0;u<c;++u){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let d;if(this.minLifetime===this.maxLifetime?d=this.minLifetime:d=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,-this._spawnTimer>=d)continue;let f;this._poolFirst?(f=this._poolFirst,this._poolFirst=this._poolFirst.next,f.next=null):f=new Nl(this),f.init(d),this.addAtBack?this._parent.addChildAt(f,0):this._parent.addChild(f),o?(h.next=f,f.prev=h,h=f):h=o=f,++this.particleCount}if(o){this._activeParticlesLast?(this._activeParticlesLast.next=o,o.prev=this._activeParticlesLast,this._activeParticlesLast=h):(this._activeParticlesFirst=o,this._activeParticlesLast=h);for(let c=0;c<this.initBehaviors.length;++c){const u=this.initBehaviors[c];if(u===Ui)for(let d=o,f;d;d=f){f=d.next,this.rotation!==0&&(ci(this.rotation,d.position),d.rotation+=this.rotation),d.position.x+=a,d.position.y+=l,d.age+=-this._spawnTimer;let m=d.age*d.oneOverLife;this.customEase&&(this.customEase.length===4?m=this.customEase(m,0,1,1):m=this.customEase(m)),d.agePercent=m}else u.initParticles(o)}for(let c=o,u;c;c=u){u=c.next;for(let d=0;d<this.updateBehaviors.length;++d)if(this.updateBehaviors[d].updateParticle(c,-this._spawnTimer)){this.recycle(c);break}}}this._spawnTimer+=this._frequency}if(this._posChanged&&(this._prevEmitterPos.x=n,this._prevEmitterPos.y=r,this._prevPosIsValid=!0,this._posChanged=!1),!this._emit&&!this._activeParticlesFirst){if(this._completeCallback){const a=this._completeCallback;this._completeCallback=null,a()}this._destroyWhenComplete&&this.destroy()}}emitNow(){const t=this.ownerPos.x+this.spawnPos.x,e=this.ownerPos.y+this.spawnPos.y;let i=null,n=null;for(let r=Math.min(this.particlesPerWave,this.maxParticles-this.particleCount),a=0;a<r;++a){if(this.spawnChance<1&&Math.random()>=this.spawnChance)continue;let l;this._poolFirst?(l=this._poolFirst,this._poolFirst=this._poolFirst.next,l.next=null):l=new Nl(this);let o;this.minLifetime===this.maxLifetime?o=this.minLifetime:o=Math.random()*(this.maxLifetime-this.minLifetime)+this.minLifetime,l.init(o),this.addAtBack?this._parent.addChildAt(l,0):this._parent.addChild(l),i?(n.next=l,l.prev=n,n=l):n=i=l,++this.particleCount}if(i){this._activeParticlesLast?(this._activeParticlesLast.next=i,i.prev=this._activeParticlesLast,this._activeParticlesLast=n):(this._activeParticlesFirst=i,this._activeParticlesLast=n);for(let r=0;r<this.initBehaviors.length;++r){const a=this.initBehaviors[r];if(a===Ui)for(let l=i,o;l;l=o)o=l.next,this.rotation!==0&&(ci(this.rotation,l.position),l.rotation+=this.rotation),l.position.x+=t,l.position.y+=e;else a.initParticles(i)}}}cleanup(){let t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t,!0);this._activeParticlesFirst=this._activeParticlesLast=null,this.particleCount=0}get destroyed(){return!(this._parent&&this.initBehaviors.length)}destroy(){this.autoUpdate=!1,this.cleanup();let t;for(let e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=this._parent=this.spawnPos=this.ownerPos=this.customEase=this._completeCallback=null,this.initBehaviors.length=this.updateBehaviors.length=this.recycleBehaviors.length=0}}Mt.knownBehaviors={};class Nu{constructor(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h}getRandPos(t){t.x=Math.random()*this.w+this.x,t.y=Math.random()*this.h+this.y}}Nu.type="rect";Nu.editorConfig=null;class za{constructor(t){this.x=t.x||0,this.y=t.y||0,this.radius=t.radius,this.innerRadius=t.innerRadius||0,this.rotation=!!t.affectRotation}getRandPos(t){this.innerRadius!==this.radius?t.x=Math.random()*(this.radius-this.innerRadius)+this.innerRadius:t.x=this.radius,t.y=0;const e=Math.random()*Math.PI*2;this.rotation&&(t.rotation+=e),ci(e,t.position),t.position.x+=this.x,t.position.y+=this.y}}za.type="torus";za.editorConfig=null;class Lu{constructor(t){this.segments=[],this.countingLengths=[],this.totalLength=0,this.init(t)}init(t){if(!t||!t.length)this.segments.push({p1:{x:0,y:0},p2:{x:0,y:0},l:0});else if(Array.isArray(t[0]))for(let e=0;e<t.length;++e){const i=t[e];let n=i[0];for(let r=1;r<i.length;++r){const a=i[r];this.segments.push({p1:n,p2:a,l:0}),n=a}}else{let e=t[0];for(let i=1;i<t.length;++i){const n=t[i];this.segments.push({p1:e,p2:n,l:0}),e=n}}for(let e=0;e<this.segments.length;++e){const{p1:i,p2:n}=this.segments[e],r=Math.sqrt((n.x-i.x)*(n.x-i.x)+(n.y-i.y)*(n.y-i.y));this.segments[e].l=r,this.totalLength+=r,this.countingLengths.push(this.totalLength)}}getRandPos(t){const e=Math.random()*this.totalLength;let i,n;if(this.segments.length===1)i=this.segments[0],n=e;else for(let l=0;l<this.countingLengths.length;++l)if(e<this.countingLengths[l]){i=this.segments[l],n=l===0?e:e-this.countingLengths[l-1];break}n/=i.l||1;const{p1:r,p2:a}=i;t.x=r.x+n*(a.x-r.x),t.y=r.y+n*(a.y-r.y)}}Lu.type="polygonalChain";Lu.editorConfig=null;class Ou{constructor(t){var e;this.order=kt.Late,this.minStart=t.minStart,this.maxStart=t.maxStart,this.accel=t.accel,this.rotate=!!t.rotate,this.maxSpeed=(e=t.maxSpeed)!==null&&e!==void 0?e:0}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.maxStart-this.minStart)+this.minStart;e.config.velocity?e.config.velocity.set(i,0):e.config.velocity=new at(i,0),ci(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=t.config.velocity,n=i.x,r=i.y;if(i.x+=this.accel.x*e,i.y+=this.accel.y*e,this.maxSpeed){const a=l0(i);a>this.maxSpeed&&h0(i,this.maxSpeed/a)}t.x+=(n+i.x)/2*e,t.y+=(r+i.y)/2*e,this.rotate&&(t.rotation=Math.atan2(i.y,i.x))}}Ou.type="moveAcceleration";Ou.editorConfig=null;function V1(s){return this.ease&&(s=this.ease(s)),(this.first.next.value-this.first.value)*s+this.first.value}function U1(s){this.ease&&(s=this.ease(s));const t=this.first.value,e=this.first.next.value,i=(e.r-t.r)*s+t.r,n=(e.g-t.g)*s+t.g,r=(e.b-t.b)*s+t.b;return Ha(i,n,r)}function X1(s){this.ease&&(s=this.ease(s));let t=this.first,e=t.next;for(;s>e.time;)t=e,e=e.next;return s=(s-t.time)/(e.time-t.time),(e.value-t.value)*s+t.value}function Y1(s){this.ease&&(s=this.ease(s));let t=this.first,e=t.next;for(;s>e.time;)t=e,e=e.next;s=(s-t.time)/(e.time-t.time);const i=t.value,n=e.value,r=(n.r-i.r)*s+i.r,a=(n.g-i.g)*s+i.g,l=(n.b-i.b)*s+i.b;return Ha(r,a,l)}function $1(s){this.ease&&(s=this.ease(s));let t=this.first;for(;t.next&&s>t.next.time;)t=t.next;return t.value}function G1(s){this.ease&&(s=this.ease(s));let t=this.first;for(;t.next&&s>t.next.time;)t=t.next;const e=t.value;return Ha(e.r,e.g,e.b)}class ao{constructor(t=!1){this.first=null,this.isColor=!!t,this.interpolate=null,this.ease=null}reset(t){this.first=t,t.next&&t.next.time>=1?this.interpolate=this.isColor?U1:V1:t.isStepped?this.interpolate=this.isColor?G1:$1:this.interpolate=this.isColor?Y1:X1,this.ease=this.first.ease}}class Vu{constructor(t){this.order=kt.Normal,this.list=new ao(!1),this.list.reset(Gs.createList(t.alpha))}initParticles(t){let e=t;for(;e;)e.alpha=this.list.first.value,e=e.next}updateParticle(t){t.alpha=this.list.interpolate(t.agePercent)}}Vu.type="alpha";Vu.editorConfig=null;class Uu{constructor(t){this.order=kt.Normal,this.value=t.alpha}initParticles(t){let e=t;for(;e;)e.alpha=this.value,e=e.next}}Uu.type="alphaStatic";Uu.editorConfig=null;function u0(s){const t=[];for(let e=0;e<s.length;++e){let i=s[e];if(typeof i=="string")t.push(zr(i));else if(i instanceof K)t.push(i);else{let n=i.count||1;for(typeof i.texture=="string"?i=zr(i.texture):i=i.texture;n>0;--n)t.push(i)}}return t}class Xu{constructor(t){this.order=kt.Normal,this.anims=[];for(let e=0;e<t.anims.length;++e){const i=t.anims[e],n=u0(i.textures),r=i.framerate<0?-1:i.framerate>0?i.framerate:60,a={textures:n,duration:r>0?n.length/r:0,framerate:r,loop:r>0?!!i.loop:!1};this.anims.push(a)}}initParticles(t){let e=t;for(;e;){const i=Math.floor(Math.random()*this.anims.length),n=e.config.anim=this.anims[i];e.texture=n.textures[0],e.config.animElapsed=0,n.framerate===-1?(e.config.animDuration=e.maxLife,e.config.animFramerate=n.textures.length/e.maxLife):(e.config.animDuration=n.duration,e.config.animFramerate=n.framerate),e=e.next}}updateParticle(t,e){const i=t.config,n=i.anim;i.animElapsed+=e,i.animElapsed>=i.animDuration&&(i.anim.loop?i.animElapsed=i.animElapsed%i.animDuration:i.animElapsed=i.animDuration-1e-6);const r=i.animElapsed*i.animFramerate+1e-7|0;t.texture=n.textures[r]||n.textures[n.textures.length-1]||K.EMPTY}}Xu.type="animatedRandom";Xu.editorConfig=null;class Yu{constructor(t){this.order=kt.Normal;const e=t.anim,i=u0(e.textures),n=e.framerate<0?-1:e.framerate>0?e.framerate:60;this.anim={textures:i,duration:n>0?i.length/n:0,framerate:n,loop:n>0?!!e.loop:!1}}initParticles(t){let e=t;const i=this.anim;for(;e;)e.texture=i.textures[0],e.config.animElapsed=0,i.framerate===-1?(e.config.animDuration=e.maxLife,e.config.animFramerate=i.textures.length/e.maxLife):(e.config.animDuration=i.duration,e.config.animFramerate=i.framerate),e=e.next}updateParticle(t,e){const i=this.anim,n=t.config;n.animElapsed+=e,n.animElapsed>=n.animDuration&&(i.loop?n.animElapsed=n.animElapsed%n.animDuration:n.animElapsed=n.animDuration-1e-6);const r=n.animElapsed*n.animFramerate+1e-7|0;t.texture=i.textures[r]||i.textures[i.textures.length-1]||K.EMPTY}}Yu.type="animatedSingle";Yu.editorConfig=null;class $u{constructor(t){this.order=kt.Normal,this.value=t.blendMode}initParticles(t){let e=t;for(;e;)e.blendMode=O1(this.value),e=e.next}}$u.type="blendMode";$u.editorConfig=null;class Gu{constructor(t){this.order=kt.Spawn,this.spacing=t.spacing*$s,this.start=t.start*$s,this.distance=t.distance}initParticles(t){let e=0,i=t;for(;i;){let n;this.spacing?n=this.start+this.spacing*e:n=Math.random()*Math.PI*2,i.rotation=n,this.distance&&(i.position.x=this.distance,ci(n,i.position)),i=i.next,++e}}}Gu.type="spawnBurst";Gu.editorConfig=null;class Wu{constructor(t){this.order=kt.Normal,this.list=new ao(!0),this.list.reset(Gs.createList(t.color))}initParticles(t){let e=t;const i=this.list.first.value,n=Ha(i.r,i.g,i.b);for(;e;)e.tint=n,e=e.next}updateParticle(t){t.tint=this.list.interpolate(t.agePercent)}}Wu.type="color";Wu.editorConfig=null;class Hu{constructor(t){this.order=kt.Normal;let e=t.color;e.charAt(0)==="#"?e=e.substr(1):e.indexOf("0x")===0&&(e=e.substr(2)),this.value=parseInt(e,16)}initParticles(t){let e=t;for(;e;)e.tint=this.value,e=e.next}}Hu.type="colorStatic";Hu.editorConfig=null;class zu{constructor(t){this.order=kt.Normal,this.index=0,this.textures=t.textures.map(e=>typeof e=="string"?zr(e):e)}initParticles(t){let e=t;for(;e;)e.texture=this.textures[this.index],++this.index>=this.textures.length&&(this.index=0),e=e.next}}zu.type="textureOrdered";zu.editorConfig=null;const xn=new at,d0=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atanh","atan2","cbrt","ceil","cos","cosh","exp","expm1","floor","fround","hypot","log","log1p","log10","log2","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh"],W1=new RegExp(["[01234567890\\.\\*\\-\\+\\/\\(\\)x ,]"].concat(d0).join("|"),"g");function H1(s){const t=s.match(W1);for(let e=t.length-1;e>=0;--e)d0.indexOf(t[e])>=0&&(t[e]=`Math.${t[e]}`);return s=t.join(""),new Function("x",`return ${s};`)}class ju{constructor(t){var e;if(this.order=kt.Late,t.path)if(typeof t.path=="function")this.path=t.path;else try{this.path=H1(t.path)}catch{this.path=null}else this.path=i=>i;this.list=new ao(!1),this.list.reset(Gs.createList(t.speed)),this.minMult=(e=t.minMult)!==null&&e!==void 0?e:1}initParticles(t){let e=t;for(;e;){e.config.initRotation=e.rotation,e.config.initPosition?e.config.initPosition.copyFrom(e.position):e.config.initPosition=new at(e.x,e.y),e.config.movement=0;const i=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=i,e=e.next}}updateParticle(t,e){const i=this.list.interpolate(t.agePercent)*t.config.speedMult;t.config.movement+=i*e,xn.x=t.config.movement,xn.y=this.path(xn.x),ci(t.config.initRotation,xn),t.position.x=t.config.initPosition.x+xn.x,t.position.y=t.config.initPosition.y+xn.y}}ju.type="movePath";ju.editorConfig=null;class qu{constructor(){this.order=kt.Spawn}initParticles(t){}}qu.type="spawnPoint";qu.editorConfig=null;class Zu{constructor(t){this.order=kt.Normal,this.textures=t.textures.map(e=>typeof e=="string"?zr(e):e)}initParticles(t){let e=t;for(;e;){const i=Math.floor(Math.random()*this.textures.length);e.texture=this.textures[i],e=e.next}}}Zu.type="textureRandom";Zu.editorConfig=null;class Ku{constructor(t){this.order=kt.Normal,this.minStart=t.minStart*$s,this.maxStart=t.maxStart*$s,this.minSpeed=t.minSpeed*$s,this.maxSpeed=t.maxSpeed*$s,this.accel=t.accel*$s}initParticles(t){let e=t;for(;e;)this.minStart===this.maxStart?e.rotation+=this.maxStart:e.rotation+=Math.random()*(this.maxStart-this.minStart)+this.minStart,e.config.rotSpeed=Math.random()*(this.maxSpeed-this.minSpeed)+this.minSpeed,e=e.next}updateParticle(t,e){if(this.accel){const i=t.config.rotSpeed;t.config.rotSpeed+=this.accel*e,t.rotation+=(t.config.rotSpeed+i)/2*e}else t.rotation+=t.config.rotSpeed*e}}Ku.type="rotation";Ku.editorConfig=null;class Qu{constructor(t){this.order=kt.Normal,this.min=t.min*$s,this.max=t.max*$s}initParticles(t){let e=t;for(;e;)this.min===this.max?e.rotation+=this.max:e.rotation+=Math.random()*(this.max-this.min)+this.min,e=e.next}}Qu.type="rotationStatic";Qu.editorConfig=null;class Ju{constructor(t){this.order=kt.Late+1,this.rotation=(t.rotation||0)*$s}initParticles(t){let e=t;for(;e;)e.rotation=this.rotation,e=e.next}}Ju.type="noRotation";Ju.editorConfig=null;class td{constructor(t){var e;this.order=kt.Normal,this.list=new ao(!1),this.list.reset(Gs.createList(t.scale)),this.minMult=(e=t.minMult)!==null&&e!==void 0?e:1}initParticles(t){let e=t;for(;e;){const i=Math.random()*(1-this.minMult)+this.minMult;e.config.scaleMult=i,e.scale.x=e.scale.y=this.list.first.value*i,e=e.next}}updateParticle(t){t.scale.x=t.scale.y=this.list.interpolate(t.agePercent)*t.config.scaleMult}}td.type="scale";td.editorConfig=null;class ed{constructor(t){this.order=kt.Normal,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.max-this.min)+this.min;e.scale.x=e.scale.y=i,e=e.next}}}ed.type="scaleStatic";ed.editorConfig=null;class ks{constructor(t){this.order=kt.Spawn;const e=ks.shapes[t.type];if(!e)throw new Error(`No shape found with type '${t.type}'`);this.shape=new e(t.data)}static registerShape(t,e){ks.shapes[e||t.type]=t}initParticles(t){let e=t;for(;e;)this.shape.getRandPos(e),e=e.next}}ks.type="spawnShape";ks.editorConfig=null;ks.shapes={};ks.registerShape(Lu);ks.registerShape(Nu);ks.registerShape(za);ks.registerShape(za,"circle");class sd{constructor(t){this.order=kt.Normal,this.texture=typeof t.texture=="string"?zr(t.texture):t.texture}initParticles(t){let e=t;for(;e;)e.texture=this.texture,e=e.next}}sd.type="textureSingle";sd.editorConfig=null;class id{constructor(t){var e;this.order=kt.Late,this.list=new ao(!1),this.list.reset(Gs.createList(t.speed)),this.minMult=(e=t.minMult)!==null&&e!==void 0?e:1}initParticles(t){let e=t;for(;e;){const i=Math.random()*(1-this.minMult)+this.minMult;e.config.speedMult=i,e.config.velocity?e.config.velocity.set(this.list.first.value*i,0):e.config.velocity=new at(this.list.first.value*i,0),ci(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=this.list.interpolate(t.agePercent)*t.config.speedMult,n=t.config.velocity;L1(n),h0(n,i),t.x+=n.x*e,t.y+=n.y*e}}id.type="moveSpeed";id.editorConfig=null;class nd{constructor(t){this.order=kt.Late,this.min=t.min,this.max=t.max}initParticles(t){let e=t;for(;e;){const i=Math.random()*(this.max-this.min)+this.min;e.config.velocity?e.config.velocity.set(i,0):e.config.velocity=new at(i,0),ci(e.rotation,e.config.velocity),e=e.next}}updateParticle(t,e){const i=t.config.velocity;t.x+=i.x*e,t.y+=i.y*e}}nd.type="moveSpeedStatic";nd.editorConfig=null;function LS(s,t){var e,i,n,r,a,l,o,h,c,u,d,f,m,p,g,v,_,x,y,b,w;if("behaviors"in s)return s;const E={lifetime:s.lifetime,ease:s.ease,particlesPerWave:s.particlesPerWave,frequency:s.frequency,spawnChance:s.spawnChance,emitterLifetime:s.emitterLifetime,maxParticles:s.maxParticles,addAtBack:s.addAtBack,pos:s.pos,emit:s.emit,autoUpdate:s.autoUpdate,behaviors:[]};if(s.alpha)if("start"in s.alpha)if(s.alpha.start===s.alpha.end)s.alpha.start!==1&&E.behaviors.push({type:"alphaStatic",config:{alpha:s.alpha.start}});else{const S={list:[{time:0,value:s.alpha.start},{time:1,value:s.alpha.end}]};E.behaviors.push({type:"alpha",config:{alpha:S}})}else s.alpha.list.length===1?s.alpha.list[0].value!==1&&E.behaviors.push({type:"alphaStatic",config:{alpha:s.alpha.list[0].value}}):E.behaviors.push({type:"alpha",config:{alpha:s.alpha}});if(s.acceleration&&(s.acceleration.x||s.acceleration.y)){let S,A;"start"in s.speed?(S=s.speed.start*((e=s.speed.minimumSpeedMultiplier)!==null&&e!==void 0?e:1),A=s.speed.start):(S=s.speed.list[0].value*((i=s.minimumSpeedMultiplier)!==null&&i!==void 0?i:1),A=s.speed.list[0].value),E.behaviors.push({type:"moveAcceleration",config:{accel:s.acceleration,minStart:S,maxStart:A,rotate:!s.noRotation,maxSpeed:s.maxSpeed}})}else if(!((n=s.extraData)===null||n===void 0)&&n.path){let S,A;"start"in s.speed?(A=(r=s.speed.minimumSpeedMultiplier)!==null&&r!==void 0?r:1,s.speed.start===s.speed.end?S={list:[{time:0,value:s.speed.start}]}:S={list:[{time:0,value:s.speed.start},{time:1,value:s.speed.end}]}):(S=s.speed,A=(a=s.minimumSpeedMultiplier)!==null&&a!==void 0?a:1),E.behaviors.push({type:"movePath",config:{path:s.extraData.path,speed:S,minMult:A}})}else if(s.speed)if("start"in s.speed)if(s.speed.start===s.speed.end)E.behaviors.push({type:"moveSpeedStatic",config:{min:s.speed.start*((l=s.speed.minimumSpeedMultiplier)!==null&&l!==void 0?l:1),max:s.speed.start}});else{const S={list:[{time:0,value:s.speed.start},{time:1,value:s.speed.end}]};E.behaviors.push({type:"moveSpeed",config:{speed:S,minMult:s.speed.minimumSpeedMultiplier}})}else s.speed.list.length===1?E.behaviors.push({type:"moveSpeedStatic",config:{min:s.speed.list[0].value*((o=s.minimumSpeedMultiplier)!==null&&o!==void 0?o:1),max:s.speed.list[0].value}}):E.behaviors.push({type:"moveSpeed",config:{speed:s.speed,minMult:(h=s.minimumSpeedMultiplier)!==null&&h!==void 0?h:1}});if(s.scale)if("start"in s.scale){const S=(c=s.scale.minimumScaleMultiplier)!==null&&c!==void 0?c:1;if(s.scale.start===s.scale.end)E.behaviors.push({type:"scaleStatic",config:{min:s.scale.start*S,max:s.scale.start}});else{const A={list:[{time:0,value:s.scale.start},{time:1,value:s.scale.end}]};E.behaviors.push({type:"scale",config:{scale:A,minMult:S}})}}else if(s.scale.list.length===1){const S=(u=s.minimumScaleMultiplier)!==null&&u!==void 0?u:1,A=s.scale.list[0].value;E.behaviors.push({type:"scaleStatic",config:{min:A*S,max:A}})}else E.behaviors.push({type:"scale",config:{scale:s.scale,minMult:(d=s.minimumScaleMultiplier)!==null&&d!==void 0?d:1}});if(s.color)if("start"in s.color)if(s.color.start===s.color.end)s.color.start!=="ffffff"&&E.behaviors.push({type:"colorStatic",config:{color:s.color.start}});else{const S={list:[{time:0,value:s.color.start},{time:1,value:s.color.end}]};E.behaviors.push({type:"color",config:{color:S}})}else s.color.list.length===1?s.color.list[0].value!=="ffffff"&&E.behaviors.push({type:"colorStatic",config:{color:s.color.list[0].value}}):E.behaviors.push({type:"color",config:{color:s.color}});if(s.rotationAcceleration||!((f=s.rotationSpeed)===null||f===void 0)&&f.min||!((m=s.rotationSpeed)===null||m===void 0)&&m.max?E.behaviors.push({type:"rotation",config:{accel:s.rotationAcceleration||0,minSpeed:((p=s.rotationSpeed)===null||p===void 0?void 0:p.min)||0,maxSpeed:((g=s.rotationSpeed)===null||g===void 0?void 0:g.max)||0,minStart:((v=s.startRotation)===null||v===void 0?void 0:v.min)||0,maxStart:((_=s.startRotation)===null||_===void 0?void 0:_.max)||0}}):(!((x=s.startRotation)===null||x===void 0)&&x.min||!((y=s.startRotation)===null||y===void 0)&&y.max)&&E.behaviors.push({type:"rotationStatic",config:{min:((b=s.startRotation)===null||b===void 0?void 0:b.min)||0,max:((w=s.startRotation)===null||w===void 0?void 0:w.max)||0}}),s.noRotation&&E.behaviors.push({type:"noRotation",config:{}}),s.blendMode&&s.blendMode!=="normal"&&E.behaviors.push({type:"blendMode",config:{blendMode:s.blendMode}}),Array.isArray(t)&&typeof t[0]!="string"&&"framerate"in t[0]){for(let S=0;S<t.length;++S)t[S].framerate==="matchLife"&&(t[S].framerate=-1);E.behaviors.push({type:"animatedRandom",config:{anims:t}})}else typeof t!="string"&&"framerate"in t?(t.framerate==="matchLife"&&(t.framerate=-1),E.behaviors.push({type:"animatedSingle",config:{anim:t}})):s.orderedArt&&Array.isArray(t)?E.behaviors.push({type:"textureOrdered",config:{textures:t}}):Array.isArray(t)?E.behaviors.push({type:"textureRandom",config:{textures:t}}):E.behaviors.push({type:"textureSingle",config:{texture:t}});if(s.spawnType==="burst")E.behaviors.push({type:"spawnBurst",config:{start:s.angleStart||0,spacing:s.particleSpacing,distance:0}});else if(s.spawnType==="point")E.behaviors.push({type:"spawnPoint",config:{}});else{let S;s.spawnType==="ring"?S={type:"torus",data:{x:s.spawnCircle.x,y:s.spawnCircle.y,radius:s.spawnCircle.r,innerRadius:s.spawnCircle.minR,affectRotation:!0}}:s.spawnType==="circle"?S={type:"torus",data:{x:s.spawnCircle.x,y:s.spawnCircle.y,radius:s.spawnCircle.r,innerRadius:0,affectRotation:!1}}:s.spawnType==="rect"?S={type:"rect",data:s.spawnRect}:s.spawnType==="polygonalChain"&&(S={type:"polygonalChain",data:s.spawnPolygon}),S&&E.behaviors.push({type:"spawnShape",config:S})}return E}Mt.registerBehavior(Ou);Mt.registerBehavior(Vu);Mt.registerBehavior(Uu);Mt.registerBehavior(Xu);Mt.registerBehavior(Yu);Mt.registerBehavior($u);Mt.registerBehavior(Gu);Mt.registerBehavior(Wu);Mt.registerBehavior(Hu);Mt.registerBehavior(zu);Mt.registerBehavior(ju);Mt.registerBehavior(qu);Mt.registerBehavior(Zu);Mt.registerBehavior(Ku);Mt.registerBehavior(Qu);Mt.registerBehavior(Ju);Mt.registerBehavior(td);Mt.registerBehavior(ed);Mt.registerBehavior(ks);Mt.registerBehavior(sd);Mt.registerBehavior(id);Mt.registerBehavior(nd);var z1={};Du(z1,{getName:()=>q1,getTauriVersion:()=>Z1,getVersion:()=>j1,hide:()=>Q1,show:()=>K1});async function j1(){return ki({__tauriModule:"App",message:{cmd:"getAppVersion"}})}async function q1(){return ki({__tauriModule:"App",message:{cmd:"getAppName"}})}async function Z1(){return ki({__tauriModule:"App",message:{cmd:"getTauriVersion"}})}async function K1(){return ki({__tauriModule:"App",message:{cmd:"show"}})}async function Q1(){return ki({__tauriModule:"App",message:{cmd:"hide"}})}export{ur as A,jp as B,wa as C,Mt as E,Zn as G,at as P,ft as R,FS as S,K as T,Bs as a,Z as b,fe as c,E1 as d,vr as e,F1 as f,na as g,NS as h,D1 as i,wc as j,Me as k,A1 as l,tE as m,j1 as n,eE as s,LS as u,n0 as y};
